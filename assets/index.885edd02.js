var M1=Object.defineProperty;var I1=(r,e,t)=>e in r?M1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Pt=(r,e,t)=>(I1(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const Ut=class{constructor({min:e,max:t,arrowFunctionProb:i,mouseFunctionProb:n,modulateItselfProb:s,ignoredList:o,exclusiveSourceList:a,exclusiveFunctionList:l}){Pt(this,"info",`// Random Hydra code generated by HCG: https://github.com/alecominotti/hydracodegenerator/
// @alecominotti

`);Pt(this,"minValue",0);Pt(this,"maxValue",5);Pt(this,"arrowFunctionProb",10);Pt(this,"mouseFunctionProb",0);Pt(this,"modulateItselfProb",20);Pt(this,"ignoredList",["solid","brightness","luma","invert","posterize","thresh","layer","modulateScrollX","modulateScrollY"]);Pt(this,"exclusiveSourceList",[]);Pt(this,"exclusiveFunctionList",[]);if(e&&(this.minValue=e),t&&(this.maxValue=t),e&&t&&e>t){this.printError("Argument max value must be bigger than min value.");return}if(o&&o.length&&(this.ignoredList=o),i)if(0<=i&&i<=100)this.arrowFunctionProb=i;else{this.printError("Arrow function probability must be a number between 0 and 100.");return}if(n)if(0<=n&&n<=100)this.mouseFunctionProb=n;else{this.printError("Mouse arrow function probability must be a number between 0 and 100.");return}if(s)if(0<=s&&s<=100)this.modulateItselfProb=s;else{this.printError("Modulate itself probability must be a number between 0 and 100.");return}if(a&&a.length>0){if(this.checkSources(a))this.exclusiveSourceList=a;else if(!a.length){this.printError("One or more of the specified exclusive sources doesn't exist");return}}if(l&&l.length>0){if(this.checkFunctions(l))this.exclusiveFunctionList=l;else if(!l.length){this.printError("One or more of the specified exclusive functions doesn't exist");return}}if(o.length>0&&(a.length>0||l.length>0)){[...this.exclusiveSourceList,...this.exclusiveFunctionList].some(h=>this.ignoredList.includes(h))&&this.printError("You can't ignore sources or functions specified as exclusive");return}}printError(e){console.log(e)}checkSources(e){return console.log("sources: ",e),Nd(e,Ut.sourcesList)}checkFunctions(e){return console.log("functions: ",e),Nd(e,Ut.allFunctions)}truncate(e,t){const i=10**t;return Math.trunc(i*e)/i}isIgnored(e){return this.ignoredList.includes(e)}isExclusiveSource(e){return this.exclusiveSourceList.length===0?!0:this.exclusiveSourceList.includes(e)}isExclusiveFunction(e){return this.exclusiveFunctionList.length==0?!0:this.exclusiveFunctionList.includes(e)}genNormalValue(){const e=nt.randint(0,3);return this.truncate(nt.uniform(this.minValue,this.maxValue),e).toString()}genArrowFunctionValue(){const e=this.truncate(nt.uniform(.1,1),nt.randint(1,2));return nt.randint(1,100)<=this.arrowFunctionProb?`() => Math.${Ut.mathFunctions[nt.randint(0,Ut.mathFunctions.length-1)]}(time * ${e})`:nt.randint(1,100)<=this.mouseFunctionProb?`() =>  ${Ut.mouseList[nt.randint(0,Ut.mouseList.length-1)]}  * ${e}`:""}genValue(){const e=this.genArrowFunctionValue();return e!==""?e:this.genNormalValue()}genPosOrNegValue(){const e=this.genArrowFunctionValue();return e!=""?e:nt.randint(1,5)==5?"-"+this.genNormalValue():this.genNormalValue()}genCeroOneValue(){const e=this.genArrowFunctionValue();return e!==""?e:this.truncate(nt.uniform(0,1),1).toString()}genCeroPointFiveValue(){const e=this.genArrowFunctionValue();return e!=""?e:this.truncate(nt.uniform(0,.5),2).toString()}genCeroPointOneToMax(){const e=this.genArrowFunctionValue();return e!==""?e:this.truncate(nt.uniform(.1,this.maxValue),2).toString()}genCeroPointOneToOne(){const e=this.genArrowFunctionValue();return e!=""?e:this.truncate(nt.uniform(.1,1),2).toString()}generateCode(e,t){const i=nt.randint(e,t);let n="";return n+=this.info,n+=this.genSource()+`
`,Array(i).fill("").forEach(s=>{n+="  "+this.genFunction()+`
`}),n+=".out(o0)",n}exclusiveIgnoredInteresection(){return Wd(this.exclusiveSourceList,this.ignoredList)}genSource(){let e;this.exclusiveSourceList.length>0?e=this.exclusiveSourceList:e=Ut.sourcesList;const t=this.exclusiveIgnoredInteresection();if(t.length)throw new Error(`the function(s) ${t.toString()} are marked as ignored and exclusive`);const i=nt.choice(e);return this[i]()}genFunction(){let e;this.exclusiveFunctionList.length>0?e=this.exclusiveFunctionList:e=Ut.functionsList;const t=Wd(this.exclusiveFunctionList,this.ignoredList);if(t.length)throw new Error(`the function(s) ${t.toString()} are marked as ignored and exclusive`);const i=nt.choice(e);return this[i]()}setExclusiveSource(e,t){if(t)this.exclusiveSourceList.push(e);else{const i=this.exclusiveSourceList.indexOf(e);this.exclusiveSourceList.splice(i,1)}}setExclusiveFunction(e,t){if(t)this.exclusiveFunctionList.push(e);else{const i=this.exclusiveFunctionList.indexOf(e);this.exclusiveFunctionList.splice(i,1)}}setIgnoredElement(e,t){if(t)this.ignoredList.push(e);else{const i=this.ignoredList.indexOf(e);this.ignoredList.splice(i,1)}}gradient(){return"gradient("+this.genValue()+")"}noise(){return"noise("+this.genValue()+", "+this.genValue()+")"}osc(){return"osc("+this.genValue()+", "+this.genValue()+", "+this.genValue()+")"}shape(){return"shape("+this.genValue()+", "+this.genCeroPointFiveValue()+", "+this.genCeroPointOneToOne()+")"}solid(){return"solid("+this.genCeroOneValue()+", "+this.genCeroOneValue()+", "+this.genCeroOneValue()+", "+this.genCeroPointOneToMax()+")"}voronoi(){return"voronoi("+this.genValue()+", "+this.genValue()+", "+this.genCeroOneValue()+")"}genColor(){const e=nt.choice(Ut.colorList);return this[e]()}genGeometry(){const e=nt.choice(Ut.geometryList);return this[e]()}genModulator(){const e=nt.choice(Ut.modulatorsList);return this[e]()}genOperator(){const e=nt.choice(Ut.operatorsList);return this[e]()}brightness(){return".brightness("+this.genCeroOneValue()+")"}contrast(){return".contrast("+this.genCeroPointOneToMax()+")"}color(){return".color("+this.genCeroOneValue()+", "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")"}colorama(){return".colorama("+this.genValue()+")"}invert(){return".invert("+this.genCeroOneValue()+")"}luma(){return".luma("+this.genCeroOneValue()+")"}posterize(){return".posterize("+this.genCeroOneValue()+", "+this.genCeroOneValue()+")"}saturate(){return".saturate("+this.genValue()+")"}thresh(){return".thresh("+this.genCeroOneValue()+", "+this.genCeroOneValue()+")"}kaleid(){return".kaleid("+this.genValue()+")"}pixelate(){return".pixelate("+this.genCeroPointOneToMax()+", "+this.genCeroPointOneToMax()+")"}repeat(){return".repeat("+this.genValue()+", "+this.genValue()+", "+this.genValue()+", "+this.genValue()+")"}repeatX(){return".repeatX("+this.genValue()+", "+this.genValue()+")"}repeatY(){return".repeatY("+this.genValue()+", "+this.genValue()+")"}rotate(){return".rotate("+this.genValue()+", "+this.genValue()+")"}scale(){return".scale("+this.genPosOrNegValue()+", "+this.genCeroPointOneToOne()+", "+this.genCeroPointOneToOne()+")"}scrollX(){return".scrollX("+this.genValue()+", "+this.genValue()+")"}scrollY(){return".scrollY("+this.genValue()+", "+this.genValue()+")"}add(){return".add("+this.genSource()+", "+this.genCeroOneValue()+")"}blend(){return".blend("+this.genSource()+", "+this.genCeroOneValue()+")"}diff(){return".diff("+this.genSource()+")"}layer(){return".layer("+this.genSource()+")"}mask(){return".mask("+this.genSource()+", "+this.genValue()+", "+this.genCeroOneValue()+")"}mult(){return".mult("+this.genSource()+", "+this.genCeroOneValue()+")"}modulate(){return nt.randint(1,100)<=this.modulateItselfProb?".modulate(o0, "+this.genValue()+")":".modulate("+this.genSource()+", "+this.genValue()+")"}modulateHue(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateHue(o0, "+this.genValue()+")":".modulateHue("+this.genSource()+", "+this.genValue()+")"}modulateKaleid(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateKaleid(o0, "+this.genValue()+")":".modulateKaleid("+this.genSource()+", "+this.genValue()+")"}modulatePixelate(){return nt.randint(1,100)<=this.modulateItselfProb?".modulatePixelate(o0, "+this.genValue()+")":".modulatePixelate("+this.genSource()+", "+this.genValue()+")"}modulateRepeat(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateRepeat(o0, "+this.genValue()+", "+this.genValue()+", "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")":".modulateRepeat("+this.genSource()+", "+this.genValue()+", "+this.genValue()+", "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")"}modulateRepeatX(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateRepeatX(o0, "+this.genValue()+", "+this.genCeroOneValue()+")":".modulateRepeatX("+this.genSource()+", "+this.genValue()+", "+this.genCeroOneValue()+")"}modulateRepeatY(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateRepeatY(o0, "+this.genValue()+", "+this.genCeroOneValue()+")":".modulateRepeatY("+this.genSource()+", "+this.genValue()+", "+this.genCeroOneValue()+")"}modulateRotate(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateRotate(o0, "+this.genValue()+")":".modulateRotate("+this.genSource()+", "+this.genValue()+")"}modulateScale(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateScale(o0, "+this.genValue()+")":".modulateScale("+this.genSource()+", "+this.genValue()+")"}modulateScrollX(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateScrollX(o0, "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")":".modulateScrollX("+this.genSource()+", "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")"}modulateScrollY(){return nt.randint(1,100)<=this.modulateItselfProb?".modulateScrollY(o0, "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")":".modulateScrollY("+this.genSource()+", "+this.genCeroOneValue()+", "+this.genCeroOneValue()+")"}};let ri=Ut;Pt(ri,"mathFunctions",["sin","cos","tan"]),Pt(ri,"mouseList",["mouse.x","mouse.y"]),Pt(ri,"sourcesList",["gradient","noise","osc","shape","solid","voronoi"]),Pt(ri,"colorList",["brightness","contrast","color","colorama","invert","luma","posterize","saturate","thresh"]),Pt(ri,"geometryList",["kaleid","pixelate","repeat","repeatX","repeatY","rotate","scale","scrollX","scrollY"]),Pt(ri,"modulatorsList",["modulate","modulateHue","modulateKaleid","modulatePixelate","modulateRepeat","modulateRepeatX","modulateRepeatY","modulateRotate","modulateScale","modulateScrollX","modulateScrollY"]),Pt(ri,"operatorsList",["add","blend","diff","layer","mask","mult"]),Pt(ri,"functionsList",["genColor","genGeometry","genModulator","genOperator"]),Pt(ri,"allFunctions",[...Ut.colorList,...Ut.geometryList,...Ut.modulatorsList,...Ut.operatorsList]);function Nd(r,e){for(var t=0;t<r.length;t++)if(e.indexOf(r[t])===-1)return!1;return!0}class nt{static randint(e,t){return Math.floor(Math.random()*(t-e))+e}static uniform(e,t){return Math.random()*(t-e)+e}static choice(e){var t=Math.floor(Math.random()*e.length);return e[t]}}function Wd(r,e){for(var t=[],i=0;i<r.length;i++)for(var n=0;n<e.length;n++)if(r[i]==e[n]){t.push(r[i]);break}return t}function B1(r){if(!!r&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=r,document.head.appendChild(e),r}}function jn(r,e){var t=r.__state.conversionName.toString(),i=Math.round(r.r),n=Math.round(r.g),s=Math.round(r.b),o=r.a,a=Math.round(r.h),l=r.s.toFixed(1),f=r.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var c=r.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}else{if(t==="CSS_RGB")return"rgb("+i+","+n+","+s+")";if(t==="CSS_RGBA")return"rgba("+i+","+n+","+s+","+o+")";if(t==="HEX")return"0x"+r.hex.toString(16);if(t==="RGB_ARRAY")return"["+i+","+n+","+s+"]";if(t==="RGBA_ARRAY")return"["+i+","+n+","+s+","+o+"]";if(t==="RGB_OBJ")return"{r:"+i+",g:"+n+",b:"+s+"}";if(t==="RGBA_OBJ")return"{r:"+i+",g:"+n+",b:"+s+",a:"+o+"}";if(t==="HSV_OBJ")return"{h:"+a+",s:"+l+",v:"+f+"}";if(t==="HSVA_OBJ")return"{h:"+a+",s:"+l+",v:"+f+",a:"+o+"}"}return"unknown format"}var Fd=Array.prototype.forEach,ws=Array.prototype.slice,fe={BREAK:{},extend:function(e){return this.each(ws.call(arguments,1),function(t){var i=this.isObject(t)?Object.keys(t):[];i.forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(ws.call(arguments,1),function(t){var i=this.isObject(t)?Object.keys(t):[];i.forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=ws.call(arguments);return function(){for(var t=ws.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(!!e){if(Fd&&e.forEach&&e.forEach===Fd)e.forEach(t,i);else if(e.length===e.length+0){var n=void 0,s=void 0;for(n=0,s=e.length;n<s;n++)if(n in e&&t.call(i,e[n],n)===this.BREAK)return}else for(var o in e)if(t.call(i,e[o],o)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var n=void 0;return function(){var s=this,o=arguments;function a(){n=null,i||e.apply(s,o)}var l=i||!n;clearTimeout(n),n=setTimeout(a,t),l&&e.apply(s,o)}},toArray:function(e){return e.toArray?e.toArray():ws.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(r){function e(t){return r.apply(this,arguments)}return e.toString=function(){return r.toString()},e}(function(r){return isNaN(r)}),isArray:Array.isArray||function(r){return r.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},G1=[{litmus:fe.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:jn},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:jn},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:jn},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:jn}}},{litmus:fe.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:fe.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:fe.isObject,conversions:{RGBA_OBJ:{read:function(e){return fe.isNumber(e.r)&&fe.isNumber(e.g)&&fe.isNumber(e.b)&&fe.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return fe.isNumber(e.r)&&fe.isNumber(e.g)&&fe.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return fe.isNumber(e.h)&&fe.isNumber(e.s)&&fe.isNumber(e.v)&&fe.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return fe.isNumber(e.h)&&fe.isNumber(e.s)&&fe.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],Ts=void 0,Jo=void 0,Ea=function(){Jo=!1;var e=arguments.length>1?fe.toArray(arguments):arguments[0];return fe.each(G1,function(t){if(t.litmus(e))return fe.each(t.conversions,function(i,n){if(Ts=i.read(e),Jo===!1&&Ts!==!1)return Jo=Ts,Ts.conversionName=n,Ts.conversion=i,fe.BREAK}),fe.BREAK}),Jo},Xd=void 0,Us={hsv_to_rgb:function(e,t,i){var n=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),o=i*(1-t),a=i*(1-s*t),l=i*(1-(1-s)*t),f=[[i,l,o],[a,i,o],[o,i,l],[o,a,i],[l,o,i],[i,o,a]][n];return{r:f[0]*255,g:f[1]*255,b:f[2]*255}},rgb_to_hsv:function(e,t,i){var n=Math.min(e,t,i),s=Math.max(e,t,i),o=s-n,a=void 0,l=void 0;if(s!==0)l=o/s;else return{h:NaN,s:0,v:0};return e===s?a=(t-i)/o:t===s?a=2+(i-e)/o:a=4+(e-t)/o,a/=6,a<0&&(a+=1),{h:a*360,s:l,v:s/255}},rgb_to_hex:function(e,t,i){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,i),n},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,i){return i<<(Xd=t*8)|e&~(255<<Xd)}},N1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Wi=function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")},Fi=function(){function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),Lr=function r(e,t,i){e===null&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(n===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:r(s,t,i)}else{if("value"in n)return n.value;var o=n.get;return o===void 0?void 0:o.call(i)}},Nr=function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)},Wr=function(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r},Nt=function(){function r(){if(Wi(this,r),this.__state=Ea.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Fi(r,[{key:"toString",value:function(){return jn(this)}},{key:"toHexString",value:function(){return jn(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),r}();function Yc(r,e,t){Object.defineProperty(r,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(Nt.recalculateRGB(this,e,t),this.__state[e])},set:function(n){this.__state.space!=="RGB"&&(Nt.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=n}})}function Kc(r,e){Object.defineProperty(r,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(Nt.recalculateHSV(this),this.__state[e])},set:function(i){this.__state.space!=="HSV"&&(Nt.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}Nt.recalculateRGB=function(r,e,t){if(r.__state.space==="HEX")r.__state[e]=Us.component_from_hex(r.__state.hex,t);else if(r.__state.space==="HSV")fe.extend(r.__state,Us.hsv_to_rgb(r.__state.h,r.__state.s,r.__state.v));else throw new Error("Corrupted color state")};Nt.recalculateHSV=function(r){var e=Us.rgb_to_hsv(r.r,r.g,r.b);fe.extend(r.__state,{s:e.s,v:e.v}),fe.isNaN(e.h)?fe.isUndefined(r.__state.h)&&(r.__state.h=0):r.__state.h=e.h};Nt.COMPONENTS=["r","g","b","h","s","v","hex","a"];Yc(Nt.prototype,"r",2);Yc(Nt.prototype,"g",1);Yc(Nt.prototype,"b",0);Kc(Nt.prototype,"h");Kc(Nt.prototype,"s");Kc(Nt.prototype,"v");Object.defineProperty(Nt.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(Nt.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Us.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Fr=function(){function r(e,t){Wi(this,r),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return Fi(r,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),r}(),W1={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},tO={};fe.each(W1,function(r,e){fe.each(r,function(t){tO[t]=e})});var F1=/(\d+(\.\d+)?)px/;function qi(r){if(r==="0"||fe.isUndefined(r))return 0;var e=r.match(F1);return fe.isNull(e)?0:parseFloat(e[1])}var X={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var n=i,s=t;fe.isUndefined(s)&&(s=!0),fe.isUndefined(n)&&(n=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,n){var s=i||{},o=tO[t];if(!o)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":{var l=s.x||s.clientX||0,f=s.y||s.clientY||0;a.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,l,f,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var c=a.initKeyboardEvent||a.initKeyEvent;fe.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break}default:{a.initEvent(t,s.bubbles||!1,s.cancelable||!0);break}}fe.defaults(a,n),e.dispatchEvent(a)},bind:function(e,t,i,n){var s=n||!1;return e.addEventListener?e.addEventListener(t,i,s):e.attachEvent&&e.attachEvent("on"+t,i),X},unbind:function(e,t,i,n){var s=n||!1;return e.removeEventListener?e.removeEventListener(t,i,s):e.detachEvent&&e.detachEvent("on"+t,i),X},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);i.indexOf(t)===-1&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return X},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),n=i.indexOf(t);n!==-1&&(i.splice(n,1),e.className=i.join(" "))}else e.className=void 0;return X},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return qi(t["border-left-width"])+qi(t["border-right-width"])+qi(t["padding-left"])+qi(t["padding-right"])+qi(t.width)},getHeight:function(e){var t=getComputedStyle(e);return qi(t["border-top-width"])+qi(t["border-bottom-width"])+qi(t["padding-top"])+qi(t["padding-bottom"])+qi(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent;while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Jc=function(r){Nr(e,r);function e(t,i){Wi(this,e);var n=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=n;n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox");function o(){s.setValue(!s.__prev)}return X.bind(n.__checkbox,"change",o,!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return Fi(e,[{key:"setValue",value:function(i){var n=Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Fr),iO=function(r){Nr(e,r);function e(t,i,n){Wi(this,e);var s=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=n,a=s;if(s.__select=document.createElement("select"),fe.isArray(o)){var l={};fe.each(o,function(f){l[f]=f}),o=l}return fe.each(o,function(f,c){var h=document.createElement("option");h.innerHTML=c,h.setAttribute("value",f),a.__select.appendChild(h)}),s.updateDisplay(),X.bind(s.__select,"change",function(){var f=this.options[this.selectedIndex].value;a.setValue(f)}),s.domElement.appendChild(s.__select),s}return Fi(e,[{key:"setValue",value:function(i){var n=Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return X.isActive(this.__select)?this:(this.__select.value=this.getValue(),Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Fr),rO=function(r){Nr(e,r);function e(t,i){Wi(this,e);var n=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),s=n;function o(){s.setValue(s.__input.value)}function a(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),X.bind(n.__input,"keyup",o),X.bind(n.__input,"change",o),X.bind(n.__input,"blur",a),X.bind(n.__input,"keydown",function(l){l.keyCode===13&&this.blur()}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return Fi(e,[{key:"updateDisplay",value:function(){return X.isActive(this.__input)||(this.__input.value=this.getValue()),Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Fr);function jd(r){var e=r.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var eh=function(r){Nr(e,r);function e(t,i,n){Wi(this,e);var s=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=n||{};return s.__min=o.min,s.__max=o.max,s.__step=o.step,fe.isUndefined(s.__step)?s.initialValue===0?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=jd(s.__impliedStep),s}return Fi(e,[{key:"setValue",value:function(i){var n=i;return this.__min!==void 0&&n<this.__min?n=this.__min:this.__max!==void 0&&n>this.__max&&(n=this.__max),this.__step!==void 0&&n%this.__step!==0&&(n=Math.round(n/this.__step)*this.__step),Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=jd(i),this}}]),e}(Fr);function X1(r,e){var t=Math.pow(10,e);return Math.round(r*t)/t}var qs=function(r){Nr(e,r);function e(t,i,n){Wi(this,e);var s=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n));s.__truncationSuspended=!1;var o=s,a=void 0;function l(){var _=parseFloat(o.__input.value);fe.isNaN(_)||o.setValue(_)}function f(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function c(){f()}function h(_){var D=a-_.clientY;o.setValue(o.getValue()+D*o.__impliedStep),a=_.clientY}function d(){X.unbind(window,"mousemove",h),X.unbind(window,"mouseup",d),f()}function g(_){X.bind(window,"mousemove",h),X.bind(window,"mouseup",d),a=_.clientY}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),X.bind(s.__input,"change",l),X.bind(s.__input,"blur",c),X.bind(s.__input,"mousedown",g),X.bind(s.__input,"keydown",function(_){_.keyCode===13&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,f())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return Fi(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():X1(this.getValue(),this.__precision),Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(eh);function Vd(r,e,t,i,n){return i+(n-i)*((r-e)/(t-e))}var Ra=function(r){Nr(e,r);function e(t,i,n,s,o){Wi(this,e);var a=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:n,max:s,step:o})),l=a;a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),X.bind(a.__background,"mousedown",f),X.bind(a.__background,"touchstart",d),X.addClass(a.__background,"slider"),X.addClass(a.__foreground,"slider-fg");function f(D){document.activeElement.blur(),X.bind(window,"mousemove",c),X.bind(window,"mouseup",h),c(D)}function c(D){D.preventDefault();var E=l.__background.getBoundingClientRect();return l.setValue(Vd(D.clientX,E.left,E.right,l.__min,l.__max)),!1}function h(){X.unbind(window,"mousemove",c),X.unbind(window,"mouseup",h),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function d(D){D.touches.length===1&&(X.bind(window,"touchmove",g),X.bind(window,"touchend",_),g(D))}function g(D){var E=D.touches[0].clientX,U=l.__background.getBoundingClientRect();l.setValue(Vd(E,U.left,U.right,l.__min,l.__max))}function _(){X.unbind(window,"touchmove",g),X.unbind(window,"touchend",_),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return Fi(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=i*100+"%",Lr(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(eh),th=function(r){Nr(e,r);function e(t,i,n){Wi(this,e);var s=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=s;return s.__button=document.createElement("div"),s.__button.innerHTML=n===void 0?"Fire":n,X.bind(s.__button,"click",function(a){return a.preventDefault(),o.fire(),!1}),X.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return Fi(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Fr),Pa=function(r){Nr(e,r);function e(t,i){Wi(this,e);var n=Wr(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));n.__color=new Nt(n.getValue()),n.__temp=new Nt(0);var s=n;n.domElement=document.createElement("div"),X.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",X.bind(n.__input,"keydown",function(D){D.keyCode===13&&h.call(this)}),X.bind(n.__input,"blur",h),X.bind(n.__selector,"mousedown",function(){X.addClass(this,"drag").bind(window,"mouseup",function(){X.removeClass(s.__selector,"drag")})}),X.bind(n.__selector,"touchstart",function(){X.addClass(this,"drag").bind(window,"touchend",function(){X.removeClass(s.__selector,"drag")})});var o=document.createElement("div");fe.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),fe.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),fe.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),fe.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),fe.extend(o.style,{width:"100%",height:"100%",background:"none"}),Zd(o,"top","rgba(0,0,0,0)","#000"),fe.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),V1(n.__hue_field),fe.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),X.bind(n.__saturation_field,"mousedown",a),X.bind(n.__saturation_field,"touchstart",a),X.bind(n.__field_knob,"mousedown",a),X.bind(n.__field_knob,"touchstart",a),X.bind(n.__hue_field,"mousedown",l),X.bind(n.__hue_field,"touchstart",l);function a(D){g(D),X.bind(window,"mousemove",g),X.bind(window,"touchmove",g),X.bind(window,"mouseup",f),X.bind(window,"touchend",f)}function l(D){_(D),X.bind(window,"mousemove",_),X.bind(window,"touchmove",_),X.bind(window,"mouseup",c),X.bind(window,"touchend",c)}function f(){X.unbind(window,"mousemove",g),X.unbind(window,"touchmove",g),X.unbind(window,"mouseup",f),X.unbind(window,"touchend",f),d()}function c(){X.unbind(window,"mousemove",_),X.unbind(window,"touchmove",_),X.unbind(window,"mouseup",c),X.unbind(window,"touchend",c),d()}function h(){var D=Ea(this.value);D!==!1?(s.__color.__state=D,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function d(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}n.__saturation_field.appendChild(o),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay();function g(D){D.type.indexOf("touch")===-1&&D.preventDefault();var E=s.__saturation_field.getBoundingClientRect(),U=D.touches&&D.touches[0]||D,Qe=U.clientX,pe=U.clientY,Te=(Qe-E.left)/(E.right-E.left),we=1-(pe-E.top)/(E.bottom-E.top);return we>1?we=1:we<0&&(we=0),Te>1?Te=1:Te<0&&(Te=0),s.__color.v=we,s.__color.s=Te,s.setValue(s.__color.toOriginal()),!1}function _(D){D.type.indexOf("touch")===-1&&D.preventDefault();var E=s.__hue_field.getBoundingClientRect(),U=D.touches&&D.touches[0]||D,Qe=U.clientY,pe=1-(Qe-E.top)/(E.bottom-E.top);return pe>1?pe=1:pe<0&&(pe=0),s.__color.h=pe*360,s.setValue(s.__color.toOriginal()),!1}return n}return Fi(e,[{key:"updateDisplay",value:function(){var i=Ea(this.getValue());if(i!==!1){var n=!1;fe.each(Nt.COMPONENTS,function(a){if(!fe.isUndefined(i[a])&&!fe.isUndefined(this.__color.__state[a])&&i[a]!==this.__color.__state[a])return n=!0,{}},this),n&&fe.extend(this.__color.__state,i)}fe.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,o=255-s;fe.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,Zd(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),fe.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(Fr),j1=["-moz-","-o-","-webkit-","-ms-",""];function Zd(r,e,t,i){r.style.background="",fe.each(j1,function(n){r.style.cssText+="background: "+n+"linear-gradient("+e+", "+t+" 0%, "+i+" 100%); "})}function V1(r){r.style.background="",r.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",r.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",r.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Z1={load:function(e,t){var i=t||document,n=i.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,i.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){var i=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var s=i.getElementsByTagName("head")[0];try{s.appendChild(n)}catch{}}},z1=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,U1=function(e,t){var i=e[t];return fe.isArray(arguments[2])||fe.isObject(arguments[2])?new iO(e,t,arguments[2]):fe.isNumber(i)?fe.isNumber(arguments[2])&&fe.isNumber(arguments[3])?fe.isNumber(arguments[4])?new Ra(e,t,arguments[2],arguments[3],arguments[4]):new Ra(e,t,arguments[2],arguments[3]):fe.isNumber(arguments[4])?new qs(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new qs(e,t,{min:arguments[2],max:arguments[3]}):fe.isString(i)?new rO(e,t):fe.isFunction(i)?new th(e,t,""):fe.isBoolean(i)?new Jc(e,t):null};function q1(r){setTimeout(r,1e3/60)}var H1=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||q1,Y1=function(){function r(){Wi(this,r),this.backgroundElement=document.createElement("div"),fe.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),X.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),fe.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;X.bind(this.backgroundElement,"click",function(){e.hide()})}return Fi(r,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),fe.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,i=function n(){t.domElement.style.display="none",t.backgroundElement.style.display="none",X.unbind(t.domElement,"webkitTransitionEnd",n),X.unbind(t.domElement,"transitionend",n),X.unbind(t.domElement,"oTransitionEnd",n)};X.bind(this.domElement,"webkitTransitionEnd",i),X.bind(this.domElement,"transitionend",i),X.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-X.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-X.getHeight(this.domElement)/2+"px"}}]),r}(),K1=B1(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Z1.inject(K1);var zd="dg",Ud=72,qd=20,Hs="Default",Ps=function(){try{return!!window.localStorage}catch{return!1}}(),Ns=void 0,Hd=!0,Gn=void 0,kf=!1,nO=[],ft=function r(e){var t=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),X.addClass(this.domElement,zd),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=fe.defaults(i,{closeOnTop:!1,autoPlace:!0,width:r.DEFAULT_WIDTH}),i=fe.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),fe.isUndefined(i.load)?i.load={preset:Hs}:i.preset&&(i.load.preset=i.preset),fe.isUndefined(i.parent)&&i.hideable&&nO.push(this),i.resizable=fe.isUndefined(i.parent)&&i.resizable,i.autoPlace&&fe.isUndefined(i.scrollable)&&(i.scrollable=!0);var n=Ps&&localStorage.getItem(Nn(this,"isLocal"))==="true",s=void 0,o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:i.load.preset},set:function(d){t.parent?t.getRoot().preset=d:i.load.preset=d,ix(this),t.revert()}},width:{get:function(){return i.width},set:function(d){i.width=d,ac(t,d)}},name:{get:function(){return i.name},set:function(d){i.name=d,o&&(o.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(d){i.closed=d,i.closed?X.addClass(t.__ul,r.CLASS_CLOSED):X.removeClass(t.__ul,r.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=d?r.TEXT_OPEN:r.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return n},set:function(d){Ps&&(n=d,d?X.bind(window,"unload",s):X.unbind(window,"unload",s),localStorage.setItem(Nn(t,"isLocal"),d))}}}),fe.isUndefined(i.parent)){if(this.closed=i.closed||!1,X.addClass(this.domElement,r.CLASS_MAIN),X.makeSelectable(this.domElement,!1),Ps&&n){t.useLocalStorage=!0;var a=localStorage.getItem(Nn(this,"gui"));a&&(i.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=r.TEXT_CLOSED,X.addClass(this.__closeButton,r.CLASS_CLOSE_BUTTON),i.closeOnTop?(X.addClass(this.__closeButton,r.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(X.addClass(this.__closeButton,r.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),X.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{i.closed===void 0&&(i.closed=!0);var l=document.createTextNode(i.name);X.addClass(l,"controller-name"),o=ih(t,l);var f=function(d){return d.preventDefault(),t.closed=!t.closed,!1};X.addClass(this.__ul,r.CLASS_CLOSED),X.addClass(o,"title"),X.bind(o,"click",f),i.closed||(this.closed=!1)}i.autoPlace&&(fe.isUndefined(i.parent)&&(Hd&&(Gn=document.createElement("div"),X.addClass(Gn,zd),X.addClass(Gn,r.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Gn),Hd=!1),Gn.appendChild(this.domElement),X.addClass(this.domElement,r.CLASS_AUTO_PLACE)),this.parent||ac(t,i.width)),this.__resizeHandler=function(){t.onResizeDebounced()},X.bind(window,"resize",this.__resizeHandler),X.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),X.bind(this.__ul,"transitionend",this.__resizeHandler),X.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&tx(this),s=function(){Ps&&localStorage.getItem(Nn(t,"isLocal"))==="true"&&localStorage.setItem(Nn(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=s;function c(){var h=t.getRoot();h.width+=1,fe.defer(function(){h.width-=1})}i.parent||c()};ft.toggleHide=function(){kf=!kf,fe.each(nO,function(r){r.domElement.style.display=kf?"none":""})};ft.CLASS_AUTO_PLACE="a";ft.CLASS_AUTO_PLACE_CONTAINER="ac";ft.CLASS_MAIN="main";ft.CLASS_CONTROLLER_ROW="cr";ft.CLASS_TOO_TALL="taller-than-window";ft.CLASS_CLOSED="closed";ft.CLASS_CLOSE_BUTTON="close-button";ft.CLASS_CLOSE_TOP="close-top";ft.CLASS_CLOSE_BOTTOM="close-bottom";ft.CLASS_DRAG="drag";ft.DEFAULT_WIDTH=245;ft.TEXT_CLOSED="Close Controls";ft.TEXT_OPEN="Open Controls";ft._keydownHandler=function(r){document.activeElement.type!=="text"&&(r.which===Ud||r.keyCode===Ud)&&ft.toggleHide()};X.bind(window,"keydown",ft._keydownHandler,!1);fe.extend(ft.prototype,{add:function(e,t){return Ws(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Ws(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;fe.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Gn.removeChild(this.domElement);var e=this;fe.each(this.__folders,function(t){e.removeFolder(t)}),X.unbind(window,"keydown",ft._keydownHandler,!1),Yd(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new ft(t);this.__folders[e]=i;var n=ih(this,i.domElement);return X.addClass(n,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Yd(e);var t=this;fe.each(e.__folders,function(i){e.removeFolder(i)}),fe.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=X.getOffset(e.__ul).top,i=0;fe.each(e.__ul.childNodes,function(n){e.autoPlace&&n===e.__save_row||(i+=X.getHeight(n))}),window.innerHeight-t-qd<i?(X.addClass(e.domElement,ft.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-qd+"px"):(X.removeClass(e.domElement,ft.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&fe.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:fe.debounce(function(){this.onResize()},50),remember:function(){if(fe.isUndefined(Ns)&&(Ns=new Y1,Ns.domElement.innerHTML=z1),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;fe.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&ex(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&ac(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ea(this)),e.folders={},fe.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ea(this),sc(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Hs]=ea(this,!0)),this.load.remembered[e]=ea(this),this.preset=e,oc(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){fe.each(this.__controllers,function(t){this.getRoot().load.remembered?sO(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),fe.each(this.__folders,function(t){t.revert(t)}),e||sc(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&oO(this.__listening)},updateDisplay:function(){fe.each(this.__controllers,function(e){e.updateDisplay()}),fe.each(this.__folders,function(e){e.updateDisplay()})}});function ih(r,e,t){var i=document.createElement("li");return e&&i.appendChild(e),t?r.__ul.insertBefore(i,t):r.__ul.appendChild(i),r.onResize(),i}function Yd(r){X.unbind(window,"resize",r.__resizeHandler),r.saveToLocalStorageIfPossible&&X.unbind(window,"unload",r.saveToLocalStorageIfPossible)}function sc(r,e){var t=r.__preset_select[r.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function J1(r,e,t){if(t.__li=e,t.__gui=r,fe.extend(t,{options:function(o){if(arguments.length>1){var a=t.__li.nextElementSibling;return t.remove(),Ws(r,t.object,t.property,{before:a,factoryArgs:[fe.toArray(arguments)]})}if(fe.isArray(o)||fe.isObject(o)){var l=t.__li.nextElementSibling;return t.remove(),Ws(r,t.object,t.property,{before:l,factoryArgs:[o]})}},name:function(o){return t.__li.firstElementChild.firstElementChild.innerHTML=o,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof Ra){var i=new qs(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});fe.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var o=t[s],a=i[s];t[s]=i[s]=function(){var l=Array.prototype.slice.call(arguments);return a.apply(i,l),o.apply(t,l)}}),X.addClass(e,"has-slider"),t.domElement.insertBefore(i.domElement,t.domElement.firstElementChild)}else if(t instanceof qs){var n=function(o){if(fe.isNumber(t.__min)&&fe.isNumber(t.__max)){var a=t.__li.firstElementChild.firstElementChild.innerHTML,l=t.__gui.__listening.indexOf(t)>-1;t.remove();var f=Ws(r,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return f.name(a),l&&f.listen(),f}return o};t.min=fe.compose(n,t.min),t.max=fe.compose(n,t.max)}else t instanceof Jc?(X.bind(e,"click",function(){X.fakeEvent(t.__checkbox,"click")}),X.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof th?(X.bind(e,"click",function(){X.fakeEvent(t.__button,"click")}),X.bind(e,"mouseover",function(){X.addClass(t.__button,"hover")}),X.bind(e,"mouseout",function(){X.removeClass(t.__button,"hover")})):t instanceof Pa&&(X.addClass(e,"color"),t.updateDisplay=fe.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=fe.compose(function(s){return r.getRoot().__preset_select&&t.isModified()&&sc(r.getRoot(),!0),s},t.setValue)}function sO(r,e){var t=r.getRoot(),i=t.__rememberedObjects.indexOf(e.object);if(i!==-1){var n=t.__rememberedObjectIndecesToControllers[i];if(n===void 0&&(n={},t.__rememberedObjectIndecesToControllers[i]=n),n[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,o=void 0;if(s[r.preset])o=s[r.preset];else if(s[Hs])o=s[Hs];else return;if(o[i]&&o[i][e.property]!==void 0){var a=o[i][e.property];e.initialValue=a,e.setValue(a)}}}}function Ws(r,e,t,i){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var n=void 0;if(i.color)n=new Pa(e,t);else{var s=[e,t].concat(i.factoryArgs);n=U1.apply(r,s)}i.before instanceof Fr&&(i.before=i.before.__li),sO(r,n),X.addClass(n.domElement,"c");var o=document.createElement("span");X.addClass(o,"property-name"),o.innerHTML=n.property;var a=document.createElement("div");a.appendChild(o),a.appendChild(n.domElement);var l=ih(r,a,i.before);return X.addClass(l,ft.CLASS_CONTROLLER_ROW),n instanceof Pa?X.addClass(l,"color"):X.addClass(l,N1(n.getValue())),J1(r,l,n),r.__controllers.push(n),n}function Nn(r,e){return document.location.href+"."+e}function oc(r,e,t){var i=document.createElement("option");i.innerHTML=e,i.value=e,r.__preset_select.appendChild(i),t&&(r.__preset_select.selectedIndex=r.__preset_select.length-1)}function Kd(r,e){e.style.display=r.useLocalStorage?"block":"none"}function ex(r){var e=r.__save_row=document.createElement("li");X.addClass(r.domElement,"has-save"),r.__ul.insertBefore(e,r.__ul.firstChild),X.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",X.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",X.addClass(i,"button"),X.addClass(i,"save");var n=document.createElement("span");n.innerHTML="New",X.addClass(n,"button"),X.addClass(n,"save-as");var s=document.createElement("span");s.innerHTML="Revert",X.addClass(s,"button"),X.addClass(s,"revert");var o=r.__preset_select=document.createElement("select");if(r.load&&r.load.remembered?fe.each(r.load.remembered,function(h,d){oc(r,d,d===r.preset)}):oc(r,Hs,!1),X.bind(o,"change",function(){for(var h=0;h<r.__preset_select.length;h++)r.__preset_select[h].innerHTML=r.__preset_select[h].value;r.preset=this.value}),e.appendChild(o),e.appendChild(t),e.appendChild(i),e.appendChild(n),e.appendChild(s),Ps){var a=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage"),f=document.getElementById("dg-save-locally");f.style.display="block",localStorage.getItem(Nn(r,"isLocal"))==="true"&&l.setAttribute("checked","checked"),Kd(r,a),X.bind(l,"change",function(){r.useLocalStorage=!r.useLocalStorage,Kd(r,a)})}var c=document.getElementById("dg-new-constructor");X.bind(c,"keydown",function(h){h.metaKey&&(h.which===67||h.keyCode===67)&&Ns.hide()}),X.bind(t,"click",function(){c.innerHTML=JSON.stringify(r.getSaveObject(),void 0,2),Ns.show(),c.focus(),c.select()}),X.bind(i,"click",function(){r.save()}),X.bind(n,"click",function(){var h=prompt("Enter a new preset name.");h&&r.saveAs(h)}),X.bind(s,"click",function(){r.revert()})}function tx(r){var e=void 0;r.__resize_handle=document.createElement("div"),fe.extend(r.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(s){return s.preventDefault(),r.width+=e-s.clientX,r.onResize(),e=s.clientX,!1}function i(){X.removeClass(r.__closeButton,ft.CLASS_DRAG),X.unbind(window,"mousemove",t),X.unbind(window,"mouseup",i)}function n(s){return s.preventDefault(),e=s.clientX,X.addClass(r.__closeButton,ft.CLASS_DRAG),X.bind(window,"mousemove",t),X.bind(window,"mouseup",i),!1}X.bind(r.__resize_handle,"mousedown",n),X.bind(r.__closeButton,"mousedown",n),r.domElement.insertBefore(r.__resize_handle,r.domElement.firstElementChild)}function ac(r,e){r.domElement.style.width=e+"px",r.__save_row&&r.autoPlace&&(r.__save_row.style.width=e+"px"),r.__closeButton&&(r.__closeButton.style.width=e+"px")}function ea(r,e){var t={};return fe.each(r.__rememberedObjects,function(i,n){var s={},o=r.__rememberedObjectIndecesToControllers[n];fe.each(o,function(a,l){s[l]=e?a.initialValue:a.getValue()}),t[n]=s}),t}function ix(r){for(var e=0;e<r.__preset_select.length;e++)r.__preset_select[e].value===r.preset&&(r.__preset_select.selectedIndex=e)}function oO(r){r.length!==0&&H1.call(window,function(){oO(r)}),fe.each(r,function(e){e.updateDisplay()})}var rx={Color:Nt,math:Us,interpret:Ea},nx={Controller:Fr,BooleanController:Jc,OptionController:iO,StringController:rO,NumberController:eh,NumberControllerBox:qs,NumberControllerSlider:Ra,FunctionController:th,ColorController:Pa},sx={dom:X},ox={GUI:ft},ax=ft,lx={color:rx,controllers:nx,dom:sx,gui:ox,GUI:ax},fx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},aO={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(l,f,c){this.fn=l,this.context=f,this.once=c||!1}function s(l,f,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var g=new n(c,h||l,d),_=t?t+f:f;return l._events[_]?l._events[_].fn?l._events[_]=[l._events[_],g]:l._events[_].push(g):(l._events[_]=g,l._eventsCount++),l}function o(l,f){--l._eventsCount===0?l._events=new i:delete l._events[f]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var f=[],c,h;if(this._eventsCount===0)return f;for(h in c=this._events)e.call(c,h)&&f.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(c)):f},a.prototype.listeners=function(f){var c=t?t+f:f,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,g=h.length,_=new Array(g);d<g;d++)_[d]=h[d].fn;return _},a.prototype.listenerCount=function(f){var c=t?t+f:f,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(f,c,h,d,g,_){var D=t?t+f:f;if(!this._events[D])return!1;var E=this._events[D],U=arguments.length,Qe,pe;if(E.fn){switch(E.once&&this.removeListener(f,E.fn,void 0,!0),U){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,c),!0;case 3:return E.fn.call(E.context,c,h),!0;case 4:return E.fn.call(E.context,c,h,d),!0;case 5:return E.fn.call(E.context,c,h,d,g),!0;case 6:return E.fn.call(E.context,c,h,d,g,_),!0}for(pe=1,Qe=new Array(U-1);pe<U;pe++)Qe[pe-1]=arguments[pe];E.fn.apply(E.context,Qe)}else{var Te=E.length,we;for(pe=0;pe<Te;pe++)switch(E[pe].once&&this.removeListener(f,E[pe].fn,void 0,!0),U){case 1:E[pe].fn.call(E[pe].context);break;case 2:E[pe].fn.call(E[pe].context,c);break;case 3:E[pe].fn.call(E[pe].context,c,h);break;case 4:E[pe].fn.call(E[pe].context,c,h,d);break;default:if(!Qe)for(we=1,Qe=new Array(U-1);we<U;we++)Qe[we-1]=arguments[we];E[pe].fn.apply(E[pe].context,Qe)}}return!0},a.prototype.on=function(f,c,h){return s(this,f,c,h,!1)},a.prototype.once=function(f,c,h){return s(this,f,c,h,!0)},a.prototype.removeListener=function(f,c,h,d){var g=t?t+f:f;if(!this._events[g])return this;if(!c)return o(this,g),this;var _=this._events[g];if(_.fn)_.fn===c&&(!d||_.once)&&(!h||_.context===h)&&o(this,g);else{for(var D=0,E=[],U=_.length;D<U;D++)(_[D].fn!==c||d&&!_[D].once||h&&_[D].context!==h)&&E.push(_[D]);E.length?this._events[g]=E.length===1?E[0]:E:o(this,g)}return this},a.prototype.removeAllListeners=function(f){var c;return f?(c=t?t+f:f,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,r.exports=a})(aO);const cx=r=>{const e=document.createElement("a");e.target="_blank",e.href=r,e.click()},Qf=(r,e,t)=>{t.add({f:()=>cx(r)},"f").name(e)},lO="code:generated";class hx extends aO.exports.EventEmitter{constructor(){super();const e=new ri({ignoredList:[],exclusiveFunctionList:[],exclusiveSourceList:[]}),t=new lx.GUI;t.width=500,t.add(e,"minValue",0,5).name("min value for function arguments"),t.add(e,"maxValue",5,10).name("max value for function arguments"),e.arrowFunctionProb,e.mouseFunctionProb;const i={minAmountFunctions:3,maxAmountFunctions:10};t.add(i,"minAmountFunctions",0,10,1).name("minimum amount of functions"),t.add(i,"maxAmountFunctions",0,10,1).name("maximum amount of functions"),t.add(e,"arrowFunctionProb",0,100).name("arrow function probability"),t.add(e,"mouseFunctionProb",0,100).name("mouse function probability"),e.modulateItselfProb,t.add(e,"modulateItselfProb",0,100).name("source self modulation probability");const s=t.add({f(){o(),s==null||s.removeAttribute("style")}},"f").name("Generate code").domElement.parentNode.parentNode;s.style.backgroundColor="red",s.style.textShadow="none",s.style.color="black";const o=()=>{const d=e.generateCode(i.minAmountFunctions,i.maxAmountFunctions);this.emit(lO,d)},a=t.addFolder("Exclusive sources");ri.sourcesList.map(d=>{const g=e.exclusiveSourceList.includes(d),_={f:E=>{e.setExclusiveSource(d,E)}};a.add({f:g},"f").name(d).onChange(_.f)});const l=t.addFolder("Exclusive functions");ri.allFunctions.forEach(d=>{const g=e.exclusiveFunctionList.includes(d);l.add({f:g},"f").name(d).onChange(D=>{e.setExclusiveFunction(d,D)})});const f=[...ri.sourcesList,...ri.allFunctions],c=t.addFolder("Ignored elements");f.forEach(d=>{const g=e.ignoredList.includes(d);c.add({f:g},"f").name(d).onChange(D=>{e.setIgnoredElement(d,D)})});const h=t.addFolder("Links");Qf("https://github.com/alvarobyrne/hydra-code-generator","this repo's code",h),Qf("https://hydracg.herokuapp.com/","original app",h),Qf("https://github.com/alecominotti/hydracodegenerator","original python repo",h),setTimeout(o,1e3)}}class st{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){let n=[];return this.decompose(0,e,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(t,this.length,n,1),tr.from(n,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];return this.decompose(e,t,i,0),tr.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),n=new Fs(this),s=new Fs(e);for(let o=t,a=t;;){if(n.next(o),s.next(o),o=0,n.lineBreak!=s.lineBreak||n.done!=s.done||n.value!=s.value)return!1;if(a+=n.value.length,n.done||a>=i)return!0}}iter(e=1){return new Fs(this,e)}iterRange(e,t=this.length){return new fO(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let n=this.line(e).from;i=this.iterRange(n,Math.max(n,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new cO(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?st.empty:e.length<=32?new Et(e):tr.from(Et.split(e,[]))}}class Et extends st{constructor(e,t=ux(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,n){for(let s=0;;s++){let o=this.text[s],a=n+o.length;if((t?i:a)>=e)return new dx(n,a,i,o);n=a+1,i++}}decompose(e,t,i,n){let s=e<=0&&t>=this.length?this:new Et(Jd(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(n&1){let o=i.pop(),a=ya(s.text,o.text.slice(),0,s.length);if(a.length<=32)i.push(new Et(a,o.length+s.length));else{let l=a.length>>1;i.push(new Et(a.slice(0,l)),new Et(a.slice(l)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Et))return super.replace(e,t,i);let n=ya(this.text,ya(i.text,Jd(this.text,0,e)),t),s=this.length+i.length-(t-e);return n.length<=32?new Et(n,s):tr.from(Et.split(n,[]),s)}sliceString(e,t=this.length,i=`
`){let n="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(n+=i),e<l&&t>s&&(n+=a.slice(Math.max(0,e-s),t-s)),s=l+1}return n}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],n=-1;for(let s of e)i.push(s),n+=s.length+1,i.length==32&&(t.push(new Et(i,n)),i=[],n=-1);return n>-1&&t.push(new Et(i,n)),t}}class tr extends st{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,n){for(let s=0;;s++){let o=this.children[s],a=n+o.length,l=i+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,i,n);n=a+1,i=l+1}}decompose(e,t,i,n){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&t>=o){let f=n&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!f?i.push(a):a.decompose(e-o,t-o,i,f)}o=l+1}}replace(e,t,i){if(i.lines<this.lines)for(let n=0,s=0;n<this.children.length;n++){let o=this.children[n],a=s+o.length;if(e>=s&&t<=a){let l=o.replace(e-s,t-s,i),f=this.lines-o.lines+l.lines;if(l.lines<f>>5-1&&l.lines>f>>5+1){let c=this.children.slice();return c[n]=l,new tr(c,this.length-(t-e)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){let n="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(n+=i),e<l&&t>o&&(n+=a.sliceString(e-o,t-o,i)),o=l+1}return n}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof tr))return 0;let i=0,[n,s,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,s+=t){if(n==o||s==a)return i;let l=this.children[n],f=e.children[s];if(l!=f)return i+l.scanIdentical(f,t);i+=l.length+1}}static from(e,t=e.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let g of e)i+=g.lines;if(i<32){let g=[];for(let _ of e)_.flatten(g);return new Et(g,t)}let n=Math.max(32,i>>5),s=n<<1,o=n>>1,a=[],l=0,f=-1,c=[];function h(g){let _;if(g.lines>s&&g instanceof tr)for(let D of g.children)h(D);else g.lines>o&&(l>o||!l)?(d(),a.push(g)):g instanceof Et&&l&&(_=c[c.length-1])instanceof Et&&g.lines+_.lines<=32?(l+=g.lines,f+=g.length+1,c[c.length-1]=new Et(_.text.concat(g.text),_.length+1+g.length)):(l+g.lines>n&&d(),l+=g.lines,f+=g.length+1,c.push(g))}function d(){l!=0&&(a.push(c.length==1?c[0]:tr.from(c,f)),f=-1,l=c.length=0)}for(let g of e)h(g);return d(),a.length==1?a[0]:new tr(a,t)}}st.empty=new Et([""],0);function ux(r){let e=-1;for(let t of r)e+=t.length+1;return e}function ya(r,e,t=0,i=1e9){for(let n=0,s=0,o=!0;s<r.length&&n<=i;s++){let a=r[s],l=n+a.length;l>=t&&(l>i&&(a=a.slice(0,i-n)),n<t&&(a=a.slice(t-n)),o?(e[e.length-1]+=a,o=!1):e.push(a)),n=l+1}return e}function Jd(r,e,t){return ya(r,[""],e,t)}class Fs{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Et?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],s=this.offsets[i],o=s>>1,a=n instanceof Et?n.text.length:n.children.length;if(o==(t>0?a:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(n instanceof Et){let l=n.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=n.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof Et?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class fO{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Fs(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:n}=this.cursor.next(e);return this.pos+=(n.length+e)*t,this.value=n.length<=i?n:t<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class cO{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:n}=this.inner.next(e);return t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(st.prototype[Symbol.iterator]=function(){return this.iter()},Fs.prototype[Symbol.iterator]=fO.prototype[Symbol.iterator]=cO.prototype[Symbol.iterator]=function(){return this});class dx{constructor(e,t,i,n){this.from=e,this.to=t,this.number=i,this.text=n}get length(){return this.to-this.from}}let zn="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(r=>r?parseInt(r,36):1);for(let r=1;r<zn.length;r++)zn[r]+=zn[r-1];function px(r){for(let e=1;e<zn.length;e+=2)if(zn[e]>r)return zn[e-1]<=r;return!1}function ep(r){return r>=127462&&r<=127487}const tp=8205;function ai(r,e,t=!0,i=!0){return(t?hO:mx)(r,e,i)}function hO(r,e,t){if(e==r.length)return e;e&&uO(r.charCodeAt(e))&&dO(r.charCodeAt(e-1))&&e--;let i=ei(r,e);for(e+=Ti(i);e<r.length;){let n=ei(r,e);if(i==tp||n==tp||t&&px(n))e+=Ti(n),i=n;else if(ep(n)){let s=0,o=e-2;for(;o>=0&&ep(ei(r,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function mx(r,e,t){for(;e>0;){let i=hO(r,e-2,t);if(i<e)return i;e--}return 0}function uO(r){return r>=56320&&r<57344}function dO(r){return r>=55296&&r<56320}function ei(r,e){let t=r.charCodeAt(e);if(!dO(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return uO(i)?(t-55296<<10)+(i-56320)+65536:t}function rh(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Ti(r){return r<65536?1:2}const lc=/\r\n?|\n/;var ii=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(ii||(ii={}));class sr{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,n=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,n,s),n+=s):n+=o,i+=s}}iterChangedRanges(e,t=!1){fc(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];n<0?e.push(i,n):e.push(n,i)}return new sr(e)}composeDesc(e){return this.empty?e:e.empty?this:pO(this,e)}mapDesc(e,t=!1){return e.empty?this:cc(this,e,t)}mapPos(e,t=-1,i=ii.Simple){let n=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],f=n+a;if(l<0){if(f>e)return s+(e-n);s+=a}else{if(i!=ii.Simple&&f>=e&&(i==ii.TrackDel&&n<e&&f>e||i==ii.TrackBefore&&n<e||i==ii.TrackAfter&&f>e))return null;if(f>e||f==e&&t<0&&!a)return e==n||t<0?s:s+l;s+=l}n=f}if(e>n)throw new RangeError(`Position ${e} is out of range for changeset of length ${n}`);return s}touchesRange(e,t=e){for(let i=0,n=0;i<this.sections.length&&n<=t;){let s=this.sections[i++],o=this.sections[i++],a=n+s;if(o>=0&&n<=t&&a>=e)return n<e&&a>t?"cover":!0;n=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+i+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new sr(e)}static create(e){return new sr(e)}}class Bt extends sr{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return fc(this,(t,i,n,s,o)=>e=e.replace(n,n+(i-t),o),!1),e}mapDesc(e,t=!1){return cc(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let n=0,s=0;n<t.length;n+=2){let o=t[n],a=t[n+1];if(a>=0){t[n]=a,t[n+1]=o;let l=n>>1;for(;i.length<l;)i.push(st.empty);i.push(o?e.slice(s,s+o):st.empty)}s+=o}return new Bt(t,i)}compose(e){return this.empty?e:e.empty?this:pO(this,e,!0)}map(e,t=!1){return e.empty?this:cc(this,e,t,!0)}iterChanges(e,t=!1){fc(this,e,t)}get desc(){return sr.create(this.sections)}filter(e){let t=[],i=[],n=[],s=new Ys(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);ni(n,c,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;ni(t,c,h),h>0&&Ar(i,t,s.text),s.forward(c),a+=c}let f=e[o++];for(;a<f;){if(s.done)break e;let c=Math.min(s.len,f-a);ni(t,c,-1),ni(n,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new Bt(t,i),filtered:sr.create(n)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],n=this.sections[t+1];n<0?e.push(i):n==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let n=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!n.length)return;o<t&&ni(n,t-o,-1);let h=new Bt(n,s);a=a?a.compose(h.map(a)):h,n=[],s=[],o=0}function f(c){if(Array.isArray(c))for(let h of c)f(h);else if(c instanceof Bt){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:h,to:d=h,insert:g}=c;if(h>d||h<0||d>t)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${t})`);let _=g?typeof g=="string"?st.of(g.split(i||lc)):g:st.empty,D=_.length;if(h==d&&D==0)return;h<o&&l(),h>o&&ni(n,h-o,-1),ni(n,d-h,D),Ar(s,n,_),o=d}}return f(e),l(!a),a}static empty(e){return new Bt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let n=0;n<e.length;n++){let s=e[n];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<n;)i.push(st.empty);i[n]=st.of(s.slice(1)),t.push(s[0],i[n].length)}}}return new Bt(t,i)}static createSet(e,t){return new Bt(e,t)}}function ni(r,e,t,i=!1){if(e==0&&t<=0)return;let n=r.length-2;n>=0&&t<=0&&t==r[n+1]?r[n]+=e:e==0&&r[n]==0?r[n+1]+=t:i?(r[n]+=e,r[n+1]+=t):r.push(e,t)}function Ar(r,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<i;)r.push(st.empty);r.push(t)}}function fc(r,e,t){let i=r.inserted;for(let n=0,s=0,o=0;o<r.sections.length;){let a=r.sections[o++],l=r.sections[o++];if(l<0)n+=a,s+=a;else{let f=n,c=s,h=st.empty;for(;f+=a,c+=l,l&&i&&(h=h.append(i[o-2>>1])),!(t||o==r.sections.length||r.sections[o+1]<0);)a=r.sections[o++],l=r.sections[o++];e(n,f,s,c,h),n=f,s=c}}}function cc(r,e,t,i=!1){let n=[],s=i?[]:null,o=new Ys(r),a=new Ys(e);for(let l=-1;;)if(o.ins==-1&&a.ins==-1){let f=Math.min(o.len,a.len);ni(n,f,-1),o.forward(f),a.forward(f)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!t))){let f=a.len;for(ni(n,a.ins,-1);f;){let c=Math.min(o.len,f);o.ins>=0&&l<o.i&&o.len<=c&&(ni(n,0,o.ins),s&&Ar(s,n,o.text),l=o.i),o.forward(c),f-=c}a.next()}else if(o.ins>=0){let f=0,c=o.len;for(;c;)if(a.ins==-1){let h=Math.min(c,a.len);f+=h,c-=h,a.forward(h)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;ni(n,f,l<o.i?o.ins:0),s&&l<o.i&&Ar(s,n,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?Bt.createSet(n,s):sr.create(n);throw new Error("Mismatched change set lengths")}}function pO(r,e,t=!1){let i=[],n=t?[]:null,s=new Ys(r),o=new Ys(e);for(let a=!1;;){if(s.done&&o.done)return n?Bt.createSet(i,n):sr.create(i);if(s.ins==0)ni(i,s.len,0,a),s.next();else if(o.len==0&&!o.done)ni(i,0,o.ins,a),n&&Ar(n,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),f=i.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;ni(i,l,c,a),n&&c&&Ar(n,i,o.text)}else o.ins==-1?(ni(i,s.off?0:s.len,l,a),n&&Ar(n,i,s.textBit(l))):(ni(i,s.off?0:s.len,o.off?0:o.ins,a),n&&!o.off&&Ar(n,i,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>f),s.forward2(l),o.forward(l)}}}}class Ys{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?st.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?st.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class cn{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let i,n;return this.empty?i=n=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new cn(i,n,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return se.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return se.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return se.range(e.anchor,e.head)}static create(e,t,i){return new cn(e,t,i)}}class se{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:se.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new se([this.main],0)}addRange(e,t=!0){return se.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,se.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new se(e.ranges.map(t=>cn.fromJSON(t)),e.main)}static single(e,t=e){return new se([se.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<e.length;n++){let s=e[n];if(s.empty?s.from<=i:s.from<i)return se.normalized(e.slice(),t);i=s.to}return new se(e,t)}static cursor(e,t=0,i,n){return cn.create(e,e,(t==0?0:t<0?4:8)|(i==null?3:Math.min(2,i))|(n!=null?n:33554431)<<5)}static range(e,t,i){let n=(i!=null?i:33554431)<<5;return t<e?cn.create(t,e,16|n|8):cn.create(e,t,n|(t>e?4:0))}static normalized(e,t=0){let i=e[t];e.sort((n,s)=>n.from-s.from),t=e.indexOf(i);for(let n=1;n<e.length;n++){let s=e[n],o=e[n-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);n<=t&&t--,e.splice(--n,2,s.anchor>s.head?se.range(l,a):se.range(a,l))}}return new se(e,t)}}function mO(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let nh=0;class Be{constructor(e,t,i,n,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=n,this.id=nh++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}static define(e={}){return new Be(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:sh),!!e.static,e.enables)}of(e){return new xa([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new xa(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new xa(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function sh(r,e){return r==e||r.length==e.length&&r.every((t,i)=>t===e[i])}class xa{constructor(e,t,i,n){this.dependencies=e,this.facet=t,this.type=i,this.value=n,this.id=nh++}dynamicSlot(e){var t;let i=this.value,n=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,f=!1,c=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?f=!0:(((t=e[h.id])!==null&&t!==void 0?t:1)&1)==0&&c.push(e[h.id]);return{create(h){return h.values[o]=i(h),1},update(h,d){if(l&&d.docChanged||f&&(d.docChanged||d.selection)||hc(h,c)){let g=i(h);if(a?!ip(g,h.values[o],n):!n(g,h.values[o]))return h.values[o]=g,1}return 0},reconfigure:(h,d)=>{let g=i(h),_=d.config.address[s];if(_!=null){let D=Da(d,_);if(this.dependencies.every(E=>E instanceof Be?d.facet(E)===h.facet(E):E instanceof Yt?d.field(E,!1)==h.field(E,!1):!0)||(a?ip(g,D,n):n(g,D)))return h.values[o]=D,0}return h.values[o]=g,1}}}}function ip(r,e,t){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!t(r[i],e[i]))return!1;return!0}function hc(r,e){let t=!1;for(let i of e)Xs(r,i)&1&&(t=!0);return t}function Ox(r,e,t){let i=t.map(l=>r[l.id]),n=t.map(l=>l.type),s=i.filter(l=>!(l&1)),o=r[e.id]>>1;function a(l){let f=[];for(let c=0;c<i.length;c++){let h=Da(l,i[c]);if(n[c]==2)for(let d of h)f.push(d);else f.push(h)}return e.combine(f)}return{create(l){for(let f of i)Xs(l,f);return l.values[o]=a(l),1},update(l,f){if(!hc(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,f){let c=hc(l,i),h=f.config.facets[e.id],d=f.facet(e);if(h&&!c&&sh(t,h))return l.values[o]=d,0;let g=a(l);return e.compare(g,d)?(l.values[o]=d,0):(l.values[o]=g,1)}}}const rp=Be.define({static:!0});class Yt{constructor(e,t,i,n,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=n,this.spec=s,this.provides=void 0}static define(e){let t=new Yt(nh++,e.create,e.update,e.compare||((i,n)=>i===n),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(rp).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,n)=>{let s=i.values[t],o=this.updateF(s,n);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,n)=>n.config.address[this.id]!=null?(i.values[t]=n.field(this),0):(i.values[t]=this.create(i),1)}}init(e){return[this,rp.of({field:this,create:e})]}get extension(){return this}}const ln={lowest:4,low:3,default:2,high:1,highest:0};function ks(r){return e=>new OO(e,r)}const vn={highest:ks(ln.highest),high:ks(ln.high),default:ks(ln.default),low:ks(ln.low),lowest:ks(ln.lowest)};class OO{constructor(e,t){this.inner=e,this.prec=t}}class ul{of(e){return new uc(this,e)}reconfigure(e){return ul.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class uc{constructor(e,t){this.compartment=e,this.inner=t}}class La{constructor(e,t,i,n,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=n,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let n=[],s=Object.create(null),o=new Map;for(let d of gx(e,t,o))d instanceof Yt?n.push(d):(s[d.facet.id]||(s[d.facet.id]=[])).push(d);let a=Object.create(null),l=[],f=[];for(let d of n)a[d.id]=f.length<<1,f.push(g=>d.slot(g));let c=i==null?void 0:i.config.facets;for(let d in s){let g=s[d],_=g[0].facet,D=c&&c[d]||[];if(g.every(E=>E.type==0))if(a[_.id]=l.length<<1|1,sh(D,g))l.push(i.facet(_));else{let E=_.combine(g.map(U=>U.value));l.push(i&&_.compare(E,i.facet(_))?i.facet(_):E)}else{for(let E of g)E.type==0?(a[E.id]=l.length<<1|1,l.push(E.value)):(a[E.id]=f.length<<1,f.push(U=>E.dynamicSlot(U)));a[_.id]=f.length<<1,f.push(E=>Ox(E,_,g))}}let h=f.map(d=>d(a));return new La(e,o,h,a,l,s)}}function gx(r,e,t){let i=[[],[],[],[],[]],n=new Map;function s(o,a){let l=n.get(o);if(l!=null){if(l<=a)return;let f=i[l].indexOf(o);f>-1&&i[l].splice(f,1),o instanceof uc&&t.delete(o.compartment)}if(n.set(o,a),Array.isArray(o))for(let f of o)s(f,a);else if(o instanceof uc){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(o.compartment)||o.inner;t.set(o.compartment,f),s(f,a)}else if(o instanceof OO)s(o.inner,o.prec);else if(o instanceof Yt)i[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof xa)i[a].push(o),o.facet.extensions&&s(o.facet.extensions,ln.default);else{let f=o.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(f,a)}}return s(r,ln.default),i.reduce((o,a)=>o.concat(a))}function Xs(r,e){if(e&1)return 2;let t=e>>1,i=r.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[t]=4;let n=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|n}function Da(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const gO=Be.define(),vO=Be.define({combine:r=>r.some(e=>e),static:!0}),bO=Be.define({combine:r=>r.length?r[0]:void 0,static:!0}),yO=Be.define(),xO=Be.define(),SO=Be.define(),_O=Be.define({combine:r=>r.length?r[0]:!1});class bn{constructor(e,t){this.type=e,this.value=t}static define(){return new vx}}class vx{of(e){return new bn(this,e)}}class bx{constructor(e){this.map=e}of(e){return new He(this,e)}}class He{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new He(this.type,t)}is(e){return this.type==e}static define(e={}){return new bx(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let n of e){let s=n.map(t);s&&i.push(s)}return i}}He.reconfigure=He.define();He.appendConfig=He.define();class Gt{constructor(e,t,i,n,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=n,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&mO(i,t.newLength),s.some(a=>a.type==Gt.time)||(this.annotations=s.concat(Gt.time.of(Date.now())))}static create(e,t,i,n,s,o){return new Gt(e,t,i,n,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Gt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Gt.time=bn.define();Gt.userEvent=bn.define();Gt.addToHistory=bn.define();Gt.remote=bn.define();function yx(r,e){let t=[];for(let i=0,n=0;;){let s,o;if(i<r.length&&(n==e.length||e[n]>=r[i]))s=r[i++],o=r[i++];else if(n<e.length)s=e[n++],o=e[n++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function wO(r,e,t){var i;let n,s,o;return t?(n=e.changes,s=Bt.empty(e.changes.length),o=r.changes.compose(e.changes)):(n=e.changes.map(r.changes),s=r.changes.mapDesc(e.changes,!0),o=r.changes.compose(n)),{changes:o,selection:e.selection?e.selection.map(s):(i=r.selection)===null||i===void 0?void 0:i.map(n),effects:He.mapEffects(r.effects,n).concat(He.mapEffects(e.effects,s)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function dc(r,e,t){let i=e.selection,n=Un(e.annotations);return e.userEvent&&(n=n.concat(Gt.userEvent.of(e.userEvent))),{changes:e.changes instanceof Bt?e.changes:Bt.of(e.changes||[],t,r.facet(bO)),selection:i&&(i instanceof se?i:se.single(i.anchor,i.head)),effects:Un(e.effects),annotations:n,scrollIntoView:!!e.scrollIntoView}}function TO(r,e,t){let i=dc(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=wO(i,dc(r,e[s],o?i.changes.newLength:r.doc.length),o)}let n=Gt.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return Sx(t?xx(n):n)}function xx(r){let e=r.startState,t=!0;for(let n of e.facet(yO)){let s=n(r);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:yx(t,s))}if(t!==!0){let n,s;if(t===!1)s=r.changes.invertedDesc,n=Bt.empty(e.doc.length);else{let o=r.changes.filter(t);n=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}r=Gt.create(e,n,r.selection&&r.selection.map(s),He.mapEffects(r.effects,s),r.annotations,r.scrollIntoView)}let i=e.facet(xO);for(let n=i.length-1;n>=0;n--){let s=i[n](r);s instanceof Gt?r=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Gt?r=s[0]:r=TO(e,Un(s),!1)}return r}function Sx(r){let e=r.startState,t=e.facet(SO),i=r;for(let n=t.length-1;n>=0;n--){let s=t[n](r);s&&Object.keys(s).length&&(i=wO(i,dc(e,s,r.changes.newLength),!0))}return i==r?r:Gt.create(e,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const _x=[];function Un(r){return r==null?_x:Array.isArray(r)?r:[r]}var bt=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(bt||(bt={}));const wx=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let pc;try{pc=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Tx(r){if(pc)return pc.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||wx.test(t)))return!0}return!1}function kx(r){return e=>{if(!/\S/.test(e))return bt.Space;if(Tx(e))return bt.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return bt.Word;return bt.Other}}class rt{constructor(e,t,i,n,s,o){this.config=e,this.doc=t,this.selection=i,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Xs(this,a<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return Xs(this,i),Da(this,i)}update(...e){return TO(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:n}=t;for(let o of e.effects)o.is(ul.reconfigure)?(t&&(n=new Map,t.compartments.forEach((a,l)=>n.set(l,a)),t=null),n.set(o.value.compartment,o.value.extension)):o.is(He.reconfigure)?(t=null,i=o.value):o.is(He.appendConfig)&&(t=null,i=Un(i).concat(o.value));let s;t?s=e.startState.values.slice():(t=La.resolve(i,n,this),s=new rt(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,l)=>l.reconfigure(a,this),null).values),new rt(t,e.newDoc,e.newSelection,s,(o,a)=>a.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:se.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),n=this.changes(i.changes),s=[i.range],o=Un(i.effects);for(let a=1;a<t.ranges.length;a++){let l=e(t.ranges[a]),f=this.changes(l.changes),c=f.map(n);for(let d=0;d<a;d++)s[d]=s[d].map(c);let h=n.mapDesc(f,!0);s.push(l.range.map(h)),n=n.compose(c),o=He.mapEffects(o,c).concat(He.mapEffects(Un(l.effects),h))}return{changes:n,selection:se.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Bt?e:Bt.of(e,this.doc.length,this.facet(rt.lineSeparator))}toText(e){return st.of(e.split(this.facet(rt.lineSeparator)||lc))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Xs(this,t),Da(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let n=e[i];n instanceof Yt&&this.config.address[n.id]!=null&&(t[i]=n.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],a=e[s];n.push(o.init(l=>o.spec.fromJSON(a,l)))}}return rt.create({doc:e.doc,selection:se.fromJSON(e.selection),extensions:t.extensions?n.concat([t.extensions]):n})}static create(e={}){let t=La.resolve(e.extensions||[],new Map),i=e.doc instanceof st?e.doc:st.of((e.doc||"").split(t.staticFacet(rt.lineSeparator)||lc)),n=e.selection?e.selection instanceof se?e.selection:se.single(e.selection.anchor,e.selection.head):se.single(0);return mO(n,i.length),t.staticFacet(vO)||(n=n.asSingle()),new rt(t,i,n,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(rt.tabSize)}get lineBreak(){return this.facet(rt.lineSeparator)||`
`}get readOnly(){return this.facet(_O)}phrase(e,...t){for(let i of this.facet(rt.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let s=+(n||1);return!s||s>t.length?i:t[s-1]})),e}languageDataAt(e,t,i=-1){let n=[];for(let s of this.facet(gO))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&n.push(o[e]);return n}charCategorizer(e){return kx(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:n}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=ai(t,o,!1);if(s(t.slice(l,o))!=bt.Word)break;o=l}for(;a<n;){let l=ai(t,a);if(s(t.slice(a,l))!=bt.Word)break;a=l}return o==a?null:se.range(o+i,a+i)}}rt.allowMultipleSelections=vO;rt.tabSize=Be.define({combine:r=>r.length?r[0]:4});rt.lineSeparator=bO;rt.readOnly=_O;rt.phrases=Be.define({compare(r,e){let t=Object.keys(r),i=Object.keys(e);return t.length==i.length&&t.every(n=>r[n]==e[n])}});rt.languageData=gO;rt.changeFilter=yO;rt.transactionFilter=xO;rt.transactionExtender=SO;ul.reconfigure=He.define();function ar(r,e,t={}){let i={};for(let n of r)for(let s of Object.keys(n)){let o=n[s],a=i[s];if(a===void 0)i[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let n in e)i[n]===void 0&&(i[n]=e[n]);return i}class mn{eq(e){return this==e}range(e,t=e){return Ks.create(e,t,this)}}mn.prototype.startSide=mn.prototype.endSide=0;mn.prototype.point=!1;mn.prototype.mapMode=ii.TrackDel;class Ks{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new Ks(e,t,i)}}function mc(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class oh{constructor(e,t,i,n){this.from=e,this.to=t,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,n=0){let s=i?this.to:this.from;for(let o=n,a=s.length;;){if(o==a)return o;let l=o+a>>1,f=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return f>=0?o:a;f>=0?a=l:o=l+1}}between(e,t,i,n){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(n(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],n=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let f=this.value[l],c=this.from[l]+e,h=this.to[l]+e,d,g;if(c==h){let _=t.mapPos(c,f.startSide,f.mapMode);if(_==null||(d=g=_,f.startSide!=f.endSide&&(g=t.mapPos(c,f.endSide),g<d)))continue}else if(d=t.mapPos(c,f.startSide),g=t.mapPos(h,f.endSide),d>g||d==g&&f.startSide>0&&f.endSide<=0)continue;(g-d||f.endSide-f.startSide)<0||(o<0&&(o=d),f.point&&(a=Math.max(a,g-d)),i.push(f),n.push(d-o),s.push(g-o))}return{mapped:i.length?new oh(n,s,i,a):null,pos:o}}}class at{constructor(e,t,i,n){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=n}static create(e,t,i,n){return new at(e,t,i,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:n=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(mc)),this.isEmpty)return t.length?at.of(t):this;let a=new kO(this,null,-1).goto(0),l=0,f=[],c=new Dr;for(;a.value||l<t.length;)if(l<t.length&&(a.from-t[l].from||a.startSide-t[l].value.startSide)>=0){let h=t[l++];c.addInner(h.from,h.to,h.value)||f.push(h)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(a.chunkIndex)<t[l].from)&&(!o||n>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||n>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||f.push(Ks.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!f.length?at.empty:this.nextLayer.update({add:f,filter:o,filterFrom:n,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],n=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],f=e.touchesRange(a,a+l.length);if(f===!1)n=Math.max(n,l.maxPoint),t.push(l),i.push(e.mapPos(a));else if(f===!0){let{mapped:c,pos:h}=l.map(a,e);c&&(n=Math.max(n,c.maxPoint),t.push(c),i.push(h))}}let s=this.nextLayer.map(e);return t.length==0?s:new at(i,t,s||at.empty,n)}between(e,t,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],o=this.chunk[n];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return Js.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Js.from(e).goto(t)}static compare(e,t,i,n,s=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),a=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=np(o,a,i),f=new Qs(o,l,s),c=new Qs(a,l,s);i.iterGaps((h,d,g)=>sp(f,h,c,d,g,n)),i.empty&&i.length==0&&sp(f,0,c,0,0,n)}static eq(e,t,i=0,n){n==null&&(n=1e9);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=np(s,o),l=new Qs(s,a,0).goto(i),f=new Qs(o,a,0).goto(i);for(;;){if(l.to!=f.to||!Oc(l.active,f.active)||l.point&&(!f.point||!l.point.eq(f.point)))return!1;if(l.to>n)return!0;l.next(),f.next()}}static spans(e,t,i,n,s=-1){let o=new Qs(e,null,s).goto(t),a=t,l=o.openStart;for(;;){let f=Math.min(o.to,i);if(o.point?(n.point(a,f,o.point,o.activeForPoint(o.to),l,o.pointRank),l=o.openEnd(f)+(o.to>f?1:0)):f>a&&(n.span(a,f,o.active,l),l=o.openEnd(f)),o.to>i)break;a=o.to,o.next()}return l}static of(e,t=!1){let i=new Dr;for(let n of e instanceof Ks?[e]:t?Qx(e):e)i.add(n.from,n.to,n.value);return i.finish()}}at.empty=new at([],[],null,-1);function Qx(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let i=r[t];if(mc(e,i)>0)return r.slice().sort(mc);e=i}return r}at.empty.nextLayer=at.empty;class Dr{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new oh(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new Dr)).add(e,t,i)}addInner(e,t,i){let n=e-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(at.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=at.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function np(r,e,t){let i=new Map;for(let s of r)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let n=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=i.get(s.chunk[o]);a!=null&&(t?t.mapPos(a):a)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(a,a+s.chunk[o].length))&&n.add(s.chunk[o])}return n}class kO{constructor(e,t,i,n=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<e||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Js{constructor(e){this.heap=e}static from(e,t=null,i=-1){let n=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&n.push(new kO(o,t,i,s));return n.length==1?n[0]:new Js(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Af(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Af(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Af(this.heap,0)}}}function Af(r,e){for(let t=r[e];;){let i=(e<<1)+1;if(i>=r.length)break;let n=r[i];if(i+1<r.length&&n.compare(r[i+1])>=0&&(n=r[i+1],i++),t.compare(n)<0)break;r[i]=t,r[e]=n,e=i}}class Qs{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Js.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ta(this.active,e),ta(this.activeTo,e),ta(this.activeRank,e),this.minActive=op(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:n,rank:s}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=s;)t++;ia(this.active,t,i),ia(this.activeTo,t,n),ia(this.activeRank,t,s),e&&ia(e,t,this.cursor.from),this.minActive=op(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&ta(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.from<e&&this.cursor.to>e&&n++,this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.from<e&&(n=1),this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){let s=0;for(;s<i.length&&i[s]<e;)s++;this.openStart=s+n}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function sp(r,e,t,i,n,s){r.goto(e),t.goto(i);let o=i+n,a=i,l=i-e;for(;;){let f=r.to+l-t.to||r.endSide-t.endSide,c=f<0?r.to+l:t.to,h=Math.min(c,o);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&Oc(r.activeForPoint(r.to+l),t.activeForPoint(t.to))||s.comparePoint(a,h,r.point,t.point):h>a&&!Oc(r.active,t.active)&&s.compareRange(a,h,r.active,t.active),c>o)break;a=c,f<=0&&r.next(),f>=0&&t.next()}}function Oc(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function ta(r,e){for(let t=e,i=r.length-1;t<i;t++)r[t]=r[t+1];r.pop()}function ia(r,e,t){for(let i=r.length-1;i>=e;i--)r[i+1]=r[i];r[e]=t}function op(r,e){let t=-1,i=1e9;for(let n=0;n<e.length;n++)(e[n]-i||r[n].endSide-r[t].endSide)<0&&(t=n,i=e[n]);return t}function ho(r,e,t=r.length){let i=0;for(let n=0;n<t;)r.charCodeAt(n)==9?(i+=e-i%e,n++):(i++,n=ai(r,n));return i}function gc(r,e,t,i){for(let n=0,s=0;;){if(s>=e)return n;if(n==r.length)break;s+=r.charCodeAt(n)==9?t-s%t:1,n=ai(r,n)}return i===!0?-1:r.length}const vc="\u037C",ap=typeof Symbol>"u"?"__"+vc:Symbol.for(vc),bc=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),lp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Mr{constructor(e,t){this.rules=[];let{finish:i}=t||{};function n(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,f){let c=[],h=/^@(\w+)\b/.exec(o[0]),d=h&&h[1]=="keyframes";if(h&&a==null)return l.push(o[0]+";");for(let g in a){let _=a[g];if(/&/.test(g))s(g.split(/,\s*/).map(D=>o.map(E=>D.replace(/&/,E))).reduce((D,E)=>D.concat(E)),_,l);else if(_&&typeof _=="object"){if(!h)throw new RangeError("The value of a property ("+g+") should be a primitive value.");s(n(g),_,c,d)}else _!=null&&c.push(g.replace(/_.*/,"").replace(/[A-Z]/g,D=>"-"+D.toLowerCase())+": "+_+";")}(c.length||d)&&l.push((i&&!h&&!f?o.map(i):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(n(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=lp[ap]||1;return lp[ap]=e+1,vc+e.toString(36)}static mount(e,t){(e[bc]||new Ax(e)).mount(Array.isArray(t)?t:[t])}}let ra=null;class Ax{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet<"u"){if(ra)return e.adoptedStyleSheets=[ra.sheet].concat(e.adoptedStyleSheets),e[bc]=ra;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),ra=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[bc]=this}mount(e){let t=this.sheet,i=0,n=0;for(let s=0;s<e.length;s++){let o=e[s],a=this.modules.indexOf(o);if(a<n&&a>-1&&(this.modules.splice(a,1),n--,a=-1),a==-1){if(this.modules.splice(n++,0,o),t)for(let l=0;l<o.rules.length;l++)t.insertRule(o.rules[l],i++)}else{for(;n<a;)i+=this.modules[n++].rules.length;i+=o.rules.length,n++}}if(!t){let s="";for(let o=0;o<this.modules.length;o++)s+=this.modules[o].getRules()+`
`;this.styleTag.textContent=s}}}var Ir={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},eo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},fp=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);var Cx=typeof navigator<"u"&&/Mac/.test(navigator.platform),$x=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ex=Cx||fp&&+fp[1]<57;for(var ti=0;ti<10;ti++)Ir[48+ti]=Ir[96+ti]=String(ti);for(var ti=1;ti<=24;ti++)Ir[ti+111]="F"+ti;for(var ti=65;ti<=90;ti++)Ir[ti]=String.fromCharCode(ti+32),eo[ti]=String.fromCharCode(ti);for(var Cf in Ir)eo.hasOwnProperty(Cf)||(eo[Cf]=Ir[Cf]);function Rx(r){var e=Ex&&(r.ctrlKey||r.altKey||r.metaKey)||$x&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?eo:Ir)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Ma(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function Yn(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function Px(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Sa(r,e){if(!e.anchorNode)return!1;try{return Yn(r,e.anchorNode)}catch{return!1}}function to(r){return r.nodeType==3?Kn(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function Ia(r,e,t,i){return t?cp(r,e,t,i,-1)||cp(r,e,t,i,1):!1}function Ba(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function cp(r,e,t,i,n){for(;;){if(r==t&&e==i)return!0;if(e==(n<0?0:io(r))){if(r.nodeName=="DIV")return!1;let s=r.parentNode;if(!s||s.nodeType!=1)return!1;e=Ba(r)+(n<0?0:1),r=s}else if(r.nodeType==1){if(r=r.childNodes[e+(n<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=n<0?io(r):0}else return!1}}function io(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}const QO={left:0,right:0,top:0,bottom:0};function dl(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function Lx(r){return{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function Dx(r,e,t,i,n,s,o,a){let l=r.ownerDocument,f=l.defaultView||window;for(let c=r;c;)if(c.nodeType==1){let h,d=c==l.body;if(d)h=Lx(f);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let D=c.getBoundingClientRect();h={left:D.left,right:D.left+c.clientWidth,top:D.top,bottom:D.top+c.clientHeight}}let g=0,_=0;if(n=="nearest")e.top<h.top?(_=-(h.top-e.top+o),t>0&&e.bottom>h.bottom+_&&(_=e.bottom-h.bottom+_+o)):e.bottom>h.bottom&&(_=e.bottom-h.bottom+o,t<0&&e.top-_<h.top&&(_=-(h.top+_-e.top+o)));else{let D=e.bottom-e.top,E=h.bottom-h.top;_=(n=="center"&&D<=E?e.top+D/2-E/2:n=="start"||n=="center"&&t<0?e.top-o:e.bottom-E+o)-h.top}if(i=="nearest"?e.left<h.left?(g=-(h.left-e.left+s),t>0&&e.right>h.right+g&&(g=e.right-h.right+g+s)):e.right>h.right&&(g=e.right-h.right+s,t<0&&e.left<h.left+g&&(g=-(h.left+g-e.left+s))):g=(i=="center"?e.left+(e.right-e.left)/2-(h.right-h.left)/2:i=="start"==a?e.left-s:e.right-(h.right-h.left)+s)-h.left,g||_)if(d)f.scrollBy(g,_);else{let D=0,E=0;if(_){let U=c.scrollTop;c.scrollTop+=_,E=c.scrollTop-U}if(g){let U=c.scrollLeft;c.scrollLeft+=g,D=c.scrollLeft-U}e={left:e.left-D,top:e.top-E,right:e.right-D,bottom:e.bottom-E},D&&Math.abs(D-g)<1&&(i="nearest"),E&&Math.abs(E-_)<1&&(n="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}class Mx{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,n){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=n}}let In=null;function AO(r){if(r.setActive)return r.setActive();if(In)return r.focus(In);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(In==null?{get preventScroll(){return In={preventScroll:!0},!0}}:void 0),!In){In=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let hp;function Kn(r,e,t=e){let i=hp||(hp=document.createRange());return i.setEnd(r,t),i.setStart(r,e),i}function js(r,e,t){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0},n=new KeyboardEvent("keydown",i);n.synthetic=!0,r.dispatchEvent(n);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,r.dispatchEvent(s),n.defaultPrevented||s.defaultPrevented}function Ix(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function CO(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function Bx(r,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(;;)if(i){if(t.nodeType!=1)return!1;let n=t.childNodes[i-1];n.contentEditable=="false"?i--:(t=n,i=io(t))}else{if(t==r)return!0;i=Ba(t),t=t.parentNode}}class si{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new si(e.parentNode,Ba(e),t)}static after(e,t){return new si(e.parentNode,Ba(e)+1,t)}}const ah=[];class gt{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(this.dirty&2){let t=this.dom,i=null,n;for(let s of this.children){if(s.dirty){if(!s.dom&&(n=i?i.nextSibling:t.firstChild)){let o=gt.get(n);(!o||!o.parent&&o.canReuseDOM(s))&&s.reuseDOM(n)}s.sync(e),s.dirty=0}if(n=i?i.nextSibling:t.firstChild,e&&!e.written&&e.node==t&&n!=s.dom&&(e.written=!0),s.dom.parentNode==t)for(;n&&n!=s.dom;)n=up(n);else t.insertBefore(s.dom,n);i=s.dom}for(n=i?i.nextSibling:t.firstChild,n&&e&&e.node==t&&(e.written=!0);n;)n=up(n)}else if(this.dirty&1)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let n=io(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;n==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?n=-1:n=1),e=s}n<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!gt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,s=0;;n++){let o=this.children[n];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let n=-1,s=-1,o=-1,a=-1;for(let l=0,f=i,c=i;l<this.children.length;l++){let h=this.children[l],d=f+h.length;if(f<e&&d>t)return h.domBoundsAround(e,t,f);if(d>=e&&n==-1&&(n=l,s=f),f>t&&h.dom.parentNode==this.dom){o=l,a=c;break}c=d,f=d+h.breakAfter}return{from:s,to:a<0?i+this.length:a,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=ah){this.markDirty();for(let n=e;n<t;n++){let s=this.children[n];s.parent==this&&s.destroy()}this.children.splice(e,t-e,...i);for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new $O(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,i,n,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}gt.prototype.breakAfter=0;function up(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class $O{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function EO(r,e,t,i,n,s,o,a,l){let{children:f}=r,c=f.length?f[e]:null,h=s.length?s[s.length-1]:null,d=h?h.breakAfter:o;if(!(e==i&&c&&!o&&!d&&s.length<2&&c.merge(t,n,s.length?h:null,t==0,a,l))){if(i<f.length){let g=f[i];g&&n<g.length?(e==i&&(g=g.split(n),n=0),!d&&h&&g.merge(0,n,h,!0,0,l)?s[s.length-1]=g:(n&&g.merge(0,n,null,!1,0,l),s.push(g))):g!=null&&g.breakAfter&&(h?h.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,a,0),e++));e<i&&s.length;)if(f[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else if(f[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&i<f.length&&!f[e-1].breakAfter&&f[i].merge(0,0,f[e-1],!1,a,l)&&e--,(e<i||s.length)&&r.replaceChildren(e,i,s)}}function RO(r,e,t,i,n,s){let o=r.childCursor(),{i:a,off:l}=o.findPos(t,1),{i:f,off:c}=o.findPos(e,-1),h=e-t;for(let d of i)h+=d.length;r.length+=h,EO(r,f,c,a,l,i,0,n,s)}let ki=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},yc=typeof document<"u"?document:{documentElement:{style:{}}};const xc=/Edge\/(\d+)/.exec(ki.userAgent),PO=/MSIE \d/.test(ki.userAgent),Sc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ki.userAgent),pl=!!(PO||Sc||xc),dp=!pl&&/gecko\/(\d+)/i.test(ki.userAgent),$f=!pl&&/Chrome\/(\d+)/.exec(ki.userAgent),pp="webkitFontSmoothing"in yc.documentElement.style,LO=!pl&&/Apple Computer/.test(ki.vendor),mp=LO&&(/Mobile\/\w+/.test(ki.userAgent)||ki.maxTouchPoints>2);var Me={mac:mp||/Mac/.test(ki.platform),windows:/Win/.test(ki.platform),linux:/Linux|X11/.test(ki.platform),ie:pl,ie_version:PO?yc.documentMode||6:Sc?+Sc[1]:xc?+xc[1]:0,gecko:dp,gecko_version:dp?+(/Firefox\/(\d+)/.exec(ki.userAgent)||[0,0])[1]:0,chrome:!!$f,chrome_version:$f?+$f[1]:0,ios:mp,android:/Android\b/.test(ki.userAgent),webkit:pp,safari:LO,webkit_version:pp?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:yc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Gx=256;class Br extends gt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return i&&(!(i instanceof Br)||this.length-(t-e)+i.length>Gx)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Br(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new si(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return _c(this.dom,e,t)}}class or extends gt{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let n of t)n.setParent(this)}setAttrs(e){if(CO(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,i,n,s,o){return i&&(!(i instanceof or&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(RO(this,e,t,i?i.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,n=-1,s=0;for(let a of this.children){let l=i+a.length;l>e&&t.push(i<e?a.split(e-i):a),n<0&&i>=e&&(n=s),i=l,s++}let o=this.length-e;return this.length=e,n>-1&&(this.children.length=n,this.markDirty()),new or(this.mark,t,o)}domAtPos(e){return IO(this,e)}coordsAt(e,t){return GO(this,e,t)}}function _c(r,e,t){let i=r.nodeValue.length;e>i&&(e=i);let n=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?Me.chrome||Me.gecko||(e?(n--,o=1):s<i&&(s++,o=-1)):t<0?n--:s<i&&s++;let a=Kn(r,n,s).getClientRects();if(!a.length)return QO;let l=a[(o?o<0:t>=0)?0:a.length-1];return Me.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,f=>f.width)||l),o?dl(l,o<0):l||null}class Cr extends gt{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}static create(e,t,i){return new(e.customView||Cr)(e,t,i)}split(e){let t=Cr.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,n,s,o){return i&&(!(i instanceof Cr)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof Cr&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return st.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,i=t&&t.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):st.empty}domAtPos(e){return e==0?si.before(this.dom):si.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),n=null;if(!i.length)return QO;for(let s=e>0?i.length-1:0;n=i[s],!(e>0?s==0:s==i.length-1||n.top<n.bottom);s+=e>0?-1:1);return e==0&&t>0||e==this.length&&t<=0?n:dl(n,e==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class DO extends Cr{domAtPos(e){let{topView:t,text:i}=this.widget;return t?wc(e,0,t,i,(n,s)=>n.domAtPos(s),n=>new si(i,Math.min(n,i.nodeValue.length))):new si(i,Math.min(e,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:i,text:n}=this.widget;return i?MO(e,t,i,n):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:i,text:n}=this.widget;return i?wc(e,t,i,n,(s,o,a)=>s.coordsAt(o,a),(s,o)=>_c(n,s,o)):_c(n,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function wc(r,e,t,i,n,s){if(t instanceof or){for(let o=t.dom.firstChild;o;o=o.nextSibling){let a=gt.get(o);if(!a)return s(r,e);let l=Yn(o,i),f=a.length+(l?i.nodeValue.length:0);if(r<f||r==f&&a.getSide()<=0)return l?wc(r,e,a,i,n,s):n(a,r,e);r-=f}return n(t,t.length,-1)}else return t.dom==i?s(r,e):n(t,r,e)}function MO(r,e,t,i){if(t instanceof or)for(let n of t.children){let s=0,o=Yn(n.dom,i);if(Yn(n.dom,r))return s+(o?MO(r,e,n,i):n.localPosFromDOM(r,e));s+=o?i.nodeValue.length:n.length}else if(t.dom==i)return Math.min(e,i.nodeValue.length);return t.localPosFromDOM(r,e)}class Jn extends gt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Jn&&e.side==this.side}split(){return new Jn(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return si.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),i=Nx(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return st.empty}}Br.prototype.children=Cr.prototype.children=Jn.prototype.children=ah;function Nx(r,e){let t=r.parent,i=t?t.children.indexOf(r):-1;for(;t&&i>=0;)if(e<0?i>0:i<t.children.length){let n=t.children[i+e];if(n instanceof Br){let s=n.coordsAt(e<0?n.length:0,e);if(s)return s}i+=e}else if(t instanceof or&&t.parent)i=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let n=t.dom.lastChild;if(n&&n.nodeName=="BR")return n.getClientRects()[0];break}}function IO(r,e){let t=r.dom,{children:i}=r,n=0;for(let s=0;n<i.length;n++){let o=i[n],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=n;s>0;s--){let o=i[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=n;s<i.length;s++){let o=i[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new si(t,0)}function BO(r,e,t){let i,{children:n}=r;t>0&&e instanceof or&&n.length&&(i=n[n.length-1])instanceof or&&i.mark.eq(e.mark)?BO(i,e.children[0],t-1):(n.push(e),e.setParent(r)),r.length+=e.length}function GO(r,e,t){for(let s=0,o=0;o<r.children.length;o++){let a=r.children[o],l=s+a.length,f;if((t<=0||l==r.length||a.getSide()>0?l>=e:l>e)&&(e<l||o+1==r.children.length||(f=r.children[o+1]).length||f.getSide()>0)){let c=0;if(l==s){if(a.getSide()<=0)continue;c=t=-a.getSide()}let h=a.coordsAt(Math.max(0,e-s),t);return c&&h?dl(h,t<0):h}s=l}let i=r.dom.lastChild;if(!i)return r.dom.getBoundingClientRect();let n=to(i);return n[n.length-1]||null}function Tc(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}function lh(r,e){if(r==e)return!0;if(!r||!e)return!1;let t=Object.keys(r),i=Object.keys(e);if(t.length!=i.length)return!1;for(let n of t)if(i.indexOf(n)==-1||r[n]!==e[n])return!1;return!0}function kc(r,e,t){let i=null;if(e)for(let n in e)t&&n in t||r.removeAttribute(i=n);if(t)for(let n in t)e&&e[n]==t[n]||r.setAttribute(i=n,t[n]);return!!i}class mr{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var dt=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(dt||(dt={}));class Xe extends mn{constructor(e,t,i,n){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(e){return new ml(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new On(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,n;if(e.isBlockGap)i=-5e8,n=4e8;else{let{start:s,end:o}=NO(e,t);i=(s?t?-3e8:-1:5e8)-1,n=(o?t?2e8:1:-6e8)+1}return new On(e,i,n,t,e.widget||null,!0)}static line(e){return new uo(e)}static set(e,t=!1){return at.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Xe.none=at.empty;class ml extends Xe{constructor(e){let{start:t,end:i}=NO(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof ml&&this.tagName==e.tagName&&this.class==e.class&&lh(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}ml.prototype.point=!1;class uo extends Xe{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof uo&&lh(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}uo.prototype.mapMode=ii.TrackBefore;uo.prototype.point=!0;class On extends Xe{constructor(e,t,i,n,s,o){super(t,i,s,e),this.block=n,this.isReplace=o,this.mapMode=n?t<=0?ii.TrackBefore:ii.TrackAfter:ii.TrackDel}get type(){return this.startSide<this.endSide?dt.WidgetRange:this.startSide<=0?dt.WidgetBefore:dt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof On&&Wx(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}On.prototype.point=!0;function NO(r,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=r;return t==null&&(t=r.inclusive),i==null&&(i=r.inclusive),{start:t!=null?t:e,end:i!=null?i:e}}function Wx(r,e){return r==e||!!(r&&e&&r.compare(e))}function Qc(r,e,t,i=0){let n=t.length-1;n>=0&&t[n]+i>=r?t[n]=Math.max(t[n],e):t.push(r,e)}class li extends gt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,n,s,o){if(i){if(!(i instanceof li))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),RO(this,e,t,i?i.children:[],s,o),!0}split(e){let t=new li;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:n}=this.childPos(e);n&&(t.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){lh(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){BO(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=Tc(t,this.attrs||{})),i&&(this.attrs=Tc({class:i},this.attrs||{}))}domAtPos(e){return IO(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?this.dirty&4&&(CO(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(kc(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let i=this.dom.lastChild;for(;i&&gt.get(i)instanceof or;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((t=gt.get(i))===null||t===void 0?void 0:t.isEditable)==!1&&(!Me.ios||!this.children.some(n=>n instanceof Br))){let n=document.createElement("BR");n.cmIgnore=!0,this.dom.appendChild(n)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof Br)||/[^ -~]/.test(t.text))return null;let i=to(t.dom);if(i.length!=1)return null;e+=i[0].width}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}:null}coordsAt(e,t){return GO(this,e,t)}become(e){return!1}get type(){return dt.Text}static find(e,t){for(let i=0,n=0;i<e.children.length;i++){let s=e.children[i],o=n+s.length;if(o>=t){if(s instanceof li)return s;if(o>t)break}n=o+s.breakAfter}return null}}class un extends gt{constructor(e,t,i){super(),this.widget=e,this.length=t,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,n,s,o){return i&&(!(i instanceof un)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?si.before(this.dom):si.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new un(this.widget,t,this.type);return i.breakAfter=this.breakAfter,i}get children(){return ah}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):st.empty}domBoundsAround(){return null}become(e){return e instanceof un&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class fh{constructor(e,t,i,n){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof un&&e.type==dt.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new li),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(na(new Jn(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}else this.text=s,this.textOff=0}let n=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,i)),this.getLine().append(na(new Br(this.text.slice(this.textOff,this.textOff+n)),t),i),this.atCursorPos=!0,this.textOff+=n,e-=n,i=0}}span(e,t,i,n){this.buildText(t-e,i,n),this.pos=t,this.openStart<0&&(this.openStart=n)}point(e,t,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof On){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=t-e;if(i instanceof On)if(i.block){let{type:l}=i;l==dt.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new un(i.widget||new Op("div"),a,l))}else{let l=Cr.create(i.widget||new Op("span"),a,i.startSide),f=this.atCursorPos&&!l.isEditable&&s<=n.length&&(e<t||i.startSide>0),c=!l.isEditable&&(e<t||i.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!f&&(this.pendingBuffer=0),this.flushBuffer(n),f&&(h.append(na(new Jn(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(na(l,n),s),this.atCursorPos=c,this.pendingBuffer=c?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,i,n,s){let o=new fh(e,t,i,s);return o.openEnd=at.spans(n,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function na(r,e){for(let t of e)r=new or(t,[r],r.length);return r}class Op extends mr{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const WO=Be.define(),FO=Be.define(),XO=Be.define(),jO=Be.define(),Ac=Be.define(),VO=Be.define(),ZO=Be.define({combine:r=>r.some(e=>e)});class Ga{constructor(e,t="nearest",i="nearest",n=5,s=5){this.range=e,this.y=t,this.x=i,this.yMargin=n,this.xMargin=s}map(e){return e.empty?this:new Ga(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const gp=He.define({map:(r,e)=>r.map(e)});function Ai(r,e,t){let i=r.facet(jO);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Ol=Be.define({combine:r=>r.length?r[0]:!0});let Fx=0;const Ls=Be.define();class Dt{constructor(e,t,i,n){this.id=e,this.create=t,this.domEventHandlers=i,this.extension=n(this)}static define(e,t){const{eventHandlers:i,provide:n,decorations:s}=t||{};return new Dt(Fx++,e,i,o=>{let a=[Ls.of(o)];return s&&a.push(ro.of(l=>{let f=l.plugin(o);return f?s(f):Xe.none})),n&&a.push(n(o)),a})}static fromClass(e,t){return Dt.define(i=>new e(i),t)}}class Ef{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Ai(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Ai(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Ai(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const zO=Be.define(),UO=Be.define(),ro=Be.define(),qO=Be.define(),HO=Be.define(),Ds=Be.define();class dr{constructor(e,t,i,n){this.fromA=e,this.toA=t,this.fromB=i,this.toB=n}join(e){return new dr(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let n=e[t-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let n=0,s=0,o=0,a=0;;n++){let l=n==e.length?null:e[n],f=o-a,c=l?l.fromB:1e9;for(;s<t.length&&t[s]<c;){let h=t[s],d=t[s+1],g=Math.max(a,h),_=Math.min(c,d);if(g<=_&&new dr(g+f,_+f,g,_).addToSet(i),d>c)break;s+=2}if(!l)return i;new dr(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}}class Na{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Bt.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let n=[];this.changes.iterChangedRanges((o,a,l,f)=>n.push(new dr(o,a,l,f))),this.changedRanges=n;let s=e.hasFocus;s!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=s,this.flags|=1)}static create(e,t,i){return new Na(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var _t=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(_t||(_t={}));const Cc=_t.LTR,Xx=_t.RTL;function YO(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const jx=YO("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Vx=YO("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),$c=Object.create(null),Hi=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);$c[e]=t,$c[t]=-e}function Zx(r){return r<=247?jx[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?Vx[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8203?256:64336<=r&&r<=65023?4:r==8204?256:1}const zx=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class qn{constructor(e,t,i){this.from=e,this.to=t,this.level=i}get dir(){return this.level%2?Xx:Cc}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,n){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==i)return o;(s<0||(n!=0?n<0?a.from<t:a.to>t:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}const St=[];function Ux(r,e){let t=r.length,i=e==Cc?1:2,n=e==Cc?2:1;if(!r||i==1&&!zx.test(r))return KO(t);for(let o=0,a=i,l=i;o<t;o++){let f=Zx(r.charCodeAt(o));f==512?f=a:f==8&&l==4&&(f=16),St[o]=f==4?2:f,f&7&&(l=f),a=f}for(let o=0,a=i,l=i;o<t;o++){let f=St[o];if(f==128)o<t-1&&a==St[o+1]&&a&24?f=St[o]=a:St[o]=256;else if(f==64){let c=o+1;for(;c<t&&St[c]==64;)c++;let h=o&&a==8||c<t&&St[c]==8?l==1?1:8:256;for(let d=o;d<c;d++)St[d]=h;o=c-1}else f==8&&l==1&&(St[o]=1);a=f,f&7&&(l=f)}for(let o=0,a=0,l=0,f,c,h;o<t;o++)if(c=$c[f=r.charCodeAt(o)])if(c<0){for(let d=a-3;d>=0;d-=3)if(Hi[d+1]==-c){let g=Hi[d+2],_=g&2?i:g&4?g&1?n:i:0;_&&(St[o]=St[Hi[d]]=_),a=d;break}}else{if(Hi.length==189)break;Hi[a++]=o,Hi[a++]=f,Hi[a++]=l}else if((h=St[o])==2||h==1){let d=h==i;l=d?0:1;for(let g=a-3;g>=0;g-=3){let _=Hi[g+2];if(_&2)break;if(d)Hi[g+2]|=2;else{if(_&4)break;Hi[g+2]|=4}}}for(let o=0;o<t;o++)if(St[o]==256){let a=o+1;for(;a<t&&St[a]==256;)a++;let l=(o?St[o-1]:i)==1,f=(a<t?St[a]:i)==1,c=l==f?l?1:2:i;for(let h=o;h<a;h++)St[h]=c;o=a-1}let s=[];if(i==1)for(let o=0;o<t;){let a=o,l=St[o++]!=1;for(;o<t&&l==(St[o]!=1);)o++;if(l)for(let f=o;f>a;){let c=f,h=St[--f]!=2;for(;f>a&&h==(St[f-1]!=2);)f--;s.push(new qn(f,c,h?2:1))}else s.push(new qn(a,o,0))}else for(let o=0;o<t;){let a=o,l=St[o++]==2;for(;o<t&&l==(St[o]==2);)o++;s.push(new qn(a,o,l?1:2))}return s}function KO(r){return[new qn(0,r,0)]}let JO="";function qx(r,e,t,i,n){var s;let o=i.head-r.from,a=-1;if(o==0){if(!n||!r.length)return null;e[0].level!=t&&(o=e[0].side(!1,t),a=0)}else if(o==r.length){if(n)return null;let d=e[e.length-1];d.level!=t&&(o=d.side(!0,t),a=e.length-1)}a<0&&(a=qn.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc));let l=e[a];o==l.side(n,t)&&(l=e[a+=n?1:-1],o=l.side(!n,t));let f=n==(l.dir==t),c=ai(r.text,o,f);if(JO=r.text.slice(Math.min(o,c),Math.max(o,c)),c!=l.side(n,t))return se.cursor(c+r.from,f?-1:1,l.level);let h=a==(n?e.length-1:0)?null:e[a+(n?1:-1)];return!h&&l.level!=t?se.cursor(n?r.to:r.from,n?-1:1,t):h&&h.level<l.level?se.cursor(h.side(!n,t)+r.from,n?1:-1,h.level):se.cursor(c+r.from,n?-1:1,l.level)}const $r="\uFFFF";class eg{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(rt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=$r}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let n=e;;){this.findPointBefore(i,n),this.readNode(n);let s=n.nextSibling;if(s==t)break;let o=gt.get(n),a=gt.get(s);(o&&a?o.breakAfter:(o?o.breakAfter:vp(n))||vp(s)&&(n.nodeName!="BR"||n.cmIgnore))&&this.lineBreak(),n=s}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=n.exec(t))&&(s=a.index,o=a[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let t=gt.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+Math.min(t,i.offset))}}function vp(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}class bp{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class yp extends gt{constructor(e){super(),this.view=e,this.compositionDeco=Xe.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new li],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new dr(0,0,0,e.state.doc.length)],0)}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:o,toA:a})=>a<this.minWidthFrom||o>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Xe.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=Yx(this.view,e.changes)),(Me.ie||Me.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,n=this.updateDeco(),s=tS(i,n,e.changes);return t=dr.extendWithRanges(t,s),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=Me.chrome||Me.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(s),this.dirty=0,s&&(s.written||i.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""});let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof un&&s.widget instanceof xp&&n.push(s.dom);i.updateGaps(n)}updateChildren(e,t){let i=this.childCursor(t);for(let n=e.length-1;;n--){let s=n>=0?e[n]:null;if(!s)break;let{fromA:o,toA:a,fromB:l,toB:f}=s,{content:c,breakAtStart:h,openStart:d,openEnd:g}=fh.build(this.view.state.doc,l,f,this.decorations,this.dynamicDecorationMap),{i:_,off:D}=i.findPos(a,1),{i:E,off:U}=i.findPos(o,-1);EO(this,E,U,_,D,c,h,d,g)}}updateSelection(e=!1,t=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection()))return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,s=this.domAtPos(n.anchor),o=n.empty?s:this.domAtPos(n.head);if(Me.gecko&&n.empty&&Hx(s)){let l=document.createTextNode("");this.view.observer.ignore(()=>s.node.insertBefore(l,s.node.childNodes[s.offset]||null)),s=o=new si(l,0),i=!0}let a=this.view.observer.selectionRange;(i||!a.focusNode||!Ia(s.node,s.offset,a.anchorNode,a.anchorOffset)||!Ia(o.node,o.offset,a.focusNode,a.focusOffset))&&(this.view.observer.ignore(()=>{Me.android&&Me.chrome&&this.dom.contains(a.focusNode)&&iS(a.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let l=Ma(this.view.root);if(l)if(n.empty){if(Me.gecko){let f=Jx(s.node,s.offset);if(f&&f!=3){let c=ig(s.node,s.offset,f==1?1:-1);c&&(s=new si(c,f==1?0:c.nodeValue.length))}}l.collapse(s.node,s.offset),n.bidiLevel!=null&&a.cursorBidiLevel!=null&&(a.cursorBidiLevel=n.bidiLevel)}else if(l.extend){l.collapse(s.node,s.offset);try{l.extend(o.node,o.offset)}catch{}}else{let f=document.createRange();n.anchor>n.head&&([s,o]=[o,s]),f.setEnd(o.node,o.offset),f.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(f)}}),this.view.observer.setSelectionRange(s,o)),this.impreciseAnchor=s.precise?null:new si(a.anchorNode,a.anchorOffset),this.impreciseHead=o.precise?null:new si(a.focusNode,a.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=Ma(this.view.root);if(!t||!e.empty||!e.assoc||!t.modify)return;let i=li.find(this,e.head);if(!i)return;let n=i.posAtStart;if(e.head==n||e.head==n+i.length)return;let s=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(!s||!o||s.bottom>o.top)return;let a=this.domAtPos(e.head+e.assoc);t.collapse(a.node,a.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||Sa(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let t=e;t;){let i=gt.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let n=this.children[t];if(i<n.length||n instanceof li)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,n=this.children.length-1;;n--){let s=this.children[n],o=i-s.breakAfter-s.length;if(e>o||e==o&&s.type!=dt.WidgetBefore&&s.type!=dt.WidgetAfter&&(!n||t==2||this.children[n-1].breakAfter||this.children[n-1].type==dt.WidgetBefore&&t>-2))return s.coordsAt(e-o,t);i=o}}measureVisibleLineHeights(e){let t=[],{from:i,to:n}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==_t.LTR;for(let f=0,c=0;c<this.children.length;c++){let h=this.children[c],d=f+h.length;if(d>n)break;if(f>=i){let g=h.dom.getBoundingClientRect();if(t.push(g.height),o){let _=h.dom.lastChild,D=_?to(_):[];if(D.length){let E=D[D.length-1],U=l?E.right-g.left:g.right-E.left;U>a&&(a=U,this.minWidth=s,this.minWidthFrom=f,this.minWidthTo=d)}}}f=d+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?_t.RTL:_t.LTR}measureTextSize(){for(let n of this.children)if(n instanceof li){let s=n.measureTextSize();if(s)return s}let e=document.createElement("div"),t,i;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let n=to(e.firstChild)[0];t=e.getBoundingClientRect().height,i=n?n.width/27:7,e.remove()}),{lineHeight:t,charWidth:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new $O(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,n=0;;n++){let s=n==t.viewports.length?null:t.viewports[n],o=s?s.from-1:this.length;if(o>i){let a=t.lineBlockAt(o).bottom-t.lineBlockAt(i).top;e.push(Xe.replace({widget:new xp(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return Xe.set(e)}updateDeco(){let e=this.view.state.facet(ro).map((t,i)=>(this.dynamicDecorationMap[i]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),n;if(!i)return;!t.empty&&(n=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let s=0,o=0,a=0,l=0;for(let c of this.view.state.facet(HO).map(h=>h(this.view)))if(c){let{left:h,right:d,top:g,bottom:_}=c;h!=null&&(s=Math.max(s,h)),d!=null&&(o=Math.max(o,d)),g!=null&&(a=Math.max(a,g)),_!=null&&(l=Math.max(l,_))}let f={left:i.left-s,top:i.top-a,right:i.right+o,bottom:i.bottom+l};Dx(this.view.scrollDOM,f,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==_t.LTR)}}function Hx(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}class xp extends mr{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function tg(r){let e=r.observer.selectionRange,t=e.focusNode&&ig(e.focusNode,e.focusOffset,0);if(!t)return null;let i=r.docView.nearest(t);if(!i)return null;if(i instanceof li){let n=t;for(;n.parentNode!=i.dom;)n=n.parentNode;let s=n.previousSibling;for(;s&&!gt.get(s);)s=s.previousSibling;let o=s?gt.get(s).posAtEnd:i.posAtStart;return{from:o,to:o,node:n,text:t}}else{for(;;){let{parent:s}=i;if(!s)return null;if(s instanceof li)break;i=s}let n=i.posAtStart;return{from:n,to:n+i.length,node:i.dom,text:t}}}function Yx(r,e){let t=tg(r);if(!t)return Xe.none;let{from:i,to:n,node:s,text:o}=t,a=e.mapPos(i,1),l=Math.max(a,e.mapPos(n,-1)),{state:f}=r,c=s.nodeType==3?s.nodeValue:new eg([],f).readRange(s.firstChild,null).text;if(l-a<c.length)if(f.doc.sliceString(a,Math.min(f.doc.length,a+c.length),$r)==c)l=a+c.length;else if(f.doc.sliceString(Math.max(0,l-c.length),l,$r)==c)a=l-c.length;else return Xe.none;else if(f.doc.sliceString(a,l,$r)!=c)return Xe.none;let h=gt.get(s);return h instanceof DO?h=h.widget.topView:h&&(h.parent=null),Xe.set(Xe.replace({widget:new Kx(s,o,h),inclusive:!0}).range(a,l))}class Kx extends mr{constructor(e,t,i){super(),this.top=e,this.text=t,this.topView=i}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return DO}}function ig(r,e,t){for(;;){if(r.nodeType==3)return r;if(r.nodeType==1&&e>0&&t<=0)r=r.childNodes[e-1],e=io(r);else if(r.nodeType==1&&e<r.childNodes.length&&t>=0)r=r.childNodes[e],e=0;else return null}}function Jx(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}class eS{constructor(){this.changes=[]}compareRange(e,t){Qc(e,t,this.changes)}comparePoint(e,t){Qc(e,t,this.changes)}}function tS(r,e,t){let i=new eS;return at.compare(r,e,t,i),i.changes}function iS(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function rS(r,e,t=1){let i=r.charCategorizer(e),n=r.doc.lineAt(e),s=e-n.from;if(n.length==0)return se.cursor(e);s==0?t=1:s==n.length&&(t=-1);let o=s,a=s;t<0?o=ai(n.text,s,!1):a=ai(n.text,s);let l=i(n.text.slice(o,a));for(;o>0;){let f=ai(n.text,o,!1);if(i(n.text.slice(f,o))!=l)break;o=f}for(;a<n.length;){let f=ai(n.text,a);if(i(n.text.slice(a,f))!=l)break;a=f}return se.range(o+n.from,a+n.from)}function nS(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function sS(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function Rf(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function Sp(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function _p(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function Ec(r,e,t){let i,n,s,o,a=!1,l,f,c,h;for(let _=r.firstChild;_;_=_.nextSibling){let D=to(_);for(let E=0;E<D.length;E++){let U=D[E];n&&Rf(n,U)&&(U=Sp(_p(U,n.bottom),n.top));let Qe=nS(e,U),pe=sS(t,U);if(Qe==0&&pe==0)return _.nodeType==3?wp(_,e,t):Ec(_,e,t);(!i||o>pe||o==pe&&s>Qe)&&(i=_,n=U,s=Qe,o=pe,a=!Qe||(Qe>0?E<D.length-1:E>0)),Qe==0?t>U.bottom&&(!c||c.bottom<U.bottom)?(l=_,c=U):t<U.top&&(!h||h.top>U.top)&&(f=_,h=U):c&&Rf(c,U)?c=_p(c,U.bottom):h&&Rf(h,U)&&(h=Sp(h,U.top))}}if(c&&c.bottom>=t?(i=l,n=c):h&&h.top<=t&&(i=f,n=h),!i)return{node:r,offset:0};let d=Math.max(n.left,Math.min(n.right,e));if(i.nodeType==3)return wp(i,d,t);if(a&&i.contentEditable!="false")return Ec(i,d,t);let g=Array.prototype.indexOf.call(r.childNodes,i)+(e>=(n.left+n.right)/2?1:0);return{node:r,offset:g}}function wp(r,e,t){let i=r.nodeValue.length,n=-1,s=1e9,o=0;for(let a=0;a<i;a++){let l=Kn(r,a,a+1).getClientRects();for(let f=0;f<l.length;f++){let c=l[f];if(c.top==c.bottom)continue;o||(o=e-c.left);let h=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<s){let d=e>=(c.left+c.right)/2,g=d;if((Me.chrome||Me.gecko)&&Kn(r,a).getBoundingClientRect().left==c.right&&(g=!d),h<=0)return{node:r,offset:a+(g?1:0)};n=a+(g?1:0),s=h}}}return{node:r,offset:n>-1?n:o>0?r.nodeValue.length:0}}function rg(r,{x:e,y:t},i,n=-1){var s;let o=r.contentDOM.getBoundingClientRect(),a=o.top+r.viewState.paddingTop,l,{docHeight:f}=r.viewState,c=t-a;if(c<0)return 0;if(c>f)return r.state.doc.length;for(let U=r.defaultLineHeight/2,Qe=!1;l=r.elementAtHeight(c),l.type!=dt.Text;)for(;c=n>0?l.bottom+U:l.top-U,!(c>=0&&c<=f);){if(Qe)return i?null:0;Qe=!0,n=-n}t=a+c;let h=l.from;if(h<r.viewport.from)return r.viewport.from==0?0:i?null:Tp(r,o,l,e,t);if(h>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:i?null:Tp(r,o,l,e,t);let d=r.dom.ownerDocument,g=r.root.elementFromPoint?r.root:d,_=g.elementFromPoint(e,t);_&&!r.contentDOM.contains(_)&&(_=null),_||(e=Math.max(o.left+1,Math.min(o.right-1,e)),_=g.elementFromPoint(e,t),_&&!r.contentDOM.contains(_)&&(_=null));let D,E=-1;if(_&&((s=r.docView.nearest(_))===null||s===void 0?void 0:s.isEditable)!=!1){if(d.caretPositionFromPoint){let U=d.caretPositionFromPoint(e,t);U&&({offsetNode:D,offset:E}=U)}else if(d.caretRangeFromPoint){let U=d.caretRangeFromPoint(e,t);U&&({startContainer:D,startOffset:E}=U,(!r.contentDOM.contains(D)||Me.safari&&oS(D,E,e)||Me.chrome&&aS(D,E,e))&&(D=void 0))}}if(!D||!r.docView.dom.contains(D)){let U=li.find(r.docView,h);if(!U)return c>l.top+l.height/2?l.to:l.from;({node:D,offset:E}=Ec(U.dom,e,t))}return r.docView.posFromDOM(D,E)}function Tp(r,e,t,i,n){let s=Math.round((i-e.left)*r.defaultCharacterWidth);r.lineWrapping&&t.height>r.defaultLineHeight*1.5&&(s+=Math.floor((n-t.top)/r.defaultLineHeight)*r.viewState.heightOracle.lineLength);let o=r.state.sliceDoc(t.from,t.to);return t.from+gc(o,s,r.state.tabSize)}function oS(r,e,t){let i;if(r.nodeType!=3||e!=(i=r.nodeValue.length))return!1;for(let n=r.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return Kn(r,i-1,i).getBoundingClientRect().left>t}function aS(r,e,t){if(e!=0)return!1;for(let n=r;;){let s=n.parentNode;if(!s||s.nodeType!=1||s.firstChild!=n)return!1;if(s.classList.contains("cm-line"))break;n=s}let i=r.nodeType==1?r.getBoundingClientRect():Kn(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function lS(r,e,t,i){let n=r.state.doc.lineAt(e.head),s=!i||!r.lineWrapping?null:r.coordsAtPos(e.assoc<0&&e.head>n.from?e.head-1:e.head);if(s){let l=r.dom.getBoundingClientRect(),f=r.textDirectionAt(n.from),c=r.posAtCoords({x:t==(f==_t.LTR)?l.right-1:l.left+1,y:(s.top+s.bottom)/2});if(c!=null)return se.cursor(c,t?-1:1)}let o=li.find(r.docView,e.head),a=o?t?o.posAtEnd:o.posAtStart:t?n.to:n.from;return se.cursor(a,t?-1:1)}function kp(r,e,t,i){let n=r.state.doc.lineAt(e.head),s=r.bidiSpans(n),o=r.textDirectionAt(n.from);for(let a=e,l=null;;){let f=qx(n,s,o,a,t),c=JO;if(!f){if(n.number==(t?r.state.doc.lines:1))return a;c=`
`,n=r.state.doc.line(n.number+(t?1:-1)),s=r.bidiSpans(n),f=se.cursor(t?n.from:n.to)}if(l){if(!l(c))return a}else{if(!i)return f;l=i(c)}a=f}}function fS(r,e,t){let i=r.state.charCategorizer(e),n=i(t);return s=>{let o=i(s);return n==bt.Space&&(n=o),n==o}}function cS(r,e,t,i){let n=e.head,s=t?1:-1;if(n==(t?r.state.doc.length:0))return se.cursor(n,e.assoc);let o=e.goalColumn,a,l=r.contentDOM.getBoundingClientRect(),f=r.coordsAtPos(n),c=r.documentTop;if(f)o==null&&(o=f.left-l.left),a=s<0?f.top:f.bottom;else{let g=r.viewState.lineBlockAt(n);o==null&&(o=Math.min(l.right-l.left,r.defaultCharacterWidth*(n-g.from))),a=(s<0?g.top:g.bottom)+c}let h=l.left+o,d=i!=null?i:r.defaultLineHeight>>1;for(let g=0;;g+=10){let _=a+(d+g)*s,D=rg(r,{x:h,y:_},!1,s);if(_<l.top||_>l.bottom||(s<0?D<n:D>n))return se.cursor(D,e.assoc,void 0,o)}}function Pf(r,e,t){let i=r.state.facet(qO).map(n=>n(r));for(;;){let n=!1;for(let s of i)s.between(t.from-1,t.from+1,(o,a,l)=>{t.from>o&&t.from<a&&(t=e.head>t.from?se.cursor(o,1):se.cursor(a,-1),n=!0)});if(!n)return t}}class hS{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.mouseSelection=null;for(let t in Ht){let i=Ht[t];e.contentDOM.addEventListener(t,n=>{!Qp(e,n)||this.ignoreDuringComposition(n)||t=="keydown"&&this.keydown(e,n)||(this.mustFlushObserver(n)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,n)?n.preventDefault():i(e,n))},Rc[t]),this.registeredEvents.push(t)}Me.chrome&&Me.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,Me.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var i;let n;this.customHandlers=[];for(let s of t)if(n=(i=s.update(e).spec)===null||i===void 0?void 0:i.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:n});for(let o in n)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),e.contentDOM.addEventListener(o,a=>{!Qp(e,a)||this.runCustomHandlers(o,e,a)&&a.preventDefault()}))}}runCustomHandlers(e,t,i){for(let n of this.customHandlers){let s=n.handlers[e];if(s)try{if(s.call(n.plugin,i,t)||i.defaultPrevented)return!0}catch(o){Ai(t.state,o)}}return!1}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,t,e)}catch(s){Ai(e.state,s)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(Me.android&&Me.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return Me.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=ng.find(n=>n.keyCode==t.keyCode))&&!t.ctrlKey||uS.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,js(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Me.safari&&!Me.ios&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const ng=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],uS="dthko",sg=[16,17,18,20,91,92,224,225];class dS{constructor(e,t,i,n){this.view=e,this.style=i,this.mustSelect=n,this.lastEvent=t;let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(rt.allowMultipleSelections)&&pS(e,t),this.dragMove=mS(e,t),this.dragging=OS(e,t)&&fg(t)==1?null:!1,this.dragging===!1&&(t.preventDefault(),this.select(t))}move(e){if(e.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=e)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function pS(r,e){let t=r.state.facet(WO);return t.length?t[0](e):Me.mac?e.metaKey:e.ctrlKey}function mS(r,e){let t=r.state.facet(FO);return t.length?t[0](e):Me.mac?!e.altKey:!e.ctrlKey}function OS(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let i=Ma(r.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let s=0;s<n.length;s++){let o=n[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Qp(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=gt.get(t))&&i.ignoreEvent(e))return!1;return!0}const Ht=Object.create(null),Rc=Object.create(null),og=Me.ie&&Me.ie_version<15||Me.ios&&Me.webkit_version<604;function gS(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),ag(r,t.value)},50)}function ag(r,e){let{state:t}=r,i,n=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Pc!=null&&t.selection.ranges.every(l=>l.empty)&&Pc==s.toString()){let l=-1;i=t.changeByRange(f=>{let c=t.doc.lineAt(f.from);if(c.from==l)return{range:f};l=c.from;let h=t.toText((o?s.line(n++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:h},range:se.cursor(f.from+h.length)}})}else o?i=t.changeByRange(l=>{let f=s.line(n++);return{changes:{from:l.from,to:l.to,insert:f.text},range:se.cursor(l.from+f.length)}}):i=t.replaceSelection(s);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Ht.keydown=(r,e)=>{r.inputState.setSelectionOrigin("select"),e.keyCode==27?r.inputState.lastEscPress=Date.now():sg.indexOf(e.keyCode)<0&&(r.inputState.lastEscPress=0)};Ht.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Ht.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};Rc.touchstart=Rc.touchmove={passive:!0};Ht.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return;let t=null;for(let i of r.state.facet(XO))if(t=i(r,e),t)break;if(!t&&e.button==0&&(t=yS(r,e)),t){let i=r.root.activeElement!=r.contentDOM;i&&r.observer.ignore(()=>AO(r.contentDOM)),r.inputState.startMouseSelection(new dS(r,e,t,i))}};function Ap(r,e,t,i){if(i==1)return se.cursor(e,t);if(i==2)return rS(r.state,e,t);{let n=li.find(r.docView,e),s=r.state.doc.lineAt(n?n.posAtEnd:e),o=n?n.posAtStart:s.from,a=n?n.posAtEnd:s.to;return a<r.state.doc.length&&a==s.to&&a++,se.range(o,a)}}let lg=(r,e)=>r>=e.top&&r<=e.bottom,Cp=(r,e,t)=>lg(e,t)&&r>=t.left&&r<=t.right;function vS(r,e,t,i){let n=li.find(r.docView,e);if(!n)return 1;let s=e-n.posAtStart;if(s==0)return 1;if(s==n.length)return-1;let o=n.coordsAt(s,-1);if(o&&Cp(t,i,o))return-1;let a=n.coordsAt(s,1);return a&&Cp(t,i,a)?1:o&&lg(i,o)?-1:1}function $p(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:vS(r,t,e.clientX,e.clientY)}}const bS=Me.ie&&Me.ie_version<=11;let Ep=null,Rp=0,Pp=0;function fg(r){if(!bS)return r.detail;let e=Ep,t=Pp;return Ep=r,Pp=Date.now(),Rp=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(Rp+1)%3:1}function yS(r,e){let t=$p(r,e),i=fg(e),n=r.state.selection,s=t,o=e;return{update(a){a.docChanged&&(t.pos=a.changes.mapPos(t.pos),n=n.map(a.changes),o=null)},get(a,l,f){let c;o&&a.clientX==o.clientX&&a.clientY==o.clientY?c=s:(c=s=$p(r,a),o=a);let h=Ap(r,c.pos,c.bias,i);if(t.pos!=c.pos&&!l){let d=Ap(r,t.pos,t.bias,i),g=Math.min(d.from,h.from),_=Math.max(d.to,h.to);h=g<h.from?se.range(g,_):se.range(_,g)}return l?n.replaceRange(n.main.extend(h.from,h.to)):f&&n.ranges.length>1&&n.ranges.some(d=>d.eq(h))?xS(n,h):f?n.addRange(h):se.create([h])}}}function xS(r,e){for(let t=0;;t++)if(r.ranges[t].eq(e))return se.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}Ht.dragstart=(r,e)=>{let{selection:{main:t}}=r.state,{mouseSelection:i}=r.inputState;i&&(i.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",r.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function Lp(r,e,t,i){if(!t)return;let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=r.inputState,o=i&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,a={from:n,insert:t},l=r.state.changes(o?[o,a]:a);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(n,-1),head:l.mapPos(n,1)},userEvent:o?"move.drop":"input.drop"})}Ht.drop=(r,e)=>{if(!e.dataTransfer)return;if(r.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let i=Array(t.length),n=0,s=()=>{++n==t.length&&Lp(r,e,i.filter(o=>o!=null).join(r.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),s()},a.readAsText(t[o])}}else Lp(r,e,e.dataTransfer.getData("Text"),!0)};Ht.paste=(r,e)=>{if(r.state.readOnly)return e.preventDefault();r.observer.flush();let t=og?null:e.clipboardData;t?(ag(r,t.getData("text/plain")),e.preventDefault()):gS(r)};function SS(r,e){let t=r.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function _S(r){let e=[],t=[],i=!1;for(let n of r.selection.ranges)n.empty||(e.push(r.sliceDoc(n.from,n.to)),t.push(n));if(!e.length){let n=-1;for(let{from:s}of r.selection.ranges){let o=r.doc.lineAt(s);o.number>n&&(e.push(o.text),t.push({from:o.from,to:Math.min(r.doc.length,o.to+1)})),n=o.number}i=!0}return{text:e.join(r.lineBreak),ranges:t,linewise:i}}let Pc=null;Ht.copy=Ht.cut=(r,e)=>{let{text:t,ranges:i,linewise:n}=_S(r.state);if(!t&&!n)return;Pc=n?t:null;let s=og?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",t)):SS(r,t),e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};function cg(r){setTimeout(()=>{r.hasFocus!=r.inputState.notifiedFocused&&r.update([])},10)}Ht.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),cg(r)};Ht.blur=r=>{r.observer.clearSelectionRange(),cg(r)};Ht.compositionstart=Ht.compositionupdate=r=>{r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0)};Ht.compositionend=r=>{r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionFirstChange=null,Me.chrome&&Me.android&&r.observer.flushSoon(),setTimeout(()=>{r.inputState.composing<0&&r.docView.compositionDeco.size&&r.update([])},50)};Ht.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};Ht.beforeinput=(r,e)=>{var t;let i;if(Me.chrome&&Me.android&&(i=ng.find(n=>n.inputType==e.inputType))&&(r.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let n=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>n+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}};const Dp=["pre-wrap","normal","pre-line","break-spaces"];class wS{constructor(){this.doc=st.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Dp.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let n=e[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(t=!0,this.heightSamples[Math.floor(n*10)]=!0)}return t}refresh(e,t,i,n,s){let o=Dp.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=i,this.lineLength=n,a){this.heightSamples={};for(let l=0;l<s.length;l++){let f=s[l];f<0?l++:this.heightSamples[Math.floor(f*10)]=!0}}return a}}class TS{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Er{constructor(e,t,i,n,s){this.from=e,this.length=t,this.top=i,this.height=n,this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new Er(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Ot=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Ot||(Ot={}));const _a=.001;class mi{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>_a&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return mi.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,n){let s=this;for(let o=n.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:f,toB:c}=n[o],h=s.lineAt(a,Ot.ByPosNoHeight,t,0,0),d=h.to>=l?h:s.lineAt(l,Ot.ByPosNoHeight,t,0,0);for(c+=d.to-l,l=d.to;o>0&&h.from<=n[o-1].toA;)a=n[o-1].fromA,f=n[o-1].fromB,o--,a<h.from&&(h=s.lineAt(a,Ot.ByPosNoHeight,t,0,0));f+=h.from-a,a=h.from;let g=ch.build(i,e,f,c);s=s.replace(a,l,g)}return s.updateHeight(i,0)}static empty(){return new wi(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,n=0,s=0;for(;;)if(t==i)if(n>s*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),i+=1+a.break,n-=a.size}else if(s>n*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,s-=a.size}else break;else if(n<s){let a=e[t++];a&&(n+=a.size)}else{let a=e[--i];a&&(s+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new kS(mi.of(e.slice(0,t)),o,mi.of(e.slice(i)))}}mi.prototype.size=1;class hg extends mi{constructor(e,t,i){super(e,t),this.type=i}blockAt(e,t,i,n){return new Er(n,this.length,i,this.height,this.type)}lineAt(e,t,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(e,t,i,n,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,i,n,s))}updateHeight(e,t=0,i=!1,n){return n&&n.from<=t&&n.more&&this.setHeight(e,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class wi extends hg{constructor(e,t){super(e,t,dt.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,i){let n=i[0];return i.length==1&&(n instanceof wi||n instanceof Jt&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Jt?n=new wi(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):mi.of(i)}updateHeight(e,t=0,i=!1,n){return n&&n.from<=t&&n.more?this.setHeight(e,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Jt extends mi{constructor(e){super(e,0)}lines(e,t){let i=e.lineAt(t).number,n=e.lineAt(t+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(e,t,i,n){let{firstLine:s,lastLine:o,lineHeight:a}=this.lines(t,n),l=Math.max(0,Math.min(o-s,Math.floor((e-i)/a))),{from:f,length:c}=t.line(s+l);return new Er(f,c,i+a*l,a,dt.Text)}lineAt(e,t,i,n,s){if(t==Ot.ByHeight)return this.blockAt(e,i,n,s);if(t==Ot.ByPosNoHeight){let{from:h,to:d}=i.lineAt(e);return new Er(h,d-h,0,0,dt.Text)}let{firstLine:o,lineHeight:a}=this.lines(i,s),{from:l,length:f,number:c}=i.lineAt(e);return new Er(l,f,n+a*(c-o),a,dt.Text)}forEachLine(e,t,i,n,s,o){let{firstLine:a,lineHeight:l}=this.lines(i,s);for(let f=Math.max(e,s),c=Math.min(s+this.length,t);f<=c;){let h=i.lineAt(f);f==e&&(n+=l*(h.number-a)),o(new Er(h.from,h.length,n,l,dt.Text)),n+=l,f=h.to+1}}replace(e,t,i){let n=this.length-t;if(n>0){let s=i[i.length-1];s instanceof Jt?i[i.length-1]=new Jt(s.length+n):i.push(null,new Jt(n-1))}if(e>0){let s=i[0];s instanceof Jt?i[0]=new Jt(e+s.length):i.unshift(new Jt(e-1),null)}return mi.of(i)}decomposeLeft(e,t){t.push(new Jt(e-1),null)}decomposeRight(e,t){t.push(null,new Jt(this.length-e-1))}updateHeight(e,t=0,i=!1,n){let s=t+this.length;if(n&&n.from<=t+this.length&&n.more){let o=[],a=Math.max(t,n.from),l=-1,f=e.heightChanged;for(n.from>t&&o.push(new Jt(n.from-t-1).updateHeight(e,t));a<=s&&n.more;){let h=e.doc.lineAt(a).length;o.length&&o.push(null);let d=n.heights[n.index++];l==-1?l=d:Math.abs(d-l)>=_a&&(l=-2);let g=new wi(h,d);g.outdated=!1,o.push(g),a+=h+1}a<=s&&o.push(null,new Jt(s-a).updateHeight(e,a));let c=mi.of(o);return e.heightChanged=f||l<0||Math.abs(c.height-this.height)>=_a||Math.abs(l-this.lines(e.doc,t).lineHeight)>=_a,c}else(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class kS extends mi{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,n){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,n):this.right.blockAt(e,t,s,n+this.left.length+this.break)}lineAt(e,t,i,n,s){let o=n+this.left.height,a=s+this.left.length+this.break,l=t==Ot.ByHeight?e<o:e<a,f=l?this.left.lineAt(e,t,i,n,s):this.right.lineAt(e,t,i,o,a);if(this.break||(l?f.to<a:f.from>a))return f;let c=t==Ot.ByPosNoHeight?Ot.ByPosNoHeight:Ot.ByPos;return l?f.join(this.right.lineAt(a,c,i,o,a)):this.left.lineAt(a,c,i,n,s).join(f)}forEachLine(e,t,i,n,s,o){let a=n+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,i,n,s,o),t>=l&&this.right.forEachLine(e,t,i,a,l,o);else{let f=this.lineAt(l,Ot.ByPos,i,n,s);e<f.from&&this.left.forEachLine(e,f.from-1,i,n,s,o),f.to>=e&&f.from<=t&&o(f),t>f.to&&this.right.forEachLine(f.to+1,t,i,a,l,o)}}replace(e,t,i){let n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of i)s.push(a);if(e>0&&Mp(s,o-1),t<this.length){let a=s.length;this.decomposeRight(t,s),Mp(s,a)}return mi.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,n=i+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<n&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?mi.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,n){let{left:s,right:o}=this,a=t+s.length+this.break,l=null;return n&&n.from<=t+s.length&&n.more?l=s=s.updateHeight(e,t,i,n):s.updateHeight(e,t,i),n&&n.from<=a+o.length&&n.more?l=o=o.updateHeight(e,a,i,n):o.updateHeight(e,a,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Mp(r,e){let t,i;r[e]==null&&(t=r[e-1])instanceof Jt&&(i=r[e+1])instanceof Jt&&r.splice(e-1,3,new Jt(t.length+1+i.length))}const QS=5;class ch{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof wi?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new wi(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let s=t-e;i.block?this.addBlock(new hg(s,n,i.type)):(s||n>=QS)&&this.addLineDeco(n,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new wi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Jt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof wi)return e;let t=new wi(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==dt.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=dt.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let i=this.ensureLine();i.length+=t,i.collapsed+=t,i.widgetHeight=Math.max(i.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof wi)&&!this.isCovered?this.nodes.push(new wi(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let n of this.nodes)n instanceof wi&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(e,t,i,n){let s=new ch(i,e);return at.spans(t,i,n,s,0),s.finish(i)}}function AS(r,e,t){let i=new CS;return at.compare(r,e,t,i,0),i.changes}class CS{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,n){(e<t||i&&i.heightRelevant||n&&n.heightRelevant)&&Qc(e,t,this.changes,5)}}function $S(r,e){let t=r.getBoundingClientRect(),i=r.ownerDocument,n=i.defaultView||window,s=Math.max(0,t.left),o=Math.min(n.innerWidth,t.right),a=Math.max(0,t.top),l=Math.min(n.innerHeight,t.bottom);for(let f=r.parentNode;f&&f!=i.body;)if(f.nodeType==1){let c=f,h=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&h.overflow!="visible"){let d=c.getBoundingClientRect();s=Math.max(s,d.left),o=Math.min(o,d.right),a=Math.max(a,d.top),l=f==r.parentNode?d.bottom:Math.min(l,d.bottom)}f=h.position=="absolute"||h.position=="fixed"?c.offsetParent:c.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:a-(t.top+e),bottom:Math.max(a,l)-(t.top+e)}}function ES(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Lf{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let n=e[i],s=t[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(e){return Xe.replace({widget:new RS(this.size,e)}).range(this.from,this.to)}}class RS extends mr{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Ip{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new wS,this.scaler=Gp,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=_t.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=e.facet(ro).filter(t=>typeof t!="function"),this.heightMap=mi.empty().applyChanges(this.stateDeco,st.empty,this.heightOracle.setDoc(e.doc),[new dr(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Xe.set(this.lineGaps.map(t=>t.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let n=i?t.head:t.anchor;if(!e.some(({from:s,to:o})=>n>=s&&n<=o)){let{from:s,to:o}=this.lineBlockAt(n);e.push(new sa(s,o))}}this.viewports=e.sort((i,n)=>i.from-n.from),this.scaler=this.heightMap.height<=7e6?Gp:new DS(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Ms(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ro).filter(f=>typeof f!="function");let n=e.changedRanges,s=dr.extendWithRanges(n,AS(i,this.stateDeco,e?e.changes:Bt.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=!e.changes.empty||e.flags&2||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?_t.RTL:_t.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=o||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight;this.contentDOMHeight=t.clientHeight,this.mustMeasureContent=!1;let l=0,f=0,c=parseInt(i.paddingTop)||0,h=parseInt(i.paddingBottom)||0;(this.paddingTop!=c||this.paddingBottom!=h)&&(this.paddingTop=c,this.paddingBottom=h,l|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(n.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,l|=8);let d=(this.printing?ES:$S)(t,this.paddingTop),g=d.top-this.pixelViewport.top,_=d.bottom-this.pixelViewport.bottom;this.pixelViewport=d;let D=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(D!=this.inView&&(this.inView=D,D&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let E=t.clientWidth;if((this.contentDOMWidth!=E||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=E,this.editorHeight=e.scrollDOM.clientHeight,l|=8),a){let Qe=e.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(Qe)&&(o=!0),o||n.lineWrapping&&Math.abs(E-this.contentDOMWidth)>n.charWidth){let{lineHeight:pe,charWidth:Te}=e.docView.measureTextSize();o=n.refresh(s,pe,Te,E/Te,Qe),o&&(e.docView.minWidth=0,l|=8)}g>0&&_>0?f=Math.max(g,_):g<0&&_<0&&(f=Math.min(g,_)),n.heightChanged=!1;for(let pe of this.viewports){let Te=pe.from==this.viewport.from?Qe:e.docView.measureVisibleLineHeights(pe);this.heightMap=this.heightMap.updateHeight(n,0,o,new TS(pe.from,Te))}n.heightChanged&&(l|=2)}let U=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return U&&(this.viewport=this.getViewport(f,this.scrollTarget)),this.updateForViewport(),(l&2||U)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,s=this.state.doc,{visibleTop:o,visibleBottom:a}=this,l=new sa(n.lineAt(o-i*1e3,Ot.ByHeight,s,0,0).from,n.lineAt(a+(1-i)*1e3,Ot.ByHeight,s,0,0).to);if(t){let{head:f}=t.range;if(f<l.from||f>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=n.lineAt(f,Ot.ByPos,s,0,0),d;t.y=="center"?d=(h.top+h.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&f<l.from?d=h.top:d=h.bottom-c,l=new sa(n.lineAt(d-1e3/2,Ot.ByHeight,s,0,0).from,n.lineAt(d+c+1e3/2,Ot.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new sa(this.heightMap.lineAt(i,Ot.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,Ot.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(e,Ot.ByPos,this.state.doc,0,0),{bottom:s}=this.heightMap.lineAt(t,Ot.ByPos,this.state.doc,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||n<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&n>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let n of e)t.touchesRange(n.from,n.to)||i.push(new Lf(t.mapPos(n.from),t.mapPos(n.to),n.size));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=_t.LTR&&!i)return[];let a=[],l=(f,c,h,d)=>{if(c-f<s)return;let g=this.state.selection.main,_=[g.from];g.empty||_.push(g.to);for(let E of _)if(E>f&&E<c){l(f,E-10,h,d),l(E+10,c,h,d);return}let D=LS(e,E=>E.from>=h.from&&E.to<=h.to&&Math.abs(E.from-f)<s&&Math.abs(E.to-c)<s&&!_.some(U=>E.from<U&&E.to>U));if(!D){if(c<h.to&&t&&i&&t.visibleRanges.some(E=>E.from<=c&&E.to>=c)){let E=t.moveToLineBoundary(se.cursor(c),!1,!0).head;E>f&&(c=E)}D=new Lf(f,c,this.gapSize(h,f,c,d))}a.push(D)};for(let f of this.viewportLines){if(f.length<o)continue;let c=PS(f.from,f.to,this.stateDeco);if(c.total<o)continue;let h=this.scrollTarget?this.scrollTarget.range.head:null,d,g;if(i){let _=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,D,E;h!=null?(D=Math.max(f.from,h-n),E=Math.min(f.to,h+n)):(D=(this.visibleTop-f.top-_)/f.height,E=(this.visibleBottom-f.top+_)/f.height),d=oa(c,D),g=oa(c,E)}else{let _,D;if(h!=null)_=Math.max(f.from,h-o),D=Math.min(f.to,h+o);else{let E=c.total*this.heightOracle.charWidth,U=n*this.heightOracle.charWidth;_=(this.pixelViewport.left-U)/E,D=(this.pixelViewport.right+U)/E}d=oa(c,_),g=oa(c,D)}d>f.from&&l(f.from,d,f,c),g<f.to&&l(g,f.to,f,c)}return a}gapSize(e,t,i,n){let s=Bp(n,i)-Bp(n,t);return this.heightOracle.lineWrapping?e.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(e){Lf.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Xe.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];at.spans(e,this.viewport.from,this.viewport.to,{span(n,s){t.push({from:n,to:s})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((n,s)=>n.from!=t[s].from||n.to!=t[s].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Ms(this.heightMap.lineAt(e,Ot.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return Ms(this.heightMap.lineAt(this.scaler.fromDOM(e),Ot.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return Ms(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class sa{constructor(e,t){this.from=e,this.to=t}}function PS(r,e,t){let i=[],n=r,s=0;return at.spans(t,r,e,{span(){},point(o,a){o>n&&(i.push({from:n,to:o}),s+=o-n),n=a}},20),n<e&&(i.push({from:n,to:e}),s+=e-n),{total:s,ranges:i}}function oa({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(r*t);for(let n=0;;n++){let{from:s,to:o}=e[n],a=o-s;if(i<=a)return s+i;i-=a}}function Bp(r,e){let t=0;for(let{from:i,to:n}of r.ranges){if(e<=n){t+=e-i;break}t+=n-i}return t/r.total}function LS(r,e){for(let t of r)if(e(t))return t}const Gp={toDOM(r){return r},fromDOM(r){return r},scale:1};class DS{constructor(e,t,i){let n=0,s=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let f=t.lineAt(a,Ot.ByPos,e,0,0).top,c=t.lineAt(l,Ot.ByPos,e,0,0).bottom;return n+=c-f,{from:a,to:l,top:f,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(t.height-n);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return n+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,n=s.domBottom}}fromDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-n)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,n=s.domBottom}}}function Ms(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),i=e.toDOM(r.bottom);return new Er(r.from,r.length,t,i-t,Array.isArray(r.type)?r.type.map(n=>Ms(n,e)):r.type)}const aa=Be.define({combine:r=>r.join(" ")}),Lc=Be.define({combine:r=>r.indexOf(!0)>-1}),Dc=Mr.newName(),ug=Mr.newName(),dg=Mr.newName(),pg={"&light":"."+ug,"&dark":"."+dg};function Mc(r,e,t){return new Mr(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return r;if(!t||!t[n])throw new RangeError(`Unsupported selector: ${n}`);return t[n]}):r+" "+i}})}const MS=Mc("."+Dc,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},pg),IS={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Df=Me.ie&&Me.ie_version<=11;class BS{constructor(e,t,i){this.view=e,this.onChange=t,this.onScrollChanged=i,this.active=!1,this.selectionRange=new Mx,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let s of n)this.queue.push(s);(Me.ie&&Me.ie_version<=11||Me.ios&&e.composing)&&n.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),Df&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resize=new ResizeObserver(()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()}),this.resize.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Ol)?i.root.activeElement!=this.dom:!Sa(i.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Me.ie&&Me.ie_version<=11||Me.android&&Me.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Ia(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Me.safari&&e.root.nodeType==11&&Px(this.dom.ownerDocument)==this.dom&&GS(this.view)||Ma(e.root);if(!t||this.selectionRange.eq(t))return!1;let i=Sa(this.dom,t);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Bx(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,IS),Df&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),Df&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;this.delayedAndroidKey||this.view.win.requestAnimationFrame(()=>{let n=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,!this.flush()&&n.force&&js(this.dom,n.key,n.keyCode)}),(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}processRecords(){let e=this.queue;for(let s of this.observer.takeRecords())e.push(s);e.length&&(this.queue=[]);let t=-1,i=-1,n=!1;for(let s of e){let o=this.readMutation(s);!o||(o.typeOver&&(n=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:n}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let{from:t,to:i,typeOver:n}=this.processRecords(),s=this.selectionChanged&&Sa(this.dom,this.selectionRange);if(t<0&&!s)return!1;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=this.view.state,a=this.onChange(t,i,n);return this.view.state==o&&this.view.update([]),a}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let i=Np(t,e.previousSibling||e.target.previousSibling,-1),n=Np(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resize)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function Np(r,e,t){for(;e;){let i=gt.get(e);if(i&&i.parent==r)return i;let n=e.parentNode;e=n!=r.dom?n:t>0?e.nextSibling:e.previousSibling}return null}function GS(r){let e=null;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}if(r.contentDOM.addEventListener("beforeinput",t,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,a=r.docView.domAtPos(r.state.selection.main.anchor);return Ia(a.node,a.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}function NS(r,e,t,i){let n,s,o=r.state.selection.main;if(e>-1){let a=r.docView.domBoundsAround(e,t,0);if(!a||r.state.readOnly)return!1;let{from:l,to:f}=a,c=r.docView.impreciseHead||r.docView.impreciseAnchor?[]:FS(r),h=new eg(c,r.state);h.readRange(a.startDOM,a.endDOM);let d=o.from,g=null;(r.inputState.lastKeyCode===8&&r.inputState.lastKeyTime>Date.now()-100||Me.android&&h.text.length<f-l)&&(d=o.to,g="end");let _=WS(r.state.doc.sliceString(l,f,$r),h.text,d-l,g);_&&(Me.chrome&&r.inputState.lastKeyCode==13&&_.toB==_.from+2&&h.text.slice(_.from,_.toB)==$r+$r&&_.toB--,n={from:l+_.from,to:l+_.toA,insert:st.of(h.text.slice(_.from,_.toB).split($r))}),s=XS(c,l)}else if(r.hasFocus||!r.state.facet(Ol)){let a=r.observer.selectionRange,{impreciseHead:l,impreciseAnchor:f}=r.docView,c=l&&l.node==a.focusNode&&l.offset==a.focusOffset||!Yn(r.contentDOM,a.focusNode)?r.state.selection.main.head:r.docView.posFromDOM(a.focusNode,a.focusOffset),h=f&&f.node==a.anchorNode&&f.offset==a.anchorOffset||!Yn(r.contentDOM,a.anchorNode)?r.state.selection.main.anchor:r.docView.posFromDOM(a.anchorNode,a.anchorOffset);(c!=o.head||h!=o.anchor)&&(s=se.single(h,c))}if(!n&&!s)return!1;if(!n&&i&&!o.empty&&s&&s.main.empty?n={from:o.from,to:o.to,insert:r.state.doc.slice(o.from,o.to)}:n&&n.from>=o.from&&n.to<=o.to&&(n.from!=o.from||n.to!=o.to)&&o.to-o.from-(n.to-n.from)<=4?n={from:o.from,to:o.to,insert:r.state.doc.slice(o.from,n.from).append(n.insert).append(r.state.doc.slice(n.to,o.to))}:(Me.mac||Me.android)&&n&&n.from==n.to&&n.from==o.head-1&&/^\. ?$/.test(n.insert.toString())&&(s&&n.insert.length==2&&(s=se.single(s.main.anchor-1,s.main.head-1)),n={from:o.from,to:o.to,insert:st.of([" "])}),n){let a=r.state;if(Me.ios&&r.inputState.flushIOSKey(r)||Me.android&&(n.from==o.from&&n.to==o.to&&n.insert.length==1&&n.insert.lines==2&&js(r.contentDOM,"Enter",13)||n.from==o.from-1&&n.to==o.to&&n.insert.length==0&&js(r.contentDOM,"Backspace",8)||n.from==o.from&&n.to==o.to+1&&n.insert.length==0&&js(r.contentDOM,"Delete",46)))return!0;let l=n.insert.toString();if(r.state.facet(VO).some(h=>h(r,n.from,n.to,l)))return!0;r.inputState.composing>=0&&r.inputState.composing++;let f;if(n.from>=o.from&&n.to<=o.to&&n.to-n.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==n.from+n.insert.length)&&r.inputState.composing<0){let h=o.from<n.from?a.sliceDoc(o.from,n.from):"",d=o.to>n.to?a.sliceDoc(n.to,o.to):"";f=a.replaceSelection(r.state.toText(h+n.insert.sliceString(0,void 0,r.state.lineBreak)+d))}else{let h=a.changes(n),d=s&&!a.selection.main.eq(s.main)&&s.main.to<=h.newLength?s.main:void 0;if(a.selection.ranges.length>1&&r.inputState.composing>=0&&n.to<=o.to&&n.to>=o.to-10){let g=r.state.sliceDoc(n.from,n.to),_=tg(r)||r.state.doc.lineAt(o.head),D=o.to-n.to,E=o.to-o.from;f=a.changeByRange(U=>{if(U.from==o.from&&U.to==o.to)return{changes:h,range:d||U.map(h)};let Qe=U.to-D,pe=Qe-g.length;if(U.to-U.from!=E||r.state.sliceDoc(pe,Qe)!=g||_&&U.to>=_.from&&U.from<=_.to)return{range:U};let Te=a.changes({from:pe,to:Qe,insert:n.insert}),we=U.to-o.to;return{changes:Te,range:d?se.range(Math.max(0,d.anchor+we),Math.max(0,d.head+we)):U.map(Te)}})}else f={changes:h,selection:d&&a.selection.replaceRange(d)}}let c="input.type";return r.composing&&(c+=".compose",r.inputState.compositionFirstChange&&(c+=".start",r.inputState.compositionFirstChange=!1)),r.dispatch(f,{scrollIntoView:!0,userEvent:c}),!0}else if(s&&!s.main.eq(o)){let a=!1,l="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(a=!0),l=r.inputState.lastSelectionOrigin),r.dispatch({selection:s,scrollIntoView:a,userEvent:l}),!0}else return!1}function WS(r,e,t,i){let n=Math.min(r.length,e.length),s=0;for(;s<n&&r.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==n&&r.length==e.length)return null;let o=r.length,a=e.length;for(;o>0&&a>0&&r.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,s-Math.min(o,a));t-=o+l-s}return o<s&&r.length<e.length?(s-=t<=s&&t>=o?s-t:0,a=s+(a-o),o=s):a<s&&(s-=t<=s&&t>=a?s-t:0,o=s+(o-a),a=s),{from:s,toA:o,toB:a}}function FS(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:n,focusOffset:s}=r.observer.selectionRange;return t&&(e.push(new bp(t,i)),(n!=t||s!=i)&&e.push(new bp(n,s))),e}function XS(r,e){if(r.length==0)return null;let t=r[0].pos,i=r.length==2?r[1].pos:t;return t>-1&&i>-1?se.single(t+e,i+e):null}class Ie{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=e.root||Ix(e.parent)||document,this.viewState=new Ip(e.state||rt.create(e)),this.plugins=this.state.facet(Ls).map(t=>new Ef(t));for(let t of this.plugins)t.update(this);this.observer=new BS(this,(t,i,n)=>NS(this,t,i,n),t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()}),this.inputState=new hS(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new yp(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Gt?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,n,s=this.state;for(let a of e){if(a.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=a.state}if(this.destroyed){this.viewState.state=s;return}if(this.observer.clear(),s.facet(rt.phrases)!=this.state.facet(rt.phrases))return this.setState(s);n=Na.create(this,s,e);let o=this.viewState.scrollTarget;try{this.updateState=2;for(let a of e){if(o&&(o=o.map(a.changes)),a.scrollIntoView){let{main:l}=a.state.selection;o=new Ga(l.empty?l:se.cursor(l.head,l.head>l.anchor?-1:1))}for(let l of a.effects)l.is(gp)&&(o=l.value)}this.viewState.update(n,o),this.bidiCache=Wa.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),t=this.docView.update(n),this.state.facet(Ds)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(a=>a.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(aa)!=n.state.facet(aa)&&(this.viewState.mustMeasureContent=!0),(t||i||o||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!n.empty)for(let a of this.state.facet(Ac))a(n)}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Ip(e),this.plugins=e.facet(Ls).map(i=>new Ef(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new yp(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Ls),i=e.state.facet(Ls);if(t!=i){let n=[];for(let s of i){let o=t.indexOf(s);if(o<0)n.push(new Ef(s));else{let a=this.plugins[o];a.mustUpdate=e,n.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let n of this.plugins)n.mustUpdate=e;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,{scrollHeight:i,scrollTop:n,clientHeight:s}=this.scrollDOM,o=n>i-s-4?i:n;try{for(let a=0;;a++){this.updateState=1;let l=this.viewport,f=this.viewState.lineBlockAtHeight(o),c=this.viewState.measure(this);if(!c&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let h=[];c&4||([this.measureRequests,h]=[h,this.measureRequests]);let d=h.map(E=>{try{return E.read(this)}catch(U){return Ai(this.state,U),Wp}}),g=Na.create(this,this.state,[]),_=!1,D=!1;g.flags|=c,t?t.flags|=c:t=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),_=this.docView.update(g));for(let E=0;E<h.length;E++)if(d[E]!=Wp)try{let U=h[E];U.write&&U.write(d[E],this)}catch(U){Ai(this.state,U)}if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,D=!0;else{let E=this.viewState.lineBlockAt(f.from).top-f.top;(E>1||E<-1)&&(this.scrollDOM.scrollTop+=E,D=!0)}if(_&&this.docView.updateSelection(!0),this.viewport.from==l.from&&this.viewport.to==l.to&&!D&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let a of this.state.facet(Ac))a(t)}get themeClasses(){return Dc+" "+(this.state.facet(Lc)?dg:ug)+" "+this.state.facet(aa)}updateAttrs(){let e=Fp(this,zO,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Ol)?"true":"false",class:"cm-content",style:`${Me.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Fp(this,UO,t);let i=this.observer.ignore(()=>{let n=kc(this.contentDOM,this.contentAttrs,t),s=kc(this.dom,this.editorAttrs,e);return n||s});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let n of i.effects)if(n.is(Ie.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(Ds),Mr.mount(this.root,this.styleModules.concat(MS).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Pf(this,e,kp(this,e,t,i))}moveByGroup(e,t){return Pf(this,e,kp(this,e,t,i=>fS(this,e.head,i)))}moveToLineBoundary(e,t,i=!0){return lS(this,e,t,i)}moveVertically(e,t,i){return Pf(this,e,cS(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),rg(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(e),s=this.bidiSpans(n),o=s[qn.find(s,e-n.from,-1,t)];return dl(i,o.dir==_t.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ZO)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>jS)return KO(e.length);let t=this.textDirectionAt(e.from);for(let n of this.bidiCache)if(n.from==e.from&&n.dir==t)return n.order;let i=Ux(e.text,t);return this.bidiCache.push(new Wa(e.from,e.to,t,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Me.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{AO(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return gp.of(new Ga(typeof e=="number"?se.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return Dt.define(()=>({}),{eventHandlers:e})}static theme(e,t){let i=Mr.newName(),n=[aa.of(i),Ds.of(Mc(`.${i}`,e))];return t&&t.dark&&n.push(Lc.of(!0)),n}static baseTheme(e){return vn.lowest(Ds.of(Mc("."+Dc,e,pg)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),n=i&&gt.get(i)||gt.get(e);return((t=n==null?void 0:n.rootView)===null||t===void 0?void 0:t.view)||null}}Ie.styleModule=Ds;Ie.inputHandler=VO;Ie.perLineTextDirection=ZO;Ie.exceptionSink=jO;Ie.updateListener=Ac;Ie.editable=Ol;Ie.mouseSelectionStyle=XO;Ie.dragMovesSelection=FO;Ie.clickAddsSelectionRange=WO;Ie.decorations=ro;Ie.atomicRanges=qO;Ie.scrollMargins=HO;Ie.darkTheme=Lc;Ie.contentAttributes=UO;Ie.editorAttributes=zO;Ie.lineWrapping=Ie.contentAttributes.of({class:"cm-lineWrapping"});Ie.announce=He.define();const jS=4096,Wp={};class Wa{constructor(e,t,i,n){this.from=e,this.to=t,this.dir=i,this.order=n}static update(e,t){if(t.empty)return e;let i=[],n=e.length?e[e.length-1].dir:_t.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==n&&!t.touchesRange(o.from,o.to)&&i.push(new Wa(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.order))}return i}}function Fp(r,e,t){for(let i=r.state.facet(e),n=i.length-1;n>=0;n--){let s=i[n],o=typeof s=="function"?s(r):s;o&&Tc(o,t)}return t}const VS=Me.mac?"mac":Me.windows?"win":Me.linux?"linux":"key";function ZS(r,e){const t=r.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let n,s,o,a;for(let l=0;l<t.length-1;++l){const f=t[l];if(/^(cmd|meta|m)$/i.test(f))a=!0;else if(/^a(lt)?$/i.test(f))n=!0;else if(/^(c|ctrl|control)$/i.test(f))s=!0;else if(/^s(hift)?$/i.test(f))o=!0;else if(/^mod$/i.test(f))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+f)}return n&&(i="Alt-"+i),s&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function la(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const zS=vn.default(Ie.domEventHandlers({keydown(r,e){return Og(mg(e.state),r,e,"editor")}})),gl=Be.define({enables:zS}),Xp=new WeakMap;function mg(r){let e=r.facet(gl),t=Xp.get(e);return t||Xp.set(e,t=HS(e.reduce((i,n)=>i.concat(n),[]))),t}function US(r,e,t){return Og(mg(r.state),e,r,t)}let Qr=null;const qS=4e3;function HS(r,e=VS){let t=Object.create(null),i=Object.create(null),n=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,f)=>{var c,h;let d=t[o]||(t[o]=Object.create(null)),g=a.split(/ (?!$)/).map(E=>ZS(E,e));for(let E=1;E<g.length;E++){let U=g.slice(0,E).join(" ");n(U,!0),d[U]||(d[U]={preventDefault:!0,run:[Qe=>{let pe=Qr={view:Qe,prefix:U,scope:o};return setTimeout(()=>{Qr==pe&&(Qr=null)},qS),!0}]})}let _=g.join(" ");n(_,!1);let D=d[_]||(d[_]={preventDefault:!1,run:((h=(c=d._any)===null||c===void 0?void 0:c.run)===null||h===void 0?void 0:h.slice())||[]});l&&D.run.push(l),f&&(D.preventDefault=!0)};for(let o of r){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let f of a){let c=t[f]||(t[f]=Object.create(null));c._any||(c._any={preventDefault:!1,run:[]});for(let h in c)c[h].run.push(o.any)}let l=o[e]||o.key;if(!!l)for(let f of a)s(f,l,o.run,o.preventDefault),o.shift&&s(f,"Shift-"+l,o.shift,o.preventDefault)}return t}function Og(r,e,t,i){let n=Rx(e),s=ei(n,0),o=Ti(s)==n.length&&n!=" ",a="",l=!1;Qr&&Qr.view==t&&Qr.scope==i&&(a=Qr.prefix+" ",(l=sg.indexOf(e.keyCode)<0)&&(Qr=null));let f=new Set,c=_=>{if(_){for(let D of _.run)if(!f.has(D)&&(f.add(D),D(t,e)))return!0;_.preventDefault&&(l=!0)}return!1},h=r[i],d,g;if(h){if(c(h[a+la(n,e,!o)]))return!0;if(o&&(e.shiftKey||e.altKey||e.metaKey||s>127)&&(d=Ir[e.keyCode])&&d!=n){if(c(h[a+la(d,e,!0)]))return!0;if(e.shiftKey&&(g=eo[e.keyCode])!=n&&g!=d&&c(h[a+la(g,e,!1)]))return!0}else if(o&&e.shiftKey&&c(h[a+la(n,e,!0)]))return!0;if(c(h._any))return!0}return l}const gg=!Me.ios,Is=Be.define({combine(r){return ar(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function YS(r={}){return[Is.of(r),KS,JS]}class vg{constructor(e,t,i,n,s){this.left=e,this.top=t,this.width=i,this.height=n,this.className=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const KS=Dt.fromClass(class{constructor(r){this.view=r,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=r.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=r.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),r.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(Is).cursorBlinkRate+"ms"}update(r){let e=r.startState.facet(Is)!=r.state.facet(Is);(e||r.selectionSet||r.geometryChanged||r.viewportChanged)&&this.view.requestMeasure(this.measureReq),r.transactions.some(t=>t.scrollIntoView)&&(this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),e&&this.setBlinkRate()}readPos(){let{state:r}=this.view,e=r.facet(Is),t=r.selection.ranges.map(n=>n.empty?[]:e_(this.view,n)).reduce((n,s)=>n.concat(s)),i=[];for(let n of r.selection.ranges){let s=n==r.selection.main;if(n.empty?!s||gg:e.drawRangeCursor){let o=t_(this.view,n,s);o&&i.push(o)}}return{rangePieces:t,cursors:i}}drawSel({rangePieces:r,cursors:e}){if(r.length!=this.rangePieces.length||r.some((t,i)=>!t.eq(this.rangePieces[i]))){this.selectionLayer.textContent="";for(let t of r)this.selectionLayer.appendChild(t.draw());this.rangePieces=r}if(e.length!=this.cursors.length||e.some((t,i)=>!t.eq(this.cursors[i]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const i of e)this.cursorLayer.appendChild(i.draw())}else e.forEach((i,n)=>i.adjust(t[n]));this.cursors=e}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),bg={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};gg&&(bg[".cm-line"].caretColor="transparent !important");const JS=vn.highest(Ie.theme(bg));function yg(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==_t.LTR?e.left:e.right-r.scrollDOM.clientWidth)-r.scrollDOM.scrollLeft,top:e.top-r.scrollDOM.scrollTop}}function jp(r,e,t){let i=se.cursor(e);return{from:Math.max(t.from,r.moveToLineBoundary(i,!1,!0).from),to:Math.min(t.to,r.moveToLineBoundary(i,!0,!0).from),type:dt.Text}}function Vp(r,e){let t=r.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==dt.Text))return i}return t}function e_(r,e){if(e.to<=r.viewport.from||e.from>=r.viewport.to)return[];let t=Math.max(e.from,r.viewport.from),i=Math.min(e.to,r.viewport.to),n=r.textDirection==_t.LTR,s=r.contentDOM,o=s.getBoundingClientRect(),a=yg(r),l=window.getComputedStyle(s.firstChild),f=o.left+parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)),c=o.right-parseInt(l.paddingRight),h=Vp(r,t),d=Vp(r,i),g=h.type==dt.Text?h:null,_=d.type==dt.Text?d:null;if(r.lineWrapping&&(g&&(g=jp(r,t,g)),_&&(_=jp(r,i,_))),g&&_&&g.from==_.from)return E(U(e.from,e.to,g));{let pe=g?U(e.from,null,g):Qe(h,!1),Te=_?U(null,e.to,_):Qe(d,!0),we=[];return(g||h).to<(_||d).from-1?we.push(D(f,pe.bottom,c,Te.top)):pe.bottom<Te.top&&r.elementAtHeight((pe.bottom+Te.top)/2).type==dt.Text&&(pe.bottom=Te.top=(pe.bottom+Te.top)/2),E(pe).concat(we).concat(E(Te))}function D(pe,Te,we,Ne){return new vg(pe-a.left,Te-a.top-.01,we-pe,Ne-Te+.01,"cm-selectionBackground")}function E({top:pe,bottom:Te,horizontal:we}){let Ne=[];for(let Ve=0;Ve<we.length;Ve+=2)Ne.push(D(we[Ve],pe,we[Ve+1],Te));return Ne}function U(pe,Te,we){let Ne=1e9,Ve=-1e9,vt=[];function it(pt,wt,Ft,Xt,Kt){let fi=r.coordsAtPos(pt,pt==we.to?-2:2),Mt=r.coordsAtPos(Ft,Ft==we.from?2:-2);Ne=Math.min(fi.top,Mt.top,Ne),Ve=Math.max(fi.bottom,Mt.bottom,Ve),Kt==_t.LTR?vt.push(n&&wt?f:fi.left,n&&Xt?c:Mt.right):vt.push(!n&&Xt?f:Mt.left,!n&&wt?c:fi.right)}let Ke=pe!=null?pe:we.from,ot=Te!=null?Te:we.to;for(let pt of r.visibleRanges)if(pt.to>Ke&&pt.from<ot)for(let wt=Math.max(pt.from,Ke),Ft=Math.min(pt.to,ot);;){let Xt=r.state.doc.lineAt(wt);for(let Kt of r.bidiSpans(Xt)){let fi=Kt.from+Xt.from,Mt=Kt.to+Xt.from;if(fi>=Ft)break;Mt>wt&&it(Math.max(fi,wt),pe==null&&fi<=Ke,Math.min(Mt,Ft),Te==null&&Mt>=ot,Kt.dir)}if(wt=Xt.to+1,wt>=Ft)break}return vt.length==0&&it(Ke,pe==null,ot,Te==null,r.textDirection),{top:Ne,bottom:Ve,horizontal:vt}}function Qe(pe,Te){let we=o.top+(Te?pe.top:pe.bottom);return{top:we,bottom:we,horizontal:[]}}}function t_(r,e,t){let i=r.coordsAtPos(e.head,e.assoc||1);if(!i)return null;let n=yg(r);return new vg(i.left-n.left,i.top-n.top,-1,i.bottom-i.top,t?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const xg=He.define({map(r,e){return r==null?null:e.mapPos(r)}}),Bs=Yt.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,i)=>i.is(xg)?i.value:t,r)}}),i_=Dt.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(Bs);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Bs)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let r=this.view.state.field(Bs),e=r!=null&&this.view.coordsAtPos(r);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(r){this.cursor&&(r?(this.cursor.style.left=r.left+"px",this.cursor.style.top=r.top+"px",this.cursor.style.height=r.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Bs)!=r&&this.view.dispatch({effects:xg.of(r)})}},{eventHandlers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function r_(){return[Bs,i_]}function Zp(r,e,t,i,n){e.lastIndex=0;for(let s=r.iterRange(t,i),o=t,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)n(o+a.index,a)}function n_(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let i=[];for(let{from:n,to:s}of t)n=Math.max(r.state.doc.lineAt(n).from,n-e),s=Math.min(r.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=n?i[i.length-1].to=s:i.push({from:n,to:s});return i}class s_{constructor(e){const{regexp:t,decoration:i,decorate:n,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,n)this.addMatch=(a,l,f,c)=>n(c,f,f+a[0].length,a,l);else if(typeof i=="function")this.addMatch=(a,l,f,c)=>{let h=i(a,l,f);h&&c(f,f+a[0].length,h)};else if(i)this.addMatch=(a,l,f,c)=>c(f,f+a[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new Dr,i=t.add.bind(t);for(let{from:n,to:s}of n_(e,this.maxLength))Zp(e.state.doc,this.regexp,n,s,(o,a)=>this.addMatch(a,e,o,i));return t.finish()}updateDeco(e,t){let i=1e9,n=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(i=Math.min(a,i),n=Math.max(l,n))}),e.viewportChanged||n-i>1e3?this.createDeco(e.view):n>-1?this.updateRange(e.view,t.map(e.changes),i,n):t}updateRange(e,t,i,n){for(let s of e.visibleRanges){let o=Math.max(s.from,i),a=Math.min(s.to,n);if(a>o){let l=e.state.doc.lineAt(o),f=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),h=Math.min(s.to,f.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<f.to;a++)if(this.boundary.test(f.text[a-f.from])){h=a;break}}let d=[],g,_=(D,E,U)=>d.push(U.range(D,E));if(l==f)for(this.regexp.lastIndex=c-l.from;(g=this.regexp.exec(l.text))&&g.index<h-l.from;)this.addMatch(g,e,g.index+l.from,_);else Zp(e.state.doc,this.regexp,c,h,(D,E)=>this.addMatch(E,e,D,_));t=t.update({filterFrom:c,filterTo:h,filter:(D,E)=>D<c||E>h,add:d})}}return t}}const Ic=/x/.unicode!=null?"gu":"g",o_=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,Ic),a_={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Mf=null;function l_(){var r;if(Mf==null&&typeof document<"u"&&document.body){let e=document.body.style;Mf=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return Mf||!1}const wa=Be.define({combine(r){let e=ar(r,{render:null,specialChars:o_,addSpecialChars:null});return(e.replaceTabs=!l_())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Ic)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Ic)),e}});function f_(r={}){return[wa.of(r),c_()]}let zp=null;function c_(){return zp||(zp=Dt.fromClass(class{constructor(r){this.view=r,this.decorations=Xe.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(wa)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new s_({regexp:r.specialChars,decoration:(e,t,i)=>{let{doc:n}=t.state,s=ei(e[0],0);if(s==9){let o=n.lineAt(i),a=t.state.tabSize,l=ho(o.text,a,i-o.from);return Xe.replace({widget:new p_((a-l%a)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=Xe.replace({widget:new d_(r,s)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(wa);r.startState.facet(wa)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const h_="\u2022";function u_(r){return r>=32?h_:r==10?"\u2424":String.fromCharCode(9216+r)}class d_ extends mr{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=u_(this.code),i=e.state.phrase("Control character")+" "+(a_[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,t);if(n)return n;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class p_ extends mr{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function m_(){return g_}const O_=Xe.line({class:"cm-activeLine"}),g_=Dt.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let i of r.state.selection.ranges){let n=r.lineBlockAt(i.head);n.from>e&&(t.push(O_.range(n.from)),e=n.from)}return Xe.set(t)}},{decorations:r=>r.decorations}),Bc=2e3;function v_(r,e,t){let i=Math.min(e.line,t.line),n=Math.max(e.line,t.line),s=[];if(e.off>Bc||t.off>Bc||e.col<0||t.col<0){let o=Math.min(e.off,t.off),a=Math.max(e.off,t.off);for(let l=i;l<=n;l++){let f=r.doc.line(l);f.length<=a&&s.push(se.range(f.from+o,f.to+a))}}else{let o=Math.min(e.col,t.col),a=Math.max(e.col,t.col);for(let l=i;l<=n;l++){let f=r.doc.line(l),c=gc(f.text,o,r.tabSize,!0);if(c>-1){let h=gc(f.text,a,r.tabSize);s.push(se.range(f.from+c,f.from+h))}}}return s}function b_(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function Up(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),i=r.state.doc.lineAt(t),n=t-i.from,s=n>Bc?-1:n==i.length?b_(r,e.clientX):ho(i.text,r.state.tabSize,t-i.from);return{line:i.number,col:s,off:n}}function y_(r,e){let t=Up(r,e),i=r.state.selection;return t?{update(n){if(n.docChanged){let s=n.changes.mapPos(n.startState.doc.line(t.line).from),o=n.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(n.changes)}},get(n,s,o){let a=Up(r,n);if(!a)return i;let l=v_(r.state,t,a);return l.length?o?se.create(l.concat(i.ranges)):se.create(l):i}}:null}function x_(r){let e=(r==null?void 0:r.eventFilter)||(t=>t.altKey&&t.button==0);return Ie.mouseSelectionStyle.of((t,i)=>e(i)?y_(t,i):null)}const S_={Alt:[18,r=>r.altKey],Control:[17,r=>r.ctrlKey],Shift:[16,r=>r.shiftKey],Meta:[91,r=>r.metaKey]},__={style:"cursor: crosshair"};function w_(r={}){let[e,t]=S_[r.key||"Alt"],i=Dt.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventHandlers:{keydown(n){this.set(n.keyCode==e||t(n))},keyup(n){(n.keyCode==e||!t(n))&&this.set(!1)}}});return[i,Ie.contentAttributes.of(n=>{var s;return!((s=n.plugin(i))===null||s===void 0)&&s.isDown?__:null})]}const If="-10000px";class Sg{constructor(e,t,i){this.facet=t,this.createTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(n=>n),this.tooltipViews=this.tooltips.map(i)}update(e){let t=e.state.facet(this.facet),i=t.filter(s=>s);if(t===this.input){for(let s of this.tooltipViews)s.update&&s.update(e);return!1}let n=[];for(let s=0;s<i.length;s++){let o=i[s],a=-1;if(!!o){for(let l=0;l<this.tooltips.length;l++){let f=this.tooltips[l];f&&f.create==o.create&&(a=l)}if(a<0)n[s]=this.createTooltipView(o);else{let l=n[s]=this.tooltipViews[a];l.update&&l.update(e)}}}for(let s of this.tooltipViews)n.indexOf(s)<0&&s.dom.remove();return this.input=t,this.tooltips=i,this.tooltipViews=n,!0}}function T_(r){let{win:e}=r;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Bf=Be.define({combine:r=>{var e,t,i;return{position:Me.ios?"absolute":((e=r.find(n=>n.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(n=>n.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=r.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||T_}}}),_g=Dt.fromClass(class{constructor(r){this.view=r,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(Bf);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Sg(r,hh,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r);e&&this.observeIntersection();let t=e||r.geometryChanged,i=r.state.facet(Bf);if(i.position!=this.position){this.position=i.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r){let e=r.create(this.view);if(e.dom.classList.add("cm-tooltip"),r.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=If,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var r;this.view.win.removeEventListener("resize",this.measureSoon);for(let{dom:e}of this.manager.tooltipViews)e.remove();(r=this.intersectionObserver)===null||r===void 0||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=this.view.dom.getBoundingClientRect();return{editor:r,parent:this.parent?this.container.getBoundingClientRect():r,pos:this.manager.tooltips.map((e,t)=>{let i=this.manager.tooltipViews[t];return i.getCoords?i.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(Bf).tooltipSpace(this.view)}}writeMeasure(r){let{editor:e,space:t}=r,i=[];for(let n=0;n<this.manager.tooltips.length;n++){let s=this.manager.tooltips[n],o=this.manager.tooltipViews[n],{dom:a}=o,l=r.pos[n],f=r.size[n];if(!l||l.bottom<=Math.max(e.top,t.top)||l.top>=Math.min(e.bottom,t.bottom)||l.right<Math.max(e.left,t.left)-.1||l.left>Math.min(e.right,t.right)+.1){a.style.top=If;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,h=c?7:0,d=f.right-f.left,g=f.bottom-f.top,_=o.offset||Q_,D=this.view.textDirection==_t.LTR,E=f.width>t.right-t.left?D?t.left:t.right-f.width:D?Math.min(l.left-(c?14:0)+_.x,t.right-d):Math.max(t.left,l.left-d+(c?14:0)-_.x),U=!!s.above;!s.strictSide&&(U?l.top-(f.bottom-f.top)-_.y<t.top:l.bottom+(f.bottom-f.top)+_.y>t.bottom)&&U==t.bottom-l.bottom>l.top-t.top&&(U=!U);let Qe=U?l.top-g-h-_.y:l.bottom+h+_.y,pe=E+d;if(o.overlap!==!0)for(let Te of i)Te.left<pe&&Te.right>E&&Te.top<Qe+g&&Te.bottom>Qe&&(Qe=U?Te.top-g-2-h:Te.bottom+h+2);this.position=="absolute"?(a.style.top=Qe-r.parent.top+"px",a.style.left=E-r.parent.left+"px"):(a.style.top=Qe+"px",a.style.left=E+"px"),c&&(c.style.left=`${l.left+(D?_.x:-_.x)-(E+14-7)}px`),o.overlap!==!0&&i.push({left:E,top:Qe,right:pe,bottom:Qe+g}),a.classList.toggle("cm-tooltip-above",U),a.classList.toggle("cm-tooltip-below",!U),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=If}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),k_=Ie.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Q_={x:0,y:0},hh=Be.define({enables:[_g,k_]}),Fa=Be.define();class uh{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Sg(e,Fa,t=>this.createHostedView(t))}static create(e){return new uh(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}}const A_=hh.compute([Fa],r=>{let e=r.facet(Fa).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:uh.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class C_{constructor(e,t,i,n,s){this.view=e,this.source=t,this.field=i,this.setHover=n,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let i=this.view.coordsAtPos(t);if(i==null||e.y<i.top||e.y>i.bottom||e.x<i.left-this.view.defaultCharacterWidth||e.x>i.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(a=>a.from<=t&&a.to>=t),s=n&&n.dir==_t.RTL?-1:1,o=this.source(this.view,t,e.x<i.left?-s:s);if(o!=null&&o.then){let a=this.pending={pos:t};o.then(l=>{this.pending==a&&(this.pending=null,l&&this.view.dispatch({effects:this.setHover.of(l)}))},l=>Ai(this.view.state,l,"hover tooltip"))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!$_(this.lastMove.target)||this.pending){let{pos:n}=i||this.pending,s=(t=i==null?void 0:i.end)!==null&&t!==void 0?t:n;(n==s?this.view.posAtCoords(this.lastMove)!=n:!E_(this.view,n,s,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function $_(r){for(let e=r;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function E_(r,e,t,i,n,s){let o=document.createRange(),a=r.domAtPos(e),l=r.domAtPos(t);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let f=o.getClientRects();o.detach();for(let c=0;c<f.length;c++){let h=f[c];if(Math.max(h.top-n,n-h.bottom,h.left-i,i-h.right)<=s)return!0}return!1}function R_(r,e={}){let t=He.define(),i=Yt.define({create(){return null},update(n,s){if(n&&(e.hideOnChange&&(s.docChanged||s.selection)||e.hideOn&&e.hideOn(s,n)))return null;if(n&&s.docChanged){let o=s.changes.mapPos(n.pos,-1,ii.TrackDel);if(o==null)return null;let a=Object.assign(Object.create(null),n);a.pos=o,n.end!=null&&(a.end=s.changes.mapPos(n.end)),n=a}for(let o of s.effects)o.is(t)&&(n=o.value),o.is(L_)&&(n=null);return n},provide:n=>Fa.from(n)});return[i,Dt.define(n=>new C_(n,r,i,t,e.hoverTime||300)),A_]}function P_(r,e){let t=r.plugin(_g);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const L_=He.define(),qp=Be.define({combine(r){let e,t;for(let i of r)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function no(r,e){let t=r.plugin(wg),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const wg=Dt.fromClass(class{constructor(r){this.input=r.state.facet(so),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(qp);this.top=new fa(r,!0,e.topContainer),this.bottom=new fa(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(qp);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new fa(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new fa(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(so);if(t!=this.input){let i=t.filter(l=>l),n=[],s=[],o=[],a=[];for(let l of i){let f=this.specs.indexOf(l),c;f<0?(c=l(r.view),a.push(c)):(c=this.panels[f],c.update&&c.update(r)),n.push(c),(c.top?s:o).push(c)}this.specs=i,this.panels=n,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Ie.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class fa{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Hp(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Hp(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Hp(r){let e=r.nextSibling;return r.remove(),e}const so=Be.define({enables:wg});class pr extends mn{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}pr.prototype.elementClass="";pr.prototype.toDOM=void 0;pr.prototype.mapMode=ii.TrackBefore;pr.prototype.startSide=pr.prototype.endSide=-1;pr.prototype.point=!0;const Ta=Be.define(),D_={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>at.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Vs=Be.define();function M_(r){return[Tg(),Vs.of(Object.assign(Object.assign({},D_),r))]}const Gc=Be.define({combine:r=>r.some(e=>e)});function Tg(r){let e=[I_];return r&&r.fixed===!1&&e.push(Gc.of(!0)),e}const I_=Dt.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=r.state.facet(Vs).map(e=>new Kp(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(Gc),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Gc)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let t=at.iter(this.view.state.facet(Ta),this.view.viewport.from),i=[],n=this.gutters.map(s=>new B_(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks){let o;if(Array.isArray(s.type)){for(let a of s.type)if(a.type==dt.Text){o=a;break}}else o=s.type==dt.Text?s:void 0;if(!!o){i.length&&(i=[]),kg(t,i,s.from);for(let a of n)a.line(this.view,o,i)}}for(let s of n)s.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(Vs),t=r.state.facet(Vs),i=r.docChanged||r.heightChanged||r.viewportChanged||!at.eq(r.startState.facet(Ta),r.state.facet(Ta),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let n of this.gutters)n.update(r)&&(i=!0);else{i=!0;let n=[];for(let s of t){let o=e.indexOf(s);o<0?n.push(new Kp(this.view,s)):(this.gutters[o].update(r),n.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),n.indexOf(s)<0&&s.destroy();for(let s of n)this.dom.appendChild(s.dom);this.gutters=n}return i}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>Ie.scrollMargins.of(e=>{let t=e.plugin(r);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==_t.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function Yp(r){return Array.isArray(r)?r:[r]}function kg(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class B_{constructor(e,t,i){this.gutter=e,this.height=i,this.localMarkers=[],this.i=0,this.cursor=at.iter(e.markers,t.from)}line(e,t,i){this.localMarkers.length&&(this.localMarkers=[]),kg(this.cursor,this.localMarkers,t.from);let n=i.length?this.localMarkers.concat(i):this.localMarkers,s=this.gutter.config.lineMarker(e,t,n);s&&n.unshift(s);let o=this.gutter;if(n.length==0&&!o.config.renderEmptyElements)return;let a=t.top-this.height;if(this.i==o.elements.length){let l=new Qg(e,t.height,a,n);o.elements.push(l),o.dom.appendChild(l.dom)}else o.elements[this.i].update(e,t.height,a,n);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Kp{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,n=>{let s=e.lineBlockAtHeight(n.clientY-e.documentTop);t.domEventHandlers[i](e,s,n)&&n.preventDefault()});this.markers=Yp(t.markers(e)),t.initialSpacer&&(this.spacer=new Qg(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Yp(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}let i=e.view.viewport;return!at.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Qg{constructor(e,t,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,n)}update(e,t,i,n){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),G_(this.markers,n)||this.setMarkers(e,n)}setMarkers(e,t){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<t.length?t[s++]:null,f=!1;if(l){let c=l.elementClass;c&&(i+=" "+c);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(l)){a=h,f=!0;break}}else a=this.markers.length;for(;o<a;){let c=this.markers[o++];if(c.toDOM){c.destroy(n);let h=n.nextSibling;n.remove(),n=h}}if(!l)break;l.toDOM&&(f?n=n.nextSibling:this.dom.insertBefore(l.toDOM(e),n)),f&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function G_(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const N_=Be.define(),Vn=Be.define({combine(r){return ar(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let n in t){let s=i[n],o=t[n];i[n]=s?(a,l,f)=>s(a,l,f)||o(a,l,f):o}return i}})}});class Gf extends pr{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Nf(r,e){return r.state.facet(Vn).formatNumber(e,r.state)}const W_=Vs.compute([Vn],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(N_)},lineMarker(e,t,i){return i.some(n=>n.toDOM)?null:new Gf(Nf(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(Vn)!=e.state.facet(Vn),initialSpacer(e){return new Gf(Nf(e,Jp(e.state.doc.lines)))},updateSpacer(e,t){let i=Nf(t.view,Jp(t.view.state.doc.lines));return i==e.number?e:new Gf(i)},domEventHandlers:r.facet(Vn).domEventHandlers}));function F_(r={}){return[Vn.of(r),Tg(),W_]}function Jp(r){let e=9;for(;e<r;)e=e*10+9;return e}const X_=new class extends pr{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},j_=Ta.compute(["selection"],r=>{let e=[],t=-1;for(let i of r.selection.ranges){let n=r.doc.lineAt(i.head).from;n>t&&(t=n,e.push(X_.range(n)))}return at.of(e)});function V_(){return j_}const Ag=1024;let Z_=0;class Wf{constructor(e,t){this.from=e,this.to=t}}class et{constructor(e={}){this.id=Z_++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Oi.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}et.closedBy=new et({deserialize:r=>r.split(" ")});et.openedBy=new et({deserialize:r=>r.split(" ")});et.group=new et({deserialize:r=>r.split(" ")});et.contextHash=new et({perNode:!0});et.lookAhead=new et({perNode:!0});et.mounted=new et({perNode:!0});const z_=Object.create(null);class Oi{constructor(e,t,i,n=0){this.name=e,this.props=t,this.id=i,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):z_,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),n=new Oi(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(n)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(et.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let n of i.split(" "))t[n]=e[i];return i=>{for(let n=i.prop(et.group),s=-1;s<(n?n.length:0);s++){let o=t[s<0?i.name:n[s]];if(o)return o}}}}Oi.none=new Oi("",Object.create(null),0,8);class dh{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let n=null;for(let s of e){let o=s(i);o&&(n||(n=Object.assign({},i.props)),n[o[0].id]=o[1])}t.push(n?new Oi(i.name,n,i.id,i.flags):i)}return new dh(t)}}const ca=new WeakMap,em=new WeakMap;var qt;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(qt||(qt={}));class Lt{constructor(e,t,i,n,s){if(this.type=e,this.children=t,this.positions=i,this.length=n,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=this.prop(et.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let n=i.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Va(this.topNode,e)}cursorAt(e,t=0,i=0){let n=ca.get(this)||this.topNode,s=new Va(n);return s.moveTo(e,t),ca.set(this,s._tree),s}get topNode(){return new Ni(this,0,0,null)}resolve(e,t=0){let i=es(ca.get(this)||this.topNode,e,t,!1);return ca.set(this,i),i}resolveInner(e,t=0){let i=es(em.get(this)||this.topNode,e,t,!0);return em.set(this,i),i}iterate(e){let{enter:t,leave:i,from:n=0,to:s=this.length}=e;for(let o=this.cursor((e.mode||0)|qt.IncludeAnonymous);;){let a=!1;if(o.from<=s&&o.to>=n&&(o.type.isAnonymous||t(o)!==!1)){if(o.firstChild())continue;a=!0}for(;a&&i&&!o.type.isAnonymous&&i(o),!o.nextSibling();){if(!o.parent())return;a=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Oh(Oi.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,n)=>new Lt(this.type,t,i,n,this.propValues),e.makeTree||((t,i,n)=>new Lt(Oi.none,t,i,n)))}static build(e){return q_(e)}}Lt.empty=new Lt(Oi.none,[],[],0);class ph{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new ph(this.buffer,this.index)}}class yn{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Oi.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],n=this.set.types[t],s=n.name;if(/\W/.test(s)&&!n.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,n,s){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(Cg(s,n,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,t,i,n){let s=this.buffer,o=new Uint16Array(t-e);for(let a=e,l=0;a<t;)o[l++]=s[a++],o[l++]=s[a++]-i,o[l++]=s[a++]-i,o[l++]=s[a++]-e;return new yn(o,n-i,this.set)}}function Cg(r,e,t,i){switch(r){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function $g(r,e){let t=r.childBefore(e);for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(r=t,t=i.prevSibling):t=i}return r}function es(r,e,t,i){for(var n;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let o=!i&&r instanceof Ni&&r.index<0?null:r.parent;if(!o)return r;r=o}let s=i?0:qt.IgnoreOverlays;if(i)for(let o=r,a=o.parent;a;o=a,a=o.parent)o instanceof Ni&&o.index<0&&((n=a.enter(e,t,s))===null||n===void 0?void 0:n.from)!=o.from&&(r=a);for(;;){let o=r.enter(e,t,s);if(!o)return r;r=o}}class Ni{constructor(e,t,i,n){this._tree=e,this.from=t,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,n,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,f=t>0?a.length:-1;e!=f;e+=t){let c=a[e],h=l[e]+o.from;if(!!Cg(n,i,h,h+c.length)){if(c instanceof yn){if(s&qt.ExcludeBuffers)continue;let d=c.findChild(0,c.buffer.length,t,i-h,n);if(d>-1)return new ir(new U_(o,c,e,h),null,d)}else if(s&qt.IncludeAnonymous||!c.type.isAnonymous||mh(c)){let d;if(!(s&qt.IgnoreMounts)&&c.props&&(d=c.prop(et.mounted))&&!d.overlay)return new Ni(d.tree,h,e,o);let g=new Ni(c,h,e,o);return s&qt.IncludeAnonymous||!g.type.isAnonymous?g:g.nextChild(t<0?c.children.length-1:0,t,i,n)}}}if(s&qt.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let n;if(!(i&qt.IgnoreOverlays)&&(n=this._tree.prop(et.mounted))&&n.overlay){let s=e-this.from;for(let{from:o,to:a}of n.overlay)if((t>0?o<=s:o<s)&&(t<0?a>=s:a>s))return new Ni(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new Va(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return es(this,e,t,!1)}resolveInner(e,t=0){return es(this,e,t,!0)}enterUnfinishedNodesBefore(e){return $g(this,e)}getChild(e,t=null,i=null){let n=Xa(this,e,t,i);return n.length?n[0]:null}getChildren(e,t=null,i=null){return Xa(this,e,t,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return ja(this,e)}}function Xa(r,e,t,i){let n=r.cursor(),s=[];if(!n.firstChild())return s;if(t!=null){for(;!n.type.is(t);)if(!n.nextSibling())return s}for(;;){if(i!=null&&n.type.is(i))return s;if(n.type.is(e)&&s.push(n.node),!n.nextSibling())return i==null?s:[]}}function ja(r,e,t=e.length-1){for(let i=r.parent;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class U_{constructor(e,t,i,n){this.parent=e,this.buffer=t,this.index=i,this.start=n}}class ir{constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new ir(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&qt.ExcludeBuffers)return null;let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new ir(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ir(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new ir(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new Va(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,n=this.index+4,s=i.buffer[this.index+3];if(s>n){let o=i.buffer[this.index+1],a=i.buffer[this.index+2];e.push(i.slice(n,s,o,a)),t.push(0)}return new Lt(this.type,e,t,this.to-this.from)}resolve(e,t=0){return es(this,e,t,!1)}resolveInner(e,t=0){return es(this,e,t,!0)}enterUnfinishedNodesBefore(e){return $g(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let n=Xa(this,e,t,i);return n.length?n[0]:null}getChildren(e,t=null,i=null){return Xa(this,e,t,i)}get node(){return this}matchContext(e){return ja(this,e)}}class Va{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ni)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=i+n.buffer[e+1],this.to=i+n.buffer[e+2],!0}yield(e){return e?e instanceof Ni?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:n}=this.buffer,s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&qt.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&qt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&qt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(t.findChild(n,this.index,-1,0,4))}else{let n=t.buffer[this.index+3];if(n<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(n.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=n)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let a=i._tree.children[s];if(this.mode&qt.IncludeAnonymous||a instanceof yn||!a.type.isAnonymous||mh(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer){e:for(let n=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==n){if(n==this.index)return o;t=o,i=s+1;break e}n=this.stack[--s]}}for(let n=i;n<this.stack.length;n++)t=new ir(this.buffer,t,this.stack[n]);return this.bufferNode=new ir(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let n=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&t&&t(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(e){if(!this.buffer)return ja(this.node,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let n=e.length-1,s=this.stack.length-1;n>=0;s--){if(s<0)return ja(this.node,e,n);let o=i[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[n]&&e[n]!=o.name)return!1;n--}}return!0}}function mh(r){return r.children.some(e=>e instanceof yn||!e.type.isAnonymous||mh(e))}function q_(r){var e;let{buffer:t,nodeSet:i,maxBufferLength:n=Ag,reused:s=[],minRepeatType:o=i.types.length}=r,a=Array.isArray(t)?new ph(t,t.length):t,l=i.types,f=0,c=0;function h(Te,we,Ne,Ve,vt){let{id:it,start:Ke,end:ot,size:pt}=a,wt=c;for(;pt<0;)if(a.next(),pt==-1){let Mt=s[it];Ne.push(Mt),Ve.push(Ke-Te);return}else if(pt==-3){f=it;return}else if(pt==-4){c=it;return}else throw new RangeError(`Unrecognized record size: ${pt}`);let Ft=l[it],Xt,Kt,fi=Ke-Te;if(ot-Ke<=n&&(Kt=D(a.pos-we,vt))){let Mt=new Uint16Array(Kt.size-Kt.skip),gi=a.pos-Kt.size,ci=Mt.length;for(;a.pos>gi;)ci=E(Kt.start,Mt,ci);Xt=new yn(Mt,ot-Kt.start,i),fi=Kt.start-Te}else{let Mt=a.pos-pt;a.next();let gi=[],ci=[],ji=it>=o?it:-1,Or=0,xn=ot;for(;a.pos>Mt;)ji>=0&&a.id==ji&&a.size>=0?(a.end<=xn-n&&(g(gi,ci,Ke,Or,a.end,xn,ji,wt),Or=gi.length,xn=a.end),a.next()):h(Ke,Mt,gi,ci,ji);if(ji>=0&&Or>0&&Or<gi.length&&g(gi,ci,Ke,Or,Ke,xn,ji,wt),gi.reverse(),ci.reverse(),ji>-1&&Or>0){let bo=d(Ft);Xt=Oh(Ft,gi,ci,0,gi.length,0,ot-Ke,bo,bo)}else Xt=_(Ft,gi,ci,ot-Ke,wt-ot)}Ne.push(Xt),Ve.push(fi)}function d(Te){return(we,Ne,Ve)=>{let vt=0,it=we.length-1,Ke,ot;if(it>=0&&(Ke=we[it])instanceof Lt){if(!it&&Ke.type==Te&&Ke.length==Ve)return Ke;(ot=Ke.prop(et.lookAhead))&&(vt=Ne[it]+Ke.length+ot)}return _(Te,we,Ne,Ve,vt)}}function g(Te,we,Ne,Ve,vt,it,Ke,ot){let pt=[],wt=[];for(;Te.length>Ve;)pt.push(Te.pop()),wt.push(we.pop()+Ne-vt);Te.push(_(i.types[Ke],pt,wt,it-vt,ot-it)),we.push(vt-Ne)}function _(Te,we,Ne,Ve,vt=0,it){if(f){let Ke=[et.contextHash,f];it=it?[Ke].concat(it):[Ke]}if(vt>25){let Ke=[et.lookAhead,vt];it=it?[Ke].concat(it):[Ke]}return new Lt(Te,we,Ne,Ve,it)}function D(Te,we){let Ne=a.fork(),Ve=0,vt=0,it=0,Ke=Ne.end-n,ot={size:0,start:0,skip:0};e:for(let pt=Ne.pos-Te;Ne.pos>pt;){let wt=Ne.size;if(Ne.id==we&&wt>=0){ot.size=Ve,ot.start=vt,ot.skip=it,it+=4,Ve+=4,Ne.next();continue}let Ft=Ne.pos-wt;if(wt<0||Ft<pt||Ne.start<Ke)break;let Xt=Ne.id>=o?4:0,Kt=Ne.start;for(Ne.next();Ne.pos>Ft;){if(Ne.size<0)if(Ne.size==-3)Xt+=4;else break e;else Ne.id>=o&&(Xt+=4);Ne.next()}vt=Kt,Ve+=wt,it+=Xt}return(we<0||Ve==Te)&&(ot.size=Ve,ot.start=vt,ot.skip=it),ot.size>4?ot:void 0}function E(Te,we,Ne){let{id:Ve,start:vt,end:it,size:Ke}=a;if(a.next(),Ke>=0&&Ve<o){let ot=Ne;if(Ke>4){let pt=a.pos-(Ke-4);for(;a.pos>pt;)Ne=E(Te,we,Ne)}we[--Ne]=ot,we[--Ne]=it-Te,we[--Ne]=vt-Te,we[--Ne]=Ve}else Ke==-3?f=Ve:Ke==-4&&(c=Ve);return Ne}let U=[],Qe=[];for(;a.pos>0;)h(r.start||0,r.bufferStart||0,U,Qe,-1);let pe=(e=r.length)!==null&&e!==void 0?e:U.length?Qe[0]+U[0].length:0;return new Lt(l[r.topID],U.reverse(),Qe.reverse(),pe)}const tm=new WeakMap;function ka(r,e){if(!r.isAnonymous||e instanceof yn||e.type!=r)return 1;let t=tm.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=r||!(i instanceof Lt)){t=1;break}t+=ka(r,i)}tm.set(e,t)}return t}function Oh(r,e,t,i,n,s,o,a,l){let f=0;for(let _=i;_<n;_++)f+=ka(r,e[_]);let c=Math.ceil(f*1.5/8),h=[],d=[];function g(_,D,E,U,Qe){for(let pe=E;pe<U;){let Te=pe,we=D[pe],Ne=ka(r,_[pe]);for(pe++;pe<U;pe++){let Ve=ka(r,_[pe]);if(Ne+Ve>=c)break;Ne+=Ve}if(pe==Te+1){if(Ne>c){let Ve=_[Te];g(Ve.children,Ve.positions,0,Ve.children.length,D[Te]+Qe);continue}h.push(_[Te])}else{let Ve=D[pe-1]+_[pe-1].length-we;h.push(Oh(r,_,D,Te,pe,we,Ve,null,l))}d.push(we+Qe-s)}}return g(e,t,i,n,0),(a||l)(h,d,o)}class H_{constructor(){this.map=new WeakMap}setBuffer(e,t,i){let n=this.map.get(e);n||this.map.set(e,n=new Map),n.set(t,i)}getBuffer(e,t){let i=this.map.get(e);return i&&i.get(t)}set(e,t){e instanceof ir?this.setBuffer(e.context.buffer,e.index,t):e instanceof Ni&&this.map.set(e.tree,t)}get(e){return e instanceof ir?this.getBuffer(e.context.buffer,e.index):e instanceof Ni?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class dn{constructor(e,t,i,n,s=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=n,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let n=[new dn(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&n.push(s);return n}static applyChanges(e,t,i=128){if(!t.length)return e;let n=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,f=0;;a++){let c=a<t.length?t[a]:null,h=c?c.fromA:1e9;if(h-l>=i)for(;o&&o.from<h;){let d=o;if(l>=d.from||h<=d.to||f){let g=Math.max(d.from,l)-f,_=Math.min(d.to,h)-f;d=g>=_?null:new dn(g,_,d.tree,d.offset+f,a>0,!!c)}if(d&&n.push(d),o.to>h)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,f=c.toA-c.toB}return n}}class Eg{startParse(e,t,i){return typeof e=="string"&&(e=new Y_(e)),i=i?i.length?i.map(n=>new Wf(n.from,n.to)):[new Wf(0,0)]:[new Wf(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let n=this.startParse(e,t,i);for(;;){let s=n.advance();if(s)return s}}}class Y_{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new et({perNode:!0});let K_=0;class er{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=K_++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new er([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new Za;return t=>t.modified.indexOf(e)>-1?t:Za.get(t.base||t,t.modified.concat(e).sort((i,n)=>i.id-n.id))}}let J_=0;class Za{constructor(){this.instances=[],this.id=J_++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(a=>a.base==e&&ew(t,a.modified));if(i)return i;let n=[],s=new er(n,e,t);for(let a of t)a.instances.push(s);let o=Rg(t);for(let a of e.set)for(let l of o)n.push(Za.get(a,l));return s}}function ew(r,e){return r.length==e.length&&r.every((t,i)=>t==e[i])}function Rg(r){let e=[r];for(let t=0;t<r.length;t++)for(let i of Rg(r.slice(0,t).concat(r.slice(t+1))))e.push(i);return e}function Pg(r){let e=Object.create(null);for(let t in r){let i=r[t];Array.isArray(i)||(i=[i]);for(let n of t.split(" "))if(n){let s=[],o=2,a=n;for(let h=0;;){if(a=="..."&&h>0&&h+3==n.length){o=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!d)throw new RangeError("Invalid path: "+n);if(s.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==n.length)break;let g=n[h++];if(h==n.length&&g=="!"){o=0;break}if(g!="/")throw new RangeError("Invalid path: "+n);a=n.slice(h)}let l=s.length-1,f=s[l];if(!f)throw new RangeError("Invalid path: "+n);let c=new za(i,o,l>0?s.slice(0,l):null);e[f]=c.sort(e[f])}}return Lg.add(e)}const Lg=new et;class za{constructor(e,t,i,n){this.tags=e,this.mode=t,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}za.empty=new za([],2,null);function Dg(r,e){let t=Object.create(null);for(let s of r)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:i,all:n=null}=e||{};return{style:s=>{let o=n;for(let a of s)for(let l of a.set){let f=t[l.id];if(f){o=o?o+" "+f:f;break}}return o},scope:i}}function tw(r,e){let t=null;for(let i of r){let n=i.style(e);n&&(t=t?t+" "+n:n)}return t}function iw(r,e,t,i=0,n=r.length){let s=new rw(i,Array.isArray(e)?e:[e],t);s.highlightRange(r.cursor(),i,n,"",s.highlighters),s.flush(n)}class rw{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,n,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=t)return;o.isTop&&(s=this.highlighters.filter(g=>!g.scope||g.scope(o)));let f=n,c=nw(e)||za.empty,h=tw(s,c.tags);if(h&&(f&&(f+=" "),f+=h,c.mode==1&&(n+=(n?" ":"")+h)),this.startSpan(e.from,f),c.opaque)return;let d=e.tree&&e.tree.prop(et.mounted);if(d&&d.overlay){let g=e.node.enter(d.overlay[0].from+a,1),_=this.highlighters.filter(E=>!E.scope||E.scope(d.tree.type)),D=e.firstChild();for(let E=0,U=a;;E++){let Qe=E<d.overlay.length?d.overlay[E]:null,pe=Qe?Qe.from+a:l,Te=Math.max(t,U),we=Math.min(i,pe);if(Te<we&&D)for(;e.from<we&&(this.highlightRange(e,Te,we,n,s),this.startSpan(Math.min(i,e.to),f),!(e.to>=pe||!e.nextSibling())););if(!Qe||pe>i)break;U=Qe.to+a,U>t&&(this.highlightRange(g.cursor(),Math.max(t,Qe.from+a),Math.min(i,U),n,_),this.startSpan(U,f))}D&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,n,s),this.startSpan(Math.min(i,e.to),f)}while(e.nextSibling());e.parent()}}}function nw(r){let e=r.type.prop(Lg);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const Ae=er.define,ha=Ae(),Tr=Ae(),im=Ae(Tr),rm=Ae(Tr),kr=Ae(),ua=Ae(kr),Ff=Ae(kr),Ji=Ae(),on=Ae(Ji),Yi=Ae(),Ki=Ae(),Nc=Ae(),As=Ae(Nc),da=Ae(),L={comment:ha,lineComment:Ae(ha),blockComment:Ae(ha),docComment:Ae(ha),name:Tr,variableName:Ae(Tr),typeName:im,tagName:Ae(im),propertyName:rm,attributeName:Ae(rm),className:Ae(Tr),labelName:Ae(Tr),namespace:Ae(Tr),macroName:Ae(Tr),literal:kr,string:ua,docString:Ae(ua),character:Ae(ua),attributeValue:Ae(ua),number:Ff,integer:Ae(Ff),float:Ae(Ff),bool:Ae(kr),regexp:Ae(kr),escape:Ae(kr),color:Ae(kr),url:Ae(kr),keyword:Yi,self:Ae(Yi),null:Ae(Yi),atom:Ae(Yi),unit:Ae(Yi),modifier:Ae(Yi),operatorKeyword:Ae(Yi),controlKeyword:Ae(Yi),definitionKeyword:Ae(Yi),moduleKeyword:Ae(Yi),operator:Ki,derefOperator:Ae(Ki),arithmeticOperator:Ae(Ki),logicOperator:Ae(Ki),bitwiseOperator:Ae(Ki),compareOperator:Ae(Ki),updateOperator:Ae(Ki),definitionOperator:Ae(Ki),typeOperator:Ae(Ki),controlOperator:Ae(Ki),punctuation:Nc,separator:Ae(Nc),bracket:As,angleBracket:Ae(As),squareBracket:Ae(As),paren:Ae(As),brace:Ae(As),content:Ji,heading:on,heading1:Ae(on),heading2:Ae(on),heading3:Ae(on),heading4:Ae(on),heading5:Ae(on),heading6:Ae(on),contentSeparator:Ae(Ji),list:Ae(Ji),quote:Ae(Ji),emphasis:Ae(Ji),strong:Ae(Ji),link:Ae(Ji),monospace:Ae(Ji),strikethrough:Ae(Ji),inserted:Ae(),deleted:Ae(),changed:Ae(),invalid:Ae(),meta:da,documentMeta:Ae(da),annotation:Ae(da),processingInstruction:Ae(da),definition:er.defineModifier(),constant:er.defineModifier(),function:er.defineModifier(),standard:er.defineModifier(),local:er.defineModifier(),special:er.defineModifier()};Dg([{tag:L.link,class:"tok-link"},{tag:L.heading,class:"tok-heading"},{tag:L.emphasis,class:"tok-emphasis"},{tag:L.strong,class:"tok-strong"},{tag:L.keyword,class:"tok-keyword"},{tag:L.atom,class:"tok-atom"},{tag:L.bool,class:"tok-bool"},{tag:L.url,class:"tok-url"},{tag:L.labelName,class:"tok-labelName"},{tag:L.inserted,class:"tok-inserted"},{tag:L.deleted,class:"tok-deleted"},{tag:L.literal,class:"tok-literal"},{tag:L.string,class:"tok-string"},{tag:L.number,class:"tok-number"},{tag:[L.regexp,L.escape,L.special(L.string)],class:"tok-string2"},{tag:L.variableName,class:"tok-variableName"},{tag:L.local(L.variableName),class:"tok-variableName tok-local"},{tag:L.definition(L.variableName),class:"tok-variableName tok-definition"},{tag:L.special(L.variableName),class:"tok-variableName2"},{tag:L.definition(L.propertyName),class:"tok-propertyName tok-definition"},{tag:L.typeName,class:"tok-typeName"},{tag:L.namespace,class:"tok-namespace"},{tag:L.className,class:"tok-className"},{tag:L.macroName,class:"tok-macroName"},{tag:L.propertyName,class:"tok-propertyName"},{tag:L.operator,class:"tok-operator"},{tag:L.comment,class:"tok-comment"},{tag:L.meta,class:"tok-meta"},{tag:L.invalid,class:"tok-invalid"},{tag:L.punctuation,class:"tok-punctuation"}]);var Xf;const oo=new et;function sw(r){return Be.define({combine:r?e=>e.concat(r):void 0})}class Gi{constructor(e,t,i=[]){this.data=e,rt.prototype.hasOwnProperty("tree")||Object.defineProperty(rt.prototype,"tree",{get(){return Wt(this)}}),this.parser=t,this.extension=[Gr.of(this),rt.languageData.of((n,s,o)=>n.facet(nm(n,s,o)))].concat(i)}isActiveAt(e,t,i=-1){return nm(e,t,i)==this.data}findRegions(e){let t=e.facet(Gr);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],n=(s,o)=>{if(s.prop(oo)==this.data){i.push({from:o,to:o+s.length});return}let a=s.prop(et.mounted);if(a){if(a.tree.prop(oo)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+s.length});return}else if(a.overlay){let l=i.length;if(n(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<s.children.length;l++){let f=s.children[l];f instanceof Lt&&n(f,s.positions[l]+o)}};return n(Wt(e),0),i}get allowsNesting(){return!0}}Gi.setState=He.define();function nm(r,e,t){let i=r.facet(Gr);if(!i)return null;let n=i.data;if(i.allowsNesting)for(let s=Wt(r).topNode;s;s=s.enter(e,t,qt.ExcludeBuffers))n=s.type.prop(oo)||n;return n}class Ua extends Gi{constructor(e,t){super(e,t),this.parser=t}static define(e){let t=sw(e.languageData);return new Ua(t,e.parser.configure({props:[oo.add(i=>i.isTop?t:void 0)]}))}configure(e){return new Ua(this.data,this.parser.configure(e))}get allowsNesting(){return this.parser.hasWrappers()}}function Wt(r){let e=r.field(Gi.state,!1);return e?e.tree:Lt.empty}class ow{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Cs=null;class qa{constructor(e,t,i=[],n,s,o,a,l){this.parser=e,this.state=t,this.fragments=i,this.tree=n,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new qa(e,t,[],Lt.empty,0,i,[],null)}startParse(){return this.parser.startParse(new ow(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Lt.empty&&this.isDone(t!=null?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let n=Date.now()+e;e=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(dn.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(t!=null?t:this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(dn.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Cs;Cs=this;try{return e()}finally{Cs=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=sm(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:n,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((f,c,h,d)=>l.push({fromA:f,toA:c,fromB:h,toB:d})),i=dn.applyChanges(i,l),n=Lt.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let f of this.skipped){let c=e.mapPos(f.from,1),h=e.mapPos(f.to,-1);c<h&&a.push({from:c,to:h})}}}return new qa(this.parser,t,i,n,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:s}=this.skipped[i];n<e.to&&s>e.from&&(this.fragments=sm(this.fragments,n,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Eg{createParse(t,i,n){let s=n[0].from,o=n[n.length-1].to;return{parsedPos:s,advance(){let l=Cs;if(l){for(let f of n)l.tempSkipped.push(f);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Lt(Oi.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Cs}}function sm(r,e,t){return dn.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}class ts{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new ts(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=qa.create(e.facet(Gr).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new ts(i)}}Gi.state=Yt.define({create:ts.init,update(r,e){for(let t of e.effects)if(t.is(Gi.setState))return t.value;return e.startState.facet(Gr)!=e.state.facet(Gr)?ts.init(e.state):r.apply(e)}});let Mg=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Mg=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:500-100})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const jf=typeof navigator<"u"&&((Xf=navigator.scheduling)===null||Xf===void 0?void 0:Xf.isInputPending)?()=>navigator.scheduling.isInputPending():null,aw=Dt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Gi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Gi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Mg(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,s=i.field(Gi.state);if(s.tree==s.context.tree&&s.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!jf?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<n&&i.doc.length>n+1e3,l=s.context.work(()=>jf&&jf()||Date.now()>o,n+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Gi.setState.of(new ts(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Ai(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Gr=Be.define({combine(r){return r.length?r[0]:null},enables:[Gi.state,aw]});class lw{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const fw=Be.define(),vl=Be.define({combine:r=>{if(!r.length)return"  ";if(!/^(?: +|\t+)$/.test(r[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return r[0]}});function Ha(r){let e=r.facet(vl);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function ao(r,e){let t="",i=r.tabSize;if(r.facet(vl).charCodeAt(0)==9)for(;e>=i;)t+="	",e-=i;for(let n=0;n<e;n++)t+=" ";return t}function gh(r,e){r instanceof rt&&(r=new bl(r));for(let i of r.state.facet(fw)){let n=i(r,e);if(n!=null)return n}let t=Wt(r.state);return t?cw(r,t,e):null}class bl{constructor(e,t={}){this.state=e,this.options=t,this.unit=Ha(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:s}=this.options;return n!=null&&n>=i.from&&n<=i.to?s&&n==e?{text:"",from:e}:(t<0?n<e:n<=e)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(e,t);return i.slice(e-n,Math.min(i.length,e+100-n))}column(e,t=1){let{text:i,from:n}=this.lineAt(e,t),s=this.countColumn(i,e-n),o=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return ho(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:n}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(n);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Ig=new et;function cw(r,e,t){return Bg(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,r)}function hw(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function uw(r){let e=r.type.prop(Ig);if(e)return e;let t=r.firstChild,i;if(t&&(i=t.type.prop(et.closedBy))){let n=r.lastChild,s=n&&i.indexOf(n.name)>-1;return o=>Gg(o,!0,1,void 0,s&&!hw(o)?n.from:void 0)}return r.parent==null?dw:null}function Bg(r,e,t){for(;r;r=r.parent){let i=uw(r);if(i)return i(vh.create(t,e,r))}return null}function dw(){return 0}class vh extends bl{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.node=i}static create(e,t,i){return new vh(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(pw(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?Bg(e,this.pos,this.base):0}}function pw(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function mw(r){let e=r.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let n=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),o=n==null||n<=s.from?s.to:Math.min(s.to,n);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped)return l.from<o?t:null;a=l.to}}function Ow({closing:r,align:e=!0,units:t=1}){return i=>Gg(i,e,t,r)}function Gg(r,e,t,i,n){let s=r.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||n==r.pos+o,l=e?mw(r):null;return l?a?r.column(l.from):r.column(l.to):r.baseIndent+(a?0:r.unit*t)}const gw=r=>r.baseIndent;function Vf({except:r,units:e=1}={}){return t=>{let i=r&&r.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const vw=200;function bw(){return rt.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:i}=r.newSelection.main,n=t.lineAt(i);if(i>n.from+vw)return r;let s=t.sliceString(n.from,i);if(!e.some(f=>f.test(s)))return r;let{state:o}=r,a=-1,l=[];for(let{head:f}of o.selection.ranges){let c=o.doc.lineAt(f);if(c.from==a)continue;a=c.from;let h=gh(o,c.from);if(h==null)continue;let d=/^\s*/.exec(c.text)[0],g=ao(o,h);d!=g&&l.push({from:c.from,to:c.from+d.length,insert:g})}return l.length?[r,{changes:l,sequential:!0}]:r})}const yw=Be.define(),Ng=new et;function xw(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}function Sw(r,e,t){let i=Wt(r);if(i.length<t)return null;let n=i.resolveInner(t),s=null;for(let o=n;o;o=o.parent){if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let a=o.type.prop(Ng);if(a&&(o.to<i.length-50||i.length==r.doc.length||!_w(o))){let l=a(o,r);l&&l.from<=t&&l.from>=e&&l.to>t&&(s=l)}}return s}function _w(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function Ya(r,e,t){for(let i of r.facet(yw)){let n=i(r,e,t);if(n)return n}return Sw(r,e,t)}function Wg(r,e){let t=e.mapPos(r.from,1),i=e.mapPos(r.to,-1);return t>=i?void 0:{from:t,to:i}}const yl=He.define({map:Wg}),po=He.define({map:Wg});function Fg(r){let e=[];for(let{head:t}of r.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(r.lineBlockAt(t));return e}const gn=Yt.define({create(){return Xe.none},update(r,e){r=r.map(e.changes);for(let t of e.effects)t.is(yl)&&!ww(r,t.value.from,t.value.to)?r=r.update({add:[om.range(t.value.from,t.value.to)]}):t.is(po)&&(r=r.update({filter:(i,n)=>t.value.from!=i||t.value.to!=n,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:i}=e.selection.main;r.between(i,i,(n,s)=>{n<i&&s>i&&(t=!0)}),t&&(r=r.update({filterFrom:i,filterTo:i,filter:(n,s)=>s<=i||n>=i}))}return r},provide:r=>Ie.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(i,n)=>{t.push(i,n)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let i=r[t++],n=r[t++];if(typeof i!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");e.push(om.range(i,n))}return Xe.set(e,!0)}});function Ka(r,e,t){var i;let n=null;return(i=r.field(gn,!1))===null||i===void 0||i.between(e,t,(s,o)=>{(!n||n.from>s)&&(n={from:s,to:o})}),n}function ww(r,e,t){let i=!1;return r.between(e,e,(n,s)=>{n==e&&s==t&&(i=!0)}),i}function Xg(r,e){return r.field(gn,!1)?e:e.concat(He.appendConfig.of(Zg()))}const Tw=r=>{for(let e of Fg(r)){let t=Ya(r.state,e.from,e.to);if(t)return r.dispatch({effects:Xg(r.state,[yl.of(t),jg(r,t)])}),!0}return!1},kw=r=>{if(!r.state.field(gn,!1))return!1;let e=[];for(let t of Fg(r)){let i=Ka(r.state,t.from,t.to);i&&e.push(po.of(i),jg(r,i,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function jg(r,e,t=!0){let i=r.state.doc.lineAt(e.from).number,n=r.state.doc.lineAt(e.to).number;return Ie.announce.of(`${r.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${r.state.phrase("to")} ${n}.`)}const Qw=r=>{let{state:e}=r,t=[];for(let i=0;i<e.doc.length;){let n=r.lineBlockAt(i),s=Ya(e,n.from,n.to);s&&t.push(yl.of(s)),i=(s?r.lineBlockAt(s.to):n).to+1}return t.length&&r.dispatch({effects:Xg(r.state,t)}),!!t.length},Aw=r=>{let e=r.state.field(gn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,r.state.doc.length,(i,n)=>{t.push(po.of({from:i,to:n}))}),r.dispatch({effects:t}),!0},Cw=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Tw},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:kw},{key:"Ctrl-Alt-[",run:Qw},{key:"Ctrl-Alt-]",run:Aw}],$w={placeholderDOM:null,placeholderText:"\u2026"},Vg=Be.define({combine(r){return ar(r,$w)}});function Zg(r){let e=[gn,Pw];return r&&e.push(Vg.of(r)),e}const om=Xe.replace({widget:new class extends mr{toDOM(r){let{state:e}=r,t=e.facet(Vg),i=s=>{let o=r.lineBlockAt(r.posAtDOM(s.target)),a=Ka(r.state,o.from,o.to);a&&r.dispatch({effects:po.of(a)}),s.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(r,i);let n=document.createElement("span");return n.textContent=t.placeholderText,n.setAttribute("aria-label",e.phrase("folded code")),n.title=e.phrase("unfold"),n.className="cm-foldPlaceholder",n.onclick=i,n}}}),Ew={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Zf extends pr{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Rw(r={}){let e=Object.assign(Object.assign({},Ew),r),t=new Zf(e,!0),i=new Zf(e,!1),n=Dt.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Gr)!=o.state.facet(Gr)||o.startState.field(gn,!1)!=o.state.field(gn,!1)||Wt(o.startState)!=Wt(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new Dr;for(let l of o.viewportLineBlocks){let f=Ka(o.state,l.from,l.to)?i:Ya(o.state,l.from,l.to)?t:null;f&&a.add(l.from,l.from,f)}return a.finish()}}),{domEventHandlers:s}=e;return[n,M_({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(n))===null||a===void 0?void 0:a.markers)||at.empty},initialSpacer(){return new Zf(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,a,l)=>{if(s.click&&s.click(o,a,l))return!0;let f=Ka(o.state,a.from,a.to);if(f)return o.dispatch({effects:po.of(f)}),!0;let c=Ya(o.state,a.from,a.to);return c?(o.dispatch({effects:yl.of(c)}),!0):!1}})}),Zg()]}const Pw=Ie.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class mo{constructor(e,t){let i;function n(a){let l=Mr.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const s=typeof t.all=="string"?t.all:t.all?n(t.all):void 0,o=t.scope;this.scope=o instanceof Gi?a=>a.prop(oo)==o.data:o?a=>a==o:void 0,this.style=Dg(e.map(a=>({tag:a.tag,class:a.class||n(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=i?new Mr(i):null,this.themeType=t.themeType}static define(e,t){return new mo(e,t||{})}}const Wc=Be.define(),zg=Be.define({combine(r){return r.length?[r[0]]:null}});function zf(r){let e=r.facet(Wc);return e.length?e:r.facet(zg)}function bh(r,e){let t=[Dw],i;return r instanceof mo&&(r.module&&t.push(Ie.styleModule.of(r.module)),i=r.themeType),e!=null&&e.fallback?t.push(zg.of(r)):i?t.push(Wc.computeN([Ie.darkTheme],n=>n.facet(Ie.darkTheme)==(i=="dark")?[r]:[])):t.push(Wc.of(r)),t}class Lw{constructor(e){this.markCache=Object.create(null),this.tree=Wt(e.state),this.decorations=this.buildDeco(e,zf(e.state))}update(e){let t=Wt(e.state),i=zf(e.state),n=i!=zf(e.startState);t.length<e.view.viewport.to&&!n&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||n)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i))}buildDeco(e,t){if(!t||!this.tree.length)return Xe.none;let i=new Dr;for(let{from:n,to:s}of e.visibleRanges)iw(this.tree,t,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=Xe.mark({class:l})))},n,s);return i.finish()}}const Dw=vn.high(Dt.fromClass(Lw,{decorations:r=>r.decorations})),Mw=mo.define([{tag:L.meta,color:"#7a757a"},{tag:L.link,textDecoration:"underline"},{tag:L.heading,textDecoration:"underline",fontWeight:"bold"},{tag:L.emphasis,fontStyle:"italic"},{tag:L.strong,fontWeight:"bold"},{tag:L.strikethrough,textDecoration:"line-through"},{tag:L.keyword,color:"#708"},{tag:[L.atom,L.bool,L.url,L.contentSeparator,L.labelName],color:"#219"},{tag:[L.literal,L.inserted],color:"#164"},{tag:[L.string,L.deleted],color:"#a11"},{tag:[L.regexp,L.escape,L.special(L.string)],color:"#e40"},{tag:L.definition(L.variableName),color:"#00f"},{tag:L.local(L.variableName),color:"#30a"},{tag:[L.typeName,L.namespace],color:"#085"},{tag:L.className,color:"#167"},{tag:[L.special(L.variableName),L.macroName],color:"#256"},{tag:L.definition(L.propertyName),color:"#00c"},{tag:L.comment,color:"#940"},{tag:L.invalid,color:"#f00"}]),Iw=Ie.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Ug=1e4,qg="()[]{}",Hg=Be.define({combine(r){return ar(r,{afterCursor:!0,brackets:qg,maxScanDistance:Ug,renderMatch:Nw})}}),Bw=Xe.mark({class:"cm-matchingBracket"}),Gw=Xe.mark({class:"cm-nonmatchingBracket"});function Nw(r){let e=[],t=r.matched?Bw:Gw;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}const Ww=Yt.define({create(){return Xe.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],i=e.state.facet(Hg);for(let n of e.state.selection.ranges){if(!n.empty)continue;let s=rr(e.state,n.head,-1,i)||n.head>0&&rr(e.state,n.head-1,1,i)||i.afterCursor&&(rr(e.state,n.head,1,i)||n.head<e.state.doc.length&&rr(e.state,n.head+1,-1,i));s&&(t=t.concat(i.renderMatch(s,e.state)))}return Xe.set(t,!0)},provide:r=>Ie.decorations.from(r)}),Fw=[Ww,Iw];function Xw(r={}){return[Hg.of(r),Fw]}function Fc(r,e,t){let i=r.prop(e<0?et.openedBy:et.closedBy);if(i)return i;if(r.name.length==1){let n=t.indexOf(r.name);if(n>-1&&n%2==(e<0?1:0))return[t[n+e]]}return null}function rr(r,e,t,i={}){let n=i.maxScanDistance||Ug,s=i.brackets||qg,o=Wt(r),a=o.resolveInner(e,t);for(let l=a;l;l=l.parent){let f=Fc(l.type,t,s);if(f&&l.from<l.to)return jw(r,e,t,l,f,s)}return Vw(r,e,t,o,a.type,n,s)}function jw(r,e,t,i,n,s){let o=i.parent,a={from:i.from,to:i.to},l=0,f=o==null?void 0:o.cursor();if(f&&(t<0?f.childBefore(i.from):f.childAfter(i.to)))do if(t<0?f.to<=i.from:f.from>=i.to){if(l==0&&n.indexOf(f.type.name)>-1&&f.from<f.to)return{start:a,end:{from:f.from,to:f.to},matched:!0};if(Fc(f.type,t,s))l++;else if(Fc(f.type,-t,s)){if(l==0)return{start:a,end:f.from==f.to?void 0:{from:f.from,to:f.to},matched:!1};l--}}while(t<0?f.prevSibling():f.nextSibling());return{start:a,matched:!1}}function Vw(r,e,t,i,n,s,o){let a=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=t>0)return null;let f={from:t<0?e-1:e,to:t>0?e+1:e},c=r.doc.iterRange(e,t>0?r.doc.length:0),h=0;for(let d=0;!c.next().done&&d<=s;){let g=c.value;t<0&&(d+=g.length);let _=e+d*t;for(let D=t>0?0:g.length-1,E=t>0?g.length:-1;D!=E;D+=t){let U=o.indexOf(g[D]);if(!(U<0||i.resolveInner(_+D,1).type!=n))if(U%2==0==t>0)h++;else{if(h==1)return{start:f,end:{from:_+D,to:_+D+1},matched:U>>1==l>>1};h--}}t>0&&(d+=g.length)}return c.done?{start:f,matched:!1}:null}const Zw=Object.create(null),am=[Oi.none],lm=[],zw=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])zw[r]=Uw(Zw,e);function Uf(r,e){lm.indexOf(r)>-1||(lm.push(r),console.warn(e))}function Uw(r,e){let t=null;for(let s of e.split(".")){let o=r[s]||L[s];o?typeof o=="function"?t?t=o(t):Uf(s,`Modifier ${s} used at start of tag`):t?Uf(s,`Tag ${s} used as modifier`):t=o:Uf(s,`Unknown highlighting tag ${s}`)}if(!t)return 0;let i=e.replace(/ /g,"_"),n=Oi.define({id:am.length,name:i,props:[Pg({[i]:t})]});return am.push(n),n.id}const qw=r=>{let e=xh(r.state);return e.line?Hw(r):e.block?Kw(r):!1};function yh(r,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let n=r(e,t);return n?(i(t.update(n)),!0):!1}}const Hw=yh(tT,0),Yw=yh(Yg,0),Kw=yh((r,e)=>Yg(r,e,eT(e)),0);function xh(r,e=r.selection.main.head){let t=r.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const $s=50;function Jw(r,{open:e,close:t},i,n){let s=r.sliceDoc(i-$s,i),o=r.sliceDoc(n,n+$s),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,f=s.length-a;if(s.slice(f-e.length,f)==e&&o.slice(l,l+t.length)==t)return{open:{pos:i-a,margin:a&&1},close:{pos:n+l,margin:l&&1}};let c,h;n-i<=2*$s?c=h=r.sliceDoc(i,n):(c=r.sliceDoc(i,i+$s),h=r.sliceDoc(n-$s,n));let d=/^\s*/.exec(c)[0].length,g=/\s*$/.exec(h)[0].length,_=h.length-g-t.length;return c.slice(d,d+e.length)==e&&h.slice(_,_+t.length)==t?{open:{pos:i+d+e.length,margin:/\s/.test(c.charAt(d+e.length))?1:0},close:{pos:n-g-t.length,margin:/\s/.test(h.charAt(_-1))?1:0}}:null}function eT(r){let e=[];for(let t of r.selection.ranges){let i=r.doc.lineAt(t.from),n=t.to<=i.to?i:r.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=n.to:e.push({from:i.from,to:n.to})}return e}function Yg(r,e,t=e.selection.ranges){let i=t.map(s=>xh(e,s.from).block);if(!i.every(s=>s))return null;let n=t.map((s,o)=>Jw(e,i[o],s.from,s.to));if(r!=2&&!n.every(s=>s))return{changes:e.changes(t.map((s,o)=>n[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(r!=1&&n.some(s=>s)){let s=[];for(let o=0,a;o<n.length;o++)if(a=n[o]){let l=i[o],{open:f,close:c}=a;s.push({from:f.pos-l.open.length,to:f.pos+f.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function tT(r,e,t=e.selection.ranges){let i=[],n=-1;for(let{from:s,to:o}of t){let a=i.length,l=1e9;for(let f=s;f<=o;){let c=e.doc.lineAt(f);if(c.from>n&&(s==o||o>c.from)){n=c.from;let h=xh(e,f).line;if(!h)continue;let d=/^\s*/.exec(c.text)[0].length,g=d==c.length,_=c.text.slice(d,d+h.length)==h?d:-1;d<c.text.length&&d<l&&(l=d),i.push({line:c,comment:_,token:h,indent:d,empty:g,single:!1})}f=c.to+1}if(l<1e9)for(let f=a;f<i.length;f++)i[f].indent<i[f].line.text.length&&(i[f].indent=l);i.length==a+1&&(i[a].single=!0)}if(r!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:f,empty:c,single:h}of i)(h||!c)&&s.push({from:a.from+f,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(r!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let f=o.from+a,c=f+l.length;o.text[c-o.from]==" "&&c++,s.push({from:f,to:c})}return{changes:s}}return null}const Xc=bn.define(),iT=bn.define(),rT=Be.define(),Kg=Be.define({combine(r){return ar(r,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function nT(r){let e=0;return r.iterChangedRanges((t,i)=>e=i),e}const Jg=Yt.define({create(){return nr.empty},update(r,e){let t=e.state.facet(Kg),i=e.annotation(Xc);if(i){let l=e.docChanged?se.single(nT(e.changes)):void 0,f=pi.fromTransaction(e,l),c=i.side,h=c==0?r.undone:r.done;return f?h=Ja(h,h.length,t.minDepth,f):h=i0(h,e.startState.selection),new nr(c==0?i.rest:h,c==0?h:i.rest)}let n=e.annotation(iT);if((n=="full"||n=="before")&&(r=r.isolate()),e.annotation(Gt.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let s=pi.fromTransaction(e),o=e.annotation(Gt.time),a=e.annotation(Gt.userEvent);return s?r=r.addChanges(s,o,a,t.newGroupDelay,t.minDepth):e.selection&&(r=r.addSelection(e.startState.selection,o,a,t.newGroupDelay)),(n=="full"||n=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new nr(r.done.map(pi.fromJSON),r.undone.map(pi.fromJSON))}});function sT(r={}){return[Jg,Kg.of(r),Ie.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?e0:e.inputType=="historyRedo"?jc:null;return i?(e.preventDefault(),i(t)):!1}})]}function xl(r,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let n=t.field(Jg,!1);if(!n)return!1;let s=n.pop(r,t,e);return s?(i(s),!0):!1}}const e0=xl(0,!1),jc=xl(1,!1),oT=xl(0,!0),aT=xl(1,!0);class pi{constructor(e,t,i,n,s){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=n,this.selectionsAfter=s}setSelAfter(e){return new pi(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(e){return new pi(e.changes&&Bt.fromJSON(e.changes),[],e.mapped&&sr.fromJSON(e.mapped),e.startSelection&&se.fromJSON(e.startSelection),e.selectionsAfter.map(se.fromJSON))}static fromTransaction(e,t){let i=Ri;for(let n of e.startState.facet(rT)){let s=n(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new pi(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,Ri)}static selection(e){return new pi(void 0,Ri,void 0,void 0,e)}}function Ja(r,e,t,i){let n=e+1>t+20?e-t-1:0,s=r.slice(n,e);return s.push(i),s}function lT(r,e){let t=[],i=!1;return r.iterChangedRanges((n,s)=>t.push(n,s)),e.iterChangedRanges((n,s,o,a)=>{for(let l=0;l<t.length;){let f=t[l++],c=t[l++];a>=f&&o<=c&&(i=!0)}}),i}function fT(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function t0(r,e){return r.length?e.length?r.concat(e):r:e}const Ri=[],cT=200;function i0(r,e){if(r.length){let t=r[r.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-cT));return i.length&&i[i.length-1].eq(e)?r:(i.push(e),Ja(r,r.length-1,1e9,t.setSelAfter(i)))}else return[pi.selection([e])]}function hT(r){let e=r[r.length-1],t=r.slice();return t[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function qf(r,e){if(!r.length)return r;let t=r.length,i=Ri;for(;t;){let n=uT(r[t-1],e,i);if(n.changes&&!n.changes.empty||n.effects.length){let s=r.slice(0,t);return s[t-1]=n,s}else e=n.mapped,t--,i=n.selectionsAfter}return i.length?[pi.selection(i)]:Ri}function uT(r,e,t){let i=t0(r.selectionsAfter.length?r.selectionsAfter.map(a=>a.map(e)):Ri,t);if(!r.changes)return pi.selection(i);let n=r.changes.map(e),s=e.mapDesc(r.changes,!0),o=r.mapped?r.mapped.composeDesc(s):s;return new pi(n,He.mapEffects(r.effects,e),o,r.startSelection.map(s),i)}const dT=/^(input\.type|delete)($|\.)/;class nr{constructor(e,t,i=0,n=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new nr(this.done,this.undone):this}addChanges(e,t,i,n,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!i||dT.test(i))&&(!a.selectionsAfter.length&&t-this.prevTime<n&&lT(a.changes,e.changes)||i=="input.type.compose")?o=Ja(o,o.length-1,s,new pi(e.changes.compose(a.changes),t0(e.effects,a.effects),a.mapped,a.startSelection,Ri)):o=Ja(o,o.length,s,e),new nr(o,Ri,t,i)}addSelection(e,t,i,n){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Ri;return s.length>0&&t-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&fT(s[s.length-1],e)?this:new nr(i0(this.done,e),this.undone,t,i)}addMapping(e){return new nr(qf(this.done,e),qf(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let n=e==0?this.done:this.undone;if(n.length==0)return null;let s=n[n.length-1];if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Xc.of({side:e,rest:hT(n)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=n.length==1?Ri:n.slice(0,n.length-1);return s.mapped&&(o=qf(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Xc.of({side:e,rest:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}nr.empty=new nr(Ri,Ri);const pT=[{key:"Mod-z",run:e0,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:jc,preventDefault:!0},{linux:"Ctrl-Shift-z",run:jc,preventDefault:!0},{key:"Mod-u",run:oT,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:aT,preventDefault:!0}];function ns(r,e){return se.create(r.ranges.map(e),r.mainIndex)}function lr(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Xi({state:r,dispatch:e},t){let i=ns(r.selection,t);return i.eq(r.selection)?!1:(e(lr(r,i)),!0)}function Sl(r,e){return se.cursor(e?r.to:r.from)}function r0(r,e){return Xi(r,t=>t.empty?r.moveByChar(t,e):Sl(t,e))}function oi(r){return r.textDirectionAt(r.state.selection.main.head)==_t.LTR}const n0=r=>r0(r,!oi(r)),s0=r=>r0(r,oi(r));function o0(r,e){return Xi(r,t=>t.empty?r.moveByGroup(t,e):Sl(t,e))}const mT=r=>o0(r,!oi(r)),OT=r=>o0(r,oi(r));function gT(r,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function _l(r,e,t){let i=Wt(r).resolveInner(e.head),n=t?et.closedBy:et.openedBy;for(let l=e.head;;){let f=t?i.childAfter(l):i.childBefore(l);if(!f)break;gT(r,f,n)?i=f:l=t?f.to:f.from}let s=i.type.prop(n),o,a;return s&&(o=t?rr(r,i.from,1):rr(r,i.to,-1))&&o.matched?a=t?o.end.to:o.end.from:a=t?i.to:i.from,se.cursor(a,t?-1:1)}const vT=r=>Xi(r,e=>_l(r.state,e,!oi(r))),bT=r=>Xi(r,e=>_l(r.state,e,oi(r)));function a0(r,e){return Xi(r,t=>{if(!t.empty)return Sl(t,e);let i=r.moveVertically(t,e);return i.head!=t.head?i:r.moveToLineBoundary(t,e)})}const l0=r=>a0(r,!1),f0=r=>a0(r,!0);function c0(r){return Math.max(r.defaultLineHeight,Math.min(r.dom.clientHeight,innerHeight)-5)}function h0(r,e){let{state:t}=r,i=ns(t.selection,a=>a.empty?r.moveVertically(a,e,c0(r)):Sl(a,e));if(i.eq(t.selection))return!1;let n=r.coordsAtPos(t.selection.main.head),s=r.scrollDOM.getBoundingClientRect(),o;return n&&n.top>s.top&&n.bottom<s.bottom&&n.top-s.top<=r.scrollDOM.scrollHeight-r.scrollDOM.scrollTop-r.scrollDOM.clientHeight&&(o=Ie.scrollIntoView(i.main.head,{y:"start",yMargin:n.top-s.top})),r.dispatch(lr(t,i),{effects:o}),!0}const fm=r=>h0(r,!1),Vc=r=>h0(r,!0);function Xr(r,e,t){let i=r.lineBlockAt(e.head),n=r.moveToLineBoundary(e,t);if(n.head==e.head&&n.head!=(t?i.to:i.from)&&(n=r.moveToLineBoundary(e,t,!1)),!t&&n.head==i.from&&i.length){let s=/^\s*/.exec(r.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(n=se.cursor(i.from+s))}return n}const yT=r=>Xi(r,e=>Xr(r,e,!0)),xT=r=>Xi(r,e=>Xr(r,e,!1)),ST=r=>Xi(r,e=>Xr(r,e,!oi(r))),_T=r=>Xi(r,e=>Xr(r,e,oi(r))),wT=r=>Xi(r,e=>se.cursor(r.lineBlockAt(e.head).from,1)),TT=r=>Xi(r,e=>se.cursor(r.lineBlockAt(e.head).to,-1));function kT(r,e,t){let i=!1,n=ns(r.selection,s=>{let o=rr(r,s.head,-1)||rr(r,s.head,1)||s.head>0&&rr(r,s.head-1,1)||s.head<r.doc.length&&rr(r,s.head+1,-1);if(!o||!o.end)return s;i=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return t?se.range(s.anchor,a):se.cursor(a)});return i?(e(lr(r,n)),!0):!1}const QT=({state:r,dispatch:e})=>kT(r,e,!1);function Li(r,e){let t=ns(r.state.selection,i=>{let n=e(i);return se.range(i.anchor,n.head,n.goalColumn)});return t.eq(r.state.selection)?!1:(r.dispatch(lr(r.state,t)),!0)}function u0(r,e){return Li(r,t=>r.moveByChar(t,e))}const d0=r=>u0(r,!oi(r)),p0=r=>u0(r,oi(r));function m0(r,e){return Li(r,t=>r.moveByGroup(t,e))}const AT=r=>m0(r,!oi(r)),CT=r=>m0(r,oi(r)),$T=r=>Li(r,e=>_l(r.state,e,!oi(r))),ET=r=>Li(r,e=>_l(r.state,e,oi(r)));function O0(r,e){return Li(r,t=>r.moveVertically(t,e))}const g0=r=>O0(r,!1),v0=r=>O0(r,!0);function b0(r,e){return Li(r,t=>r.moveVertically(t,e,c0(r)))}const cm=r=>b0(r,!1),hm=r=>b0(r,!0),RT=r=>Li(r,e=>Xr(r,e,!0)),PT=r=>Li(r,e=>Xr(r,e,!1)),LT=r=>Li(r,e=>Xr(r,e,!oi(r))),DT=r=>Li(r,e=>Xr(r,e,oi(r))),MT=r=>Li(r,e=>se.cursor(r.lineBlockAt(e.head).from)),IT=r=>Li(r,e=>se.cursor(r.lineBlockAt(e.head).to)),um=({state:r,dispatch:e})=>(e(lr(r,{anchor:0})),!0),dm=({state:r,dispatch:e})=>(e(lr(r,{anchor:r.doc.length})),!0),pm=({state:r,dispatch:e})=>(e(lr(r,{anchor:r.selection.main.anchor,head:0})),!0),mm=({state:r,dispatch:e})=>(e(lr(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),BT=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),GT=({state:r,dispatch:e})=>{let t=Tl(r).map(({from:i,to:n})=>se.range(i,Math.min(n+1,r.doc.length)));return e(r.update({selection:se.create(t),userEvent:"select"})),!0},NT=({state:r,dispatch:e})=>{let t=ns(r.selection,i=>{var n;let s=Wt(r).resolveInner(i.head,1);for(;!(s.from<i.from&&s.to>=i.to||s.to>i.to&&s.from<=i.from||!(!((n=s.parent)===null||n===void 0)&&n.parent));)s=s.parent;return se.range(s.to,s.from)});return e(lr(r,t)),!0},WT=({state:r,dispatch:e})=>{let t=r.selection,i=null;return t.ranges.length>1?i=se.create([t.main]):t.main.empty||(i=se.create([se.cursor(t.main.head)])),i?(e(lr(r,i)),!0):!1};function wl(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:i}=r,n=i.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(o);l<o?(t="delete.backward",l=pa(r,l,!1)):l>o&&(t="delete.forward",l=pa(r,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=pa(r,o,!1),a=pa(r,o,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:se.cursor(o)}});return n.changes.empty?!1:(r.dispatch(i.update(n,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?Ie.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function pa(r,e,t){if(r instanceof Ie)for(let i of r.state.facet(Ie.atomicRanges).map(n=>n(r)))i.between(e,e,(n,s)=>{n<e&&s>e&&(e=t?s:n)});return e}const y0=(r,e)=>wl(r,t=>{let{state:i}=r,n=i.doc.lineAt(t),s,o;if(!e&&t>n.from&&t<n.from+200&&!/[^ \t]/.test(s=n.text.slice(0,t-n.from))){if(s[s.length-1]=="	")return t-1;let a=ho(s,i.tabSize),l=a%Ha(i)||Ha(i);for(let f=0;f<l&&s[s.length-1-f]==" ";f++)t--;o=t}else o=ai(n.text,t-n.from,e,e)+n.from,o==t&&n.number!=(e?i.doc.lines:1)&&(o+=e?1:-1);return o}),Zc=r=>y0(r,!1),x0=r=>y0(r,!0),S0=(r,e)=>wl(r,t=>{let i=t,{state:n}=r,s=n.doc.lineAt(i),o=n.charCategorizer(i);for(let a=null;;){if(i==(e?s.to:s.from)){i==t&&s.number!=(e?n.doc.lines:1)&&(i+=e?1:-1);break}let l=ai(s.text,i-s.from,e)+s.from,f=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),c=o(f);if(a!=null&&c!=a)break;(f!=" "||i!=t)&&(a=c),i=l}return i}),_0=r=>S0(r,!1),FT=r=>S0(r,!0),w0=r=>wl(r,e=>{let t=r.lineBlockAt(e).to;return e<t?t:Math.min(r.state.doc.length,e+1)}),XT=r=>wl(r,e=>{let t=r.lineBlockAt(e).from;return e>t?t:Math.max(0,e-1)}),jT=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:st.of(["",""])},range:se.cursor(i.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},VT=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>{if(!i.empty||i.from==0||i.from==r.doc.length)return{range:i};let n=i.from,s=r.doc.lineAt(n),o=n==s.from?n-1:ai(s.text,n-s.from,!1)+s.from,a=n==s.to?n+1:ai(s.text,n-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:r.doc.slice(n,a).append(r.doc.slice(o,n))},range:se.cursor(a)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Tl(r){let e=[],t=-1;for(let i of r.selection.ranges){let n=r.doc.lineAt(i.from),s=r.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=r.doc.lineAt(i.to-1)),t>=n.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:n.from,to:s.to,ranges:[i]});t=s.number+1}return e}function T0(r,e,t){if(r.readOnly)return!1;let i=[],n=[];for(let s of Tl(r)){if(t?s.to==r.doc.length:s.from==0)continue;let o=r.doc.lineAt(t?s.to+1:s.from-1),a=o.length+1;if(t){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+r.lineBreak});for(let l of s.ranges)n.push(se.range(Math.min(r.doc.length,l.anchor+a),Math.min(r.doc.length,l.head+a)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:r.lineBreak+o.text});for(let l of s.ranges)n.push(se.range(l.anchor-a,l.head-a))}}return i.length?(e(r.update({changes:i,scrollIntoView:!0,selection:se.create(n,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const ZT=({state:r,dispatch:e})=>T0(r,e,!1),zT=({state:r,dispatch:e})=>T0(r,e,!0);function k0(r,e,t){if(r.readOnly)return!1;let i=[];for(let n of Tl(r))t?i.push({from:n.from,insert:r.doc.slice(n.from,n.to)+r.lineBreak}):i.push({from:n.to,insert:r.lineBreak+r.doc.slice(n.from,n.to)});return e(r.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const UT=({state:r,dispatch:e})=>k0(r,e,!1),qT=({state:r,dispatch:e})=>k0(r,e,!0),HT=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(Tl(e).map(({from:n,to:s})=>(n>0?n--:s<e.doc.length&&s++,{from:n,to:s}))),i=ns(e.selection,n=>r.moveVertically(n,!0)).map(t);return r.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function YT(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Wt(r).resolveInner(e),i=t.childBefore(e),n=t.childAfter(e),s;return i&&n&&i.to<=e&&n.from>=e&&(s=i.type.prop(et.closedBy))&&s.indexOf(n.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(n.from).from?{from:i.to,to:n.from}:null}const KT=Q0(!1),JT=Q0(!0);function Q0(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(n=>{let{from:s,to:o}=n,a=e.doc.lineAt(s),l=!r&&s==o&&YT(e,s);r&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let f=new bl(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=gh(f,s);for(c==null&&(c=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let h=["",ao(e,c)];return l&&h.push(ao(e,f.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:st.of(h)},range:se.cursor(s+1+h[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Sh(r,e){let t=-1;return r.changeByRange(i=>{let n=[];for(let o=i.from;o<=i.to;){let a=r.doc.lineAt(o);a.number>t&&(i.empty||i.to>a.from)&&(e(a,n,i),t=a.number),o=a.to+1}let s=r.changes(n);return{changes:n,range:se.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const ek=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),i=new bl(r,{overrideIndentation:s=>{let o=t[s];return o==null?-1:o}}),n=Sh(r,(s,o,a)=>{let l=gh(i,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let f=/^\s*/.exec(s.text)[0],c=ao(r,l);(f!=c||a.from<s.from+f.length)&&(t[s.from]=l,o.push({from:s.from,to:s.from+f.length,insert:c}))});return n.changes.empty||e(r.update(n,{userEvent:"indent"})),!0},tk=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(Sh(r,(t,i)=>{i.push({from:t.from,insert:r.facet(vl)})}),{userEvent:"input.indent"})),!0),ik=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(Sh(r,(t,i)=>{let n=/^\s*/.exec(t.text)[0];if(!n)return;let s=ho(n,r.tabSize),o=0,a=ao(r,Math.max(0,s-Ha(r)));for(;o<n.length&&o<a.length&&n.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+n.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),rk=[{key:"Ctrl-b",run:n0,shift:d0,preventDefault:!0},{key:"Ctrl-f",run:s0,shift:p0},{key:"Ctrl-p",run:l0,shift:g0},{key:"Ctrl-n",run:f0,shift:v0},{key:"Ctrl-a",run:wT,shift:MT},{key:"Ctrl-e",run:TT,shift:IT},{key:"Ctrl-d",run:x0},{key:"Ctrl-h",run:Zc},{key:"Ctrl-k",run:w0},{key:"Ctrl-Alt-h",run:_0},{key:"Ctrl-o",run:jT},{key:"Ctrl-t",run:VT},{key:"Ctrl-v",run:Vc}],nk=[{key:"ArrowLeft",run:n0,shift:d0,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:mT,shift:AT,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:ST,shift:LT,preventDefault:!0},{key:"ArrowRight",run:s0,shift:p0,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:OT,shift:CT,preventDefault:!0},{mac:"Cmd-ArrowRight",run:_T,shift:DT,preventDefault:!0},{key:"ArrowUp",run:l0,shift:g0,preventDefault:!0},{mac:"Cmd-ArrowUp",run:um,shift:pm},{mac:"Ctrl-ArrowUp",run:fm,shift:cm},{key:"ArrowDown",run:f0,shift:v0,preventDefault:!0},{mac:"Cmd-ArrowDown",run:dm,shift:mm},{mac:"Ctrl-ArrowDown",run:Vc,shift:hm},{key:"PageUp",run:fm,shift:cm},{key:"PageDown",run:Vc,shift:hm},{key:"Home",run:xT,shift:PT,preventDefault:!0},{key:"Mod-Home",run:um,shift:pm},{key:"End",run:yT,shift:RT,preventDefault:!0},{key:"Mod-End",run:dm,shift:mm},{key:"Enter",run:KT},{key:"Mod-a",run:BT},{key:"Backspace",run:Zc,shift:Zc},{key:"Delete",run:x0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:_0},{key:"Mod-Delete",mac:"Alt-Delete",run:FT},{mac:"Mod-Backspace",run:XT},{mac:"Mod-Delete",run:w0}].concat(rk.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),sk=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:vT,shift:$T},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:bT,shift:ET},{key:"Alt-ArrowUp",run:ZT},{key:"Shift-Alt-ArrowUp",run:UT},{key:"Alt-ArrowDown",run:zT},{key:"Shift-Alt-ArrowDown",run:qT},{key:"Escape",run:WT},{key:"Mod-Enter",run:JT},{key:"Alt-l",mac:"Ctrl-l",run:GT},{key:"Mod-i",run:NT,preventDefault:!0},{key:"Mod-[",run:ik},{key:"Mod-]",run:tk},{key:"Mod-Alt-\\",run:ek},{key:"Shift-Mod-k",run:HT},{key:"Shift-Mod-\\",run:QT},{key:"Mod-/",run:qw},{key:"Alt-A",run:Yw}].concat(nk);function ut(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];typeof n=="string"?r.setAttribute(i,n):n!=null&&(r[i]=n)}e++}for(;e<arguments.length;e++)A0(r,arguments[e]);return r}function A0(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)A0(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}const Om=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class is{constructor(e,t,i=0,n=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,n),this.bufferStart=i,this.normalize=s?a=>s(Om(a)):Om,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ei(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=rh(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Ti(e);let n=this.normalize(t);for(let s=0,o=i;;s++){let a=n.charCodeAt(s),l=this.match(a,o);if(l)return this.value=l,this;if(s==n.length-1)break;o==i&&s<t.length&&t.charCodeAt(s)==a&&o++}}}match(e,t){let i=null;for(let n=0;n<this.matches.length;n+=2){let s=this.matches[n],o=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?i={from:this.matches[n+1],to:t+1}:(this.matches[n]++,o=!0)),o||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:t+1}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferPos)&&(i=null),i}}typeof Symbol<"u"&&(is.prototype[Symbol.iterator]=function(){return this});const C0={from:-1,to:-1,match:/.*/.exec("")},_h="gm"+(/x/.unicode==null?"":"u");class $0{constructor(e,t,i,n=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=C0,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new E0(e,t,i,n,s);this.re=new RegExp(t,_h+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(n);this.curLineStart=o.from,this.matchPos=el(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,n=i+t[0].length;if(this.matchPos=el(this.text,n+(i==n?1:0)),i==this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,t)))return this.value={from:i,to:n,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Hf=new WeakMap;class Hn{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let n=Hf.get(e);if(!n||n.from>=i||n.to<=t){let a=new Hn(t,e.sliceString(t,i));return Hf.set(e,a),a}if(n.from==t&&n.to==i)return n;let{text:s,from:o}=n;return o>t&&(s=e.sliceString(t,o)+s,o=t),n.to<i&&(s+=e.sliceString(n.to,i)),Hf.set(e,new Hn(o,s)),new Hn(t,s.slice(t-o,i-o))}}class E0{constructor(e,t,i,n,s){this.text=e,this.to=s,this.done=!1,this.value=C0,this.matchPos=el(e,n),this.re=new RegExp(t,_h+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=Hn.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,n=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,n,t)))return this.value={from:i,to:n,match:t},this.matchPos=el(this.text,n+(i==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Hn.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&($0.prototype[Symbol.iterator]=E0.prototype[Symbol.iterator]=function(){return this});function ok(r){try{return new RegExp(r,_h),!0}catch{return!1}}function el(r,e){if(e>=r.length)return e;let t=r.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}function zc(r){let e=ut("input",{class:"cm-textfield",name:"line"}),t=ut("form",{class:"cm-gotoLine",onkeydown:n=>{n.keyCode==27?(n.preventDefault(),r.dispatch({effects:tl.of(!1)}),r.focus()):n.keyCode==13&&(n.preventDefault(),i())},onsubmit:n=>{n.preventDefault(),i()}},ut("label",r.state.phrase("Go to line"),": ",e)," ",ut("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function i(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!n)return;let{state:s}=r,o=s.doc.lineAt(s.selection.main.head),[,a,l,f,c]=n,h=f?+f.slice(1):0,d=l?+l:o.number;if(l&&c){let _=d/100;a&&(_=_*(a=="-"?-1:1)+o.number/s.doc.lines),d=Math.round(s.doc.lines*_)}else l&&a&&(d=d*(a=="-"?-1:1)+o.number);let g=s.doc.line(Math.max(1,Math.min(s.doc.lines,d)));r.dispatch({effects:tl.of(!1),selection:se.cursor(g.from+Math.max(0,Math.min(h,g.length))),scrollIntoView:!0}),r.focus()}return{dom:t}}const tl=He.define(),gm=Yt.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(tl)&&(r=t.value);return r},provide:r=>so.from(r,e=>e?zc:null)}),ak=r=>{let e=no(r,zc);if(!e){let t=[tl.of(!0)];r.state.field(gm,!1)==null&&t.push(He.appendConfig.of([gm,lk])),r.dispatch({effects:t}),e=no(r,zc)}return e&&e.dom.querySelector("input").focus(),!0},lk=Ie.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),fk={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},R0=Be.define({combine(r){return ar(r,fk,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function ck(r){let e=[mk,pk];return r&&e.push(R0.of(r)),e}const hk=Xe.mark({class:"cm-selectionMatch"}),uk=Xe.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function vm(r,e,t,i){return(t==0||r(e.sliceDoc(t-1,t))!=bt.Word)&&(i==e.doc.length||r(e.sliceDoc(i,i+1))!=bt.Word)}function dk(r,e,t,i){return r(e.sliceDoc(t,t+1))==bt.Word&&r(e.sliceDoc(i-1,i))==bt.Word}const pk=Dt.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(R0),{state:t}=r,i=t.selection;if(i.ranges.length>1)return Xe.none;let n=i.main,s,o=null;if(n.empty){if(!e.highlightWordAroundCursor)return Xe.none;let l=t.wordAt(n.head);if(!l)return Xe.none;o=t.charCategorizer(n.head),s=t.sliceDoc(l.from,l.to)}else{let l=n.to-n.from;if(l<e.minSelectionLength||l>200)return Xe.none;if(e.wholeWords){if(s=t.sliceDoc(n.from,n.to),o=t.charCategorizer(n.head),!(vm(o,t,n.from,n.to)&&dk(o,t,n.from,n.to)))return Xe.none}else if(s=t.sliceDoc(n.from,n.to).trim(),!s)return Xe.none}let a=[];for(let l of r.visibleRanges){let f=new is(t.doc,s,l.from,l.to);for(;!f.next().done;){let{from:c,to:h}=f.value;if((!o||vm(o,t,c,h))&&(n.empty&&c<=n.from&&h>=n.to?a.push(uk.range(c,h)):(c>=n.to||h<=n.from)&&a.push(hk.range(c,h)),a.length>e.maxMatches))return Xe.none}}return Xe.set(a)}},{decorations:r=>r.decorations}),mk=Ie.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Ok=({state:r,dispatch:e})=>{let{selection:t}=r,i=se.create(t.ranges.map(n=>r.wordAt(n.head)||se.cursor(n.head)),t.mainIndex);return i.eq(t)?!1:(e(r.update({selection:i})),!0)};function gk(r,e){let{main:t,ranges:i}=r.selection,n=r.wordAt(t.head),s=n&&n.from==t.from&&n.to==t.to;for(let o=!1,a=new is(r.doc,e,i[i.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new is(r.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(l=>l.from==a.value.from))continue;if(s){let l=r.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const vk=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(s=>s.from===s.to))return Ok({state:r,dispatch:e});let i=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(s=>r.sliceDoc(s.from,s.to)!=i))return!1;let n=gk(r,i);return n?(e(r.update({selection:r.selection.addRange(se.range(n.from,n.to),!1),effects:Ie.scrollIntoView(n.to)})),!0):!1},wh=Be.define({combine(r){return ar(r,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new $k(e)})}});class P0{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||ok(this.search)),this.unquoted=this.literal?this.search:this.search.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\"),this.wholeWord=!!e.wholeWord}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Sk(this):new yk(this)}getCursor(e,t=0,i){let n=e.doc?e:rt.create({doc:e});return i==null&&(i=n.doc.length),this.regexp?Fn(this,n,t,i):Wn(this,n,t,i)}}class L0{constructor(e){this.spec=e}}function Wn(r,e,t,i){return new is(e.doc,r.unquoted,t,i,r.caseSensitive?void 0:n=>n.toLowerCase(),r.wholeWord?bk(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function bk(r,e){return(t,i,n,s)=>((s>t||s+n.length<i)&&(s=Math.max(0,t-2),n=r.sliceString(s,Math.min(r.length,i+2))),(e(il(n,t-s))!=bt.Word||e(rl(n,t-s))!=bt.Word)&&(e(rl(n,i-s))!=bt.Word||e(il(n,i-s))!=bt.Word))}class yk extends L0{constructor(e){super(e)}nextMatch(e,t,i){let n=Wn(this.spec,e,i,e.doc.length).nextOverlapping();return n.done&&(n=Wn(this.spec,e,0,t).nextOverlapping()),n.done?null:n.value}prevMatchInRange(e,t,i){for(let n=i;;){let s=Math.max(t,n-1e4-this.spec.unquoted.length),o=Wn(this.spec,e,s,n),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==t)return null;n-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let i=Wn(this.spec,e,0,e.doc.length),n=[];for(;!i.next().done;){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=Wn(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}function Fn(r,e,t,i){return new $0(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?xk(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function il(r,e){return r.slice(ai(r,e,!1),e)}function rl(r,e){return r.slice(e,ai(r,e))}function xk(r){return(e,t,i)=>!i[0].length||(r(il(i.input,i.index))!=bt.Word||r(rl(i.input,i.index))!=bt.Word)&&(r(rl(i.input,i.index+i[0].length))!=bt.Word||r(il(i.input,i.index+i[0].length))!=bt.Word)}class Sk extends L0{nextMatch(e,t,i){let n=Fn(this.spec,e,i,e.doc.length).next();return n.done&&(n=Fn(this.spec,e,0,t).next()),n.done?null:n.value}prevMatchInRange(e,t,i){for(let n=1;;n++){let s=Math.max(t,i-n*1e4),o=Fn(this.spec,e,s,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==t||a.from>s+10))return a;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,(t,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:t)}matchAll(e,t){let i=Fn(this.spec,e,0,e.doc.length),n=[];for(;!i.next().done;){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=Fn(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}const lo=He.define(),Th=He.define(),Rr=Yt.define({create(r){return new Yf(Uc(r).create(),null)},update(r,e){for(let t of e.effects)t.is(lo)?r=new Yf(t.value.create(),r.panel):t.is(Th)&&(r=new Yf(r.query,t.value?kh:null));return r},provide:r=>so.from(r,e=>e.panel)});class Yf{constructor(e,t){this.query=e,this.panel=t}}const _k=Xe.mark({class:"cm-searchMatch"}),wk=Xe.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Tk=Dt.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(Rr))}update(r){let e=r.state.field(Rr);(e!=r.startState.field(Rr)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return Xe.none;let{view:t}=this,i=new Dr;for(let n=0,s=t.visibleRanges,o=s.length;n<o;n++){let{from:a,to:l}=s[n];for(;n<o-1&&l>s[n+1].from-2*250;)l=s[++n].to;r.highlight(t.state,a,l,(f,c)=>{let h=t.state.selection.ranges.some(d=>d.from==f&&d.to==c);i.add(f,c,h?wk:_k)})}return i.finish()}},{decorations:r=>r.decorations});function Oo(r){return e=>{let t=e.state.field(Rr,!1);return t&&t.query.spec.valid?r(e,t):D0(e)}}const nl=Oo((r,{query:e})=>{let{to:t}=r.state.selection.main,i=e.nextMatch(r.state,t,t);return i?(r.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Qh(r,i),userEvent:"select.search"}),!0):!1}),sl=Oo((r,{query:e})=>{let{state:t}=r,{from:i}=t.selection.main,n=e.prevMatch(t,i,i);return n?(r.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Qh(r,n),userEvent:"select.search"}),!0):!1}),kk=Oo((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:se.create(t.map(i=>se.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),Qk=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:n}=t.main,s=[],o=0;for(let a=new is(r.doc,r.sliceDoc(i,n));!a.next().done;){if(s.length>1e3)return!1;a.value.from==i&&(o=s.length),s.push(se.range(a.value.from,a.value.to))}return e(r.update({selection:se.create(s,o),userEvent:"select.search.matches"})),!0},bm=Oo((r,{query:e})=>{let{state:t}=r,{from:i,to:n}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,i,i);if(!s)return!1;let o=[],a,l,f=[];if(s.from==i&&s.to==n&&(l=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(t,s.from,s.to),f.push(Ie.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+"."))),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-l.length;a={anchor:s.from-c,head:s.to-c},f.push(Qh(r,s))}return r.dispatch({changes:o,selection:a,scrollIntoView:!!a,effects:f,userEvent:"input.replace"}),!0}),Ak=Oo((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(n=>{let{from:s,to:o}=n;return{from:s,to:o,insert:e.getReplacement(n)}});if(!t.length)return!1;let i=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:Ie.announce.of(i),userEvent:"input.replace.all"}),!0});function kh(r){return r.state.facet(wh).createPanel(r)}function Uc(r,e){var t,i,n,s;let o=r.selection.main,a=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!a)return e;let l=r.facet(wh);return new P0({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:l.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:l.caseSensitive,literal:(n=e==null?void 0:e.literal)!==null&&n!==void 0?n:l.literal,wholeWord:(s=e==null?void 0:e.wholeWord)!==null&&s!==void 0?s:l.wholeWord})}const D0=r=>{let e=r.state.field(Rr,!1);if(e&&e.panel){let t=no(r,kh);if(!t)return!1;let i=t.dom.querySelector("[main-field]");if(i&&i!=r.root.activeElement){let n=Uc(r.state,e.query.spec);n.valid&&r.dispatch({effects:lo.of(n)}),i.focus(),i.select()}}else r.dispatch({effects:[Th.of(!0),e?lo.of(Uc(r.state,e.query.spec)):He.appendConfig.of(Rk)]});return!0},M0=r=>{let e=r.state.field(Rr,!1);if(!e||!e.panel)return!1;let t=no(r,kh);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:Th.of(!1)}),!0},Ck=[{key:"Mod-f",run:D0,scope:"editor search-panel"},{key:"F3",run:nl,shift:sl,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:nl,shift:sl,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:M0,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Qk},{key:"Alt-g",run:ak},{key:"Mod-d",run:vk,preventDefault:!0}];class $k{constructor(e){this.view=e;let t=this.query=e.state.field(Rr).query.spec;this.commit=this.commit.bind(this),this.searchField=ut("input",{value:t.search,placeholder:_i(e,"Find"),"aria-label":_i(e,"Find"),class:"cm-textfield",name:"search","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ut("input",{value:t.replace,placeholder:_i(e,"Replace"),"aria-label":_i(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=ut("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit}),this.reField=ut("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit}),this.wordField=ut("input",{type:"checkbox",name:"word",checked:t.wholeWord,onchange:this.commit});function i(n,s,o){return ut("button",{class:"cm-button",name:n,onclick:s,type:"button"},o)}this.dom=ut("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,i("next",()=>nl(e),[_i(e,"next")]),i("prev",()=>sl(e),[_i(e,"previous")]),i("select",()=>kk(e),[_i(e,"all")]),ut("label",null,[this.caseField,_i(e,"match case")]),ut("label",null,[this.reField,_i(e,"regexp")]),ut("label",null,[this.wordField,_i(e,"by word")]),...e.state.readOnly?[]:[ut("br"),this.replaceField,i("replace",()=>bm(e),[_i(e,"replace")]),i("replaceAll",()=>Ak(e),[_i(e,"replace all")]),ut("button",{name:"close",onclick:()=>M0(e),"aria-label":_i(e,"close"),type:"button"},["\xD7"])]])}commit(){let e=new P0({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:lo.of(e)}))}keydown(e){US(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?sl:nl)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),bm(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(lo)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(wh).top}}function _i(r,e){return r.state.phrase(e)}const ma=30,Oa=/[\s\.,:;?!]/;function Qh(r,{from:e,to:t}){let i=r.state.doc.lineAt(e),n=r.state.doc.lineAt(t).to,s=Math.max(i.from,e-ma),o=Math.min(n,t+ma),a=r.state.sliceDoc(s,o);if(s!=i.from){for(let l=0;l<ma;l++)if(!Oa.test(a[l+1])&&Oa.test(a[l])){a=a.slice(l);break}}if(o!=n){for(let l=a.length-1;l>a.length-ma;l--)if(!Oa.test(a[l-1])&&Oa.test(a[l])){a=a.slice(0,l);break}}return Ie.announce.of(`${r.state.phrase("current match")}. ${a} ${r.state.phrase("on line")} ${i.number}.`)}const Ek=Ie.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Rk=[Rr,vn.lowest(Tk),Ek];class I0{constructor(e,t,i){this.state=e,this.pos=t,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let t=Wt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),n=t.text.slice(i-t.from,this.pos-t.from),s=n.search(G0(e,!1));return s<0?null:{from:i+s,to:this.pos,text:n.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function ym(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Pk(r){let e=Object.create(null),t=Object.create(null);for(let{label:n}of r){e[n[0]]=!0;for(let s=1;s<n.length;s++)t[n[s]]=!0}let i=ym(e)+ym(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function B0(r){let e=r.map(n=>typeof n=="string"?{label:n}:n),[t,i]=e.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:Pk(e);return n=>{let s=n.matchBefore(i);return s||n.explicit?{from:s?s.from:n.pos,options:e,validFor:t}:null}}function Lk(r,e){return t=>{for(let i=Wt(t.state).resolveInner(t.pos,-1);i;i=i.parent)if(r.indexOf(i.name)>-1)return null;return e(t)}}class xm{constructor(e,t,i){this.completion=e,this.source=t,this.match=i}}function Pr(r){return r.selection.main.head}function G0(r,e){var t;let{source:i}=r,n=e&&i[0]!="^",s=i[i.length-1]!="$";return!n&&!s?r:new RegExp(`${n?"^":""}(?:${i})${s?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":"")}function Dk(r,e,t,i){return Object.assign(Object.assign({},r.changeByRange(n=>{if(n==r.selection.main)return{changes:{from:t,to:i,insert:e},range:se.cursor(t+e.length)};let s=i-t;return!n.empty||s&&r.sliceDoc(n.from-s,n.from)!=r.sliceDoc(t,i)?{range:n}:{changes:{from:n.from-s,to:n.from,insert:e},range:se.cursor(n.from-s+e.length)}})),{userEvent:"input.complete"})}function N0(r,e){const t=e.completion.apply||e.completion.label;let i=e.source;typeof t=="string"?r.dispatch(Dk(r.state,t,i.from,i.to)):t(r,e.completion,i.from,i.to)}const Sm=new WeakMap;function Mk(r){if(!Array.isArray(r))return r;let e=Sm.get(r);return e||Sm.set(r,e=B0(r)),e}class Ik{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let i=ei(e,t),n=Ti(i);this.chars.push(i);let s=e.slice(t,t+n),o=s.toUpperCase();this.folded.push(ei(o==s?s.toLowerCase():o,0)),t+=n}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:n,precise:s,byWord:o}=this;if(t.length==1){let Qe=ei(e,0);return Qe==t[0]?[0,0,Ti(Qe)]:Qe==i[0]?[-200,0,Ti(Qe)]:null}let a=e.indexOf(this.pattern);if(a==0)return[0,0,this.pattern.length];let l=t.length,f=0;if(a<0){for(let Qe=0,pe=Math.min(e.length,200);Qe<pe&&f<l;){let Te=ei(e,Qe);(Te==t[f]||Te==i[f])&&(n[f++]=Qe),Qe+=Ti(Te)}if(f<l)return null}let c=0,h=0,d=!1,g=0,_=-1,D=-1,E=/[a-z]/.test(e),U=!0;for(let Qe=0,pe=Math.min(e.length,200),Te=0;Qe<pe&&h<l;){let we=ei(e,Qe);a<0&&(c<l&&we==t[c]&&(s[c++]=Qe),g<l&&(we==t[g]||we==i[g]?(g==0&&(_=Qe),D=Qe+1,g++):g=0));let Ne,Ve=we<255?we>=48&&we<=57||we>=97&&we<=122?2:we>=65&&we<=90?1:0:(Ne=rh(we))!=Ne.toLowerCase()?1:Ne!=Ne.toUpperCase()?2:0;(!Qe||Ve==1&&E||Te==0&&Ve!=0)&&(t[h]==we||i[h]==we&&(d=!0)?o[h++]=Qe:o.length&&(U=!1)),Te=Ve,Qe+=Ti(we)}return h==l&&o[0]==0&&U?this.result(-100+(d?-200:0),o,e):g==l&&_==0?[-200-e.length,0,D]:a>-1?[-700-e.length,a,a+this.pattern.length]:g==l?[-200+-700-e.length,_,D]:h==l?this.result(-100+(d?-200:0)+-700+(U?0:-1100),o,e):t.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,e)}result(e,t,i){let n=[e-i.length],s=1;for(let o of t){let a=o+(this.astral?Ti(ei(i,o)):1);s>1&&n[s-1]==o?n[s-1]=a:(n[s++]=o,n[s++]=a)}return n}}const Pi=Be.define({combine(r){return ar(r,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>i=>Bk(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})}});function Bk(r,e){return r?e?r+" "+e:r:e}function Gk(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,n){let s=document.createElement("span");s.className="cm-completionLabel";let{label:o}=t,a=0;for(let l=1;l<n.length;){let f=n[l++],c=n[l++];f>a&&s.appendChild(document.createTextNode(o.slice(a,f)));let h=s.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(o.slice(f,c))),h.className="cm-completionMatchedText",a=c}return a<o.length&&s.appendChild(document.createTextNode(o.slice(a))),s},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function _m(r,e,t){if(r<=t)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let n=Math.floor(e/t);return{from:n*t,to:(n+1)*t}}let i=Math.floor((r-e)/t);return{from:r-(i+1)*t,to:r-i*t}}class Nk{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:a=>this.positionInfo(a),key:this};let i=e.state.field(t),{options:n,selected:s}=i.open,o=e.state.facet(Pi);this.optionContent=Gk(o),this.optionClass=o.optionClass,this.range=_m(n.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",a=>{for(let l=a.target,f;l&&l!=this.dom;l=l.parentNode)if(l.nodeName=="LI"&&(f=/-(\d+)$/.exec(l.id))&&+f[1]<n.length){N0(e,n[+f[1]]),a.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(n,i.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=_m(t.options.length,t.selected,this.view.state.facet(Pi).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=t.options[t.selected],{info:n}=i;if(!n)return;let s=typeof n=="string"?document.createTextNode(n):n(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o)}).catch(o=>Ai(this.view.state,o,"completion info")):this.addInfoPane(s)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)n==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&Fk(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.ownerDocument.defaultView||window,i=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),s=e.getBoundingClientRect();if(s.top>Math.min(t.innerHeight,i.bottom)-10||s.bottom<Math.max(0,i.top)+10)return null;let o=this.view.textDirection==_t.RTL,a=o,l=!1,f,c="",h="",d=i.left,g=t.innerWidth-i.right;if(a&&d<Math.min(n.width,g)?a=!1:!a&&g<Math.min(n.width,d)&&(a=!0),n.width<=(a?d:g))c=Math.max(0,Math.min(s.top,t.innerHeight-n.height))-i.top+"px",f=Math.min(400,a?d:g)+"px";else{l=!0,f=Math.min(400,(o?i.right:t.innerWidth-i.left)-30)+"px";let _=t.innerHeight-i.bottom;_>=n.height||_>i.top?c=s.bottom-i.top+"px":h=i.bottom-s.top+"px"}return{top:c,bottom:h,maxWidth:f,class:l?o?"left-narrow":"right-narrow":a?"left":"right"}}positionInfo(e){this.info&&(e?(this.info.style.top=e.top,this.info.style.bottom=e.bottom,this.info.style.maxWidth=e.maxWidth,this.info.className="cm-tooltip cm-completionInfo cm-completionInfo-"+e.class):this.info.style.top="-1e6px")}createListBox(e,t,i){const n=document.createElement("ul");n.id=t,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let s=i.from;s<i.to;s++){let{completion:o,match:a}=e[s];const l=n.appendChild(document.createElement("li"));l.id=t+"-"+s,l.setAttribute("role","option");let f=this.optionClass(o);f&&(l.className=f);for(let c of this.optionContent){let h=c(o,this.view.state,a);h&&l.appendChild(h)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&n.classList.add("cm-completionListIncompleteBottom"),n}}function Wk(r){return e=>new Nk(e,r)}function Fk(r,e){let t=r.getBoundingClientRect(),i=e.getBoundingClientRect();i.top<t.top?r.scrollTop-=t.top-i.top:i.bottom>t.bottom&&(r.scrollTop+=i.bottom-t.bottom)}function wm(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function Xk(r,e){let t=[],i=0;for(let a of r)if(a.hasResult())if(a.result.filter===!1){let l=a.result.getMatch;for(let f of a.result.options){let c=[1e9-i++];if(l)for(let h of l(f))c.push(h);t.push(new xm(f,a,c))}}else{let l=new Ik(e.sliceDoc(a.from,a.to)),f;for(let c of a.result.options)(f=l.match(c.label))&&(c.boost!=null&&(f[0]+=c.boost),t.push(new xm(c,a,f)))}let n=[],s=null,o=e.facet(Pi).compareCompletions;for(let a of t.sort((l,f)=>f.match[0]-l.match[0]||o(l.completion,f.completion)))!s||s.label!=a.completion.label||s.detail!=a.completion.detail||s.type!=null&&a.completion.type!=null&&s.type!=a.completion.type||s.apply!=a.completion.apply?n.push(a):wm(a.completion)>wm(s)&&(n[n.length-1]=a),s=a.completion;return n}class Zs{constructor(e,t,i,n,s){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=n,this.selected=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Zs(this.options,Tm(t,e),this.tooltip,this.timestamp,e)}static build(e,t,i,n,s){let o=Xk(e,t);if(!o.length)return null;let a=t.facet(Pi).selectOnOpen?0:-1;if(n&&n.selected!=a&&n.selected!=-1){let l=n.options[n.selected].completion;for(let f=0;f<o.length;f++)if(o[f].completion==l){a=f;break}}return new Zs(o,Tm(i,a),{pos:e.reduce((l,f)=>f.hasResult()?Math.min(l,f.from):l,1e8),create:Wk(Ei),above:s.aboveCursor},n?n.timestamp:Date.now(),a)}map(e){return new Zs(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class ol{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new ol(Zk,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Pi),s=(i.override||t.languageDataAt("autocomplete",Pr(t)).map(Mk)).map(a=>(this.active.find(f=>f.source==a)||new di(a,this.active.some(f=>f.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((a,l)=>a==this.active[l])&&(s=this.active);let o=e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!jk(s,this.active)?Zs.build(s,t,this.id,this.open,i):this.open&&e.docChanged?this.open.map(e.changes):this.open;!o&&s.every(a=>a.state!=1)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new di(a.source,0):a));for(let a of e.effects)a.is(F0)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new ol(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:Vk}}function jk(r,e){if(r==e)return!0;for(let t=0,i=0;;){for(;t<r.length&&!r[t].hasResult;)t++;for(;i<e.length&&!e[i].hasResult;)i++;let n=t==r.length,s=i==e.length;if(n||s)return n==s;if(r[t++].result!=e[i++].result)return!1}}const Vk={"aria-autocomplete":"list"};function Tm(r,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(t["aria-activedescendant"]=r+"-"+e),t}const Zk=[];function qc(r){return r.isUserEvent("input.type")?"input":r.isUserEvent("delete.backward")?"delete":null}class di{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=qc(e),n=this;i?n=n.handleUserEvent(e,i,t):e.docChanged?n=n.handleChange(e):e.selection&&n.state!=0&&(n=new di(n.source,0));for(let s of e.effects)if(s.is(Ah))n=new di(n.source,1,s.value?Pr(e.state):-1);else if(s.is(al))n=new di(n.source,0);else if(s.is(W0))for(let o of s.value)o.source==n.source&&(n=o);return n}handleUserEvent(e,t,i){return t=="delete"||!i.activateOnTyping?this.map(e.changes):new di(this.source,1)}handleChange(e){return e.changes.touchesRange(Pr(e.startState))?new di(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new di(this.source,this.state,e.mapPos(this.explicitPos))}}class zs extends di{constructor(e,t,i,n,s){super(e,2,t),this.result=i,this.from=n,this.to=s}hasResult(){return!0}handleUserEvent(e,t,i){var n;let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=Pr(e.state);if((this.explicitPos<0?a<=s:a<this.from)||a>o||t=="delete"&&Pr(e.startState)==this.from)return new di(this.source,t=="input"&&i.activateOnTyping?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),f;return zk(this.result.validFor,e.state,s,o)?new zs(this.source,l,this.result,s,o):this.result.update&&(f=this.result.update(this.result,s,o,new I0(e.state,a,l>=0)))?new zs(this.source,l,f,f.from,(n=f.to)!==null&&n!==void 0?n:Pr(e.state)):new di(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new di(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new zs(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function zk(r,e,t,i){if(!r)return!1;let n=e.sliceDoc(t,i);return typeof r=="function"?r(n,t,i,e):G0(r,!0).test(n)}const Ah=He.define(),al=He.define(),W0=He.define({map(r,e){return r.map(t=>t.map(e))}}),F0=He.define(),Ei=Yt.define({create(){return ol.start()},update(r,e){return r.update(e)},provide:r=>[hh.from(r,e=>e.tooltip),Ie.contentAttributes.from(r,e=>e.attrs)]});function ga(r,e="option"){return t=>{let i=t.state.field(Ei,!1);if(!i||!i.open||Date.now()-i.open.timestamp<t.state.facet(Pi).interactionDelay)return!1;let n=1,s;e=="page"&&(s=P_(t,i.open.tooltip))&&(n=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+n*(r?1:-1):r?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),t.dispatch({effects:F0.of(a)}),!0}}const Uk=r=>{let e=r.state.field(Ei,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<r.state.facet(Pi).interactionDelay?!1:(N0(r,e.open.options[e.open.selected]),!0)},qk=r=>r.state.field(Ei,!1)?(r.dispatch({effects:Ah.of(!0)}),!0):!1,Hk=r=>{let e=r.state.field(Ei,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(r.dispatch({effects:al.of(null)}),!0)};class Yk{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const km=50,Kk=50,Jk=1e3,eQ=Dt.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of r.state.field(Ei).active)e.state==1&&this.startQuery(e)}update(r){let e=r.state.field(Ei);if(!r.selectionSet&&!r.docChanged&&r.startState.field(Ei)==e)return;let t=r.transactions.some(i=>(i.selection||i.docChanged)&&!qc(i));for(let i=0;i<this.running.length;i++){let n=this.running[i];if(t||n.updates.length+r.transactions.length>Kk&&Date.now()-n.time>Jk){for(let s of n.context.abortListeners)try{s()}catch(o){Ai(this.view.state,o)}n.context.abortListeners=null,this.running.splice(i--,1)}else n.updates.push(...r.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(n=>n.active.source==i.source))?setTimeout(()=>this.startUpdate(),km):-1,this.composing!=0)for(let i of r.transactions)qc(i)=="input"?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:r}=this.view,e=r.field(Ei);for(let t of e.active)t.state==1&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t)}startQuery(r){let{state:e}=this.view,t=Pr(e),i=new I0(e,t,r.explicitPos==t),n=new Yk(r,i);this.running.push(n),Promise.resolve(r.source(i)).then(s=>{n.context.aborted||(n.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:al.of(null)}),Ai(this.view.state,s)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),km))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Pi);for(let i=0;i<this.running.length;i++){let n=this.running[i];if(n.done===void 0)continue;if(this.running.splice(i--,1),n.done){let o=new zs(n.active.source,n.active.explicitPos,n.done,n.done.from,(r=n.done.to)!==null&&r!==void 0?r:Pr(n.updates.length?n.updates[0].startState:this.view.state));for(let a of n.updates)o=o.update(a,t);if(o.hasResult()){e.push(o);continue}}let s=this.view.state.field(Ei).active.find(o=>o.source==n.active.source);if(s&&s.state==1)if(n.done==null){let o=new di(n.active.source,0);for(let a of n.updates)o=o.update(a,t);o.state!=1&&e.push(o)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:W0.of(e)})}},{eventHandlers:{blur(){let r=this.view.state.field(Ei,!1);r&&r.tooltip&&this.view.state.facet(Pi).closeOnBlur&&this.view.dispatch({effects:al.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Ah.of(!1)}),20),this.composing=0}}}),X0=Ie.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class tQ{constructor(e,t,i,n){this.field=e,this.line=t,this.from=i,this.to=n}}class Ch{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,ii.TrackDel),i=e.mapPos(this.to,1,ii.TrackDel);return t==null||i==null?null:new Ch(this.field,t,i)}}class $h{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],n=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let l of this.lines){if(i.length){let f=o,c=/^\t*/.exec(l)[0].length;for(let h=0;h<c;h++)f+=e.facet(vl);n.push(t+f.length-c),l=f+l.slice(c)}i.push(l),t+=l.length+1}let a=this.fieldPositions.map(l=>new Ch(l.field,n[l.line]+l.from,n[l.line]+l.to));return{text:i,ranges:a}}static parse(e){let t=[],i=[],n=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){let a=s[1]?+s[1]:null,l=s[2]||s[3]||"",f=-1;for(let c=0;c<t.length;c++)(a!=null?t[c].seq==a:l?t[c].name==l:!1)&&(f=c);if(f<0){let c=0;for(;c<t.length&&(a==null||t[c].seq!=null&&t[c].seq<a);)c++;t.splice(c,0,{seq:a,name:l}),f=c;for(let h of n)h.field>=f&&h.field++}n.push(new tQ(f,i.length,s.index,s.index+l.length)),o=o.slice(0,s.index)+l+o.slice(s.index+s[0].length)}for(let a;a=/([$#])\\{/.exec(o);){o=o.slice(0,a.index)+a[1]+"{"+o.slice(a.index+a[0].length);for(let l of n)l.line==i.length&&l.from>a.index&&(l.from--,l.to--)}i.push(o)}return new $h(i,n)}}let iQ=Xe.widget({widget:new class extends mr{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),rQ=Xe.mark({class:"cm-snippetField"});class ss{constructor(e,t){this.ranges=e,this.active=t,this.deco=Xe.set(e.map(i=>(i.from==i.to?iQ:rQ).range(i.from,i.to)))}map(e){let t=[];for(let i of this.ranges){let n=i.map(e);if(!n)return null;t.push(n)}return new ss(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const go=He.define({map(r,e){return r&&r.map(e)}}),nQ=He.define(),fo=Yt.define({create(){return null},update(r,e){for(let t of e.effects){if(t.is(go))return t.value;if(t.is(nQ)&&r)return new ss(r.ranges,t.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>Ie.decorations.from(r,e=>e?e.deco:Xe.none)});function Eh(r,e){return se.create(r.filter(t=>t.field==e).map(t=>se.range(t.from,t.to)))}function sQ(r){let e=$h.parse(r);return(t,i,n,s)=>{let{text:o,ranges:a}=e.instantiate(t.state,n),l={changes:{from:n,to:s,insert:st.of(o)},scrollIntoView:!0};if(a.length&&(l.selection=Eh(a,0)),a.length>1){let f=new ss(a,0),c=l.effects=[go.of(f)];t.state.field(fo,!1)===void 0&&c.push(He.appendConfig.of([fo,cQ,hQ,X0]))}t.dispatch(t.state.update(l))}}function j0(r){return({state:e,dispatch:t})=>{let i=e.field(fo,!1);if(!i||r<0&&i.active==0)return!1;let n=i.active+r,s=r>0&&!i.ranges.some(o=>o.field==n+r);return t(e.update({selection:Eh(i.ranges,n),effects:go.of(s?null:new ss(i.ranges,n))})),!0}}const oQ=({state:r,dispatch:e})=>r.field(fo,!1)?(e(r.update({effects:go.of(null)})),!0):!1,aQ=j0(1),lQ=j0(-1),fQ=[{key:"Tab",run:aQ,shift:lQ},{key:"Escape",run:oQ}],Qm=Be.define({combine(r){return r.length?r[0]:fQ}}),cQ=vn.highest(gl.compute([Qm],r=>r.facet(Qm)));function Ii(r,e){return Object.assign(Object.assign({},e),{apply:sQ(r)})}const hQ=Ie.domEventHandlers({mousedown(r,e){let t=e.state.field(fo,!1),i;if(!t||(i=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let n=t.ranges.find(s=>s.from<=i&&s.to>=i);return!n||n.field==t.active?!1:(e.dispatch({selection:Eh(t.ranges,n.field),effects:go.of(t.ranges.some(s=>s.field>n.field)?new ss(t.ranges,n.field):null)}),!0)}}),co={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},hn=He.define({map(r,e){let t=e.mapPos(r,-1,ii.TrackAfter);return t==null?void 0:t}}),Rh=He.define({map(r,e){return e.mapPos(r)}}),Ph=new class extends mn{};Ph.startSide=1;Ph.endSide=-1;const V0=Yt.define({create(){return at.empty},update(r,e){if(e.selection){let t=e.state.doc.lineAt(e.selection.main.head).from,i=e.startState.doc.lineAt(e.startState.selection.main.head).from;t!=e.changes.mapPos(i,-1)&&(r=at.empty)}r=r.map(e.changes);for(let t of e.effects)t.is(hn)?r=r.update({add:[Ph.range(t.value,t.value+1)]}):t.is(Rh)&&(r=r.update({filter:i=>i!=t.value}));return r}});function uQ(){return[pQ,V0]}const Kf="()[]{}<>";function Z0(r){for(let e=0;e<Kf.length;e+=2)if(Kf.charCodeAt(e)==r)return Kf.charAt(e+1);return rh(r<128?r:r+1)}function z0(r,e){return r.languageDataAt("closeBrackets",e)[0]||co}const dQ=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),pQ=Ie.inputHandler.of((r,e,t,i)=>{if((dQ?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let n=r.state.selection.main;if(i.length>2||i.length==2&&Ti(ei(i,0))==1||e!=n.from||t!=n.to)return!1;let s=gQ(r.state,i);return s?(r.dispatch(s),!0):!1}),mQ=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=z0(r,r.selection.main.head).brackets||co.brackets,n=null,s=r.changeByRange(o=>{if(o.empty){let a=vQ(r.doc,o.head);for(let l of i)if(l==a&&kl(r.doc,o.head)==Z0(ei(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:se.cursor(o.head-l.length)}}return{range:n=o}});return n||e(r.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},OQ=[{key:"Backspace",run:mQ}];function gQ(r,e){let t=z0(r,r.selection.main.head),i=t.brackets||co.brackets;for(let n of i){let s=Z0(ei(n,0));if(e==n)return s==n?xQ(r,n,i.indexOf(n+n+n)>-1,t):bQ(r,n,s,t.before||co.before);if(e==s&&U0(r,r.selection.main.from))return yQ(r,n,s)}return null}function U0(r,e){let t=!1;return r.field(V0).between(0,r.doc.length,i=>{i==e&&(t=!0)}),t}function kl(r,e){let t=r.sliceString(e,e+2);return t.slice(0,Ti(ei(t,0)))}function vQ(r,e){let t=r.sliceString(e-2,e);return Ti(ei(t,0))==t.length?t:t.slice(1)}function bQ(r,e,t,i){let n=null,s=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:hn.of(o.to+e.length),range:se.range(o.anchor+e.length,o.head+e.length)};let a=kl(r.doc,o.head);return!a||/\s/.test(a)||i.indexOf(a)>-1?{changes:{insert:e+t,from:o.head},effects:hn.of(o.head+e.length),range:se.cursor(o.head+e.length)}:{range:n=o}});return n?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function yQ(r,e,t){let i=null,n=r.selection.ranges.map(s=>s.empty&&kl(r.doc,s.head)==t?se.cursor(s.head+t.length):i=s);return i?null:r.update({selection:se.create(n,r.selection.mainIndex),scrollIntoView:!0,effects:r.selection.ranges.map(({from:s})=>Rh.of(s))})}function xQ(r,e,t,i){let n=i.stringPrefixes||co.stringPrefixes,s=null,o=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:e,from:a.to}],effects:hn.of(a.to+e.length),range:se.range(a.anchor+e.length,a.head+e.length)};let l=a.head,f=kl(r.doc,l),c;if(f==e){if(Am(r,l))return{changes:{insert:e+e,from:l},effects:hn.of(l+e.length),range:se.cursor(l+e.length)};if(U0(r,l)){let h=t&&r.sliceDoc(l,l+e.length*3)==e+e+e;return{range:se.cursor(l+e.length*(h?3:1)),effects:Rh.of(l)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(c=Cm(r,l-2*e.length,n))>-1&&Am(r,c))return{changes:{insert:e+e+e+e,from:l},effects:hn.of(l+e.length),range:se.cursor(l+e.length)};if(r.charCategorizer(l)(f)!=bt.Word&&Cm(r,l,n)>-1&&!SQ(r,l,e,n))return{changes:{insert:e+e,from:l},effects:hn.of(l+e.length),range:se.cursor(l+e.length)}}return{range:s=a}});return s?null:r.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Am(r,e){let t=Wt(r).resolveInner(e+1);return t.parent&&t.from==e}function SQ(r,e,t,i){let n=Wt(r).resolveInner(e,-1),s=i.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=r.sliceDoc(n.from,Math.min(n.to,n.from+t.length+s)),l=a.indexOf(t);if(!l||l>-1&&i.indexOf(a.slice(0,l))>-1){let c=n.firstChild;for(;c&&c.from==n.from&&c.to-c.from>t.length+l;){if(r.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let f=n.to==e&&n.parent;if(!f)break;n=f}return!1}function Cm(r,e,t){let i=r.charCategorizer(e);if(i(r.sliceDoc(e-1,e))!=bt.Word)return e;for(let n of t){let s=e-n.length;if(r.sliceDoc(s,e)==n&&i(r.sliceDoc(s-1,s))!=bt.Word)return s}return-1}function _Q(r={}){return[Ei,Pi.of(r),eQ,wQ,X0]}const q0=[{key:"Ctrl-Space",run:qk},{key:"Escape",run:Hk},{key:"ArrowDown",run:ga(!0)},{key:"ArrowUp",run:ga(!1)},{key:"PageDown",run:ga(!0,"page")},{key:"PageUp",run:ga(!1,"page")},{key:"Enter",run:Uk}],wQ=vn.highest(gl.computeN([Pi],r=>r.facet(Pi).defaultKeymap?[q0]:[]));class TQ{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class fn{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let n=e,s=i.facet(Zn).markerFilter;s&&(n=s(n));let o=Xe.set(n.map(a=>a.from==a.to||a.from==a.to-1&&i.doc.lineAt(a.from).to==a.from?Xe.widget({widget:new DQ(a),diagnostic:a}).range(a.from):Xe.mark({attributes:{class:"cm-lintRange cm-lintRange-"+a.severity},diagnostic:a}).range(a.from,a.to)),!0);return new fn(o,t,rs(o))}}function rs(r,e=null,t=0){let i=null;return r.between(t,1e9,(n,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new TQ(n,s,o.diagnostic),!1}),i}function kQ(r,e){return!!(r.effects.some(t=>t.is(Lh))||r.changes.touchesRange(e.pos))}function H0(r,e){return r.field(Qi,!1)?e:e.concat(He.appendConfig.of([Qi,Ie.decorations.compute([Qi],t=>{let{selected:i,panel:n}=t.field(Qi);return!i||!n||i.from==i.to?Xe.none:Xe.set([AQ.range(i.from,i.to)])}),R_(CQ,{hideOn:kQ}),IQ]))}function QQ(r,e){return{effects:H0(r,[Lh.of(e)])}}const Lh=He.define(),Dh=He.define(),Y0=He.define(),Qi=Yt.define({create(){return new fn(Xe.none,null,null)},update(r,e){if(e.docChanged){let t=r.diagnostics.map(e.changes),i=null;if(r.selected){let n=e.changes.mapPos(r.selected.from,1);i=rs(t,r.selected.diagnostic,n)||rs(t,null,n)}r=new fn(t,r.panel,i)}for(let t of e.effects)t.is(Lh)?r=fn.init(t.value,r.panel,e.state):t.is(Dh)?r=new fn(r.diagnostics,t.value?Ql.open:null,r.selected):t.is(Y0)&&(r=new fn(r.diagnostics,r.panel,t.value));return r},provide:r=>[so.from(r,e=>e.panel),Ie.decorations.from(r,e=>e.diagnostics)]}),AQ=Xe.mark({class:"cm-lintRange cm-lintRange-active"});function CQ(r,e,t){let{diagnostics:i}=r.state.field(Qi),n=[],s=2e8,o=0;i.between(e-(t<0?1:0),e+(t>0?1:0),(l,f,{spec:c})=>{e>=l&&e<=f&&(l==f||(e>l||t>0)&&(e<f||t<0))&&(n.push(c.diagnostic),s=Math.min(l,s),o=Math.max(f,o))});let a=r.state.facet(Zn).tooltipFilter;return a&&(n=a(n)),n.length?{pos:s,end:o,above:r.state.doc.lineAt(s).to<o,create(){return{dom:$Q(r,n)}}}:null}function $Q(r,e){return ut("ul",{class:"cm-tooltip-lint"},e.map(t=>J0(r,t,!1)))}const EQ=r=>{let e=r.state.field(Qi,!1);(!e||!e.panel)&&r.dispatch({effects:H0(r.state,[Dh.of(!0)])});let t=no(r,Ql.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},$m=r=>{let e=r.state.field(Qi,!1);return!e||!e.panel?!1:(r.dispatch({effects:Dh.of(!1)}),!0)},RQ=r=>{let e=r.state.field(Qi,!1);if(!e)return!1;let t=r.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(r.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},PQ=[{key:"Mod-Shift-m",run:EQ},{key:"F8",run:RQ}],LQ=Dt.fromClass(class{constructor(r){this.view=r,this.timeout=-1,this.set=!0;let{delay:e}=r.state.facet(Zn);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let r=Date.now();if(r<this.lintTime-10)setTimeout(this.run,this.lintTime-r);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(Zn);Promise.all(t.map(i=>Promise.resolve(i(this.view)))).then(i=>{let n=i.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(QQ(this.view.state,n))},i=>{Ai(this.view.state,i)})}}update(r){let e=r.state.facet(Zn);(r.docChanged||e!=r.startState.facet(Zn))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Zn=Be.define({combine(r){return Object.assign({sources:r.map(e=>e.source)},ar(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null}))},enables:LQ});function K0(r){let e=[];if(r)e:for(let{name:t}of r){for(let i=0;i<t.length;i++){let n=t[i];if(/[a-zA-Z]/.test(n)&&!e.some(s=>s.toLowerCase()==n.toLowerCase())){e.push(n);continue e}}e.push("")}return e}function J0(r,e,t){var i;let n=t?K0(e.actions):[];return ut("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},ut("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let a=h=>{h.preventDefault();let d=rs(r.state.field(Qi).diagnostics,e);d&&s.apply(r,d.from,d.to)},{name:l}=s,f=n[o]?l.indexOf(n[o]):-1,c=f<0?l:[l.slice(0,f),ut("u",l.slice(f,f+1)),l.slice(f+1)];return ut("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${l}${f<0?"":` (access key "${n[o]})"`}.`},c)}),e.source&&ut("div",{class:"cm-diagnosticSource"},e.source))}class DQ extends mr{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return ut("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Em{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=J0(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Ql{constructor(e){this.view=e,this.items=[];let t=n=>{if(n.keyCode==27)$m(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=K0(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==n.keyCode){let l=rs(this.view.state.field(Qi).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;n.preventDefault()},i=n=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(n.target)&&this.moveSelection(s)};this.list=ut("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=ut("div",{class:"cm-panel-lint"},this.list,ut("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>$m(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(Qi).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Qi),i=0,n=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,a,{spec:l})=>{let f=-1,c;for(let h=i;h<this.items.length;h++)if(this.items[h].diagnostic==l.diagnostic){f=h;break}f<0?(c=new Em(this.view,l.diagnostic),this.items.splice(i,0,c),n=!0):(c=this.items[f],f>i&&(this.items.splice(i,f-i),n=!0)),t&&c.diagnostic==t.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new Em(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:a})=>{o.top<a.top?this.list.scrollTop-=a.top-o.top:o.bottom>a.bottom&&(this.list.scrollTop+=o.bottom-a.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Qi),i=rs(t.diagnostics,this.items[e].diagnostic);!i||this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Y0.of(i)})}static open(e){return new Ql(e)}}function MQ(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function Jf(r){return MQ(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const IQ=Ie.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Jf("#d11")},".cm-lintRange-warning":{backgroundImage:Jf("orange")},".cm-lintRange-info":{backgroundImage:Jf("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),BQ=(()=>[F_(),V_(),f_(),sT(),Rw(),YS(),r_(),rt.allowMultipleSelections.of(!0),bw(),bh(Mw,{fallback:!0}),Xw(),uQ(),_Q(),x_(),w_(),m_(),ck(),gl.of([...OQ,...sk,...Ck,...pT,...Cw,...q0,...PQ])])();class ll{constructor(e,t,i,n,s,o,a,l,f,c=0,h){this.p=e,this.stack=t,this.state=i,this.reducePos=n,this.pos=s,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=f,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let n=e.parser.context;return new ll(e,[],t,i,i,0,[],0,n?new Rm(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){let t=e>>19,i=e&65535,{parser:n}=this.p,s=n.dynamicPrecedence(i);if(s&&(this.score+=s),t==0){this.pushState(n.getGoto(this.state,i,!0),this.reducePos),i<n.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),this.reduceContext(i,this.reducePos);return}let o=this.stack.length-(t-1)*3-(e&262144?6:0),a=this.stack[o-2],l=this.stack[o-1],f=this.bufferBase+this.buffer.length-l;if(i<n.minRepeatTerm||e&131072){let c=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,a,c,f+4,!0)}if(e&262144)this.state=this.stack[o];else{let c=this.stack[o-3];this.state=n.getGoto(c,i,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(i,a)}storeNode(e,t,i,n=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(t==i)return;if(o.buffer[a-2]>=t){o.buffer[a-2]=i;return}}}if(!s||this.pos==i)this.buffer.push(e,t,i,n);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,n>4&&(n-=4);this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=i,this.buffer[o+3]=n}}shift(e,t,i){let n=this.pos;if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let s=e,{parser:o}=this.p;(i>this.pos||t<=o.maxNode)&&(this.pos=i,o.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,n),this.shiftContext(t,n),t<=o.maxNode&&this.buffer.push(t,n,i,4)}else this.pos=i,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,i,4)}apply(e,t,i){e&65536?this.reduce(e):this.shift(e,t,i)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let n=this.pos;this.reducePos=this.pos=n+e.length,this.pushState(t,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),n=e.bufferBase+t;for(;e&&n==e.bufferBase;)e=e.parent;return new ll(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new GQ(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if((i&65536)==0)return!0;if(i==0)return!1;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>4<<1||this.stack.length>=120){let n=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&n.push(t[s],o);if(this.stack.length<120)for(let s=0;n.length<4<<1&&s<t.length;s+=2){let o=t[s+1];n.some((a,l)=>l&1&&a==o)||n.push(t[s],o)}t=n}let i=[];for(let n=0;n<t.length&&i.length<4;n+=2){let s=t[n+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[n],this.pos),o.score-=200,i.push(o)}return i}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if((e&65536)==0)return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let i=e>>19,n=e&65535,s=this.stack.length-i*3;if(s<0||t.getGoto(this.stack[s],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Rm(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Rm{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}var Pm;(function(r){r[r.Insert=200]="Insert",r[r.Delete=190]="Delete",r[r.Reduce=100]="Reduce",r[r.MaxNext=4]="MaxNext",r[r.MaxInsertStackDepth=300]="MaxInsertStackDepth",r[r.DampenInsertStackDepth=120]="DampenInsertStackDepth"})(Pm||(Pm={}));class GQ{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=n}}class fl{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new fl(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new fl(this.stack,this.pos,this.index)}}class Qa{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Lm=new Qa;class NQ{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Lm,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,n=this.rangeIndex,s=this.pos+e;for(;s<i.from;){if(!n)return null;let o=this.ranges[--n];s-=i.from-o.to,i=o}for(;t<0?s>i.to:s>=i.to;){if(n==this.ranges.length-1)return null;let o=this.ranges[++n];s+=o.from-i.to,i=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,i,n;if(t>=0&&t<this.chunk.length)i=this.pos+e,n=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(i=s,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=i;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Lm,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let n of this.ranges){if(n.from>=t)break;n.to>e&&(i+=this.input.read(Math.max(n.from,e),Math.min(n.to,t)))}return i}}class Aa{constructor(e,t){this.data=e,this.id=t}token(e,t){WQ(this.data,e,t,this.id)}}Aa.prototype.contextual=Aa.prototype.fallback=Aa.prototype.extend=!1;class vo{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function WQ(r,e,t,i){let n=0,s=1<<i,{parser:o}=t.p,{dialect:a}=o;e:for(;(s&r[n])!=0;){let l=r[n+1];for(let d=n+3;d<l;d+=2)if((r[d+1]&s)>0){let g=r[d];if(a.allows(g)&&(e.token.value==-1||e.token.value==g||o.overrides(g,e.token.value))){e.acceptToken(g);break}}let f=e.next,c=0,h=r[n+2];if(e.next<0&&h>c&&r[l+h*3-3]==65535){n=r[l+h*3-1];continue e}for(;c<h;){let d=c+h>>1,g=l+d+(d<<1),_=r[g],D=r[g+1];if(f<_)h=d;else if(f>=D)c=d+1;else{n=r[g+2],e.advance();continue e}}break}}function va(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let i=0,n=0;i<r.length;){let s=0;for(;;){let o=r.charCodeAt(i++),a=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),s+=l,a)break;s*=46}t?t[n++]=s:t=new e(s)}return t}const Bi=typeof process<"u"&&process.env&&/\bparse\b/.test(process.env.LOG);let ec=null;var Dm;(function(r){r[r.Margin=25]="Margin"})(Dm||(Dm={}));function Mm(r,e,t){let i=r.cursor(qt.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(r.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:r.length}}class FQ{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Mm(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Mm(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],n=this.index[t];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[n],o=this.start[t]+i.positions[n];if(o>e)return this.nextStart=o,null;if(s instanceof Lt){if(o==e){if(o<this.safeFrom)return null;let a=o+s.length;if(a<=this.safeTo){let l=s.prop(et.lookAhead);if(!l||a+l<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class XQ{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new Qa)}getActions(e){let t=0,i=null,{parser:n}=e.p,{tokenizers:s}=n,o=n.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,l=0;for(let f=0;f<s.length;f++){if((1<<f&o)==0)continue;let c=s[f],h=this.tokens[f];if(!(i&&!c.fallback)&&((c.contextual||h.start!=e.pos||h.mask!=o||h.context!=a)&&(this.updateCachedToken(h,c,e),h.mask=o,h.context=a),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let d=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!c.extend&&(i=h,t>d))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!i&&e.pos==this.stream.end&&(i=new Qa,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Qa,{pos:i,p:n}=e;return t.start=i,t.end=Math.min(i+1,n.stream.end),t.value=i==n.stream.end?n.parser.eofTerm:0,t}updateCachedToken(e,t,i){let n=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(n,e),i),e.value>-1){let{parser:s}=i.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let a=s.specializers[o](this.stream.read(e.start,e.end),i);if(a>=0&&i.p.parser.dialect.allows(a>>1)){(a&1)==0?e.value=a>>1:e.extended=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(n+1)}putAction(e,t,i,n){for(let s=0;s<n;s+=3)if(this.actions[s]==e)return n;return this.actions[n++]=e,this.actions[n++]=t,this.actions[n++]=i,n}addActions(e,t,i,n){let{state:s}=e,{parser:o}=e.p,{data:a}=o;for(let l=0;l<2;l++)for(let f=o.stateSlot(s,l?2:1);;f+=3){if(a[f]==65535)if(a[f+1]==1)f=ur(a,f+2);else{n==0&&a[f+1]==2&&(n=this.putAction(ur(a,f+2),t,i,n));break}a[f]==t&&(n=this.putAction(ur(a,f+1),t,i,n))}return n}}var Im;(function(r){r[r.Distance=5]="Distance",r[r.MaxRemainingPerStep=3]="MaxRemainingPerStep",r[r.MinBufferLengthPrune=500]="MinBufferLengthPrune",r[r.ForceReduceLimit=10]="ForceReduceLimit",r[r.CutDepth=15e3]="CutDepth",r[r.CutTo=9e3]="CutTo"})(Im||(Im={}));class jQ{constructor(e,t,i,n){this.parser=e,this.input=t,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.stream=new NQ(t,n),this.tokens=new XQ(e,this.stream),this.topTerm=e.top[1];let{from:s}=n[0];this.stacks=[ll.start(this,e.top[0],s)],this.fragments=i.length&&this.stream.end-s>e.bufferLength*4?new FQ(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],n,s;for(let o=0;o<e.length;o++){let a=e[o];for(;;){if(this.tokens.mainToken=null,a.pos>t)i.push(a);else{if(this.advanceStack(a,i,e))continue;{n||(n=[],s=[]),n.push(a);let l=this.tokens.getMainToken(a);s.push(l.value,l.end)}}break}}if(!i.length){let o=n&&zQ(n);if(o)return this.stackToTree(o);if(this.parser.strict)throw Bi&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&n){let o=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,s,i);if(o)return this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((a,l)=>l.score-a.score);i.length>o;)i.pop();i.some(a=>a.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let o=0;o<i.length-1;o++){let a=i[o];for(let l=o+1;l<i.length;l++){let f=i[l];if(a.sameState(f)||a.buffer.length>500&&f.buffer.length>500)if((a.score-f.score||a.buffer.length-f.buffer.length)>0)i.splice(l--,1);else{i.splice(o--,1);continue e}}}}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let n=e.pos,{parser:s}=this,o=Bi?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let f=e.curContext&&e.curContext.tracker.strict,c=f?e.curContext.hash:0;for(let h=this.fragments.nodeAt(n);h;){let d=this.parser.nodeSet.types[h.type.id]==h.type?s.getGoto(e.state,h.type.id):-1;if(d>-1&&h.length&&(!f||(h.prop(et.contextHash)||0)==c))return e.useNode(h,d),Bi&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(h.type.id)})`),!0;if(!(h instanceof Lt)||h.children.length==0||h.positions[0]>0)break;let g=h.children[0];if(g instanceof Lt&&h.positions[0]==0)h=g;else break}}let a=s.stateSlot(e.state,4);if(a>0)return e.reduce(a),Bi&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(a&65535)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let f=0;f<l.length;){let c=l[f++],h=l[f++],d=l[f++],g=f==l.length||!i,_=g?e:e.split();if(_.apply(c,h,d),Bi&&console.log(o+this.stackID(_)+` (via ${(c&65536)==0?"shift":`reduce of ${s.getName(c&65535)}`} for ${s.getName(h)} @ ${n}${_==e?"":", split"})`),g)return!0;_.pos>n?t.push(_):i.push(_)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return Bm(e,t),!0}}runRecovery(e,t,i){let n=null,s=!1;for(let o=0;o<e.length;o++){let a=e[o],l=t[o<<1],f=t[(o<<1)+1],c=Bi?this.stackID(a)+" -> ":"";if(a.deadEnd&&(s||(s=!0,a.restart(),Bi&&console.log(c+this.stackID(a)+" (restarted)"),this.advanceFully(a,i))))continue;let h=a.split(),d=c;for(let g=0;h.forceReduce()&&g<10&&(Bi&&console.log(d+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,i));g++)Bi&&(d=this.stackID(h)+" -> ");for(let g of a.recoverByInsert(l))Bi&&console.log(c+this.stackID(g)+" (via recover-insert)"),this.advanceFully(g,i);this.stream.end>a.pos?(f==a.pos&&(f++,l=0),a.recoverByDelete(l,f),Bi&&console.log(c+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),Bm(a,i)):(!n||n.score<a.score)&&(n=a)}return n}stackToTree(e){return e.close(),Lt.build({buffer:fl.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(ec||(ec=new WeakMap)).get(e);return t||ec.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Bm(r,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==r.pos&&i.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}class VQ{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}const tc=r=>r;class ZQ{constructor(e){this.start=e.start,this.shift=e.shift||tc,this.reduce=e.reduce||tc,this.reuse=e.reuse||tc,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class cl extends Eg{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (${14})`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let a=0;a<e.repeatNodeCount;a++)t.push("");let i=Object.keys(e.topRules).map(a=>e.topRules[a][1]),n=[];for(let a=0;a<t.length;a++)n.push([]);function s(a,l,f){n[a].push([l,l.deserialize(String(f))])}if(e.nodeProps)for(let a of e.nodeProps){let l=a[0];typeof l=="string"&&(l=et[l]);for(let f=1;f<a.length;){let c=a[f++];if(c>=0)s(c,l,a[f++]);else{let h=a[f+-c];for(let d=-c;d>0;d--)s(a[f++],l,h);f++}}}this.nodeSet=new dh(t.map((a,l)=>Oi.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:n[l],top:i.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=Ag;let o=va(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(Nm),this.states=va(e.states,Uint32Array),this.data=va(e.stateData),this.goto=va(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(a=>typeof a=="number"?new Aa(o,a):a),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let n=new jQ(this,e,t,i);for(let s of this.wrappers)n=s(n,e,t,i);return n}getGoto(e,t,i=!1){let n=this.goto;if(t>=n[0])return-1;for(let s=n[t+1];;){let o=n[s++],a=o&1,l=n[s++];if(a&&i)return l;for(let f=s+(o>>1);s<f;s++)if(n[s]==e)return l;if(a)return-1}}hasAction(e,t){let i=this.data;for(let n=0;n<2;n++)for(let s=this.stateSlot(e,n?2:1),o;;s+=3){if((o=i[s])==65535)if(i[s+1]==1)o=i[s=ur(i,s+2)];else{if(i[s+1]==2)return ur(i,s+2);break}if(o==t||o==0)return ur(i,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=ur(this.data,i+2);else return!1;if(t==ur(this.data,i+1))return!0}}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=ur(this.data,i+2);else break;if((this.data[i+2]&1)==0){let n=this.data[i+1];t.some((s,o)=>o&1&&s==n)||t.push(this.data[i],n)}}return t}overrides(e,t){let i=Gm(this.data,this.tokenPrecTable,t);return i<0||Gm(this.data,this.tokenPrecTable,e)<i}configure(e){let t=Object.assign(Object.create(cl.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let n=e.tokenizers.find(s=>s.from==i);return n?n.to:i})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((i,n)=>{let s=e.specializers.find(a=>a.from==i.external);if(!s)return i;let o=Object.assign(Object.assign({},i),{external:s.to});return t.specializers[n]=Nm(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(i[o]=!0)}let n=null;for(let s=0;s<t.length;s++)if(!i[s])for(let o=this.dialects[t[s]],a;(a=this.data[o++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[a]=1;return new VQ(e,i,n)}static deserialize(e){return new cl(e)}}function ur(r,e){return r[e]|r[e+1]<<16}function Gm(r,e,t){for(let i=e,n;(n=r[i])!=65535;i++)if(n==t)return i-e;return-1}function zQ(r){let e=null;for(let t of r){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function Nm(r){if(r.external){let e=r.extend?1:0;return(t,i)=>r.external(t,i)<<1|e}return r.get}const UQ=1,Wm=281,Fm=2,qQ=3,ba=282,HQ=4,YQ=283,Xm=284,KQ=286,JQ=287,eA=5,tA=6,iA=1,rA=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],ev=125,nA=123,sA=59,jm=47,oA=42,aA=43,lA=45,fA=36,cA=96,hA=92,uA=new ZQ({start:!1,shift(r,e){return e==eA||e==tA||e==KQ?r:e==JQ},strict:!1}),dA=new vo((r,e)=>{let{next:t}=r;(t==ev||t==-1||e.context)&&e.canShift(Xm)&&r.acceptToken(Xm)},{contextual:!0,fallback:!0}),pA=new vo((r,e)=>{let{next:t}=r,i;rA.indexOf(t)>-1||t==jm&&((i=r.peek(1))==jm||i==oA)||t!=ev&&t!=sA&&t!=-1&&!e.context&&e.canShift(Wm)&&r.acceptToken(Wm)},{contextual:!0}),mA=new vo((r,e)=>{let{next:t}=r;if((t==aA||t==lA)&&(r.advance(),t==r.next)){r.advance();let i=!e.context&&e.canShift(Fm);r.acceptToken(i?Fm:qQ)}},{contextual:!0}),OA=new vo(r=>{for(let e=!1,t=0;;t++){let{next:i}=r;if(i<0){t&&r.acceptToken(ba);break}else if(i==cA){t?r.acceptToken(ba):r.acceptToken(YQ,1);break}else if(i==nA&&e){t==1?r.acceptToken(HQ,1):r.acceptToken(ba,-1);break}else if(i==10&&t){r.advance(),r.acceptToken(ba);break}else i==hA&&r.advance();e=i==fA,r.advance()}}),gA=new vo((r,e)=>{if(!(r.next!=101||!e.dialectEnabled(iA))){r.advance();for(let t=0;t<6;t++){if(r.next!="xtends".charCodeAt(t))return;r.advance()}r.next>=57&&r.next<=65||r.next>=48&&r.next<=90||r.next==95||r.next>=97&&r.next<=122||r.next>160||r.acceptToken(UQ)}}),vA=Pg({"get set async static":L.modifier,"for while do if else switch try catch finally return throw break continue default case":L.controlKeyword,"in of await yield void typeof delete instanceof":L.operatorKeyword,"let var const function class extends":L.definitionKeyword,"import export from":L.moduleKeyword,"with debugger as new":L.keyword,TemplateString:L.special(L.string),super:L.atom,BooleanLiteral:L.bool,this:L.self,null:L.null,Star:L.modifier,VariableName:L.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":L.function(L.variableName),VariableDefinition:L.definition(L.variableName),Label:L.labelName,PropertyName:L.propertyName,PrivatePropertyName:L.special(L.propertyName),"CallExpression/MemberExpression/PropertyName":L.function(L.propertyName),"FunctionDeclaration/VariableDefinition":L.function(L.definition(L.variableName)),"ClassDeclaration/VariableDefinition":L.definition(L.className),PropertyDefinition:L.definition(L.propertyName),PrivatePropertyDefinition:L.definition(L.special(L.propertyName)),UpdateOp:L.updateOperator,LineComment:L.lineComment,BlockComment:L.blockComment,Number:L.number,String:L.string,ArithOp:L.arithmeticOperator,LogicOp:L.logicOperator,BitOp:L.bitwiseOperator,CompareOp:L.compareOperator,RegExp:L.regexp,Equals:L.definitionOperator,Arrow:L.function(L.punctuation),": Spread":L.punctuation,"( )":L.paren,"[ ]":L.squareBracket,"{ }":L.brace,"InterpolationStart InterpolationEnd":L.special(L.brace),".":L.derefOperator,", ;":L.separator,TypeName:L.typeName,TypeDefinition:L.definition(L.typeName),"type enum interface implements namespace module declare":L.definitionKeyword,"abstract global Privacy readonly override":L.modifier,"is keyof unique infer":L.operatorKeyword,JSXAttributeValue:L.attributeValue,JSXText:L.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":L.angleBracket,"JSXIdentifier JSXNameSpacedName":L.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":L.attributeName}),bA={__proto__:null,export:18,as:23,from:29,default:32,async:37,function:38,this:48,true:56,false:56,void:66,typeof:70,null:86,super:88,new:122,await:139,yield:141,delete:142,class:152,extends:154,public:197,private:197,protected:197,readonly:199,instanceof:220,in:222,const:224,import:256,keyof:307,unique:311,infer:317,is:351,abstract:371,implements:373,type:375,let:378,var:380,interface:387,enum:391,namespace:397,module:399,declare:403,global:407,for:428,of:437,while:440,with:444,do:448,if:452,else:454,switch:458,case:464,try:470,catch:474,finally:478,return:482,throw:486,break:490,continue:494,debugger:498},yA={__proto__:null,async:109,get:111,set:113,public:161,private:161,protected:161,static:163,abstract:165,override:167,readonly:173,new:355},xA={__proto__:null,"<":129},SA=cl.deserialize({version:14,states:"$8SO`QdOOO'QQ(C|O'#ChO'XOWO'#DVO)dQdO'#D]O)tQdO'#DhO){QdO'#DrO-xQdO'#DxOOQO'#E]'#E]O.]Q`O'#E[O.bQ`O'#E[OOQ(C['#Ef'#EfO0aQ(C|O'#ItO2wQ(C|O'#IuO3eQ`O'#EzO3jQ!bO'#FaOOQ(C['#FS'#FSO3rO#tO'#FSO4QQ&jO'#FhO5bQ`O'#FgOOQ(C['#Iu'#IuOOQ(CW'#It'#ItOOQS'#J^'#J^O5gQ`O'#HpO5lQ(ChO'#HqOOQS'#Ih'#IhOOQS'#Hr'#HrQ`QdOOO){QdO'#DjO5tQ`O'#G[O5yQ&jO'#CmO6XQ`O'#EZO6dQ`O'#EgO6iQ,UO'#FRO7TQ`O'#G[O7YQ`O'#G`O7eQ`O'#G`O7sQ`O'#GcO7sQ`O'#GdO7sQ`O'#GfO5tQ`O'#GiO8dQ`O'#GlO9rQ`O'#CdO:SQ`O'#GyO:[Q`O'#HPO:[Q`O'#HRO`QdO'#HTO:[Q`O'#HVO:[Q`O'#HYO:aQ`O'#H`O:fQ(CjO'#HfO){QdO'#HhO:qQ(CjO'#HjO:|Q(CjO'#HlO5lQ(ChO'#HnO){QdO'#DWOOOW'#Ht'#HtO;XOWO,59qOOQ(C[,59q,59qO=jQtO'#ChO=tQdO'#HuO>XQ`O'#IvO@WQtO'#IvO'dQdO'#IvO@_Q`O,59wO@uQ7[O'#DbOAnQ`O'#E]OA{Q`O'#JROBWQ`O'#JQOBWQ`O'#JQOB`Q`O,5:yOBeQ`O'#JPOBlQaO'#DyO5yQ&jO'#EZOBzQ`O'#EZOCVQpO'#FROOQ(C[,5:S,5:SOC_QdO,5:SOE]Q(C|O,5:^OEyQ`O,5:dOFdQ(ChO'#JOO7YQ`O'#I}OFkQ`O'#I}OFsQ`O,5:xOFxQ`O'#I}OGWQdO,5:vOIWQ&jO'#EWOJeQ`O,5:vOKwQ&jO'#DlOLOQdO'#DqOLYQ7[O,5;PO){QdO,5;POOQS'#Er'#ErOOQS'#Et'#EtO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;RO){QdO,5;ROOQS'#Ex'#ExOLbQdO,5;cOOQ(C[,5;h,5;hOOQ(C[,5;i,5;iONbQ`O,5;iOOQ(C[,5;j,5;jO){QdO'#IPONgQ(ChO,5<TO! RQ&jO,5;RO){QdO,5;fO! kQ!bO'#JVO! YQ!bO'#JVO! rQ!bO'#JVO!!TQ!bO,5;qOOOO,5;{,5;{O!!cQdO'#FcOOOO'#IO'#IOO3rO#tO,5;nO!!jQ!bO'#FeOOQ(C[,5;n,5;nO!#WQ,VO'#CrOOQ(C]'#Cu'#CuO!#kQ`O'#CuO!#pOWO'#CyO!$^Q,VO,5<QO!$eQ`O,5<SO!%tQ&jO'#FrO!&RQ`O'#FsO!&WQ`O'#FsO!&]Q&jO'#FwO!'[Q7[O'#F{O!'}Q,VO'#IqOOQ(C]'#Iq'#IqO!(XQaO'#IpO!(gQ`O'#IoO!(oQ`O'#CqOOQ(C]'#Cs'#CsOOQ(C]'#C|'#C|O!(wQ`O'#DOOJjQ&jO'#FjOJjQ&jO'#FlO!(|Q`O'#FnO!)RQ`O'#FoO!&WQ`O'#FuOJjQ&jO'#FzO!)WQ`O'#E^O!)oQ`O,5<RO`QdO,5>[OOQS'#Ik'#IkOOQS,5>],5>]OOQS-E;p-E;pO!+kQ(C|O,5:UOOQ(CX'#Cp'#CpO!,[Q&kO,5<vOOQO'#Cf'#CfO!,mQ(ChO'#IlO5bQ`O'#IlO:aQ`O,59XO!-OQ!bO,59XO!-WQ&jO,59XO5yQ&jO,59XO!-cQ`O,5:vO!-kQ`O'#GxO!-yQ`O'#JbO){QdO,5;kO!.RQ7[O,5;mO!.WQ`O,5=cO!.]Q`O,5=cO!.bQ`O,5=cO5lQ(ChO,5=cO5tQ`O,5<vO!.pQ`O'#E_O!/UQ7[O'#E`OOQ(CW'#JP'#JPO!/gQ(ChO'#J_O5lQ(ChO,5<zO7sQ`O,5=QOOQP'#Cr'#CrO!/rQ!bO,5<}O!/zQ!cO,5=OO!0VQ`O,5=QO!0[QpO,5=TO:aQ`O'#GnO5tQ`O'#GpO!0dQ`O'#GpO5yQ&jO'#GsO!0iQ`O'#GsOOQS,5=W,5=WO!0nQ`O'#GtO!0vQ`O'#CmO!0{Q`O,59OO!1VQ`O,59OO!3XQdO,59OOOQS,59O,59OO!3fQ(ChO,59OO){QdO,59OO!3qQdO'#G{OOQS'#G|'#G|OOQS'#G}'#G}O`QdO,5=eO!4RQ`O,5=eO){QdO'#DxO`QdO,5=kO`QdO,5=mO!4WQ`O,5=oO`QdO,5=qO!4]Q`O,5=tO!4bQdO,5=zOOQS,5>Q,5>QO){QdO,5>QO5lQ(ChO,5>SOOQS,5>U,5>UO!8cQ`O,5>UOOQS,5>W,5>WO!8cQ`O,5>WOOQS,5>Y,5>YO!8hQpO,59rOOOW-E;r-E;rOOQ(C[1G/]1G/]O!8mQtO,5>aO'dQdO,5>aOOQO,5>f,5>fO!8wQdO'#HuOOQO-E;s-E;sO!9UQ`O,5?bO!9^QtO,5?bO!9eQ`O,5?lOOQ(C[1G/c1G/cO!9mQ!bO'#DTOOQO'#Ix'#IxO){QdO'#IxO!:[Q!bO'#IxO!:yQ!bO'#DcO!;[Q7[O'#DcO!=gQdO'#DcO!=nQ`O'#IwO!=vQ`O,59|O!={Q`O'#EaO!>ZQ`O'#JSO!>cQ`O,5:zO!>yQ7[O'#DcO){QdO,5?mO!?TQ`O'#HzOOQO-E;x-E;xO!9eQ`O,5?lOOQ(CW1G0e1G0eO!@aQ7[O'#D|OOQ(C[,5:e,5:eO){QdO,5:eOIWQ&jO,5:eO!@hQaO,5:eO:aQ`O,5:uO!-OQ!bO,5:uO!-WQ&jO,5:uO5yQ&jO,5:uOOQ(C[1G/n1G/nOOQ(C[1G0O1G0OOOQ(CW'#EV'#EVO){QdO,5?jO!@sQ(ChO,5?jO!AUQ(ChO,5?jO!A]Q`O,5?iO!AeQ`O'#H|O!A]Q`O,5?iOOQ(CW1G0d1G0dO7YQ`O,5?iOOQ(C[1G0b1G0bO!BPQ(C|O1G0bO!CRQ(CyO,5:rOOQ(C]'#Fq'#FqO!CoQ(C}O'#IqOGWQdO1G0bO!EqQ,VO'#IyO!E{Q`O,5:WO!FQQtO'#IzO){QdO'#IzO!F[Q`O,5:]OOQ(C]'#DT'#DTOOQ(C[1G0k1G0kO!FaQ`O1G0kO!HrQ(C|O1G0mO!HyQ(C|O1G0mO!K^Q(C|O1G0mO!KeQ(C|O1G0mO!MlQ(C|O1G0mO!NPQ(C|O1G0mO#!pQ(C|O1G0mO#!wQ(C|O1G0mO#%[Q(C|O1G0mO#%cQ(C|O1G0mO#'WQ(C|O1G0mO#*QQMlO'#ChO#+{QMlO1G0}O#-vQMlO'#IuOOQ(C[1G1T1G1TO#.ZQ(C|O,5>kOOQ(CW-E;}-E;}O#.zQ(C}O1G0mOOQ(C[1G0m1G0mO#1PQ(C|O1G1QO#1pQ!bO,5;sO#1uQ!bO,5;tO#1zQ!bO'#F[O#2`Q`O'#FZOOQO'#JW'#JWOOQO'#H}'#H}O#2eQ!bO1G1]OOQ(C[1G1]1G1]OOOO1G1f1G1fO#2sQMlO'#ItO#2}Q`O,5;}OLbQdO,5;}OOOO-E;|-E;|OOQ(C[1G1Y1G1YOOQ(C[,5<P,5<PO#3SQ!bO,5<POOQ(C],59a,59aOIWQ&jO'#C{OOOW'#Hs'#HsO#3XOWO,59eOOQ(C],59e,59eO){QdO1G1lO!)RQ`O'#IRO#3dQ`O,5<eOOQ(C],5<b,5<bOOQO'#GV'#GVOJjQ&jO,5<pOOQO'#GX'#GXOJjQ&jO,5<rOIWQ&jO,5<tOOQO1G1n1G1nO#3oQqO'#CpO#4SQqO,5<^O#4ZQ`O'#JZO5tQ`O'#JZO#4iQ`O,5<`OJjQ&jO,5<_O#4nQ`O'#FtO#4yQ`O,5<_O#5OQqO'#FqO#5]QqO'#J[O#5gQ`O'#J[OIWQ&jO'#J[O#5lQ`O,5<cOOQ(CW'#Dg'#DgO#5qQ!bO'#F|O!'VQ7[O'#F|O!'VQ7[O'#GOO#6SQ`O'#GPO!&WQ`O'#GSO#6XQ(ChO'#ITO#6dQ7[O,5<gOOQ(C],5<g,5<gO#6kQ7[O'#F|O#6yQ7[O'#F}O#7RQ7[O'#F}OOQ(C],5<u,5<uOJjQ&jO,5?[OJjQ&jO,5?[O#7WQ`O'#IUO#7cQ`O,5?ZO#7kQ`O,59]OOQ(C]'#Ch'#ChO#8[Q,VO,59jOOQ(C],59j,59jO#8}Q,VO,5<UO#9pQ,VO,5<WO#9zQ`O,5<YOOQ(C],5<Z,5<ZO#:PQ`O,5<aO#:UQ,VO,5<fOGWQdO1G1mO#:fQ`O1G1mOOQS1G3v1G3vOOQ(C[1G/p1G/pONbQ`O1G/pOOQS1G2b1G2bOIWQ&jO1G2bO){QdO1G2bOIWQ&jO1G2bO#:kQaO1G2bO#<QQ&jO'#EWOOQ(CW,5?W,5?WO#<[Q(ChO,5?WOOQS1G.s1G.sO:aQ`O1G.sO!-OQ!bO1G.sO!-WQ&jO1G.sO#<mQ`O1G0bO#<rQ`O'#ChO#<}Q`O'#JcO#=VQ`O,5=dO#=[Q`O'#JcO#=aQ`O'#JcO#=iQ`O'#I^O#=wQ`O,5?|O#>PQtO1G1VOOQ(C[1G1X1G1XO5tQ`O1G2}O#>WQ`O1G2}O#>]Q`O1G2}O#>bQ`O1G2}OOQS1G2}1G2}O#>gQ&kO1G2bO7YQ`O'#JQO7YQ`O'#EaO7YQ`O'#IWO#>xQ(ChO,5?yOOQS1G2f1G2fO!0VQ`O1G2lOIWQ&jO1G2iO#?TQ`O1G2iOOQS1G2j1G2jOIWQ&jO1G2jO#?YQaO1G2jO#?bQ7[O'#GhOOQS1G2l1G2lO!'VQ7[O'#IYO!0[QpO1G2oOOQS1G2o1G2oOOQS,5=Y,5=YO#?jQ&kO,5=[O5tQ`O,5=[O#6SQ`O,5=_O5bQ`O,5=_O!-OQ!bO,5=_O!-WQ&jO,5=_O5yQ&jO,5=_O#?{Q`O'#JaO#@WQ`O,5=`OOQS1G.j1G.jO#@]Q(ChO1G.jO#@hQ`O1G.jO#@mQ`O1G.jO5lQ(ChO1G.jO#@uQtO,5@OO#APQ`O,5@OO#A[QdO,5=gO#AcQ`O,5=gO7YQ`O,5@OOOQS1G3P1G3PO`QdO1G3POOQS1G3V1G3VOOQS1G3X1G3XO:[Q`O1G3ZO#AhQdO1G3]O#EcQdO'#H[OOQS1G3`1G3`O#EpQ`O'#HbO:aQ`O'#HdOOQS1G3f1G3fO#ExQdO1G3fO5lQ(ChO1G3lOOQS1G3n1G3nOOQ(CW'#Fx'#FxO5lQ(ChO1G3pO5lQ(ChO1G3rOOOW1G/^1G/^O#IvQpO,5<TO#JOQtO1G3{OOQO1G4Q1G4QO){QdO,5>aO#JYQ`O1G4|O#JbQ`O1G5WO#JjQ`O,5?dOLbQdO,5:{O7YQ`O,5:{O:aQ`O,59}OLbQdO,59}O!-OQ!bO,59}O#JoQMlO,59}OOQO,5:{,5:{O#JyQ7[O'#HvO#KaQ`O,5?cOOQ(C[1G/h1G/hO#KiQ7[O'#H{O#K}Q`O,5?nOOQ(CW1G0f1G0fO!;[Q7[O,59}O#LVQtO1G5XO7YQ`O,5>fOOQ(CW'#ES'#ESO#LaQ(DjO'#ETO!@XQ7[O'#D}OOQO'#Hy'#HyO#L{Q7[O,5:hOOQ(C[,5:h,5:hO#MSQ7[O'#D}O#MeQ7[O'#D}O#MlQ7[O'#EYO#MoQ7[O'#ETO#M|Q7[O'#ETO!@XQ7[O'#ETO#NaQ`O1G0PO#NfQqO1G0POOQ(C[1G0P1G0PO){QdO1G0POIWQ&jO1G0POOQ(C[1G0a1G0aO:aQ`O1G0aO!-OQ!bO1G0aO!-WQ&jO1G0aO#NmQ(C|O1G5UO){QdO1G5UO#N}Q(ChO1G5UO$ `Q`O1G5TO7YQ`O,5>hOOQO,5>h,5>hO$ hQ`O,5>hOOQO-E;z-E;zO$ `Q`O1G5TO$ vQ(C}O,59jO$#xQ(C}O,5<UO$%}Q(C}O,5<WO$(SQ(C}O,5<fOOQ(C[7+%|7+%|O$*_Q(C|O7+%|O$+OQ&jO'#HwO$+YQ`O,5?eOOQ(C]1G/r1G/rO$+bQdO'#HxO$+oQ`O,5?fO$+wQtO,5?fOOQ(C[1G/w1G/wOOQ(C[7+&V7+&VO$,RQMlO,5:^O){QdO7+&iO$,]QMlO,5:UOOQO1G1_1G1_OOQO1G1`1G1`O$,jQ!LQO,5;vOLbQdO,5;uOOQO-E;{-E;{OOQ(C[7+&w7+&wOOOO7+'Q7+'QOOOO1G1i1G1iO$,uQ`O1G1iOOQ(C[1G1k1G1kO$,zQqO,59gOOOW-E;q-E;qOOQ(C]1G/P1G/PO$-RQ(C|O7+'WOOQ(C],5>m,5>mO$-rQ`O,5>mOOQ(C]1G2P1G2PP$-wQ`O'#IRPOQ(C]-E<P-E<PO$.hQ,VO1G2[O$/ZQ,VO1G2^O$/eQqO1G2`OOQ(C]1G1x1G1xO$/lQ`O'#IQO$/zQ`O,5?uO$/zQ`O,5?uO$0SQ`O,5?uO$0_Q`O,5?uOOQO1G1z1G1zO$0mQ,VO1G1yOJjQ&jO1G1yO$0}Q&jO'#ISO$1_Q`O,5?vOIWQ&jO,5?vO$1gQqO,5?vOOQ(C]1G1}1G1}OOQ(CW,5<h,5<hOOQ(CW,5<i,5<iO$1qQ`O,5<iO#5}Q`O,5<iO!-OQ!bO,5<hO$1vQ`O,5<jOOQ(CW,5<k,5<kO$1qQ`O,5<nOOQO,5>o,5>oOOQO-E<R-E<ROOQ(C]1G2R1G2RO!'VQ7[O,5<hO$2OQ`O,5<iO!'VQ7[O,5<jO!'VQ7[O,5<iO$2ZQ,VO1G4vO$2eQ,VO1G4vOOQO,5>p,5>pOOQO-E<S-E<SOOQP1G.w1G.wO!.RQ7[O,59lO){QdO,59lO$2rQ`O1G1tOJjQ&jO1G1{O$2wQ(C|O7+'XOOQ(C[7+'X7+'XOGWQdO7+'XOOQ(C[7+%[7+%[O$3hQqO'#J]O#NaQ`O7+'|O$3rQ`O7+'|O$3zQqO7+'|OOQS7+'|7+'|OIWQ&jO7+'|O){QdO7+'|OIWQ&jO7+'|O$4UQ(CyO'#ChO$4iQ(CyO,5<lO$5ZQ`O,5<lOOQ(CW1G4r1G4rOOQS7+$_7+$_O:aQ`O7+$_O!-OQ!bO7+$_OGWQdO7+%|O$5`Q`O'#I]O$5qQ`O,5?}OOQO1G3O1G3OO5tQ`O,5?}O$5qQ`O,5?}O$5yQ`O,5?}OOQO,5>x,5>xOOQO-E<[-E<[OOQ(C[7+&q7+&qO$6OQ`O7+(iO5lQ(ChO7+(iO5tQ`O7+(iO$6TQ`O7+(iO$6YQaO7+'|OOQ(CW,5>r,5>rOOQ(CW-E<U-E<UOOQS7+(W7+(WO$6hQ(CyO7+(TOIWQ&jO7+(TO$6rQqO7+(UOOQS7+(U7+(UOIWQ&jO7+(UO$6yQ`O'#J`O$7UQ`O,5=SOOQO,5>t,5>tOOQO-E<W-E<WOOQS7+(Z7+(ZO$8OQ7[O'#GqOOQS1G2v1G2vOIWQ&jO1G2vO){QdO1G2vOIWQ&jO1G2vO$8VQaO1G2vO$8eQ&kO1G2vO5lQ(ChO1G2yO#6SQ`O1G2yO5bQ`O1G2yO!-OQ!bO1G2yO!-WQ&jO1G2yO$8vQ`O'#I[O$9RQ`O,5?{O$9ZQ7[O,5?{OOQ(CW1G2z1G2zOOQS7+$U7+$UO$9cQ`O7+$UO5lQ(ChO7+$UO$9hQ`O7+$UO){QdO1G5jO){QdO1G5kO$9mQdO1G3RO$9tQ`O1G3RO$9yQdO1G3RO$:QQ(ChO1G5jOOQS7+(k7+(kO5lQ(ChO7+(uO`QdO7+(wOOQS'#Jf'#JfOOQS'#I_'#I_O$:[QdO,5=vOOQS,5=v,5=vO){QdO'#H]O$:iQ`O'#H_OOQS,5=|,5=|O7YQ`O,5=|OOQS,5>O,5>OOOQS7+)Q7+)QOOQS7+)W7+)WOOQS7+)[7+)[OOQS7+)^7+)^OOQO1G5O1G5OO$:nQMlO1G0gO$:xQ`O1G0gOOQO1G/i1G/iO$;TQMlO1G/iO:aQ`O1G/iOLbQdO'#DcOOQO,5>b,5>bOOQO-E;t-E;tOOQO,5>g,5>gOOQO-E;y-E;yO!-OQ!bO1G/iO:aQ`O,5:iOOQO,5:o,5:oO){QdO,5:oO$;_Q(ChO,5:oO$;jQ(ChO,5:oO!-OQ!bO,5:iOOQO-E;w-E;wOOQ(C[1G0S1G0SO!@XQ7[O,5:iO$;xQ7[O,5:iO$<ZQ(DjO,5:oO$<uQ7[O,5:iO!@XQ7[O,5:oOOQO,5:t,5:tO$<|Q7[O,5:oO$=ZQ(ChO,5:oOOQ(C[7+%k7+%kO#NaQ`O7+%kO#NfQqO7+%kOOQ(C[7+%{7+%{O:aQ`O7+%{O!-OQ!bO7+%{O$=oQ(C|O7+*pO){QdO7+*pOOQO1G4S1G4SO7YQ`O1G4SO$>PQ`O7+*oO$>XQ(C}O1G2[O$@^Q(C}O1G2^O$BcQ(C}O1G1yO$DnQ,VO,5>cOOQO-E;u-E;uO$DxQtO,5>dO){QdO,5>dOOQO-E;v-E;vO$ESQ`O1G5QO$E[QMlO1G0bO$GcQMlO1G0mO$GjQMlO1G0mO$IkQMlO1G0mO$IrQMlO1G0mO$KgQMlO1G0mO$KzQMlO1G0mO$NXQMlO1G0mO$N`QMlO1G0mO%!aQMlO1G0mO%!hQMlO1G0mO%$]QMlO1G0mO%$pQ(C|O<<JTO%%rQMmO1G0mO%'|QMmO'#IqO%)iQMlO1G1QOLbQdO'#F^OOQO'#JX'#JXOOQO1G1b1G1bO%)vQ`O1G1aO%){QMlO,5>kOOOO7+'T7+'TOOOW1G/R1G/ROOQ(C]1G4X1G4XOJjQ&jO7+'zO%*VQ`O,5>lO5tQ`O,5>lOOQO-E<O-E<OO%*eQ`O1G5aO%*eQ`O1G5aO%*mQ`O1G5aO%*xQ,VO7+'eO%+YQqO,5>nO%+dQ`O,5>nOIWQ&jO,5>nOOQO-E<Q-E<QO%+iQqO1G5bO%+sQ`O1G5bOOQ(CW1G2T1G2TO$1qQ`O1G2TOOQ(CW1G2S1G2SO%+{Q`O1G2UOIWQ&jO1G2UOOQ(CW1G2Y1G2YO!-OQ!bO1G2SO#5}Q`O1G2TO%,QQ`O1G2UO%,YQ`O1G2TOJjQ&jO7+*bOOQ(C]1G/W1G/WO%,eQ`O1G/WOOQ(C]7+'`7+'`O%,jQ,VO7+'gO%,zQ(C|O<<JsOOQ(C[<<Js<<JsOIWQ&jO'#IVO%-kQ`O,5?wOOQS<<Kh<<KhOIWQ&jO<<KhO#NaQ`O<<KhO%-sQ`O<<KhO%-{QqO<<KhOIWQ&jO1G2WOOQS<<Gy<<GyO:aQ`O<<GyO%.VQ(C|O<<IhOOQ(C[<<Ih<<IhOOQO,5>w,5>wO%.vQ`O,5>wO%.{Q`O,5>wOOQO-E<Z-E<ZO%/TQ`O1G5iO%/TQ`O1G5iO5tQ`O1G5iO%/]Q`O<<LTOOQS<<LT<<LTO%/bQ`O<<LTO5lQ(ChO<<LTO){QdO<<KhOIWQ&jO<<KhOOQS<<Ko<<KoO$6hQ(CyO<<KoOOQS<<Kp<<KpO$6rQqO<<KpO%/gQ7[O'#IXO%/rQ`O,5?zOLbQdO,5?zOOQS1G2n1G2nO#LaQ(DjO'#ETO!@XQ7[O'#GrOOQO'#IZ'#IZO%/zQ7[O,5=]OOQS,5=],5=]O%0RQ7[O'#ETO%0^Q7[O'#ETO%0uQ7[O'#ETO%1PQ7[O'#GrO%1bQ`O7+(bO%1gQ`O7+(bO%1oQqO7+(bOOQS7+(b7+(bOIWQ&jO7+(bO){QdO7+(bOIWQ&jO7+(bO%1yQaO7+(bOOQS7+(e7+(eO5lQ(ChO7+(eO#6SQ`O7+(eO5bQ`O7+(eO!-OQ!bO7+(eO%2XQ`O,5>vOOQO-E<Y-E<YOOQO'#Gu'#GuO%2dQ`O1G5gO5lQ(ChO<<GpOOQS<<Gp<<GpO%2lQ`O<<GpO%2qQ`O7++UO%2vQ`O7++VOOQS7+(m7+(mO%2{Q`O7+(mO%3QQdO7+(mO%3XQ`O7+(mO){QdO7++UO){QdO7++VOOQS<<La<<LaOOQS<<Lc<<LcOOQS-E<]-E<]OOQS1G3b1G3bO%3^Q`O,5=wOOQS,5=y,5=yO%3cQ`O1G3hOLbQdO7+&ROOQO7+%T7+%TO%3hQMlO1G5XO:aQ`O7+%TOOQO1G0T1G0TO%3rQ(C|O1G0ZOOQO1G0Z1G0ZO){QdO1G0ZO%3|Q(ChO1G0ZO:aQ`O1G0TO!-OQ!bO1G0TO!@XQ7[O1G0TO%4XQ(ChO1G0ZO%4gQ7[O1G0TO%4xQ(ChO1G0ZO%5^Q(DjO1G0ZO%5hQ7[O1G0TO!@XQ7[O1G0ZOOQ(C[<<IV<<IVOOQ(C[<<Ig<<IgO:aQ`O<<IgO%5oQ(C|O<<N[OOQO7+)n7+)nO%6PQ(C}O7+'eO%8[Q(C}O7+'gO%:gQtO1G4OO%:qQMlO7+%|O%;gQMmO,59jO%=hQMmO,5<UO%?lQMmO,5<WO%A[QMmO,5<fO%B}QMlO7+'WO%C[QMlO7+'XO%CiQ`O,5;xOOQO7+&{7+&{O%CnQ,VO<<KfOOQO1G4W1G4WO%CuQ`O1G4WO%DQQ`O1G4WO%D`Q`O7+*{O%D`Q`O7+*{OIWQ&jO1G4YO%DhQqO1G4YO%DrQ`O7+*|OOQ(CW7+'o7+'oO$1qQ`O7+'pO%DzQqO7+'pOOQ(CW7+'n7+'nO$1qQ`O7+'oO%ERQ`O7+'pOIWQ&jO7+'pO#5}Q`O7+'oO%EWQ,VO<<M|OOQ(C]7+$r7+$rO%EbQqO,5>qOOQO-E<T-E<TO#NaQ`OANASOOQSANASANASOIWQ&jOANASO%ElQ(CyO7+'rOOQSAN=eAN=eO5tQ`O1G4cOOQO1G4c1G4cO%E|Q`O1G4cO%FRQ`O7++TO%FRQ`O7++TO5lQ(ChOANAoO%FZQ`OANAoOOQSANAoANAoO%F`Q`OANASO%FhQqOANASOOQSANAZANAZOOQSANA[ANA[O%FrQ`O,5>sOOQO-E<V-E<VO%F}QMlO1G5fO#6SQ`O,5=^O5bQ`O,5=^O!-OQ!bO,5=^OOQO-E<X-E<XOOQS1G2w1G2wO$<ZQ(DjO,5:oO!@XQ7[O,5=^O%GXQ7[O,5=^O%GjQ7[O,5:oOOQS<<K|<<K|OIWQ&jO<<K|O%1bQ`O<<K|O%GtQ`O<<K|O%G|QqO<<K|O){QdO<<K|OIWQ&jO<<K|OOQS<<LP<<LPO5lQ(ChO<<LPO#6SQ`O<<LPO5bQ`O<<LPO%HWQ7[O1G4bO%H`Q`O7++ROOQSAN=[AN=[O5lQ(ChOAN=[OOQS<<Np<<NpOOQS<<Nq<<NqOOQS<<LX<<LXO%HhQ`O<<LXO%HmQdO<<LXO%HtQ`O<<NpO%HyQ`O<<NqOOQS1G3c1G3cO:aQ`O7+)SO%IOQMlO<<ImOOQO<<Ho<<HoOOQO7+%u7+%uO%3rQ(C|O7+%uO){QdO7+%uOOQO7+%o7+%oO:aQ`O7+%oO!-OQ!bO7+%oO%IYQ(ChO7+%uO!@XQ7[O7+%oO%IeQ(ChO7+%uO%IsQ7[O7+%oO%JUQ(ChO7+%uOOQ(C[AN?RAN?RO%JjQMlO<<JTO%JwQMmO1G1yO%MOQMmO1G2[O& SQMmO1G2^O&!rQMlO<<JsO&#PQMlO<<IhOOQO1G1d1G1dOJjQ&jOANAQOOQO7+)r7+)rO&#^Q`O7+)rO&#iQ`O<<NgO&#qQqO7+)tOOQ(CW<<K[<<K[O$1qQ`O<<K[OOQ(CW<<KZ<<KZO&#{QqO<<K[O$1qQ`O<<KZOOQSG26nG26nO#NaQ`OG26nOOQO7+)}7+)}O5tQ`O7+)}O&$SQ`O<<NoOOQSG27ZG27ZO5lQ(ChOG27ZOIWQ&jOG26nOLbQdO1G4_O&$[Q`O7++QO5lQ(ChO1G2xO#6SQ`O1G2xO5bQ`O1G2xO!-OQ!bO1G2xO!@XQ7[O1G2xO%5^Q(DjO1G0ZO&$dQ7[O1G2xO%1bQ`OANAhOOQSANAhANAhOIWQ&jOANAhO&$uQ`OANAhO&$}QqOANAhOOQSANAkANAkO5lQ(ChOANAkO#6SQ`OANAkOOQO'#Gv'#GvOOQO7+)|7+)|OOQSG22vG22vOOQSANAsANAsO&%XQ`OANAsOOQSAND[AND[OOQSAND]AND]OOQS<<Ln<<LnOOQO<<Ia<<IaO%3rQ(C|O<<IaOOQO<<IZ<<IZO:aQ`O<<IZO){QdO<<IaO!-OQ!bO<<IZO&%^Q(ChO<<IaO!@XQ7[O<<IZO&%iQ(ChO<<IaO&%wQMmO7+'eO&'jQMmO7+'gO&)]Q,VOG26lOOQO<<M^<<M^OOQ(CWAN@vAN@vO$1qQ`OAN@vOOQ(CWAN@uAN@uOOQSLD,YLD,YOOQO<<Mi<<MiOOQSLD,uLD,uO#NaQ`OLD,YO&)mQMlO7+)yOOQO7+(d7+(dO5lQ(ChO7+(dO#6SQ`O7+(dO5bQ`O7+(dO!-OQ!bO7+(dO!@XQ7[O7+(dOOQSG27SG27SO%1bQ`OG27SOIWQ&jOG27SOOQSG27VG27VO5lQ(ChOG27VOOQSG27_G27_OOQOAN>{AN>{OOQOAN>uAN>uO%3rQ(C|OAN>{O:aQ`OAN>uO){QdOAN>{O!-OQ!bOAN>uO&)wQ(ChOAN>{O&*SQ(C}OG26lOOQ(CWG26bG26bOOQS!$( t!$( tOOQO<<LO<<LOO5lQ(ChO<<LOO#6SQ`O<<LOO5bQ`O<<LOO!-OQ!bO<<LOOOQSLD,nLD,nO%1bQ`OLD,nOOQSLD,qLD,qOOQOG24gG24gOOQOG24aG24aO%3rQ(C|OG24gO:aQ`OG24aO){QdOG24gO&,pQ!LRO,5:rO&-gQ$ITO'#IqOOQOANAjANAjO5lQ(ChOANAjO#6SQ`OANAjO5bQ`OANAjOOQS!$(!Y!$(!YOOQOLD*RLD*ROOQOLD){LD){O%3rQ(C|OLD*RO&.ZQMmOG26lO&/|Q!LRO,59jO&0pQ!LRO,5<UO&1dQ!LRO,5<WO&2WQ!LRO,5<fOOQOG27UG27UO5lQ(ChOG27UO#6SQ`OG27UOOQO!$'Mm!$'MmO&2}Q!LRO1G2[O&3qQ!LRO1G2^O&4eQ!LRO1G1yOOQOLD,pLD,pO5lQ(ChOLD,pO&5[Q!LRO7+'eO&6RQ!LRO7+'gOOQO!$(![!$(![O&6xQ!LROG26lOLbQdO'#DrO&7oQtO'#ItOLbQdO'#DjO&7vQ(C|O'#ChO&8aQtO'#ChO&8qQdO,5:vO&:qQ&jO'#EWOLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO,5;ROLbQdO'#IPO&<OQ`O,5<TO&=eQ&jO,5;ROLbQdO,5;fO!(wQ`O'#DOO!(wQ`O'#DOO!(wQ`O'#DOOIWQ&jO'#FjO&:qQ&jO'#FjO&<WQ&jO'#FjOIWQ&jO'#FlO&:qQ&jO'#FlO&<WQ&jO'#FlOIWQ&jO'#FzO&:qQ&jO'#FzO&<WQ&jO'#FzOLbQdO,5?mO&8qQdO1G0bO&=lQMlO'#ChOLbQdO1G1lOIWQ&jO,5<pO&:qQ&jO,5<pO&<WQ&jO,5<pOIWQ&jO,5<rO&:qQ&jO,5<rO&<WQ&jO,5<rOIWQ&jO,5<_O&:qQ&jO,5<_O&<WQ&jO,5<_O&8qQdO1G1mOLbQdO7+&iOIWQ&jO1G1yO&:qQ&jO1G1yO&<WQ&jO1G1yOIWQ&jO1G1{O&:qQ&jO1G1{O&<WQ&jO1G1{O&8qQdO7+'XO&8qQdO7+%|O&=vQ`O7+'pOIWQ&jOANAQO&:qQ&jOANAQO&<WQ&jOANAQO&=vQ`O<<K[O&=vQ`OAN@vO&={Q`O'#E[O&>QQ`O'#E[O&>YQ`O'#EzO&>_Q`O'#EgO&>dQ`O'#JRO&>oQ`O'#JPO&>zQ`O,5:vO&?PQ,VO,5<QO&?WQ`O'#FsO&?]Q`O'#FsO&?bQ`O'#FsO&?gQ`O,5<RO&?oQ`O,5:vO&?wQMlO1G0}O&@OQ`O,5<_O&@TQ`O,5<_O&@YQ`O,5<_O&@_Q`O,5<aO&@dQ`O,5<aO&@iQ`O,5<aO&@nQ`O1G1mO&@sQ`O1G0bO&@xQ`O1G2UO&@}Q,VO<<KfO&AUQ,VO<<KfO&A]Q,VO<<KfO&AdQqO7+'pO&AkQ`O7+'pO&ApQqO<<K[O4QQ&jO'#FhO5bQ`O'#FgOBzQ`O'#EZOLbQdO,5;cO!&WQ`O'#FsO!&WQ`O'#FsO!&WQ`O'#FsO!&WQ`O'#FuO!&WQ`O'#FuO!&WQ`O'#FuO&AwQ`O,5<jOJjQ&jO7+'zOJjQ&jO7+'zOJjQ&jO7+'zOIWQ&jO1G2UO&BPQ`O1G2UOIWQ&jO7+'pO!'VQ7[O'#GOO$/eQqO1G2`O$/eQqO1G2`O$/eQqO1G2`O!'VQ7[O,5<jOIWQ&jO,5<tOIWQ&jO,5<tOIWQ&jO,5<t",stateData:"&B}~O'YOS'ZOSTOSUOS~OQTORTOXyO]cO_hObnOcmOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!TSO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!nlO#dsO#tpO#x^O%PqO%RtO%TrO%UrO%XuO%ZvO%^wO%_wO%axO%nzO%t{O%v|O%x}O%z!OO%}!PO&T!QO&Z!RO&]!SO&_!TO&a!UO&c!VO']PO'fQO'oYO'|aO~OQ[XZ[X_[Xj[Xu[Xv[Xx[X!R[X!a[X!b[X!d[X!j[X!{[X#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'W[X'f[X'p[X'w[X'x[X~O!]$lX~P$zOS!WO'U!XO'V!ZO~OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']![O'fQO'oYO'|aO~O!Q!`O!R!]O!O'jP!O'tP~P'dO!S!mO~P`OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']9aO'fQO'oYO'|aO~OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!T!bO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O'fQO'oYO'|aO~O!Q!rO#U!uO#V!rO']9bO!c'qP~P+{O#W!vO~O!]!wO#W!vO~OQ#^OZ#dOj#ROu!{Ov!{Ox!|O!R#bO!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O_'hX'W'hX!c'hX!O'hX!T'hX%Q'hX!]'hX~P.jO!{#eO#o#eOQ'iXZ'iX_'iXj'iXu'iXv'iXx'iX!R'iX!a'iX!b'iX!d'iX!j'iX#['iX#]'iX#^'iX#_'iX#`'iX#a'iX#b'iX#e'iX#g'iX#i'iX#j'iX'f'iX'p'iX'w'iX'x'iX~O#c'iX'W'iX!O'iX!c'iXn'iX!T'iX%Q'iX!]'iX~P0zO!{#eO~O#z#fO$R#jO~O!T#kO#x^O$U#lO$W#nO~O]#qOh$QOj#rOk#qOl#qOq$ROs$SOx#yO!T#zO!_$XO!d#vO#V$YO#t$VO$_$TO$a$UO$d$WO']#pO'b$PO'f#sO'a'cP~O!d$ZO~O!]$]O~O_$^O'W$^O~O']$bO~O!d$ZO']$bO'^$dO'b$PO~Oc$jO!d$ZO']$bO~O#c#TO~O]$sOu$oO!T$lO!d$nO%R$rO']$bO'^$dO^(UP~O!n$tO~Ox$uO!T$vO']$bO~Ox$uO!T$vO%Z$zO']$bO~O']${O~O#dsO%RtO%TrO%UrO%XuO%ZvO%^wO%_wO~Ob%UOc%TO!n%RO%P%SO%c%QO~P7xOb%XOcmO!T%WO!nlO#dsO%PqO%TrO%UrO%XuO%ZvO%^wO%_wO%axO~O`%[O!{%_O%R%YO'^$dO~P8wO!d%`O!g%dO~O!d%eO~O!TSO~O_$^O'T%mO'W$^O~O_$^O'T%pO'W$^O~O_$^O'T%rO'W$^O~OS!WO'U!XO'V%vO~OQ[XZ[Xj[Xu[Xv[Xx[X!R[X!RdX!a[X!b[X!d[X!j[X!{[X!{dX#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'f[X'p[X'w[X'x[X~O!O[X!OdX~P;dO!Q%xO!O&iX!O&nX!R&iX!R&nX~P'dO!R%zO!O'jX~OQ#^OZ#dOj#ROu!{Ov!{Ox!|O!R%zO!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O!O'jX~P>aO!O&PO~Ox&SO!W&^O!X&VO!Y&VO'^$dO~O]&TOk&TO!Q&WO'g&QO!S'kP!S'vP~P@dO!O'sX!R'sX!]'sX!c'sX'p'sX~O!{'sX#W#PX!S'sX~PA]O!{&_O!O'uX!R'uX~O!R&`O!O'tX~O!O&cO~O!{#eO~PA]OP&gO!T&dO!o&fO']$bO~Oc&lO!d$ZO']$bO~Ou$oO!d$nO~O!S&mO~P`Ou!{Ov!{Ox!|O!b!yO!d!zO'fQOQ!faZ!faj!fa!R!fa!a!fa!j!fa#[!fa#]!fa#^!fa#_!fa#`!fa#a!fa#b!fa#c!fa#e!fa#g!fa#i!fa#j!fa'p!fa'w!fa'x!fa~O_!fa'W!fa!O!fa!c!fan!fa!T!fa%Q!fa!]!fa~PCfO!c&nO~O!]!wO!{&pO'p&oO!R'rX_'rX'W'rX~O!c'rX~PFOO!R&tO!c'qX~O!c&vO~Ox$uO!T$vO#V&wO']$bO~OQTORTO]cOb!kOc!jOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!TSO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!n!iO#t!lO#x^O']9aO'fQO'oYO'|aO~O]#qOh$QOj#rOk#qOl#qOq$ROs9tOx#yO!T#zO!_;eO!d#vO#V9}O#t$VO$_9wO$a9zO$d$WO']&{O'b$PO'f#sO~O#W&}O~O]#qOh$QOj#rOk#qOl#qOq$ROs$SOx#yO!T#zO!_$XO!d#vO#V$YO#t$VO$_$TO$a$UO$d$WO']&{O'b$PO'f#sO~O'a'mP~PJjO!Q'RO!c'nP~P){O'g'TO'oYO~OQ9^OR9^O]cOb;`Oc!jOhcOj9^OkcOlcOq9^Os9^OxRO{cO|cO}cO!T!bO!_9`O!dUO!g9^O!h9^O!i9^O!j9^O!k9^O!n!iO#t!lO#x^O']'cO'fQO'oYO'|;^O~O!d!zO~O!R#bO_$]a'W$]a!c$]a!O$]a!T$]a%Q$]a!]$]a~O#d'jO~PIWO!]'lO!T'yX#w'yX#z'yX$R'yX~Ou'mO~P! YOu'mO!T'yX#w'yX#z'yX$R'yX~O!T'oO#w'sO#z'nO$R'tO~O!Q'wO~PLbO#z#fO$R'zO~OP$eXu$eXx$eX!b$eX'w$eX'x$eX~OPfX!RfX!{fX'afX'a$eX~P!!rOk'|O~OS'}O'U(OO'V(QO~OP(ZOu(SOx(TO'w(VO'x(XO~O'a(RO~P!#{O'a([O~O]#qOh$QOj#rOk#qOl#qOq$ROs9tOx#yO!T#zO!_;eO!d#vO#V9}O#t$VO$_9wO$a9zO$d$WO'b$PO'f#sO~O!Q(`O'](]O!c'}P~P!$jO#W(bO~O!d(cO~O!Q(hO'](eO!O(OP~P!$jOj(uOx(mO!W(sO!X(lO!Y(lO!d(cO!x(tO$w(oO'^$dO'g(jO~O!S(rO~P!&jO!b!yOP'eXu'eXx'eX'w'eX'x'eX!R'eX!{'eX~O'a'eX#m'eX~P!'cOP(xO!{(wO!R'dX'a'dX~O!R(yO'a'cX~O']${O'a'cP~O'](|O~O!d)RO~O']&{O~Ox$uO!Q!rO!T$vO#U!uO#V!rO']$bO!c'qP~O!]!wO#W)VO~OQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO#j#ZO'fQO'p#[O'w!}O'x#OO~O_!^a!R!^a'W!^a!O!^a!c!^an!^a!T!^a%Q!^a!]!^a~P!)wOP)_O!T&dO!o)^O%Q)]O'b$PO~O!])aO!T'`X_'`X!R'`X'W'`X~O!d$ZO'b$PO~O!d$ZO']$bO'b$PO~O!]!wO#W&}O~O])lO%R)mO'])iO!S(VP~O!R)nO^(UX~O'g'TO~OZ)rO~O^)sO~O!T$lO']$bO'^$dO^(UP~Ox$uO!Q)xO!R&`O!T$vO']$bO!O'tP~O]&ZOk&ZO!Q)yO'g'TO!S'vP~O!R)zO_(RX'W(RX~O!{*OO'b$PO~OP*RO!T#zO'b$PO~O!T*TO~Ou*VO!TSO~O!n*[O~Oc*aO~O'](|O!S(TP~Oc$jO~O%RtO']${O~P8wOZ*gO^*fO~OQTORTO]cObnOcmOhcOjTOkcOlcOqTOsTOxRO{cO|cO}cO!_kO!dUO!gTO!hTO!iTO!jTO!kTO!nlO#x^O%PqO'fQO'oYO'|aO~O!T!bO#t!lO']9aO~P!1_O^*fO_$^O'W$^O~O_*kO#d*mO%T*mO%U*mO~P){O!d%`O~O%t*rO~O!T*tO~O&V*vO&X*wOQ&SaR&SaX&Sa]&Sa_&Sab&Sac&Sah&Saj&Sak&Sal&Saq&Sas&Sax&Sa{&Sa|&Sa}&Sa!T&Sa!_&Sa!d&Sa!g&Sa!h&Sa!i&Sa!j&Sa!k&Sa!n&Sa#d&Sa#t&Sa#x&Sa%P&Sa%R&Sa%T&Sa%U&Sa%X&Sa%Z&Sa%^&Sa%_&Sa%a&Sa%n&Sa%t&Sa%v&Sa%x&Sa%z&Sa%}&Sa&T&Sa&Z&Sa&]&Sa&_&Sa&a&Sa&c&Sa'S&Sa']&Sa'f&Sa'o&Sa'|&Sa!S&Sa%{&Sa`&Sa&Q&Sa~O']*|O~On+PO~O!O&ia!R&ia~P!)wO!Q+TO!O&iX!R&iX~P){O!R%zO!O'ja~O!O'ja~P>aO!R&`O!O'ta~O!RwX!R!ZX!SwX!S!ZX!]wX!]!ZX!d!ZX!{wX'b!ZX~O!]+YO!{+XO!R#TX!R'lX!S#TX!S'lX!]'lX!d'lX'b'lX~O!]+[O!d$ZO'b$PO!R!VX!S!VX~O]&ROk&ROx&SO'g(jO~OQ9^OR9^O]cOb;`Oc!jOhcOj9^OkcOlcOq9^Os9^OxRO{cO|cO}cO!T!bO!_9`O!dUO!g9^O!h9^O!i9^O!j9^O!k9^O!n!iO#t!lO#x^O'fQO'oYO'|;^O~O']:SO~P!;jO!R+`O!S'kX~O!S+bO~O!]+YO!{+XO!R#TX!S#TX~O!R+cO!S'vX~O!S+eO~O]&ROk&ROx&SO'^$dO'g(jO~O!X+fO!Y+fO~P!>hOx$uO!Q+hO!T$vO']$bO!O&nX!R&nX~O_+lO!W+oO!X+kO!Y+kO!r+sO!s+qO!t+rO!u+pO!x+tO'^$dO'g(jO'o+iO~O!S+nO~P!?iOP+yO!T&dO!o+xO~O!{,PO!R'ra!c'ra_'ra'W'ra~O!]!wO~P!@sO!R&tO!c'qa~Ox$uO!Q,SO!T$vO#U,UO#V,SO']$bO!R&pX!c&pX~O_#Oi!R#Oi'W#Oi!O#Oi!c#Oin#Oi!T#Oi%Q#Oi!]#Oi~P!)wOP;tOu(SOx(TO'w(VO'x(XO~O#W!za!R!za!c!za!{!za!T!za_!za'W!za!O!za~P!BpO#W'eXQ'eXZ'eX_'eXj'eXv'eX!a'eX!d'eX!j'eX#['eX#]'eX#^'eX#_'eX#`'eX#a'eX#b'eX#c'eX#e'eX#g'eX#i'eX#j'eX'W'eX'f'eX'p'eX!c'eX!O'eX!T'eXn'eX%Q'eX!]'eX~P!'cO!R,_O'a'mX~P!#{O'a,aO~O!R,bO!c'nX~P!)wO!c,eO~O!O,fO~OQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O'fQOZ#Zi_#Zij#Zi!R#Zi!a#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O#[#Zi~P!FfO#[#PO~P!FfOQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO'fQOZ#Zi_#Zi!R#Zi!a#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~Oj#Zi~P!IQOj#RO~P!IQOQ#^Oj#ROu!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO'fQO_#Zi!R#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'w#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~OZ#Zi!a#Zi#a#Zi#b#Zi#c#Zi~P!KlOZ#dO!a#TO#a#TO#b#TO#c#TO~P!KlOQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO'fQO_#Zi!R#Zi#g#Zi#i#Zi#j#Zi'W#Zi'p#Zi'x#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O'w#Zi~P!NdO'w!}O~P!NdOQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO'fQO'w!}O_#Zi!R#Zi#i#Zi#j#Zi'W#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~O'x#Zi~P##OO'x#OO~P##OOQ#^OZ#dOj#ROu!{Ov!{Ox!|O!a#TO!b!yO!d!zO!j#^O#[#PO#]#QO#^#QO#_#QO#`#SO#a#TO#b#TO#c#TO#e#UO#g#WO#i#YO'fQO'w!}O'x#OO~O_#Zi!R#Zi#j#Zi'W#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~P#%jOQ[XZ[Xj[Xu[Xv[Xx[X!a[X!b[X!d[X!j[X!{[X#WdX#[[X#][X#^[X#_[X#`[X#a[X#b[X#c[X#e[X#g[X#i[X#j[X#o[X'f[X'p[X'w[X'x[X!R[X!S[X~O#m[X~P#'}OQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO#g9lO#i9nO#j9oO'fQO'p#[O'w!}O'x#OO~O#m,hO~P#*XOQ'iXZ'iXj'iXu'iXv'iXx'iX!a'iX!b'iX!d'iX!j'iX#['iX#]'iX#^'iX#_'iX#`'iX#a'iX#b'iX#e'iX#g'iX#i'iX#j'iX'f'iX'p'iX'w'iX'x'iX!R'iX~O!{9sO#o9sO#c'iX#m'iX!S'iX~P#,SO_&sa!R&sa'W&sa!c&san&sa!O&sa!T&sa%Q&sa!]&sa~P!)wOQ#ZiZ#Zi_#Zij#Ziv#Zi!R#Zi!a#Zi!b#Zi!d#Zi!j#Zi#[#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi'W#Zi'f#Zi'p#Zi!O#Zi!c#Zin#Zi!T#Zi%Q#Zi!]#Zi~P!BpO_#ni!R#ni'W#ni!O#ni!c#nin#ni!T#ni%Q#ni!]#ni~P!)wO#z,jO~O#z,kO~O!]'lO!{,lO!T$OX#w$OX#z$OX$R$OX~O!Q,mO~O!T'oO#w,oO#z'nO$R,pO~O!R9pO!S'hX~P#*XO!S,qO~O$R,sO~OS'}O'U(OO'V,vO~O],yOk,yO!O,zO~O!RdX!]dX!cdX!c$eX'pdX~P!!rO!c-QO~P!BpO!R-RO!]!wO'p&oO!c'}X~O!c-WO~O!Q(`O']$bO!c'}P~O#W-YO~O!O$eX!R$eX!]$lX~P!!rO!R-ZO!O(OX~P!BpO!]-]O~O!O-_O~Oj-cO!]!wO!d$ZO'b$PO'p&oO~O!])aO~O_$^O!R-hO'W$^O~O!S-jO~P!&jO!X-kO!Y-kO'^$dO'g(jO~Ox-mO'g(jO~O!x-nO~O']${O!R&xX'a&xX~O!R(yO'a'ca~O'a-sO~Ou-tOv-tOx-uOPra'wra'xra!Rra!{ra~O'ara#mra~P#7pOu(SOx(TOP$^a'w$^a'x$^a!R$^a!{$^a~O'a$^a#m$^a~P#8fOu(SOx(TOP$`a'w$`a'x$`a!R$`a!{$`a~O'a$`a#m$`a~P#9XO]-vO~O#W-wO~O'a$na!R$na!{$na#m$na~P!#{O#W-zO~OP.TO!T&dO!o.SO%Q.RO~O]#qOj#rOk#qOl#qOq$ROs9tOx#yO!T#zO!_;eO!d#vO#V9}O#t$VO$_9wO$a9zO$d$WO'b$PO'f#sO~Oh.VO'].UO~P#:yO!])aO!T'`a_'`a!R'`a'W'`a~O#W.]O~OZ[X!RdX!SdX~O!R.^O!S(VX~O!S.`O~OZ.aO~O].cO'])iO~O!T$lO']$bO^'QX!R'QX~O!R)nO^(Ua~O!c.fO~P!)wO].hO~OZ.iO~O^.jO~OP.TO!T&dO!o.SO%Q.RO'b$PO~O!R)zO_(Ra'W(Ra~O!{.pO~OP.sO!T#zO~O'g'TO!S(SP~OP.}O!T.yO!o.|O%Q.{O'b$PO~OZ/XO!R/VO!S(TX~O!S/YO~O^/[O_$^O'W$^O~O]/]O~O]/^O'](|O~O#c/_O%r/`O~P0zO!{#eO#c/_O%r/`O~O_/aO~P){O_/cO~O%{/gOQ%yiR%yiX%yi]%yi_%yib%yic%yih%yij%yik%yil%yiq%yis%yix%yi{%yi|%yi}%yi!T%yi!_%yi!d%yi!g%yi!h%yi!i%yi!j%yi!k%yi!n%yi#d%yi#t%yi#x%yi%P%yi%R%yi%T%yi%U%yi%X%yi%Z%yi%^%yi%_%yi%a%yi%n%yi%t%yi%v%yi%x%yi%z%yi%}%yi&T%yi&Z%yi&]%yi&_%yi&a%yi&c%yi'S%yi']%yi'f%yi'o%yi'|%yi!S%yi`%yi&Q%yi~O`/mO!S/kO&Q/lO~P`O!TSO!d/oO~O&X*wOQ&SiR&SiX&Si]&Si_&Sib&Sic&Sih&Sij&Sik&Sil&Siq&Sis&Six&Si{&Si|&Si}&Si!T&Si!_&Si!d&Si!g&Si!h&Si!i&Si!j&Si!k&Si!n&Si#d&Si#t&Si#x&Si%P&Si%R&Si%T&Si%U&Si%X&Si%Z&Si%^&Si%_&Si%a&Si%n&Si%t&Si%v&Si%x&Si%z&Si%}&Si&T&Si&Z&Si&]&Si&_&Si&a&Si&c&Si'S&Si']&Si'f&Si'o&Si'|&Si!S&Si%{&Si`&Si&Q&Si~O!R#bOn$]a~O!O&ii!R&ii~P!)wO!R%zO!O'ji~O!R&`O!O'ti~O!O/uO~O!R!Va!S!Va~P#*XO]&ROk&RO!Q/{O'g(jO!R&jX!S&jX~P@dO!R+`O!S'ka~O]&ZOk&ZO!Q)yO'g'TO!R&oX!S&oX~O!R+cO!S'va~O!O'ui!R'ui~P!)wO_$^O!]!wO!d$ZO!j0VO!{0TO'W$^O'b$PO'p&oO~O!S0YO~P!?iO!X0ZO!Y0ZO'^$dO'g(jO'o+iO~O!W0[O~P#MSO!TSO!W0[O!u0^O!x0_O~P#MSO!W0[O!s0aO!t0aO!u0^O!x0_O~P#MSO!T&dO~O!T&dO~P!BpO!R'ri!c'ri_'ri'W'ri~P!)wO!{0jO!R'ri!c'ri_'ri'W'ri~O!R&tO!c'qi~Ox$uO!T$vO#V0lO']$bO~O#WraQraZra_rajra!ara!bra!dra!jra#[ra#]ra#^ra#_ra#`ra#ara#bra#cra#era#gra#ira#jra'Wra'fra'pra!cra!Ora!Tranra%Qra!]ra~P#7pO#W$^aQ$^aZ$^a_$^aj$^av$^a!a$^a!b$^a!d$^a!j$^a#[$^a#]$^a#^$^a#_$^a#`$^a#a$^a#b$^a#c$^a#e$^a#g$^a#i$^a#j$^a'W$^a'f$^a'p$^a!c$^a!O$^a!T$^an$^a%Q$^a!]$^a~P#8fO#W$`aQ$`aZ$`a_$`aj$`av$`a!a$`a!b$`a!d$`a!j$`a#[$`a#]$`a#^$`a#_$`a#`$`a#a$`a#b$`a#c$`a#e$`a#g$`a#i$`a#j$`a'W$`a'f$`a'p$`a!c$`a!O$`a!T$`an$`a%Q$`a!]$`a~P#9XO#W$naQ$naZ$na_$naj$nav$na!R$na!a$na!b$na!d$na!j$na#[$na#]$na#^$na#_$na#`$na#a$na#b$na#c$na#e$na#g$na#i$na#j$na'W$na'f$na'p$na!c$na!O$na!T$na!{$nan$na%Q$na!]$na~P!BpO_#Oq!R#Oq'W#Oq!O#Oq!c#Oqn#Oq!T#Oq%Q#Oq!]#Oq~P!)wO!R&kX'a&kX~PJjO!R,_O'a'ma~O!Q0tO!R&lX!c&lX~P){O!R,bO!c'na~O!R,bO!c'na~P!)wO#m!fa!S!fa~PCfO#m!^a!R!^a!S!^a~P#*XO!T1XO#x^O$P1YO~O!S1^O~On1_O~P!BpO_$Yq!R$Yq'W$Yq!O$Yq!c$Yqn$Yq!T$Yq%Q$Yq!]$Yq~P!)wO!O1`O~O],yOk,yO~Ou(SOx(TO'x(XOP$xi'w$xi!R$xi!{$xi~O'a$xi#m$xi~P$.POu(SOx(TOP$zi'w$zi'x$zi!R$zi!{$zi~O'a$zi#m$zi~P$.rO'p#[O~P!BpO!Q1cO']$bO!R&tX!c&tX~O!R-RO!c'}a~O!R-RO!]!wO!c'}a~O!R-RO!]!wO'p&oO!c'}a~O'a$gi!R$gi!{$gi#m$gi~P!#{O!Q1kO'](eO!O&vX!R&vX~P!$jO!R-ZO!O(Oa~O!R-ZO!O(Oa~P!BpO!]!wO~O!]!wO#c1sO~Oj1vO!]!wO'p&oO~O!R'di'a'di~P!#{O!{1yO!R'di'a'di~P!#{O!c1|O~O_$Zq!R$Zq'W$Zq!O$Zq!c$Zqn$Zq!T$Zq%Q$Zq!]$Zq~P!)wO!R2QO!T(PX~P!BpO!T&dO%Q2TO~O!T&dO%Q2TO~P!BpO!T$eX$u[X_$eX!R$eX'W$eX~P!!rO$u2XOPgXugXxgX!TgX'wgX'xgX_gX!RgX'WgX~O$u2XO~O]2_O%R2`O'])iO!R'PX!S'PX~O!R.^O!S(Va~OZ2dO~O^2eO~O]2hO~OP2jO!T&dO!o2iO%Q2TO~O_$^O'W$^O~P!BpO!T#zO~P!BpO!R2oO!{2qO!S(SX~O!S2rO~Ox;oO!W2{O!X2tO!Y2tO!r2zO!s2yO!t2yO!x2xO'^$dO'g(jO'o+iO~O!S2wO~P$7ZOP3SO!T.yO!o3RO%Q3QO~OP3SO!T.yO!o3RO%Q3QO'b$PO~O'](|O!R'OX!S'OX~O!R/VO!S(Ta~O]3^O'g3]O~O]3_O~O^3aO~O!c3dO~P){O_3fO~O_3fO~P){O#c3hO%r3iO~PFOO`/mO!S3mO&Q/lO~P`O!]3oO~O!R#Ti!S#Ti~P#*XO!{3qO!R#Ti!S#Ti~O!R!Vi!S!Vi~P#*XO_$^O!{3xO'W$^O~O_$^O!]!wO!{3xO'W$^O~O!X3|O!Y3|O'^$dO'g(jO'o+iO~O_$^O!]!wO!d$ZO!j3}O!{3xO'W$^O'b$PO'p&oO~O!W4OO~P$;xO!W4OO!u4RO!x4SO~P$;xO_$^O!]!wO!j3}O!{3xO'W$^O'p&oO~O!R'rq!c'rq_'rq'W'rq~P!)wO!R&tO!c'qq~O#W$xiQ$xiZ$xi_$xij$xiv$xi!a$xi!b$xi!d$xi!j$xi#[$xi#]$xi#^$xi#_$xi#`$xi#a$xi#b$xi#c$xi#e$xi#g$xi#i$xi#j$xi'W$xi'f$xi'p$xi!c$xi!O$xi!T$xin$xi%Q$xi!]$xi~P$.PO#W$ziQ$ziZ$zi_$zij$ziv$zi!a$zi!b$zi!d$zi!j$zi#[$zi#]$zi#^$zi#_$zi#`$zi#a$zi#b$zi#c$zi#e$zi#g$zi#i$zi#j$zi'W$zi'f$zi'p$zi!c$zi!O$zi!T$zin$zi%Q$zi!]$zi~P$.rO#W$giQ$giZ$gi_$gij$giv$gi!R$gi!a$gi!b$gi!d$gi!j$gi#[$gi#]$gi#^$gi#_$gi#`$gi#a$gi#b$gi#c$gi#e$gi#g$gi#i$gi#j$gi'W$gi'f$gi'p$gi!c$gi!O$gi!T$gi!{$gin$gi%Q$gi!]$gi~P!BpO!R&ka'a&ka~P!#{O!R&la!c&la~P!)wO!R,bO!c'ni~O#m#Oi!R#Oi!S#Oi~P#*XOQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O'fQOZ#Zij#Zi!a#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~O#[#Zi~P$EiO#[9eO~P$EiOQ#^Ou!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO'fQOZ#Zi!a#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~Oj#Zi~P$GqOj9gO~P$GqOQ#^Oj9gOu!{Ov!{Ox!|O!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO'fQO#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'w#Zi'x#Zi!R#Zi!S#Zi~OZ#Zi!a#Zi#a#Zi#b#Zi#c#Zi~P$IyOZ9rO!a9iO#a9iO#b9iO#c9iO~P$IyOQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO'fQO#g#Zi#i#Zi#j#Zi#m#Zi'p#Zi'x#Zi!R#Zi!S#Zi~O'w#Zi~P$L_O'w!}O~P$L_OQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO#g9lO'fQO'w!}O#i#Zi#j#Zi#m#Zi'p#Zi!R#Zi!S#Zi~O'x#Zi~P$NgO'x#OO~P$NgOQ#^OZ9rOj9gOu!{Ov!{Ox!|O!a9iO!b!yO!d!zO!j#^O#[9eO#]9fO#^9fO#_9fO#`9hO#a9iO#b9iO#c9iO#e9jO#g9lO#i9nO'fQO'w!}O'x#OO~O#j#Zi#m#Zi'p#Zi!R#Zi!S#Zi~P%!oO_#ky!R#ky'W#ky!O#ky!c#kyn#ky!T#ky%Q#ky!]#ky~P!)wOP;vOu(SOx(TO'w(VO'x(XO~OQ#ZiZ#Zij#Ziv#Zi!a#Zi!b#Zi!d#Zi!j#Zi#[#Zi#]#Zi#^#Zi#_#Zi#`#Zi#a#Zi#b#Zi#c#Zi#e#Zi#g#Zi#i#Zi#j#Zi#m#Zi'f#Zi'p#Zi!R#Zi!S#Zi~P%%aO!b!yOP'eXu'eXx'eX'w'eX'x'eX!S'eX~OQ'eXZ'eXj'eXv'eX!a'eX!d'eX!j'eX#['eX#]'eX#^'eX#_'eX#`'eX#a'eX#b'eX#c'eX#e'eX#g'eX#i'eX#j'eX#m'eX'f'eX'p'eX!R'eX~P%'eO#m#ni!R#ni!S#ni~P#*XO!S4eO~O!R&sa!S&sa~P#*XO!]!wO'p&oO!R&ta!c&ta~O!R-RO!c'}i~O!R-RO!]!wO!c'}i~O'a$gq!R$gq!{$gq#m$gq~P!#{O!O&va!R&va~P!BpO!]4lO~O!R-ZO!O(Oi~P!BpO!R-ZO!O(Oi~O!O4pO~O!]!wO#c4uO~Oj4vO!]!wO'p&oO~O!O4xO~O'a$iq!R$iq!{$iq#m$iq~P!#{O_$Zy!R$Zy'W$Zy!O$Zy!c$Zyn$Zy!T$Zy%Q$Zy!]$Zy~P!)wO!R2QO!T(Pa~O!T&dO%Q4}O~O!T&dO%Q4}O~P!BpO_#Oy!R#Oy'W#Oy!O#Oy!c#Oyn#Oy!T#Oy%Q#Oy!]#Oy~P!)wOZ5QO~O]5SO'])iO~O!R.^O!S(Vi~O]5VO~O^5WO~O'g'TO!R&{X!S&{X~O!R2oO!S(Sa~O!S5eO~P$7ZOx;sO'g(jO'o+iO~O!W5hO!X5gO!Y5gO!x0_O'^$dO'g(jO'o+iO~O!s5iO!t5iO~P%0^O!X5gO!Y5gO'^$dO'g(jO'o+iO~O!T.yO~O!T.yO%Q5kO~O!T.yO%Q5kO~P!BpOP5pO!T.yO!o5oO%Q5kO~OZ5uO!R'Oa!S'Oa~O!R/VO!S(Ti~O]5xO~O!c5yO~O!c5zO~O!c5{O~O!c5{O~P){O_5}O~O!]6QO~O!c6RO~O!R'ui!S'ui~P#*XO_$^O'W$^O~P!)wO_$^O!{6WO'W$^O~O_$^O!]!wO!{6WO'W$^O~O!X6]O!Y6]O'^$dO'g(jO'o+iO~O_$^O!]!wO!j6^O!{6WO'W$^O'p&oO~O!d$ZO'b$PO~P%4xO!W6_O~P%4gO!R'ry!c'ry_'ry'W'ry~P!)wO#W$gqQ$gqZ$gq_$gqj$gqv$gq!R$gq!a$gq!b$gq!d$gq!j$gq#[$gq#]$gq#^$gq#_$gq#`$gq#a$gq#b$gq#c$gq#e$gq#g$gq#i$gq#j$gq'W$gq'f$gq'p$gq!c$gq!O$gq!T$gq!{$gqn$gq%Q$gq!]$gq~P!BpO#W$iqQ$iqZ$iq_$iqj$iqv$iq!R$iq!a$iq!b$iq!d$iq!j$iq#[$iq#]$iq#^$iq#_$iq#`$iq#a$iq#b$iq#c$iq#e$iq#g$iq#i$iq#j$iq'W$iq'f$iq'p$iq!c$iq!O$iq!T$iq!{$iqn$iq%Q$iq!]$iq~P!BpO!R&li!c&li~P!)wO#m#Oq!R#Oq!S#Oq~P#*XOu-tOv-tOx-uOPra'wra'xra!Sra~OQraZrajra!ara!bra!dra!jra#[ra#]ra#^ra#_ra#`ra#ara#bra#cra#era#gra#ira#jra#mra'fra'pra!Rra~P%;OOu(SOx(TOP$^a'w$^a'x$^a!S$^a~OQ$^aZ$^aj$^av$^a!a$^a!b$^a!d$^a!j$^a#[$^a#]$^a#^$^a#_$^a#`$^a#a$^a#b$^a#c$^a#e$^a#g$^a#i$^a#j$^a#m$^a'f$^a'p$^a!R$^a~P%=SOu(SOx(TOP$`a'w$`a'x$`a!S$`a~OQ$`aZ$`aj$`av$`a!a$`a!b$`a!d$`a!j$`a#[$`a#]$`a#^$`a#_$`a#`$`a#a$`a#b$`a#c$`a#e$`a#g$`a#i$`a#j$`a#m$`a'f$`a'p$`a!R$`a~P%?WOQ$naZ$naj$nav$na!a$na!b$na!d$na!j$na#[$na#]$na#^$na#_$na#`$na#a$na#b$na#c$na#e$na#g$na#i$na#j$na#m$na'f$na'p$na!R$na!S$na~P%%aO#m$Yq!R$Yq!S$Yq~P#*XO#m$Zq!R$Zq!S$Zq~P#*XO!S6hO~O#m6iO~P!#{O!]!wO!R&ti!c&ti~O!]!wO'p&oO!R&ti!c&ti~O!R-RO!c'}q~O!O&vi!R&vi~P!BpO!R-ZO!O(Oq~O!O6oO~P!BpO!O6oO~O!R'dy'a'dy~P!#{O!R&ya!T&ya~P!BpO!T$tq_$tq!R$tq'W$tq~P!BpOZ6vO~O!R.^O!S(Vq~O]6yO~O!T&dO%Q6zO~O!T&dO%Q6zO~P!BpO!{6{O!R&{a!S&{a~O!R2oO!S(Si~P#*XO!X7RO!Y7RO'^$dO'g(jO'o+iO~O!W7TO!x4SO~P%GXO!T.yO%Q7WO~O!T.yO%Q7WO~P!BpO]7_O'g7^O~O!R/VO!S(Tq~O!c7aO~O!c7aO~P){O!c7cO~O!c7dO~O!R#Ty!S#Ty~P#*XO_$^O!{7jO'W$^O~O_$^O!]!wO!{7jO'W$^O~O!X7mO!Y7mO'^$dO'g(jO'o+iO~O_$^O!]!wO!j7nO!{7jO'W$^O'p&oO~O#m#ky!R#ky!S#ky~P#*XOQ$giZ$gij$giv$gi!a$gi!b$gi!d$gi!j$gi#[$gi#]$gi#^$gi#_$gi#`$gi#a$gi#b$gi#c$gi#e$gi#g$gi#i$gi#j$gi#m$gi'f$gi'p$gi!R$gi!S$gi~P%%aOu(SOx(TO'x(XOP$xi'w$xi!S$xi~OQ$xiZ$xij$xiv$xi!a$xi!b$xi!d$xi!j$xi#[$xi#]$xi#^$xi#_$xi#`$xi#a$xi#b$xi#c$xi#e$xi#g$xi#i$xi#j$xi#m$xi'f$xi'p$xi!R$xi~P%LjOu(SOx(TOP$zi'w$zi'x$zi!S$zi~OQ$ziZ$zij$ziv$zi!a$zi!b$zi!d$zi!j$zi#[$zi#]$zi#^$zi#_$zi#`$zi#a$zi#b$zi#c$zi#e$zi#g$zi#i$zi#j$zi#m$zi'f$zi'p$zi!R$zi~P%NnO#m$Zy!R$Zy!S$Zy~P#*XO#m#Oy!R#Oy!S#Oy~P#*XO!]!wO!R&tq!c&tq~O!R-RO!c'}y~O!O&vq!R&vq~P!BpO!O7tO~P!BpO!R.^O!S(Vy~O!R2oO!S(Sq~O!X8QO!Y8QO'^$dO'g(jO'o+iO~O!T.yO%Q8TO~O!T.yO%Q8TO~P!BpO!c8WO~O_$^O!{8]O'W$^O~O_$^O!]!wO!{8]O'W$^O~OQ$gqZ$gqj$gqv$gq!a$gq!b$gq!d$gq!j$gq#[$gq#]$gq#^$gq#_$gq#`$gq#a$gq#b$gq#c$gq#e$gq#g$gq#i$gq#j$gq#m$gq'f$gq'p$gq!R$gq!S$gq~P%%aOQ$iqZ$iqj$iqv$iq!a$iq!b$iq!d$iq!j$iq#[$iq#]$iq#^$iq#_$iq#`$iq#a$iq#b$iq#c$iq#e$iq#g$iq#i$iq#j$iq#m$iq'f$iq'p$iq!R$iq!S$iq~P%%aO'a$|!Z!R$|!Z!{$|!Z#m$|!Z~P!#{O!R&{q!S&{q~P#*XO_$^O!{8oO'W$^O~O#W$|!ZQ$|!ZZ$|!Z_$|!Zj$|!Zv$|!Z!R$|!Z!a$|!Z!b$|!Z!d$|!Z!j$|!Z#[$|!Z#]$|!Z#^$|!Z#_$|!Z#`$|!Z#a$|!Z#b$|!Z#c$|!Z#e$|!Z#g$|!Z#i$|!Z#j$|!Z'W$|!Z'f$|!Z'p$|!Z!c$|!Z!O$|!Z!T$|!Z!{$|!Zn$|!Z%Q$|!Z!]$|!Z~P!BpOP;uOu(SOx(TO'w(VO'x(XO~O!S!za!W!za!X!za!Y!za!r!za!s!za!t!za!x!za'^!za'g!za'o!za~P&,_O!W'eX!X'eX!Y'eX!r'eX!s'eX!t'eX!x'eX'^'eX'g'eX'o'eX~P%'eOQ$|!ZZ$|!Zj$|!Zv$|!Z!a$|!Z!b$|!Z!d$|!Z!j$|!Z#[$|!Z#]$|!Z#^$|!Z#_$|!Z#`$|!Z#a$|!Z#b$|!Z#c$|!Z#e$|!Z#g$|!Z#i$|!Z#j$|!Z#m$|!Z'f$|!Z'p$|!Z!R$|!Z!S$|!Z~P%%aO!Wra!Xra!Yra!rra!sra!tra!xra'^ra'gra'ora~P%;OO!W$^a!X$^a!Y$^a!r$^a!s$^a!t$^a!x$^a'^$^a'g$^a'o$^a~P%=SO!W$`a!X$`a!Y$`a!r$`a!s$`a!t$`a!x$`a'^$`a'g$`a'o$`a~P%?WO!S$na!W$na!X$na!Y$na!r$na!s$na!t$na!x$na'^$na'g$na'o$na~P&,_O!W$xi!X$xi!Y$xi!r$xi!s$xi!t$xi!x$xi'^$xi'g$xi'o$xi~P%LjO!W$zi!X$zi!Y$zi!r$zi!s$zi!t$zi!x$zi'^$zi'g$zi'o$zi~P%NnO!S$gi!W$gi!X$gi!Y$gi!r$gi!s$gi!t$gi!x$gi'^$gi'g$gi'o$gi~P&,_O!S$gq!W$gq!X$gq!Y$gq!r$gq!s$gq!t$gq!x$gq'^$gq'g$gq'o$gq~P&,_O!S$iq!W$iq!X$iq!Y$iq!r$iq!s$iq!t$iq!x$iq'^$iq'g$iq'o$iq~P&,_O!S$|!Z!W$|!Z!X$|!Z!Y$|!Z!r$|!Z!s$|!Z!t$|!Z!x$|!Z'^$|!Z'g$|!Z'o$|!Z~P&,_On'hX~P.jOn[X!O[X!c[X%r[X!T[X%Q[X!][X~P$zO!]dX!c[X!cdX'pdX~P;dOQ9^OR9^O]cOb;`Oc!jOhcOj9^OkcOlcOq9^Os9^OxRO{cO|cO}cO!TSO!_9`O!dUO!g9^O!h9^O!i9^O!j9^O!k9^O!n!iO#t!lO#x^O']'cO'fQO'oYO'|;^O~O]#qOh$QOj#rOk#qOl#qOq$ROs9uOx#yO!T#zO!_;fO!d#vO#V:OO#t$VO$_9xO$a9{O$d$WO']&{O'b$PO'f#sO~O!R9pO!S$]a~O]#qOh$QOj#rOk#qOl#qOq$ROs9vOx#yO!T#zO!_;gO!d#vO#V:PO#t$VO$_9yO$a9|O$d$WO']&{O'b$PO'f#sO~O#d'jO~P&<WO!S[X!SdX~P;dO!]9dO~O#W9cO~O!]!wO#W9cO~O!{9sO~O#c9iO~O!{:QO!R'uX!S'uX~O!{9sO!R'sX!S'sX~O#W:RO~O'a:TO~P!#{O#W:[O~O#W:]O~O#W:^O~O!]!wO#W:_O~O!]!wO#W:RO~O#m:`O~P#*XO#W:aO~O#W:bO~O#W:cO~O#W:dO~O#W:eO~O#W:fO~O#W:gO~O#W:hO~O!O:iO~O#m:jO~P!#{O#m:kO~P!#{O#m:lO~P!#{O!O:mO~P!BpO!O:mO~O!O:nO~P!BpO!]!wO#c;lO~O!]!wO#c;nO~O#x~!b!r!t!u#U#V'|$_$a$d$u%P%Q%R%X%Z%^%_%a%c~UT#x'|#]}'Y'Z#z'Y']'g~",goto:"#Kk(ZPPPPPPPP([P(lP*`PPPP-zPP.a3s7o8SP8SPPP8SP:U8SP8SP:YPP:`P:t?VPPPP?ZPPPP?ZA{PPPBRDdP?ZPFwPPPPHp?ZPPPPPJi?ZPPMjNgPPPPNk!!TP!!]!#^PNg?Z?Z!&n!)i!.[!.[!1kPPP!1r!4h?ZPPPPPPPPPP!7_P!8pPP?Z!9}P?ZP?Z?Z?Z?ZP?Z!;dPP!>]P!AQ!AY!A^!A^P!>YP!Ab!AbP!DVP!DZ?Z?Z!Da!GT8SP8SP8S8SP!HW8S8S!Jf8S!M_8S# g8S8S#!T#$c#$c#$g#$c#$oP#$cP8S#%k8S#'X8S8S-zPPP#(yPP#)c#)cP#)cP#)x#)cPP#*OP#)uP#)u#*b!!X#)u#+P#+V#+Y([#+]([P#+d#+d#+dP([P([P([P([PP([P#+j#+mP#+m([P#+qP#+tP([P([P([P([P([P([([#+z#,U#,[#,b#,p#,v#,|#-W#-^#-m#-s#.R#.X#._#.m#/S#0z#1Y#1`#1f#1l#1r#1|#2S#2Y#2d#2v#2|PPPPPPPP#3SPP#3v#7OPP#8f#8m#8uPP#>a#@t#Fp#Fs#Fv#GR#GUPP#GX#G]#Gz#Hq#Hu#IZPP#I_#Ie#IiP#Il#Ip#Is#Jc#Jy#KO#KR#KU#K[#K_#Kc#KgmhOSj}!n$]%c%f%g%i*o*t/g/jQ$imQ$ppQ%ZyS&V!b+`Q&k!jS(l#z(qQ)g$jQ)t$rQ*`%TQ+f&^S+k&d+mQ+}&lQ-k(sQ/U*aY0Z+o+p+q+r+sS2t.y2vU3|0[0^0aU5g2y2z2{S6]4O4RS7R5h5iQ7m6_R8Q7T$p[ORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8o!j'e#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ(}$SQ)l$lQ*b%WQ*i%`Q,X9tQ.W)aQ.c)mQ/^*gQ2_.^Q3Z/VQ4^9vQ5S2`R8{9upeOSjy}!n$]%Y%c%f%g%i*o*t/g/jR*d%[&WVOSTjkn}!S!W!k!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%z&S&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;`;a[!cRU!]!`%x&WQ$clQ$hmS$mp$rv$wrs!r!u$Z$u&`&t&w)x)y)z*m+Y+h,S,U/o0lQ%PwQ&h!iQ&j!jS(_#v(cS)f$i$jQ)j$lQ)w$tQ*Z%RQ*_%TS+|&k&lQ-V(`Q.[)gQ.b)mQ.d)nQ.g)rQ/P*[S/T*`*aQ0h+}Q1b-RQ2^.^Q2b.aQ2g.iQ3Y/UQ4i1cQ5R2`Q5U2dQ6u5QR7w6vx#xa!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;k!Y$fm!j$h$i$j&U&j&k&l(k)f)g+]+j+|+}-d.[0Q0W0]0h1u3{4Q6Z7k8^Q)`$cQ*P$|Q*S$}Q*^%TQ.k)wQ/O*ZU/S*_*`*aQ3T/PS3X/T/UQ5b2sQ5t3YS7P5c5fS8O7Q7SQ8f8PQ8u8g#[;b!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vd;c9d9x9{:O:V:Y:]:b:e:ke;d9r9y9|:P:W:Z:^:c:f:lW#}a$P(y;^S$|t%YQ$}uQ%OvR)}$z%P#|a!w!y#d#v#y$T$U$Y&g'}(W(Y(Z(b(h(w(x)])_)a*O*R+y,_-Y-Z-]-w.R.T.p.s.{.}1a1k1s1y2Q2T2X2j3Q3S4l4u4}5k5p6i6z7W8T9d9r9w9x9y9z9{9|9}:O:P:U:V:W:X:Y:Z:[:]:^:a:b:c:d:e:f:j:k:l;^;i;j;k;l;n;t;u;vT(O#s(PX)O$S9t9u9vU&Z!b$v+cQ'U!{Q)q$oQ.t*TQ1z-tR5^2o&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;a$]#aZ!_!o$a%w%}&y'Q'W'X'Y'Z'[']'^'_'`'a'b'd'g'k'u)p+R+^+g,O,^,d,g,i,w-x/v/y0i0s0w0x0y0z0{0|0}1O1P1Q1R1S1T1W1]2O2[3s3v4W4[4]4b4c5`6S6V6b6f6g7g7z8Z8m8y9_:|T!XQ!Y&_cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ&X!bR/|+`Y&R!b&V&^+`+fS(k#z(qS+j&d+mS-d(l(sQ-e(mQ-l(tQ.v*VU0W+k+o+pU0]+q+r+sS0b+t2xQ1u-kQ1w-mQ1x-nS2s.y2vU3{0Z0[0^Q4P0_Q4Q0aS5c2t2{S5f2y2zU6Z3|4O4RQ6`4SS7Q5g5hQ7S5iS7k6]6_S8P7R7TQ8^7mQ8g8QQ;h;oR;m;slhOSj}!n$]%c%f%g%i*o*t/g/jQ%k!QS&x!v9cQ)d$gQ*X%PQ*Y%QQ+z&iS,]&}:RS-y)V:_Q.Y)eQ.x*WQ/n*vQ/p*wQ/x+ZQ0`+qQ0f+{S2P-z:gQ2Y.ZS2].]:hQ3r/zQ3u0RQ4U0gQ5P2ZQ6T3tQ6X3zQ6a4VQ7e6RQ7h6YQ8Y7iQ8l8[R8x8n$W#`Z!_!o%w%}&y'Q'W'X'Y'Z'[']'^'_'`'a'b'd'g'k'u)p+R+^+g,O,^,d,g,w-x/v/y0i0s0w0x0y0z0{0|0}1O1P1Q1R1S1T1W1]2O2[3s3v4W4[4]4b4c5`6S6V6b6f6g7g7z8Z8m8y9_:|W(v#{&|1V8qT)Z$a,i$W#_Z!_!o%w%}&y'Q'W'X'Y'Z'[']'^'_'`'a'b'd'g'k'u)p+R+^+g,O,^,d,g,w-x/v/y0i0s0w0x0y0z0{0|0}1O1P1Q1R1S1T1W1]2O2[3s3v4W4[4]4b4c5`6S6V6b6f6g7g7z8Z8m8y9_:|Q'f#`S)Y$a,iR-{)Z&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ%f{Q%g|Q%i!OQ%j!PR/f*rQ&e!iQ)[$cQ+w&hS.Q)`)wS0c+u+vW2S-}.O.P.kS4T0d0eU4|2U2V2WU6s4{5Y5ZQ7v6tR8b7yT+l&d+mS+j&d+mU0W+k+o+pU0]+q+r+sS0b+t2xS2s.y2vU3{0Z0[0^Q4P0_Q4Q0aS5c2t2{S5f2y2zU6Z3|4O4RQ6`4SS7Q5g5hQ7S5iS7k6]6_S8P7R7TQ8^7mR8g8QS+l&d+mT2u.y2vS&r!q/dQ-U(_Q-b(kS0V+j2sQ1g-VS1p-c-lU3}0]0b5fQ4h1bS4s1v1xU6^4P4Q7SQ6k4iQ6r4vR7n6`Q!xXS&q!q/dQ)W$[Q)b$eQ)h$kQ,Q&rQ-T(_Q-a(kQ-f(nQ.X)cQ/Q*]S0U+j2sS1f-U-VS1o-b-lQ1r-eQ1t-gQ3V/RW3y0V0]0b5fQ4g1bQ4k1gS4o1p1xQ4t1wQ5r3WW6[3}4P4Q7SS6j4h4iS6n4p:iQ6p4sQ6}5aQ7[5sS7l6^6`Q7r6kS7s6o:mQ7u6rQ7|7OQ8V7]Q8_7nS8a7t:nQ8d7}Q8s8eQ9Q8tQ9X9RQ:u:pQ;T:zQ;U:{Q;V;hR;[;m$rWORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oS!xn!k!j:o#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aR:u;`$rXORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oQ$[b!Y$em!j$h$i$j&U&j&k&l(k)f)g+]+j+|+}-d.[0Q0W0]0h1u3{4Q6Z7k8^S$kn!kQ)c$fQ*]%TW/R*^*_*`*aU3W/S/T/UQ5a2sS5s3X3YU7O5b5c5fQ7]5tU7}7P7Q7SS8e8O8PS8t8f8gQ9R8u!j:p#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aQ:z;_R:{;`$f]OSTjk}!S!W!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%c%e%f%g%i%m%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oY!hRU!]!`%xv$wrs!r!u$Z$u&`&t&w)x)y)z*m+Y+h,S,U/o0lQ*j%`!h:q#]#k'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aR:t&WS&[!b$vR0O+c$p[ORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8o!j'e#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aR*i%`$roORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8oQ'U!{!k:r#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;a!h#VZ!_$a%w%}&y'Q'_'`'a'b'g'k)p+R+g,O,^,d,w-x0i0s1T2O2[3v4W4[6V7g8Z8m8y9_!R9k'd'u+^,i/v/y0w1P1Q1R1S1W1]3s4]4b4c5`6S6b6f6g7z:|!d#XZ!_$a%w%}&y'Q'a'b'g'k)p+R+g,O,^,d,w-x0i0s1T2O2[3v4W4[6V7g8Z8m8y9_}9m'd'u+^,i/v/y0w1R1S1W1]3s4]4b4c5`6S6b6f6g7z:|!`#]Z!_$a%w%}&y'Q'g'k)p+R+g,O,^,d,w-x0i0s1T2O2[3v4W4[6V7g8Z8m8y9_Q1a-Px;a'd'u+^,i/v/y0w1W1]3s4]4b4c5`6S6b6f6g7z:|Q;i;pQ;j;qR;k;r&^cORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aS#l`#mR1Y,l&e_ORSTU`jk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k#m$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,l,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aS#g^#nT'n#i'rT#h^#nT'p#i'r&e`ORSTU`jk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#]#b#e#k#m$]$n%[%_%`%c%e%f%g%i%m%x%z&S&W&_&f&p&}'R'w(R)V)^*k*o*t+T+X+[+x,P,b,h,l,m-u-z.S.].|/_/`/a/c/g/j/l/{0T0j0t1X2i2q3R3f3h3i3q3x5o5}6W6{7j8]8o9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;aT#l`#mQ#o`R'y#m$rbORSTUjk}!S!W!]!`!n!v!z!|#P#Q#R#S#T#U#V#W#X#Y#Z#b#e$]$n%[%_%`%c%e%f%g%i%m%x%z&S&_&f&p&}'R(R)V)^*k*o*t+T+x,P,b,h-u-z.S.].|/_/`/a/c/g/j/l0T0j0t2i3R3f3h3i3x5o5}6W7j8]8o!k;_#]#k&W'w+X+[,m/{1X2q3q6{9^9`9c9e9f9g9h9i9j9k9l9m9n9o9p9s:Q:R:T:_:`:g:h;a#RdOSUj}!S!W!n!|#k$]%[%_%`%c%e%f%g%i%m&S&f'w)^*k*o*t+x,m-u.S.|/_/`/a/c/g/j/l1X2i3R3f3h3i5o5}x#{a!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;k#[&|!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vQ)S$WQ,x(Sd1V9r9y9|:P:W:Z:^:c:f:le8q9d9x9{:O:V:Y:]:b:e:kx#wa!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;kQ(d#xS(n#z(qQ)T$XQ-g(o#[:w!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vd:x9d9x9{:O:V:Y:]:b:e:kd:y9r9y9|:P:W:Z:^:c:f:lQ:};bQ;O;cQ;P;dQ;Q;eQ;R;fR;S;gx#{a!y$T$U$Y(W(Y(b(w(x,_-Y-w1a1y6i;^;i;j;k#[&|!w#d#v#y&g'}(Z(h)])_)a*O*R+y-Z-].R.T.p.s.{.}1k1s2Q2T2X2j3Q3S4l4u4}5k5p6z7W8T9w9z9}:U:X:[:a:d:j;l;n;t;u;vd1V9r9y9|:P:W:Z:^:c:f:le8q9d9x9{:O:V:Y:]:b:e:klfOSj}!n$]%c%f%g%i*o*t/g/jQ(g#yQ*}%pQ+O%rR1j-Z%O#|a!w!y#d#v#y$T$U$Y&g'}(W(Y(Z(b(h(w(x)])_)a*O*R+y,_-Y-Z-]-w.R.T.p.s.{.}1a1k1s1y2Q2T2X2j3Q3S4l4u4}5k5p6i6z7W8T9d9r9w9x9y9z9{9|9}:O:P:U:V:W:X:Y:Z:[:]:^:a:b:c:d:e:f:j:k:l;^;i;j;k;l;n;t;u;vQ*Q$}Q.r*SQ2m.qR5]2nT(p#z(qS(p#z(qT2u.y2vQ)b$eQ-f(nQ.X)cQ/Q*]Q3V/RQ5r3WQ6}5aQ7[5sQ7|7OQ8V7]Q8d7}Q8s8eQ9Q8tR9X9Rp(W#t'O)U-X-o-p0q1h1}4f4w7q:v;W;X;Y!n:U&z'i(^(f+v,[,t-P-^-|.P.o.q0e0p1i1m2W2l2n3O4Y4Z4m4q4y5O5Z5n6m6q7Y8`;Z;];p;q;r[:V8p9O9V9Y9Z9]]:W1U4a6c7o7p8zr(Y#t'O)U,}-X-o-p0q1h1}4f4w7q:v;W;X;Y!p:X&z'i(^(f+v,[,t-P-^-|.P.o.q0e0n0p1i1m2W2l2n3O4Y4Z4m4q4y5O5Z5n6m6q7Y8`;Z;];p;q;r^:Y8p9O9T9V9Y9Z9]_:Z1U4a6c6d7o7p8zpeOSjy}!n$]%Y%c%f%g%i*o*t/g/jQ%VxR*k%`peOSjy}!n$]%Y%c%f%g%i*o*t/g/jR%VxQ*U%OR.n)}qeOSjy}!n$]%Y%c%f%g%i*o*t/g/jQ.z*ZS3P/O/PW5j2|2}3O3TU7V5l5m5nU8R7U7X7YQ8h8SR8v8iQ%^yR*e%YR3^/XR7_5uS$mp$rR.d)nQ%czR*o%dR*u%jT/h*t/jR*y%kQ*x%kR/q*yQjOQ!nST$`j!nQ(P#sR,u(PQ!YQR%u!YQ!^RU%{!^%|+UQ%|!_R+U%}Q+a&XR/}+aQ,`'OR0r,`Q,c'QS0u,c0vR0v,dQ+m&dR0X+mS!eR$uU&a!e&b+VQ&b!fR+V&OQ+d&[R0P+dQ&u!sQ,R&sU,V&u,R0mR0m,WQ'r#iR,n'rQ#m`R'x#mQ#cZU'h#c+Q9qQ+Q9_R9q'uQ-S(_W1d-S1e4j6lU1e-T-U-VS4j1f1gR6l4k$k(U#t&z'O'i(^(f)P)Q)U+v,Y,Z,[,t,}-O-P-X-^-o-p-|.P.o.q0e0n0o0p0q1U1h1i1m1}2W2l2n3O4Y4Z4_4`4a4f4m4q4w4y5O5Z5n6c6d6e6m6q7Y7o7p7q8`8p8z8|8}9O9T9U9V9Y9Z9]:v;W;X;Y;Z;];p;q;rQ-[(fU1l-[1n4nQ1n-^R4n1mQ(q#zR-i(qQ(z$OR-r(zQ2R-|R4z2RQ){$xR.m){Q2p.tS5_2p6|R6|5`Q*W%PR.w*WQ2v.yR5d2vQ/W*bS3[/W5vR5v3^Q._)jW2a._2c5T6wQ2c.bQ5T2bR6w5UQ)o$mR.e)oQ/j*tR3l/jWiOSj!nQ%h}Q)X$]Q*n%cQ*p%fQ*q%gQ*s%iQ/e*oS/h*t/jR3k/gQ$_gQ%l!RQ%o!TQ%q!UQ%s!VQ)v$sQ)|$yQ*d%^Q*{%nQ-h(pS/Z*e*hQ/r*zQ/s*}Q/t+OS0S+j2sQ2f.hQ2k.oQ3U/QQ3`/]Q3j/fY3w0U0V0]0b5fQ5X2hQ5[2lQ5q3VQ5w3_[6U3v3y3}4P4Q7SQ6x5VQ7Z5rQ7`5xW7f6V6[6^6`Q7x6yQ7{6}Q8U7[U8X7g7l7nQ8c7|Q8j8VS8k8Z8_Q8r8dQ8w8mQ9P8sQ9S8yQ9W9QR9[9XQ$gmQ&i!jU)e$h$i$jQ+Z&UU+{&j&k&lQ-`(kS.Z)f)gQ/z+]Q0R+jS0g+|+}Q1q-dQ2Z.[Q3t0QS3z0W0]Q4V0hQ4r1uS6Y3{4QQ7i6ZQ8[7kR8n8^S#ua;^R({$PU$Oa$P;^R-q(yQ#taS&z!w)aQ'O!yQ'i#dQ(^#vQ(f#yQ)P$TQ)Q$UQ)U$YQ+v&gQ,Y9wQ,Z9zQ,[9}Q,t'}Q,}(WQ-O(YQ-P(ZQ-X(bQ-^(hQ-o(wQ-p(xd-|)].R.{2T3Q4}5k6z7W8TQ.P)_Q.o*OQ.q*RQ0e+yQ0n:UQ0o:XQ0p:[Q0q,_Q1U9rQ1h-YQ1i-ZQ1m-]Q1}-wQ2W.TQ2l.pQ2n.sQ3O.}Q4Y:aQ4Z:dQ4_9yQ4`9|Q4a:PQ4f1aQ4m1kQ4q1sQ4w1yQ4y2QQ5O2XQ5Z2jQ5n3SQ6c:^Q6d:WQ6e:ZQ6m4lQ6q4uQ7Y5pQ7o:cQ7p:fQ7q6iQ8`:jQ8p9dQ8z:lQ8|9xQ8}9{Q9O:OQ9T:VQ9U:YQ9V:]Q9Y:bQ9Z:eQ9]:kQ:v;^Q;W;iQ;X;jQ;Y;kQ;Z;lQ;];nQ;p;tQ;q;uR;r;vlgOSj}!n$]%c%f%g%i*o*t/g/jS!pU%eQ%n!SQ%t!WQ'V!|Q'v#kS*h%[%_Q*l%`Q*z%mQ+W&SQ+u&fQ,r'wQ.O)^Q/b*kQ0d+xQ1[,mQ1{-uQ2V.SQ2}.|Q3b/_Q3c/`Q3e/aQ3g/cQ3n/lQ4d1XQ5Y2iQ5m3RQ5|3fQ6O3hQ6P3iQ7X5oR7b5}!vZOSUj}!S!n!|$]%[%_%`%c%e%f%g%i%m&S&f)^*k*o*t+x-u.S.|/_/`/a/c/g/j/l2i3R3f3h3i5o5}Q!_RQ!oTQ$akS%w!]%zQ%}!`Q&y!vQ'Q!zQ'W#PQ'X#QQ'Y#RQ'Z#SQ'[#TQ']#UQ'^#VQ'_#WQ'`#XQ'a#YQ'b#ZQ'd#]Q'g#bQ'k#eW'u#k'w,m1XQ)p$nS+R%x+TS+^&W/{Q+g&_Q,O&pQ,^&}Q,d'RQ,g9^Q,i9`Q,w(RQ-x)VQ/v+XQ/y+[Q0i,PQ0s,bQ0w9cQ0x9eQ0y9fQ0z9gQ0{9hQ0|9iQ0}9jQ1O9kQ1P9lQ1Q9mQ1R9nQ1S9oQ1T,hQ1W9sQ1]9pQ2O-zQ2[.]Q3s:QQ3v0TQ4W0jQ4[0tQ4]:RQ4b:TQ4c:_Q5`2qQ6S3qQ6V3xQ6b:`Q6f:gQ6g:hQ7g6WQ7z6{Q8Z7jQ8m8]Q8y8oQ9_!WR:|;aR!aRR&Y!bS&U!b+`S+]&V&^R0Q+fR'P!yR'S!zT!tU$ZS!sU$ZU$xrs*mS&s!r!uQ,T&tQ,W&wQ.l)zS0k,S,UR4X0l`!dR!]!`$u%x&`)x+hh!qUrs!r!u$Z&t&w)z,S,U0lQ/d*mQ/w+YQ3p/oT:s&W)yT!gR$uS!fR$uS%y!]&`S&O!`)xS+S%x+hT+_&W)yT&]!b$vQ#i^R'{#nT'q#i'rR1Z,lT(a#v(cR(i#yQ-})]Q2U.RQ2|.{Q4{2TQ5l3QQ6t4}Q7U5kQ7y6zQ8S7WR8i8TlhOSj}!n$]%c%f%g%i*o*t/g/jQ%]yR*d%YV$yrs*mR.u*TR*c%WQ$qpR)u$rR)k$lT%az%dT%bz%dT/i*t/j",nodeNames:"\u26A0 extends ArithOp ArithOp InterpolationStart LineComment BlockComment Script ExportDeclaration export Star as VariableName String from ; default FunctionDeclaration async function VariableDefinition TypeParamList TypeDefinition ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Interpolation null super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression await yield delete LogicOp BitOp ParenthesizedExpression ClassExpression class extends ClassBody MethodDeclaration Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression PrivatePropertyName BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody MethodDeclaration AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement",maxTerm:332,context:uA,nodeProps:[["closedBy",4,"InterpolationEnd",40,"]",51,"}",66,")",132,"JSXSelfCloseEndTag JSXEndTag",146,"JSXEndTag"],["group",-26,8,15,17,58,184,188,191,192,194,197,200,211,213,219,221,223,225,228,234,240,242,244,246,248,250,251,"Statement",-30,12,13,24,27,28,41,43,44,45,47,52,60,68,74,75,91,92,101,103,119,122,124,125,126,127,129,130,148,149,151,"Expression",-22,23,25,29,32,34,152,154,156,157,159,160,161,163,164,165,167,168,169,178,180,182,183,"Type",-3,79,85,90,"ClassItem"],["openedBy",30,"InterpolationStart",46,"[",50,"{",65,"(",131,"JSXStartTag",141,"JSXStartTag JSXStartCloseTag"]],propSources:[vA],skippedNodes:[0,5,6],repeatNodeCount:28,tokenData:"!C}~R!`OX%TXY%cYZ'RZ[%c[]%T]^'R^p%Tpq%cqr'crs(kst0htu2`uv4pvw5ewx6cxy<yyz=Zz{=k{|>k|}?O}!O>k!O!P?`!P!QCl!Q!R!0[!R![!1q![!]!7s!]!^!8V!^!_!8g!_!`!9d!`!a!:[!a!b!<R!b!c%T!c!}2`!}#O!=d#O#P%T#P#Q!=t#Q#R!>U#R#S2`#S#T!>i#T#o2`#o#p!>y#p#q!?O#q#r!?f#r#s!?x#s$f%T$f$g%c$g#BY2`#BY#BZ!@Y#BZ$IS2`$IS$I_!@Y$I_$I|2`$I|$I}!Bq$I}$JO!Bq$JO$JT2`$JT$JU!@Y$JU$KV2`$KV$KW!@Y$KW&FU2`&FU&FV!@Y&FV?HT2`?HT?HU!@Y?HU~2`W%YR$UWO!^%T!_#o%T#p~%T7Z%jg$UW'Y7ROX%TXY%cYZ%TZ[%c[p%Tpq%cq!^%T!_#o%T#p$f%T$f$g%c$g#BY%T#BY#BZ%c#BZ$IS%T$IS$I_%c$I_$JT%T$JT$JU%c$JU$KV%T$KV$KW%c$KW&FU%T&FU&FV%c&FV?HT%T?HT?HU%c?HU~%T7Z'YR$UW'Z7RO!^%T!_#o%T#p~%T$T'jS$UW!j#{O!^%T!_!`'v!`#o%T#p~%T$O'}S#e#v$UWO!^%T!_!`(Z!`#o%T#p~%T$O(bR#e#v$UWO!^%T!_#o%T#p~%T)X(rZ$UW]#eOY(kYZ)eZr(krs*rs!^(k!^!_+U!_#O(k#O#P-b#P#o(k#o#p+U#p~(k&r)jV$UWOr)ers*Ps!^)e!^!_*a!_#o)e#o#p*a#p~)e&r*WR$P&j$UWO!^%T!_#o%T#p~%T&j*dROr*ars*ms~*a&j*rO$P&j)X*{R$P&j$UW]#eO!^%T!_#o%T#p~%T)P+ZV]#eOY+UYZ*aZr+Urs+ps#O+U#O#P+w#P~+U)P+wO$P&j]#e)P+zROr+Urs,Ts~+U)P,[U$P&j]#eOY,nZr,nrs-Vs#O,n#O#P-[#P~,n#e,sU]#eOY,nZr,nrs-Vs#O,n#O#P-[#P~,n#e-[O]#e#e-_PO~,n)X-gV$UWOr(krs-|s!^(k!^!_+U!_#o(k#o#p+U#p~(k)X.VZ$P&j$UW]#eOY.xYZ%TZr.xrs/rs!^.x!^!_,n!_#O.x#O#P0S#P#o.x#o#p,n#p~.x#m/PZ$UW]#eOY.xYZ%TZr.xrs/rs!^.x!^!_,n!_#O.x#O#P0S#P#o.x#o#p,n#p~.x#m/yR$UW]#eO!^%T!_#o%T#p~%T#m0XT$UWO!^.x!^!_,n!_#o.x#o#p,n#p~.x3]0mZ$UWOt%Ttu1`u!^%T!_!c%T!c!}1`!}#R%T#R#S1`#S#T%T#T#o1`#p$g%T$g~1`3]1g]$UW'o3TOt%Ttu1`u!Q%T!Q![1`![!^%T!_!c%T!c!}1`!}#R%T#R#S1`#S#T%T#T#o1`#p$g%T$g~1`7Z2k_$UW#zS']$y'g3SOt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$g%T$g~2`[3q_$UW#zSOt%Ttu3ju}%T}!O3j!O!Q%T!Q![3j![!^%T!_!c%T!c!}3j!}#R%T#R#S3j#S#T%T#T#o3j#p$g%T$g~3j$O4wS#^#v$UWO!^%T!_!`5T!`#o%T#p~%T$O5[R$UW#o#vO!^%T!_#o%T#p~%T5b5lU'x5Y$UWOv%Tvw6Ow!^%T!_!`5T!`#o%T#p~%T$O6VS$UW#i#vO!^%T!_!`5T!`#o%T#p~%T)X6jZ$UW]#eOY6cYZ7]Zw6cwx*rx!^6c!^!_8T!_#O6c#O#P:T#P#o6c#o#p8T#p~6c&r7bV$UWOw7]wx*Px!^7]!^!_7w!_#o7]#o#p7w#p~7]&j7zROw7wwx*mx~7w)P8YV]#eOY8TYZ7wZw8Twx+px#O8T#O#P8o#P~8T)P8rROw8Twx8{x~8T)P9SU$P&j]#eOY9fZw9fwx-Vx#O9f#O#P9}#P~9f#e9kU]#eOY9fZw9fwx-Vx#O9f#O#P9}#P~9f#e:QPO~9f)X:YV$UWOw6cwx:ox!^6c!^!_8T!_#o6c#o#p8T#p~6c)X:xZ$P&j$UW]#eOY;kYZ%TZw;kwx/rx!^;k!^!_9f!_#O;k#O#P<e#P#o;k#o#p9f#p~;k#m;rZ$UW]#eOY;kYZ%TZw;kwx/rx!^;k!^!_9f!_#O;k#O#P<e#P#o;k#o#p9f#p~;k#m<jT$UWO!^;k!^!_9f!_#o;k#o#p9f#p~;k&i=QR!d&a$UWO!^%T!_#o%T#p~%Tk=bR!cc$UWO!^%T!_#o%T#p~%T7V=tU'^4V#_#v$UWOz%Tz{>W{!^%T!_!`5T!`#o%T#p~%T$O>_S#[#v$UWO!^%T!_!`5T!`#o%T#p~%T%w>rSj%o$UWO!^%T!_!`5T!`#o%T#p~%T&i?VR!R&a$UWO!^%T!_#o%T#p~%T7Z?gVu5^$UWO!O%T!O!P?|!P!Q%T!Q![@r![!^%T!_#o%T#p~%T!{@RT$UWO!O%T!O!P@b!P!^%T!_#o%T#p~%T!{@iR!Q!s$UWO!^%T!_#o%T#p~%T!{@yZ$UWk!sO!Q%T!Q![@r![!^%T!_!g%T!g!hAl!h#R%T#R#S@r#S#X%T#X#YAl#Y#o%T#p~%T!{AqZ$UWO{%T{|Bd|}%T}!OBd!O!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T!{BiV$UWO!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T!{CVV$UWk!sO!Q%T!Q![CO![!^%T!_#R%T#R#SCO#S#o%T#p~%T7ZCs`$UW#]#vOYDuYZ%TZzDuz{Jl{!PDu!P!Q!-e!Q!^Du!^!_Fx!_!`!.^!`!a!/]!a!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~DuXD|[$UW}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~DuXEy_$UW}PO!^%T!_#Z%T#Z#[Er#[#]%T#]#^Er#^#a%T#a#bEr#b#g%T#g#hEr#h#i%T#i#jEr#j#m%T#m#nEr#n#o%T#p~%TPF}V}POYFxZ!PFx!P!QGd!Q!}Fx!}#OG{#O#PHh#P~FxPGiU}P#Z#[Gd#]#^Gd#a#bGd#g#hGd#i#jGd#m#nGdPHOTOYG{Z#OG{#O#PH_#P#QFx#Q~G{PHbQOYG{Z~G{PHkQOYFxZ~FxXHvY$UWOYHqYZ%TZ!^Hq!^!_G{!_#OHq#O#PIf#P#QDu#Q#oHq#o#pG{#p~HqXIkV$UWOYHqYZ%TZ!^Hq!^!_G{!_#oHq#o#pG{#p~HqXJVV$UWOYDuYZ%TZ!^Du!^!_Fx!_#oDu#o#pFx#p~Du7ZJs^$UW}POYJlYZKoZzJlz{NQ{!PJl!P!Q!,R!Q!^Jl!^!_!!]!_!}Jl!}#O!'|#O#P!+a#P#oJl#o#p!!]#p~Jl7ZKtV$UWOzKoz{LZ{!^Ko!^!_M]!_#oKo#o#pM]#p~Ko7ZL`X$UWOzKoz{LZ{!PKo!P!QL{!Q!^Ko!^!_M]!_#oKo#o#pM]#p~Ko7ZMSR$UWU7RO!^%T!_#o%T#p~%T7RM`ROzM]z{Mi{~M]7RMlTOzM]z{Mi{!PM]!P!QM{!Q~M]7RNQOU7R7ZNX^$UW}POYJlYZKoZzJlz{NQ{!PJl!P!Q! T!Q!^Jl!^!_!!]!_!}Jl!}#O!'|#O#P!+a#P#oJl#o#p!!]#p~Jl7Z! ^_$UWU7R}PO!^%T!_#Z%T#Z#[Er#[#]%T#]#^Er#^#a%T#a#bEr#b#g%T#g#hEr#h#i%T#i#jEr#j#m%T#m#nEr#n#o%T#p~%T7R!!bY}POY!!]YZM]Zz!!]z{!#Q{!P!!]!P!Q!&x!Q!}!!]!}#O!$`#O#P!&f#P~!!]7R!#VY}POY!!]YZM]Zz!!]z{!#Q{!P!!]!P!Q!#u!Q!}!!]!}#O!$`#O#P!&f#P~!!]7R!#|UU7R}P#Z#[Gd#]#^Gd#a#bGd#g#hGd#i#jGd#m#nGd7R!$cWOY!$`YZM]Zz!$`z{!${{#O!$`#O#P!&S#P#Q!!]#Q~!$`7R!%OYOY!$`YZM]Zz!$`z{!${{!P!$`!P!Q!%n!Q#O!$`#O#P!&S#P#Q!!]#Q~!$`7R!%sTU7ROYG{Z#OG{#O#PH_#P#QFx#Q~G{7R!&VTOY!$`YZM]Zz!$`z{!${{~!$`7R!&iTOY!!]YZM]Zz!!]z{!#Q{~!!]7R!&}_}POzM]z{Mi{#ZM]#Z#[!&x#[#]M]#]#^!&x#^#aM]#a#b!&x#b#gM]#g#h!&x#h#iM]#i#j!&x#j#mM]#m#n!&x#n~M]7Z!(R[$UWOY!'|YZKoZz!'|z{!(w{!^!'|!^!_!$`!_#O!'|#O#P!*o#P#QJl#Q#o!'|#o#p!$`#p~!'|7Z!(|^$UWOY!'|YZKoZz!'|z{!(w{!P!'|!P!Q!)x!Q!^!'|!^!_!$`!_#O!'|#O#P!*o#P#QJl#Q#o!'|#o#p!$`#p~!'|7Z!*PY$UWU7ROYHqYZ%TZ!^Hq!^!_G{!_#OHq#O#PIf#P#QDu#Q#oHq#o#pG{#p~Hq7Z!*tX$UWOY!'|YZKoZz!'|z{!(w{!^!'|!^!_!$`!_#o!'|#o#p!$`#p~!'|7Z!+fX$UWOYJlYZKoZzJlz{NQ{!^Jl!^!_!!]!_#oJl#o#p!!]#p~Jl7Z!,Yc$UW}POzKoz{LZ{!^Ko!^!_M]!_#ZKo#Z#[!,R#[#]Ko#]#^!,R#^#aKo#a#b!,R#b#gKo#g#h!,R#h#iKo#i#j!,R#j#mKo#m#n!,R#n#oKo#o#pM]#p~Ko7Z!-lV$UWT7ROY!-eYZ%TZ!^!-e!^!_!.R!_#o!-e#o#p!.R#p~!-e7R!.WQT7ROY!.RZ~!.R$P!.g[$UW#o#v}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~Du]!/f[#wS$UW}POYDuYZ%TZ!PDu!P!QEr!Q!^Du!^!_Fx!_!}Du!}#OHq#O#PJQ#P#oDu#o#pFx#p~Du!{!0cd$UWk!sO!O%T!O!P@r!P!Q%T!Q![!1q![!^%T!_!g%T!g!hAl!h#R%T#R#S!1q#S#U%T#U#V!3X#V#X%T#X#YAl#Y#b%T#b#c!2w#c#d!4m#d#l%T#l#m!5{#m#o%T#p~%T!{!1x_$UWk!sO!O%T!O!P@r!P!Q%T!Q![!1q![!^%T!_!g%T!g!hAl!h#R%T#R#S!1q#S#X%T#X#YAl#Y#b%T#b#c!2w#c#o%T#p~%T!{!3OR$UWk!sO!^%T!_#o%T#p~%T!{!3^W$UWO!Q%T!Q!R!3v!R!S!3v!S!^%T!_#R%T#R#S!3v#S#o%T#p~%T!{!3}Y$UWk!sO!Q%T!Q!R!3v!R!S!3v!S!^%T!_#R%T#R#S!3v#S#b%T#b#c!2w#c#o%T#p~%T!{!4rV$UWO!Q%T!Q!Y!5X!Y!^%T!_#R%T#R#S!5X#S#o%T#p~%T!{!5`X$UWk!sO!Q%T!Q!Y!5X!Y!^%T!_#R%T#R#S!5X#S#b%T#b#c!2w#c#o%T#p~%T!{!6QZ$UWO!Q%T!Q![!6s![!^%T!_!c%T!c!i!6s!i#R%T#R#S!6s#S#T%T#T#Z!6s#Z#o%T#p~%T!{!6z]$UWk!sO!Q%T!Q![!6s![!^%T!_!c%T!c!i!6s!i#R%T#R#S!6s#S#T%T#T#Z!6s#Z#b%T#b#c!2w#c#o%T#p~%T$u!7|R!]V$UW#m$fO!^%T!_#o%T#p~%T!q!8^R_!i$UWO!^%T!_#o%T#p~%T5w!8rR'bd!a/n#x&s'|P!P!Q!8{!^!_!9Q!_!`!9_W!9QO$WW#v!9VP#`#v!_!`!9Y#v!9_O#o#v#v!9dO#a#v$u!9kT!{$m$UWO!^%T!_!`'v!`!a!9z!a#o%T#p~%T$P!:RR#W#w$UWO!^%T!_#o%T#p~%T%V!:gT'a!R#a#v$RS$UWO!^%T!_!`!:v!`!a!;W!a#o%T#p~%T$O!:}R#a#v$UWO!^%T!_#o%T#p~%T$O!;_T#`#v$UWO!^%T!_!`5T!`!a!;n!a#o%T#p~%T$O!;uS#`#v$UWO!^%T!_!`5T!`#o%T#p~%T*a!<YV'p#{$UWO!O%T!O!P!<o!P!^%T!_!a%T!a!b!=P!b#o%T#p~%T*[!<vRv*S$UWO!^%T!_#o%T#p~%T$O!=WS$UW#j#vO!^%T!_!`5T!`#o%T#p~%T7V!=kRx6}$UWO!^%T!_#o%T#p~%Tk!={R!Oc$UWO!^%T!_#o%T#p~%T$O!>]S#g#v$UWO!^%T!_!`5T!`#o%T#p~%T$a!>pR$UW'f$XO!^%T!_#o%T#p~%T~!?OO!T~5b!?VT'w5Y$UWO!^%T!_!`5T!`#o%T#p#q!=P#q~%T6X!?oR!S5}nQ$UWO!^%T!_#o%T#p~%TX!@PR!kP$UWO!^%T!_#o%T#p~%T7Z!@gr$UW'Y7R#zS']$y'g3SOX%TXY%cYZ%TZ[%c[p%Tpq%cqt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$f%T$f$g%c$g#BY2`#BY#BZ!@Y#BZ$IS2`$IS$I_!@Y$I_$JT2`$JT$JU!@Y$JU$KV2`$KV$KW!@Y$KW&FU2`&FU&FV!@Y&FV?HT2`?HT?HU!@Y?HU~2`7Z!CO_$UW'Z7R#zS']$y'g3SOt%Ttu2`u}%T}!O3j!O!Q%T!Q![2`![!^%T!_!c%T!c!}2`!}#R%T#R#S2`#S#T%T#T#o2`#p$g%T$g~2`",tokenizers:[gA,pA,mA,OA,0,1,2,3,4,5,6,7,8,9,dA],topRules:{Script:[0,7]},dialects:{jsx:12107,ts:12109},dynamicPrecedences:{149:1,176:1},specialized:[{term:289,get:r=>bA[r]||-1},{term:299,get:r=>yA[r]||-1},{term:63,get:r=>xA[r]||-1}],tokenPrec:12130}),_A=[Ii("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Ii("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Ii("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Ii("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Ii("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Ii(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Ii("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Ii(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Ii(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Ii('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Ii('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],Vm=new H_,tv=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Es(r){return(e,t)=>{let i=e.node.getChild("VariableDefinition");return i&&t(i,r),!0}}const wA=["FunctionDeclaration"],TA={FunctionDeclaration:Es("function"),ClassDeclaration:Es("class"),ClassExpression:()=>!0,EnumDeclaration:Es("constant"),TypeAliasDeclaration:Es("type"),NamespaceDeclaration:Es("namespace"),VariableDefinition(r,e){r.matchContext(wA)||e(r,"variable")},TypeDefinition(r,e){e(r,"type")},__proto__:null};function iv(r,e){let t=Vm.get(e);if(t)return t;let i=[],n=!0;function s(o,a){let l=r.sliceString(o.from,o.to);i.push({label:l,type:a})}return e.cursor(qt.IncludeAnonymous).iterate(o=>{if(n)n=!1;else if(o.name){let a=TA[o.name];if(a&&a(o,s)||tv.has(o.name))return!1}else if(o.to-o.from>8192){for(let a of iv(r,o.node))i.push(a);return!1}}),Vm.set(e,i),i}const Zm=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,rv=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName"];function kA(r){let e=Wt(r.state).resolveInner(r.pos,-1);if(rv.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&Zm.test(r.state.sliceDoc(e.from,e.to));if(!t&&!r.explicit)return null;let i=[];for(let n=e;n;n=n.parent)tv.has(n.name)&&(i=i.concat(iv(r.state.doc,n)));return{options:i,from:t?e.from:r.pos,validFor:Zm}}const pn=Ua.define({parser:SA.configure({props:[Ig.add({IfStatement:Vf({except:/^\s*({|else\b)/}),TryStatement:Vf({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:gw,SwitchBody:r=>{let e=r.textAfter,t=/^\s*\}/.test(e),i=/^\s*(case|default)\b/.test(e);return r.baseIndent+(t?0:i?1:2)*r.unit},Block:Ow({closing:"}"}),ArrowFunction:r=>r.baseIndent+r.unit,"TemplateString BlockComment":()=>null,"Statement Property":Vf({except:/^{/}),JSXElement(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},JSXEscape(r){let e=/\s*\}/.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"JSXOpenTag JSXSelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),Ng.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression":xw,BlockComment(r){return{from:r.from+2,to:r.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),QA=pn.configure({dialect:"ts"}),AA=pn.configure({dialect:"jsx"}),CA=pn.configure({dialect:"jsx ts"}),$A="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(r=>({label:r,type:"keyword"}));function EA(r={}){let e=r.jsx?r.typescript?CA:AA:r.typescript?QA:pn;return new lw(e,[pn.data.of({autocomplete:Lk(rv,B0(_A.concat($A)))}),pn.data.of({autocomplete:kA}),r.jsx?PA:[]])}function zm(r,e,t=r.length){if(!e)return"";let i=e.getChild("JSXIdentifier");return i?r.sliceString(i.from,Math.min(i.to,t)):""}const RA=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),PA=Ie.inputHandler.of((r,e,t,i)=>{if((RA?r.composing:r.compositionStarted)||r.state.readOnly||e!=t||i!=">"&&i!="/"||!pn.isActiveAt(r.state,e,-1))return!1;let{state:n}=r,s=n.changeByRange(o=>{var a,l,f;let{head:c}=o,h=Wt(n).resolveInner(c,-1),d;if(h.name=="JSXStartTag"&&(h=h.parent),i==">"&&h.name=="JSXFragmentTag")return{range:se.cursor(c+1),changes:{from:c,insert:"><>"}};if(i==">"&&h.name=="JSXIdentifier"){if(((l=(a=h.parent)===null||a===void 0?void 0:a.lastChild)===null||l===void 0?void 0:l.name)!="JSXEndTag"&&(d=zm(n.doc,h.parent,c)))return{range:se.cursor(c+1),changes:{from:c,insert:`></${d}>`}}}else if(i=="/"&&h.name=="JSXFragmentTag"){let g=h.parent,_=g==null?void 0:g.parent;if(g.from==c-1&&((f=_.lastChild)===null||f===void 0?void 0:f.name)!="JSXEndTag"&&(d=zm(n.doc,_==null?void 0:_.firstChild,c))){let D=`/${d}>`;return{range:se.cursor(c+D.length),changes:{from:c,insert:D}}}}return{range:o}});return s.changes.empty?!1:(r.dispatch(s,{userEvent:"input.type",scrollIntoView:!0}),!0)}),LA="#e5c07b",Um="#e06c75",DA="#56b6c2",MA="#ffffff",Ca="#abb2bf",Hc="#7d8799",IA="#61afef",BA="#98c379",qm="#d19a66",GA="#c678dd",NA="#21252b",Hm="#2c313a",Ym="#282c34",ic="#353a42",WA="#3E4451",Km="#528bff",FA=Ie.theme({"&":{color:Ca,backgroundColor:Ym},".cm-content":{caretColor:Km},".cm-cursor, .cm-dropCursor":{borderLeftColor:Km},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:WA},".cm-panels":{backgroundColor:NA,color:Ca},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{backgroundColor:Ym,color:Hc,border:"none"},".cm-activeLineGutter":{backgroundColor:Hm},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:ic},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:ic,borderBottomColor:ic},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Hm,color:Ca}}},{dark:!0}),nv=mo.define([{tag:L.keyword,color:GA},{tag:[L.name,L.deleted,L.character,L.propertyName,L.macroName],color:Um},{tag:[L.function(L.variableName),L.labelName],color:IA},{tag:[L.color,L.constant(L.name),L.standard(L.name)],color:qm},{tag:[L.definition(L.name),L.separator],color:Ca},{tag:[L.typeName,L.className,L.number,L.changed,L.annotation,L.modifier,L.self,L.namespace],color:LA},{tag:[L.operator,L.operatorKeyword,L.url,L.escape,L.regexp,L.link,L.special(L.string)],color:DA},{tag:[L.meta,L.comment],color:Hc},{tag:L.strong,fontWeight:"bold"},{tag:L.emphasis,fontStyle:"italic"},{tag:L.strikethrough,textDecoration:"line-through"},{tag:L.link,color:Hc,textDecoration:"underline"},{tag:L.heading,fontWeight:"bold",color:Um},{tag:[L.atom,L.bool,L.special(L.variableName)],color:qm},{tag:[L.processingInstruction,L.string,L.inserted],color:BA},{tag:L.invalid,color:MA}]),XA=[FA,bh(nv)];class jA{constructor(){Pt(this,"editor",new Ie({parent:document.body.querySelector("#app"),doc:"code here",extensions:[BQ,bh(nv,{fallback:!0}),Ie.theme({"&":{fontSize:"16px",backgroundColor:"transparent"},"& .cm-line":{maxWidth:"fit-content",background:"rgba(0, 0, 0, 0.7)"}}),EA(),XA]}))}setValue(e){console.log("code: ",e),this.editor.dispatch({changes:{from:0,to:this.editor.state.doc.length,insert:e}})}}var sv={exports:{}};(function(r,e){(function(t,i){r.exports=i()})(fx,function(){var t=function(u){return u instanceof Uint8Array||u instanceof Uint16Array||u instanceof Uint32Array||u instanceof Int8Array||u instanceof Int16Array||u instanceof Int32Array||u instanceof Float32Array||u instanceof Float64Array||u instanceof Uint8ClampedArray},i=function(u,m){for(var w=Object.keys(m),G=0;G<w.length;++G)u[w[G]]=m[w[G]];return u},n=`
`;function s(u){return typeof atob<"u"?atob(u):"base64:"+u}function o(u){var m=new Error("(regl) "+u);throw console.error(m),m}function a(u,m){u||o(m)}function l(u){return u?": "+u:""}function f(u,m,w){u in m||o("unknown parameter ("+u+")"+l(w)+". possible values: "+Object.keys(m).join())}function c(u,m){t(u)||o("invalid parameter type"+l(m)+". must be a typed array")}function h(u,m){switch(m){case"number":return typeof u=="number";case"object":return typeof u=="object";case"string":return typeof u=="string";case"boolean":return typeof u=="boolean";case"function":return typeof u=="function";case"undefined":return typeof u>"u";case"symbol":return typeof u=="symbol"}}function d(u,m,w){h(u,m)||o("invalid parameter type"+l(w)+". expected "+m+", got "+typeof u)}function g(u,m){u>=0&&(u|0)===u||o("invalid parameter type, ("+u+")"+l(m)+". must be a nonnegative integer")}function _(u,m,w){m.indexOf(u)<0&&o("invalid value"+l(w)+". must be one of: "+m)}var D=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function E(u){Object.keys(u).forEach(function(m){D.indexOf(m)<0&&o('invalid regl constructor argument "'+m+'". must be one of '+D)})}function U(u,m){for(u=u+"";u.length<m;)u=" "+u;return u}function Qe(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function pe(u,m){this.number=u,this.line=m,this.errors=[]}function Te(u,m,w){this.file=u,this.line=m,this.message=w}function we(){var u=new Error,m=(u.stack||u).toString(),w=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(m);if(w)return w[1];var G=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(m);return G?G[1]:"unknown"}function Ne(){var u=new Error,m=(u.stack||u).toString(),w=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(m);if(w)return w[1];var G=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(m);return G?G[1]:"unknown"}function Ve(u,m){var w=u.split(`
`),G=1,z=0,B={unknown:new Qe,0:new Qe};B.unknown.name=B[0].name=m||we(),B.unknown.lines.push(new pe(0,""));for(var F=0;F<w.length;++F){var ee=w[F],J=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(ee);if(J)switch(J[1]){case"line":var oe=/(\d+)(\s+\d+)?/.exec(J[2]);oe&&(G=oe[1]|0,oe[2]&&(z=oe[2]|0,z in B||(B[z]=new Qe)));break;case"define":var le=/SHADER_NAME(_B64)?\s+(.*)$/.exec(J[2]);le&&(B[z].name=le[1]?s(le[2]):le[2]);break}B[z].lines.push(new pe(G++,ee))}return Object.keys(B).forEach(function(ae){var he=B[ae];he.lines.forEach(function(te){he.index[te.number]=te})}),B}function vt(u){var m=[];return u.split(`
`).forEach(function(w){if(!(w.length<5)){var G=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(w);G?m.push(new Te(G[1]|0,G[2]|0,G[3].trim())):w.length>0&&m.push(new Te("unknown",0,w))}}),m}function it(u,m){m.forEach(function(w){var G=u[w.file];if(G){var z=G.index[w.line];if(z){z.errors.push(w),G.hasErrors=!0;return}}u.unknown.hasErrors=!0,u.unknown.lines[0].errors.push(w)})}function Ke(u,m,w,G,z){if(!u.getShaderParameter(m,u.COMPILE_STATUS)){var B=u.getShaderInfoLog(m),F=G===u.FRAGMENT_SHADER?"fragment":"vertex";fi(w,"string",F+" shader source must be a string",z);var ee=Ve(w,z),J=vt(B);it(ee,J),Object.keys(ee).forEach(function(oe){var le=ee[oe];if(!le.hasErrors)return;var ae=[""],he=[""];function te(ne,$){ae.push(ne),he.push($||"")}te("file number "+oe+": "+le.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),le.lines.forEach(function(ne){if(ne.errors.length>0){te(U(ne.number,4)+"|  ","background-color:yellow; font-weight:bold"),te(ne.line+n,"color:red; background-color:yellow; font-weight:bold");var $=0;ne.errors.forEach(function(W){var re=W.message,ye=/^\s*'(.*)'\s*:\s*(.*)$/.exec(re);if(ye){var K=ye[1];switch(re=ye[2],K){case"assign":K="=";break}$=Math.max(ne.line.indexOf(K,$),0)}else $=0;te(U("| ",6)),te(U("^^^",$+3)+n,"font-weight:bold"),te(U("| ",6)),te(re+n,"font-weight:bold")}),te(U("| ",6)+n)}else te(U(ne.number,4)+"|  "),te(ne.line+n,"color:red")}),typeof document<"u"&&!window.chrome?(he[0]=ae.join("%c"),console.log.apply(console,he)):console.log(ae.join(""))}),a.raise("Error compiling "+F+" shader, "+ee[0].name)}}function ot(u,m,w,G,z){if(!u.getProgramParameter(m,u.LINK_STATUS)){var B=u.getProgramInfoLog(m),F=Ve(w,z),ee=Ve(G,z),J='Error linking program with vertex shader, "'+ee[0].name+'", and fragment shader "'+F[0].name+'"';typeof document<"u"?console.log("%c"+J+n+"%c"+B,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(J+n+B),a.raise(J)}}function pt(u){u._commandRef=we()}function wt(u,m,w,G){pt(u);function z(J){return J?G.id(J):0}u._fragId=z(u.static.frag),u._vertId=z(u.static.vert);function B(J,oe){Object.keys(oe).forEach(function(le){J[G.id(le)]=!0})}var F=u._uniformSet={};B(F,m.static),B(F,m.dynamic);var ee=u._attributeSet={};B(ee,w.static),B(ee,w.dynamic),u._hasCount="count"in u.static||"count"in u.dynamic||"elements"in u.static||"elements"in u.dynamic}function Ft(u,m){var w=Ne();o(u+" in command "+(m||we())+(w==="unknown"?"":" called from "+w))}function Xt(u,m,w){u||Ft(m,w||we())}function Kt(u,m,w,G){u in m||Ft("unknown parameter ("+u+")"+l(w)+". possible values: "+Object.keys(m).join(),G||we())}function fi(u,m,w,G){h(u,m)||Ft("invalid parameter type"+l(w)+". expected "+m+", got "+typeof u,G||we())}function Mt(u){u()}function gi(u,m,w){u.texture?_(u.texture._texture.internalformat,m,"unsupported texture format for attachment"):_(u.renderbuffer._renderbuffer.format,w,"unsupported renderbuffer format for attachment")}var ci=33071,ji=9728,Or=9984,xn=9985,bo=9986,uv=9987,dv=5120,pv=5121,mv=5122,Ov=5123,gv=5124,vv=5125,Mh=5126,Ih=32819,Bh=32820,Gh=33635,Nh=34042,bv=36193,vi={};vi[dv]=vi[pv]=1,vi[mv]=vi[Ov]=vi[bv]=vi[Gh]=vi[Ih]=vi[Bh]=2,vi[gv]=vi[vv]=vi[Mh]=vi[Nh]=4;function Wh(u,m){return u===Bh||u===Ih||u===Gh?2:u===Nh?4:vi[u]*m}function yo(u){return!(u&u-1)&&!!u}function yv(u,m,w){var G,z=m.width,B=m.height,F=m.channels;a(z>0&&z<=w.maxTextureSize&&B>0&&B<=w.maxTextureSize,"invalid texture shape"),(u.wrapS!==ci||u.wrapT!==ci)&&a(yo(z)&&yo(B),"incompatible wrap mode for texture, both width and height must be power of 2"),m.mipmask===1?z!==1&&B!==1&&a(u.minFilter!==Or&&u.minFilter!==bo&&u.minFilter!==xn&&u.minFilter!==uv,"min filter requires mipmap"):(a(yo(z)&&yo(B),"texture must be a square power of 2 to support mipmapping"),a(m.mipmask===(z<<1)-1,"missing or incomplete mipmap data")),m.type===Mh&&(w.extensions.indexOf("oes_texture_float_linear")<0&&a(u.minFilter===ji&&u.magFilter===ji,"filter not supported, must enable oes_texture_float_linear"),a(!u.genMipmaps,"mipmap generation not supported with float textures"));var ee=m.images;for(G=0;G<16;++G)if(ee[G]){var J=z>>G,oe=B>>G;a(m.mipmask&1<<G,"missing mipmap data");var le=ee[G];if(a(le.width===J&&le.height===oe,"invalid shape for mip images"),a(le.format===m.format&&le.internalformat===m.internalformat&&le.type===m.type,"incompatible type for mip image"),!le.compressed)if(le.data){var ae=Math.ceil(Wh(le.type,F)*J/le.unpackAlignment)*le.unpackAlignment;a(le.data.byteLength===ae*oe,"invalid data for image, buffer size is inconsistent with image format")}else le.element||le.copy}else u.genMipmaps||a((m.mipmask&1<<G)===0,"extra mipmap data");m.compressed&&a(!u.genMipmaps,"mipmap generation for compressed images not supported")}function xv(u,m,w,G){var z=u.width,B=u.height,F=u.channels;a(z>0&&z<=G.maxTextureSize&&B>0&&B<=G.maxTextureSize,"invalid texture shape"),a(z===B,"cube map must be square"),a(m.wrapS===ci&&m.wrapT===ci,"wrap mode not supported by cube map");for(var ee=0;ee<w.length;++ee){var J=w[ee];a(J.width===z&&J.height===B,"inconsistent cube map face shape"),m.genMipmaps&&(a(!J.compressed,"can not generate mipmap for compressed textures"),a(J.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var oe=J.images,le=0;le<16;++le){var ae=oe[le];if(ae){var he=z>>le,te=B>>le;a(J.mipmask&1<<le,"missing mipmap data"),a(ae.width===he&&ae.height===te,"invalid shape for mip images"),a(ae.format===u.format&&ae.internalformat===u.internalformat&&ae.type===u.type,"incompatible type for mip image"),ae.compressed||(ae.data?a(ae.data.byteLength===he*te*Math.max(Wh(ae.type,F),ae.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ae.element||ae.copy)}}}}var O=i(a,{optional:Mt,raise:o,commandRaise:Ft,command:Xt,parameter:f,commandParameter:Kt,constructor:E,type:d,commandType:fi,isTypedArray:c,nni:g,oneOf:_,shaderError:Ke,linkError:ot,callSite:Ne,saveCommandRef:pt,saveDrawInfo:wt,framebufferFormat:gi,guessCommand:we,texture2D:yv,textureCube:xv}),Sv=0,_v=0,wv=5,Tv=6;function jr(u,m){this.id=Sv++,this.type=u,this.data=m}function Fh(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function os(u){if(u.length===0)return[];var m=u.charAt(0),w=u.charAt(u.length-1);if(u.length>1&&m===w&&(m==='"'||m==="'"))return['"'+Fh(u.substr(1,u.length-2))+'"'];var G=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(u);if(G)return os(u.substr(0,G.index)).concat(os(G[1])).concat(os(u.substr(G.index+G[0].length)));var z=u.split(".");if(z.length===1)return['"'+Fh(u)+'"'];for(var B=[],F=0;F<z.length;++F)B=B.concat(os(z[F]));return B}function Xh(u){return"["+os(u).join("][")+"]"}function kv(u,m){return new jr(u,Xh(m+""))}function Qv(u){return typeof u=="function"&&!u._reglType||u instanceof jr}function jh(u,m){if(typeof u=="function")return new jr(_v,u);if(typeof u=="number"||typeof u=="boolean")return new jr(wv,u);if(Array.isArray(u))return new jr(Tv,u.map(function(w,G){return jh(w,m+"["+G+"]")}));if(u instanceof jr)return u;O(!1,"invalid option type in uniform "+m)}var bi={DynamicVariable:jr,define:kv,isDynamic:Qv,unbox:jh,accessor:Xh},Al={next:typeof requestAnimationFrame=="function"?function(u){return requestAnimationFrame(u)}:function(u){return setTimeout(u,16)},cancel:typeof cancelAnimationFrame=="function"?function(u){return cancelAnimationFrame(u)}:clearTimeout},Vh=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Av(){var u={"":0},m=[""];return{id:function(w){var G=u[w];return G||(G=u[w]=m.length,m.push(w),G)},str:function(w){return m[w]}}}function Cv(u,m,w){var G=document.createElement("canvas");i(G.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),u.appendChild(G),u===document.body&&(G.style.position="absolute",i(u.style,{margin:0,padding:0}));function z(){var ee=window.innerWidth,J=window.innerHeight;if(u!==document.body){var oe=G.getBoundingClientRect();ee=oe.right-oe.left,J=oe.bottom-oe.top}G.width=w*ee,G.height=w*J}var B;u!==document.body&&typeof ResizeObserver=="function"?(B=new ResizeObserver(function(){setTimeout(z)}),B.observe(u)):window.addEventListener("resize",z,!1);function F(){B?B.disconnect():window.removeEventListener("resize",z),u.removeChild(G)}return z(),{canvas:G,onDestroy:F}}function $v(u,m){function w(G){try{return u.getContext(G,m)}catch{return null}}return w("webgl")||w("experimental-webgl")||w("webgl-experimental")}function Ev(u){return typeof u.nodeName=="string"&&typeof u.appendChild=="function"&&typeof u.getBoundingClientRect=="function"}function Rv(u){return typeof u.drawArrays=="function"||typeof u.drawElements=="function"}function Zh(u){return typeof u=="string"?u.split():(O(Array.isArray(u),"invalid extension array"),u)}function zh(u){return typeof u=="string"?(O(typeof document<"u","not supported outside of DOM"),document.querySelector(u)):u}function Pv(u){var m=u||{},w,G,z,B,F={},ee=[],J=[],oe=typeof window>"u"?1:window.devicePixelRatio,le=!1,ae=function(ne){ne&&O.raise(ne)},he=function(){};if(typeof m=="string"?(O(typeof document<"u","selector queries only supported in DOM enviroments"),w=document.querySelector(m),O(w,"invalid query string for element")):typeof m=="object"?Ev(m)?w=m:Rv(m)?(B=m,z=B.canvas):(O.constructor(m),"gl"in m?B=m.gl:"canvas"in m?z=zh(m.canvas):"container"in m&&(G=zh(m.container)),"attributes"in m&&(F=m.attributes,O.type(F,"object","invalid context attributes")),"extensions"in m&&(ee=Zh(m.extensions)),"optionalExtensions"in m&&(J=Zh(m.optionalExtensions)),"onDone"in m&&(O.type(m.onDone,"function","invalid or missing onDone callback"),ae=m.onDone),"profile"in m&&(le=!!m.profile),"pixelRatio"in m&&(oe=+m.pixelRatio,O(oe>0,"invalid pixel ratio"))):O.raise("invalid arguments to regl"),w&&(w.nodeName.toLowerCase()==="canvas"?z=w:G=w),!B){if(!z){O(typeof document<"u","must manually specify webgl context outside of DOM environments");var te=Cv(G||document.body,ae,oe);if(!te)return null;z=te.canvas,he=te.onDestroy}F.premultipliedAlpha===void 0&&(F.premultipliedAlpha=!0),B=$v(z,F)}return B?{gl:B,canvas:z,container:G,extensions:ee,optionalExtensions:J,pixelRatio:oe,profile:le,onDone:ae,onDestroy:he}:(he(),ae("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Lv(u,m){var w={};function G(F){O.type(F,"string","extension name must be string");var ee=F.toLowerCase(),J;try{J=w[ee]=u.getExtension(ee)}catch{}return!!J}for(var z=0;z<m.extensions.length;++z){var B=m.extensions[z];if(!G(B))return m.onDestroy(),m.onDone('"'+B+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return m.optionalExtensions.forEach(G),{extensions:w,restore:function(){Object.keys(w).forEach(function(F){if(w[F]&&!G(F))throw new Error("(regl): error restoring extension "+F)})}}}function yi(u,m){for(var w=Array(u),G=0;G<u;++G)w[G]=m(G);return w}var Dv=5120,Mv=5121,Iv=5122,Bv=5123,Gv=5124,Nv=5125,Wv=5126;function Fv(u){for(var m=16;m<=1<<28;m*=16)if(u<=m)return m;return 0}function Uh(u){var m,w;return m=(u>65535)<<4,u>>>=m,w=(u>255)<<3,u>>>=w,m|=w,w=(u>15)<<2,u>>>=w,m|=w,w=(u>3)<<1,u>>>=w,m|=w,m|u>>1}function qh(){var u=yi(8,function(){return[]});function m(B){var F=Fv(B),ee=u[Uh(F)>>2];return ee.length>0?ee.pop():new ArrayBuffer(F)}function w(B){u[Uh(B.byteLength)>>2].push(B)}function G(B,F){var ee=null;switch(B){case Dv:ee=new Int8Array(m(F),0,F);break;case Mv:ee=new Uint8Array(m(F),0,F);break;case Iv:ee=new Int16Array(m(2*F),0,F);break;case Bv:ee=new Uint16Array(m(2*F),0,F);break;case Gv:ee=new Int32Array(m(4*F),0,F);break;case Nv:ee=new Uint32Array(m(4*F),0,F);break;case Wv:ee=new Float32Array(m(4*F),0,F);break;default:return null}return ee.length!==F?ee.subarray(0,F):ee}function z(B){w(B.buffer)}return{alloc:m,free:w,allocType:G,freeType:z}}var Tt=qh();Tt.zero=qh();var Xv=3408,jv=3410,Vv=3411,Zv=3412,zv=3413,Uv=3414,qv=3415,Hv=33901,Yv=33902,Kv=3379,Jv=3386,eb=34921,tb=36347,ib=36348,rb=35661,nb=35660,sb=34930,ob=36349,ab=34076,lb=34024,fb=7936,cb=7937,hb=7938,ub=35724,db=34047,pb=36063,mb=34852,xo=3553,Hh=34067,Ob=34069,gb=33984,as=6408,Cl=5126,Yh=5121,$l=36160,vb=36053,bb=36064,yb=16384,xb=function(u,m){var w=1;m.ext_texture_filter_anisotropic&&(w=u.getParameter(db));var G=1,z=1;m.webgl_draw_buffers&&(G=u.getParameter(mb),z=u.getParameter(pb));var B=!!m.oes_texture_float;if(B){var F=u.createTexture();u.bindTexture(xo,F),u.texImage2D(xo,0,as,1,1,0,as,Cl,null);var ee=u.createFramebuffer();if(u.bindFramebuffer($l,ee),u.framebufferTexture2D($l,bb,xo,F,0),u.bindTexture(xo,null),u.checkFramebufferStatus($l)!==vb)B=!1;else{u.viewport(0,0,1,1),u.clearColor(1,0,0,1),u.clear(yb);var J=Tt.allocType(Cl,4);u.readPixels(0,0,1,1,as,Cl,J),u.getError()?B=!1:(u.deleteFramebuffer(ee),u.deleteTexture(F),B=J[0]===1),Tt.freeType(J)}}var oe=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),le=!0;if(!oe){var ae=u.createTexture(),he=Tt.allocType(Yh,36);u.activeTexture(gb),u.bindTexture(Hh,ae),u.texImage2D(Ob,0,as,3,3,0,as,Yh,he),Tt.freeType(he),u.bindTexture(Hh,null),u.deleteTexture(ae),le=!u.getError()}return{colorBits:[u.getParameter(jv),u.getParameter(Vv),u.getParameter(Zv),u.getParameter(zv)],depthBits:u.getParameter(Uv),stencilBits:u.getParameter(qv),subpixelBits:u.getParameter(Xv),extensions:Object.keys(m).filter(function(te){return!!m[te]}),maxAnisotropic:w,maxDrawbuffers:G,maxColorAttachments:z,pointSizeDims:u.getParameter(Hv),lineWidthDims:u.getParameter(Yv),maxViewportDims:u.getParameter(Jv),maxCombinedTextureUnits:u.getParameter(rb),maxCubeMapSize:u.getParameter(ab),maxRenderbufferSize:u.getParameter(lb),maxTextureUnits:u.getParameter(sb),maxTextureSize:u.getParameter(Kv),maxAttributes:u.getParameter(eb),maxVertexUniforms:u.getParameter(tb),maxVertexTextureUnits:u.getParameter(nb),maxVaryingVectors:u.getParameter(ib),maxFragmentUniforms:u.getParameter(ob),glsl:u.getParameter(ub),renderer:u.getParameter(cb),vendor:u.getParameter(fb),version:u.getParameter(hb),readFloat:B,npotTextureCube:le}};function Di(u){return!!u&&typeof u=="object"&&Array.isArray(u.shape)&&Array.isArray(u.stride)&&typeof u.offset=="number"&&u.shape.length===u.stride.length&&(Array.isArray(u.data)||t(u.data))}var xi=function(u){return Object.keys(u).map(function(m){return u[m]})},So={shape:Tb,flatten:wb};function Sb(u,m,w){for(var G=0;G<m;++G)w[G]=u[G]}function _b(u,m,w,G){for(var z=0,B=0;B<m;++B)for(var F=u[B],ee=0;ee<w;++ee)G[z++]=F[ee]}function Kh(u,m,w,G,z,B){for(var F=B,ee=0;ee<m;++ee)for(var J=u[ee],oe=0;oe<w;++oe)for(var le=J[oe],ae=0;ae<G;++ae)z[F++]=le[ae]}function Jh(u,m,w,G,z){for(var B=1,F=w+1;F<m.length;++F)B*=m[F];var ee=m[w];if(m.length-w===4){var J=m[w+1],oe=m[w+2],le=m[w+3];for(F=0;F<ee;++F)Kh(u[F],J,oe,le,G,z),z+=B}else for(F=0;F<ee;++F)Jh(u[F],m,w+1,G,z),z+=B}function wb(u,m,w,G){var z=1;if(m.length)for(var B=0;B<m.length;++B)z*=m[B];else z=0;var F=G||Tt.allocType(w,z);switch(m.length){case 0:break;case 1:Sb(u,m[0],F);break;case 2:_b(u,m[0],m[1],F);break;case 3:Kh(u,m[0],m[1],m[2],F,0);break;default:Jh(u,m,0,F,0)}return F}function Tb(u){for(var m=[],w=u;w.length;w=w[0])m.push(w.length);return m}var El={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},kb=5120,Qb=5122,Ab=5124,Cb=5121,$b=5123,Eb=5125,Rb=5126,Pb=5126,Vr={int8:kb,int16:Qb,int32:Ab,uint8:Cb,uint16:$b,uint32:Eb,float:Rb,float32:Pb},Lb=35048,Db=35040,_o={dynamic:Lb,stream:Db,static:35044},Rl=So.flatten,eu=So.shape,tu=35044,Mb=35040,Pl=5121,Ll=5126,gr=[];gr[5120]=1,gr[5122]=2,gr[5124]=4,gr[5121]=1,gr[5123]=2,gr[5125]=4,gr[5126]=4;function wo(u){return El[Object.prototype.toString.call(u)]|0}function iu(u,m){for(var w=0;w<m.length;++w)u[w]=m[w]}function ru(u,m,w,G,z,B,F){for(var ee=0,J=0;J<w;++J)for(var oe=0;oe<G;++oe)u[ee++]=m[z*J+B*oe+F]}function Ib(u,m,w,G){var z=0,B={};function F($){this.id=z++,this.buffer=u.createBuffer(),this.type=$,this.usage=tu,this.byteLength=0,this.dimension=1,this.dtype=Pl,this.persistentData=null,w.profile&&(this.stats={size:0})}F.prototype.bind=function(){u.bindBuffer(this.type,this.buffer)},F.prototype.destroy=function(){he(this)};var ee=[];function J($,W){var re=ee.pop();return re||(re=new F($)),re.bind(),ae(re,W,Mb,0,1,!1),re}function oe($){ee.push($)}function le($,W,re){$.byteLength=W.byteLength,u.bufferData($.type,W,re)}function ae($,W,re,ye,K,ve){var Oe;if($.usage=re,Array.isArray(W)){if($.dtype=ye||Ll,W.length>0){var Ee;if(Array.isArray(W[0])){Oe=eu(W);for(var q=1,Z=1;Z<Oe.length;++Z)q*=Oe[Z];$.dimension=q,Ee=Rl(W,Oe,$.dtype),le($,Ee,re),ve?$.persistentData=Ee:Tt.freeType(Ee)}else if(typeof W[0]=="number"){$.dimension=K;var _e=Tt.allocType($.dtype,W.length);iu(_e,W),le($,_e,re),ve?$.persistentData=_e:Tt.freeType(_e)}else t(W[0])?($.dimension=W[0].length,$.dtype=ye||wo(W[0])||Ll,Ee=Rl(W,[W.length,W[0].length],$.dtype),le($,Ee,re),ve?$.persistentData=Ee:Tt.freeType(Ee)):O.raise("invalid buffer data")}}else if(t(W))$.dtype=ye||wo(W),$.dimension=K,le($,W,re),ve&&($.persistentData=new Uint8Array(new Uint8Array(W.buffer)));else if(Di(W)){Oe=W.shape;var ue=W.stride,ie=W.offset,de=0,me=0,We=0,Ge=0;Oe.length===1?(de=Oe[0],me=1,We=ue[0],Ge=0):Oe.length===2?(de=Oe[0],me=Oe[1],We=ue[0],Ge=ue[1]):O.raise("invalid shape"),$.dtype=ye||wo(W.data)||Ll,$.dimension=me;var ge=Tt.allocType($.dtype,de*me);ru(ge,W.data,de,me,We,Ge,ie),le($,ge,re),ve?$.persistentData=ge:Tt.freeType(ge)}else W instanceof ArrayBuffer?($.dtype=Pl,$.dimension=K,le($,W,re),ve&&($.persistentData=new Uint8Array(new Uint8Array(W)))):O.raise("invalid buffer data")}function he($){m.bufferCount--,G($);var W=$.buffer;O(W,"buffer must not be deleted already"),u.deleteBuffer(W),$.buffer=null,delete B[$.id]}function te($,W,re,ye){m.bufferCount++;var K=new F(W);B[K.id]=K;function ve(q){var Z=tu,_e=null,ue=0,ie=0,de=1;return Array.isArray(q)||t(q)||Di(q)||q instanceof ArrayBuffer?_e=q:typeof q=="number"?ue=q|0:q&&(O.type(q,"object","buffer arguments must be an object, a number or an array"),"data"in q&&(O(_e===null||Array.isArray(_e)||t(_e)||Di(_e),"invalid data for buffer"),_e=q.data),"usage"in q&&(O.parameter(q.usage,_o,"invalid buffer usage"),Z=_o[q.usage]),"type"in q&&(O.parameter(q.type,Vr,"invalid buffer type"),ie=Vr[q.type]),"dimension"in q&&(O.type(q.dimension,"number","invalid dimension"),de=q.dimension|0),"length"in q&&(O.nni(ue,"buffer length must be a nonnegative integer"),ue=q.length|0)),K.bind(),_e?ae(K,_e,Z,ie,de,ye):(ue&&u.bufferData(K.type,ue,Z),K.dtype=ie||Pl,K.usage=Z,K.dimension=de,K.byteLength=ue),w.profile&&(K.stats.size=K.byteLength*gr[K.dtype]),ve}function Oe(q,Z){O(Z+q.byteLength<=K.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+q.byteLength+" starting from offset "+Z+" to a buffer of size "+K.byteLength),u.bufferSubData(K.type,Z,q)}function Ee(q,Z){var _e=(Z||0)|0,ue;if(K.bind(),t(q)||q instanceof ArrayBuffer)Oe(q,_e);else if(Array.isArray(q)){if(q.length>0)if(typeof q[0]=="number"){var ie=Tt.allocType(K.dtype,q.length);iu(ie,q),Oe(ie,_e),Tt.freeType(ie)}else if(Array.isArray(q[0])||t(q[0])){ue=eu(q);var de=Rl(q,ue,K.dtype);Oe(de,_e),Tt.freeType(de)}else O.raise("invalid buffer data")}else if(Di(q)){ue=q.shape;var me=q.stride,We=0,Ge=0,ge=0,be=0;ue.length===1?(We=ue[0],Ge=1,ge=me[0],be=0):ue.length===2?(We=ue[0],Ge=ue[1],ge=me[0],be=me[1]):O.raise("invalid shape");var Pe=Array.isArray(q.data)?K.dtype:wo(q.data),Fe=Tt.allocType(Pe,We*Ge);ru(Fe,q.data,We,Ge,ge,be,q.offset),Oe(Fe,_e),Tt.freeType(Fe)}else O.raise("invalid data for buffer subdata");return ve}return re||ve($),ve._reglType="buffer",ve._buffer=K,ve.subdata=Ee,w.profile&&(ve.stats=K.stats),ve.destroy=function(){he(K)},ve}function ne(){xi(B).forEach(function($){$.buffer=u.createBuffer(),u.bindBuffer($.type,$.buffer),u.bufferData($.type,$.persistentData||$.byteLength,$.usage)})}return w.profile&&(m.getTotalBufferSize=function(){var $=0;return Object.keys(B).forEach(function(W){$+=B[W].stats.size}),$}),{create:te,createStream:J,destroyStream:oe,clear:function(){xi(B).forEach(he),ee.forEach(he)},getBuffer:function($){return $&&$._buffer instanceof F?$._buffer:null},restore:ne,_initBuffer:ae}}var Bb=0,Gb=0,Nb=1,Wb=1,Fb=4,Xb=4,vr={points:Bb,point:Gb,lines:Nb,line:Wb,triangles:Fb,triangle:Xb,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},jb=0,Vb=1,ls=4,Zb=5120,Sn=5121,nu=5122,_n=5123,su=5124,Zr=5125,Dl=34963,zb=35040,Ub=35044;function qb(u,m,w,G){var z={},B=0,F={uint8:Sn,uint16:_n};m.oes_element_index_uint&&(F.uint32=Zr);function ee(ne){this.id=B++,z[this.id]=this,this.buffer=ne,this.primType=ls,this.vertCount=0,this.type=0}ee.prototype.bind=function(){this.buffer.bind()};var J=[];function oe(ne){var $=J.pop();return $||($=new ee(w.create(null,Dl,!0,!1)._buffer)),ae($,ne,zb,-1,-1,0,0),$}function le(ne){J.push(ne)}function ae(ne,$,W,re,ye,K,ve){ne.buffer.bind();var Oe;if($){var Ee=ve;!ve&&(!t($)||Di($)&&!t($.data))&&(Ee=m.oes_element_index_uint?Zr:_n),w._initBuffer(ne.buffer,$,W,Ee,3)}else u.bufferData(Dl,K,W),ne.buffer.dtype=Oe||Sn,ne.buffer.usage=W,ne.buffer.dimension=3,ne.buffer.byteLength=K;if(Oe=ve,!ve){switch(ne.buffer.dtype){case Sn:case Zb:Oe=Sn;break;case _n:case nu:Oe=_n;break;case Zr:case su:Oe=Zr;break;default:O.raise("unsupported type for element array")}ne.buffer.dtype=Oe}ne.type=Oe,O(Oe!==Zr||!!m.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var q=ye;q<0&&(q=ne.buffer.byteLength,Oe===_n?q>>=1:Oe===Zr&&(q>>=2)),ne.vertCount=q;var Z=re;if(re<0){Z=ls;var _e=ne.buffer.dimension;_e===1&&(Z=jb),_e===2&&(Z=Vb),_e===3&&(Z=ls)}ne.primType=Z}function he(ne){G.elementsCount--,O(ne.buffer!==null,"must not double destroy elements"),delete z[ne.id],ne.buffer.destroy(),ne.buffer=null}function te(ne,$){var W=w.create(null,Dl,!0),re=new ee(W._buffer);G.elementsCount++;function ye(K){if(!K)W(),re.primType=ls,re.vertCount=0,re.type=Sn;else if(typeof K=="number")W(K),re.primType=ls,re.vertCount=K|0,re.type=Sn;else{var ve=null,Oe=Ub,Ee=-1,q=-1,Z=0,_e=0;Array.isArray(K)||t(K)||Di(K)?ve=K:(O.type(K,"object","invalid arguments for elements"),"data"in K&&(ve=K.data,O(Array.isArray(ve)||t(ve)||Di(ve),"invalid data for element buffer")),"usage"in K&&(O.parameter(K.usage,_o,"invalid element buffer usage"),Oe=_o[K.usage]),"primitive"in K&&(O.parameter(K.primitive,vr,"invalid element buffer primitive"),Ee=vr[K.primitive]),"count"in K&&(O(typeof K.count=="number"&&K.count>=0,"invalid vertex count for elements"),q=K.count|0),"type"in K&&(O.parameter(K.type,F,"invalid buffer type"),_e=F[K.type]),"length"in K?Z=K.length|0:(Z=q,_e===_n||_e===nu?Z*=2:(_e===Zr||_e===su)&&(Z*=4))),ae(re,ve,Oe,Ee,q,Z,_e)}return ye}return ye(ne),ye._reglType="elements",ye._elements=re,ye.subdata=function(K,ve){return W.subdata(K,ve),ye},ye.destroy=function(){he(re)},ye}return{create:te,createStream:oe,destroyStream:le,getElements:function(ne){return typeof ne=="function"&&ne._elements instanceof ee?ne._elements:null},clear:function(){xi(z).forEach(he)}}}var ou=new Float32Array(1),Hb=new Uint32Array(ou.buffer),Yb=5123;function au(u){for(var m=Tt.allocType(Yb,u.length),w=0;w<u.length;++w)if(isNaN(u[w]))m[w]=65535;else if(u[w]===1/0)m[w]=31744;else if(u[w]===-1/0)m[w]=64512;else{ou[0]=u[w];var G=Hb[0],z=G>>>31<<15,B=(G<<1>>>24)-127,F=G>>13&(1<<10)-1;if(B<-24)m[w]=z;else if(B<-14){var ee=-14-B;m[w]=z+(F+(1<<10)>>ee)}else B>15?m[w]=z+31744:m[w]=z+(B+15<<10)+F}return m}function ct(u){return Array.isArray(u)||t(u)}var lu=function(u){return!(u&u-1)&&!!u},Kb=34467,Vi=3553,Ml=34067,To=34069,zr=6408,Il=6406,ko=6407,fs=6409,Qo=6410,fu=32854,Bl=32855,cu=36194,Jb=32819,ey=32820,ty=33635,iy=34042,Gl=6402,Ao=34041,Nl=35904,Wl=35906,wn=36193,Fl=33776,Xl=33777,jl=33778,Vl=33779,hu=35986,uu=35987,du=34798,pu=35840,mu=35841,Ou=35842,gu=35843,vu=36196,Tn=5121,Zl=5123,zl=5125,cs=5126,ry=10242,ny=10243,sy=10497,Ul=33071,oy=33648,ay=10240,ly=10241,ql=9728,fy=9729,Hl=9984,bu=9985,yu=9986,Yl=9987,cy=33170,Co=4352,hy=4353,uy=4354,dy=34046,py=3317,my=37440,Oy=37441,gy=37443,xu=37444,hs=33984,vy=[Hl,yu,bu,Yl],$o=[0,fs,Qo,ko,zr],Ci={};Ci[fs]=Ci[Il]=Ci[Gl]=1,Ci[Ao]=Ci[Qo]=2,Ci[ko]=Ci[Nl]=3,Ci[zr]=Ci[Wl]=4;function kn(u){return"[object "+u+"]"}var Su=kn("HTMLCanvasElement"),_u=kn("OffscreenCanvas"),wu=kn("CanvasRenderingContext2D"),Tu=kn("ImageBitmap"),ku=kn("HTMLImageElement"),Qu=kn("HTMLVideoElement"),by=Object.keys(El).concat([Su,_u,wu,Tu,ku,Qu]),Qn=[];Qn[Tn]=1,Qn[cs]=4,Qn[wn]=2,Qn[Zl]=2,Qn[zl]=4;var jt=[];jt[fu]=2,jt[Bl]=2,jt[cu]=2,jt[Ao]=4,jt[Fl]=.5,jt[Xl]=.5,jt[jl]=1,jt[Vl]=1,jt[hu]=.5,jt[uu]=1,jt[du]=1,jt[pu]=.5,jt[mu]=.25,jt[Ou]=.5,jt[gu]=.25,jt[vu]=.5;function Au(u){return Array.isArray(u)&&(u.length===0||typeof u[0]=="number")}function Cu(u){if(!Array.isArray(u))return!1;var m=u.length;return!(m===0||!ct(u[0]))}function Ur(u){return Object.prototype.toString.call(u)}function $u(u){return Ur(u)===Su}function Eu(u){return Ur(u)===_u}function yy(u){return Ur(u)===wu}function xy(u){return Ur(u)===Tu}function Sy(u){return Ur(u)===ku}function _y(u){return Ur(u)===Qu}function Kl(u){if(!u)return!1;var m=Ur(u);return by.indexOf(m)>=0?!0:Au(u)||Cu(u)||Di(u)}function Ru(u){return El[Object.prototype.toString.call(u)]|0}function wy(u,m){var w=m.length;switch(u.type){case Tn:case Zl:case zl:case cs:var G=Tt.allocType(u.type,w);G.set(m),u.data=G;break;case wn:u.data=au(m);break;default:O.raise("unsupported texture type, must specify a typed array")}}function Pu(u,m){return Tt.allocType(u.type===wn?cs:u.type,m)}function Lu(u,m){u.type===wn?(u.data=au(m),Tt.freeType(m)):u.data=m}function Ty(u,m,w,G,z,B){for(var F=u.width,ee=u.height,J=u.channels,oe=F*ee*J,le=Pu(u,oe),ae=0,he=0;he<ee;++he)for(var te=0;te<F;++te)for(var ne=0;ne<J;++ne)le[ae++]=m[w*te+G*he+z*ne+B];Lu(u,le)}function Eo(u,m,w,G,z,B){var F;if(typeof jt[u]<"u"?F=jt[u]:F=Ci[u]*Qn[m],B&&(F*=6),z){for(var ee=0,J=w;J>=1;)ee+=F*J*J,J/=2;return ee}else return F*w*G}function ky(u,m,w,G,z,B,F){var ee={"don't care":Co,"dont care":Co,nice:uy,fast:hy},J={repeat:sy,clamp:Ul,mirror:oy},oe={nearest:ql,linear:fy},le=i({mipmap:Yl,"nearest mipmap nearest":Hl,"linear mipmap nearest":bu,"nearest mipmap linear":yu,"linear mipmap linear":Yl},oe),ae={none:0,browser:xu},he={uint8:Tn,rgba4:Jb,rgb565:ty,"rgb5 a1":ey},te={alpha:Il,luminance:fs,"luminance alpha":Qo,rgb:ko,rgba:zr,rgba4:fu,"rgb5 a1":Bl,rgb565:cu},ne={};m.ext_srgb&&(te.srgb=Nl,te.srgba=Wl),m.oes_texture_float&&(he.float32=he.float=cs),m.oes_texture_half_float&&(he.float16=he["half float"]=wn),m.webgl_depth_texture&&(i(te,{depth:Gl,"depth stencil":Ao}),i(he,{uint16:Zl,uint32:zl,"depth stencil":iy})),m.webgl_compressed_texture_s3tc&&i(ne,{"rgb s3tc dxt1":Fl,"rgba s3tc dxt1":Xl,"rgba s3tc dxt3":jl,"rgba s3tc dxt5":Vl}),m.webgl_compressed_texture_atc&&i(ne,{"rgb atc":hu,"rgba atc explicit alpha":uu,"rgba atc interpolated alpha":du}),m.webgl_compressed_texture_pvrtc&&i(ne,{"rgb pvrtc 4bppv1":pu,"rgb pvrtc 2bppv1":mu,"rgba pvrtc 4bppv1":Ou,"rgba pvrtc 2bppv1":gu}),m.webgl_compressed_texture_etc1&&(ne["rgb etc1"]=vu);var $=Array.prototype.slice.call(u.getParameter(Kb));Object.keys(ne).forEach(function(x){var N=ne[x];$.indexOf(N)>=0&&(te[x]=N)});var W=Object.keys(te);w.textureFormats=W;var re=[];Object.keys(te).forEach(function(x){var N=te[x];re[N]=x});var ye=[];Object.keys(he).forEach(function(x){var N=he[x];ye[N]=x});var K=[];Object.keys(oe).forEach(function(x){var N=oe[x];K[N]=x});var ve=[];Object.keys(le).forEach(function(x){var N=le[x];ve[N]=x});var Oe=[];Object.keys(J).forEach(function(x){var N=J[x];Oe[N]=x});var Ee=W.reduce(function(x,N){var I=te[N];return I===fs||I===Il||I===fs||I===Qo||I===Gl||I===Ao||m.ext_srgb&&(I===Nl||I===Wl)?x[I]=I:I===Bl||N.indexOf("rgba")>=0?x[I]=zr:x[I]=ko,x},{});function q(){this.internalformat=zr,this.format=zr,this.type=Tn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=xu,this.width=0,this.height=0,this.channels=0}function Z(x,N){x.internalformat=N.internalformat,x.format=N.format,x.type=N.type,x.compressed=N.compressed,x.premultiplyAlpha=N.premultiplyAlpha,x.flipY=N.flipY,x.unpackAlignment=N.unpackAlignment,x.colorSpace=N.colorSpace,x.width=N.width,x.height=N.height,x.channels=N.channels}function _e(x,N){if(!(typeof N!="object"||!N)){if("premultiplyAlpha"in N&&(O.type(N.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),x.premultiplyAlpha=N.premultiplyAlpha),"flipY"in N&&(O.type(N.flipY,"boolean","invalid texture flip"),x.flipY=N.flipY),"alignment"in N&&(O.oneOf(N.alignment,[1,2,4,8],"invalid texture unpack alignment"),x.unpackAlignment=N.alignment),"colorSpace"in N&&(O.parameter(N.colorSpace,ae,"invalid colorSpace"),x.colorSpace=ae[N.colorSpace]),"type"in N){var I=N.type;O(m.oes_texture_float||!(I==="float"||I==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),O(m.oes_texture_half_float||!(I==="half float"||I==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),O(m.webgl_depth_texture||!(I==="uint16"||I==="uint32"||I==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(I,he,"invalid texture type"),x.type=he[I]}var Se=x.width,Ze=x.height,v=x.channels,p=!1;"shape"in N?(O(Array.isArray(N.shape)&&N.shape.length>=2,"shape must be an array"),Se=N.shape[0],Ze=N.shape[1],N.shape.length===3&&(v=N.shape[2],O(v>0&&v<=4,"invalid number of channels"),p=!0),O(Se>=0&&Se<=w.maxTextureSize,"invalid width"),O(Ze>=0&&Ze<=w.maxTextureSize,"invalid height")):("radius"in N&&(Se=Ze=N.radius,O(Se>=0&&Se<=w.maxTextureSize,"invalid radius")),"width"in N&&(Se=N.width,O(Se>=0&&Se<=w.maxTextureSize,"invalid width")),"height"in N&&(Ze=N.height,O(Ze>=0&&Ze<=w.maxTextureSize,"invalid height")),"channels"in N&&(v=N.channels,O(v>0&&v<=4,"invalid number of channels"),p=!0)),x.width=Se|0,x.height=Ze|0,x.channels=v|0;var T=!1;if("format"in N){var C=N.format;O(m.webgl_depth_texture||!(C==="depth"||C==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(C,te,"invalid texture format");var R=x.internalformat=te[C];x.format=Ee[R],C in he&&("type"in N||(x.type=he[C])),C in ne&&(x.compressed=!0),T=!0}!p&&T?x.channels=Ci[x.format]:p&&!T?x.channels!==$o[x.format]&&(x.format=x.internalformat=$o[x.channels]):T&&p&&O(x.channels===Ci[x.format],"number of channels inconsistent with specified format")}}function ue(x){u.pixelStorei(my,x.flipY),u.pixelStorei(Oy,x.premultiplyAlpha),u.pixelStorei(gy,x.colorSpace),u.pixelStorei(py,x.unpackAlignment)}function ie(){q.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function de(x,N){var I=null;if(Kl(N)?I=N:N&&(O.type(N,"object","invalid pixel data type"),_e(x,N),"x"in N&&(x.xOffset=N.x|0),"y"in N&&(x.yOffset=N.y|0),Kl(N.data)&&(I=N.data)),O(!x.compressed||I instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),N.copy){O(!I,"can not specify copy and data field for the same texture");var Se=z.viewportWidth,Ze=z.viewportHeight;x.width=x.width||Se-x.xOffset,x.height=x.height||Ze-x.yOffset,x.needsCopy=!0,O(x.xOffset>=0&&x.xOffset<Se&&x.yOffset>=0&&x.yOffset<Ze&&x.width>0&&x.width<=Se&&x.height>0&&x.height<=Ze,"copy texture read out of bounds")}else if(!I)x.width=x.width||1,x.height=x.height||1,x.channels=x.channels||4;else if(t(I))x.channels=x.channels||4,x.data=I,!("type"in N)&&x.type===Tn&&(x.type=Ru(I));else if(Au(I))x.channels=x.channels||4,wy(x,I),x.alignment=1,x.needsFree=!0;else if(Di(I)){var v=I.data;!Array.isArray(v)&&x.type===Tn&&(x.type=Ru(v));var p=I.shape,T=I.stride,C,R,Q,k,A,b;p.length===3?(Q=p[2],b=T[2]):(O(p.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Q=1,b=1),C=p[0],R=p[1],k=T[0],A=T[1],x.alignment=1,x.width=C,x.height=R,x.channels=Q,x.format=x.internalformat=$o[Q],x.needsFree=!0,Ty(x,v,k,A,b,I.offset)}else if($u(I)||Eu(I)||yy(I))$u(I)||Eu(I)?x.element=I:x.element=I.canvas,x.width=x.element.width,x.height=x.element.height,x.channels=4;else if(xy(I))x.element=I,x.width=I.width,x.height=I.height,x.channels=4;else if(Sy(I))x.element=I,x.width=I.naturalWidth,x.height=I.naturalHeight,x.channels=4;else if(_y(I))x.element=I,x.width=I.videoWidth,x.height=I.videoHeight,x.channels=4;else if(Cu(I)){var S=x.width||I[0].length,y=x.height||I.length,M=x.channels;ct(I[0][0])?M=M||I[0][0].length:M=M||1;for(var P=So.shape(I),V=1,H=0;H<P.length;++H)V*=P[H];var ce=Pu(x,V);So.flatten(I,P,"",ce),Lu(x,ce),x.alignment=1,x.width=S,x.height=y,x.channels=M,x.format=x.internalformat=$o[M],x.needsFree=!0}x.type===cs?O(w.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):x.type===wn&&O(w.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function me(x,N,I){var Se=x.element,Ze=x.data,v=x.internalformat,p=x.format,T=x.type,C=x.width,R=x.height;ue(x),Se?u.texImage2D(N,I,p,p,T,Se):x.compressed?u.compressedTexImage2D(N,I,v,C,R,0,Ze):x.needsCopy?(G(),u.copyTexImage2D(N,I,p,x.xOffset,x.yOffset,C,R,0)):u.texImage2D(N,I,p,C,R,0,p,T,Ze||null)}function We(x,N,I,Se,Ze){var v=x.element,p=x.data,T=x.internalformat,C=x.format,R=x.type,Q=x.width,k=x.height;ue(x),v?u.texSubImage2D(N,Ze,I,Se,C,R,v):x.compressed?u.compressedTexSubImage2D(N,Ze,I,Se,T,Q,k,p):x.needsCopy?(G(),u.copyTexSubImage2D(N,Ze,I,Se,x.xOffset,x.yOffset,Q,k)):u.texSubImage2D(N,Ze,I,Se,Q,k,C,R,p)}var Ge=[];function ge(){return Ge.pop()||new ie}function be(x){x.needsFree&&Tt.freeType(x.data),ie.call(x),Ge.push(x)}function Pe(){q.call(this),this.genMipmaps=!1,this.mipmapHint=Co,this.mipmask=0,this.images=Array(16)}function Fe(x,N,I){var Se=x.images[0]=ge();x.mipmask=1,Se.width=x.width=N,Se.height=x.height=I,Se.channels=x.channels=4}function ze(x,N){var I=null;if(Kl(N))I=x.images[0]=ge(),Z(I,x),de(I,N),x.mipmask=1;else if(_e(x,N),Array.isArray(N.mipmap))for(var Se=N.mipmap,Ze=0;Ze<Se.length;++Ze)I=x.images[Ze]=ge(),Z(I,x),I.width>>=Ze,I.height>>=Ze,de(I,Se[Ze]),x.mipmask|=1<<Ze;else I=x.images[0]=ge(),Z(I,x),de(I,N),x.mipmask=1;Z(x,x.images[0]),x.compressed&&(x.internalformat===Fl||x.internalformat===Xl||x.internalformat===jl||x.internalformat===Vl)&&O(x.width%4===0&&x.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ht(x,N){for(var I=x.images,Se=0;Se<I.length;++Se){if(!I[Se])return;me(I[Se],N,Se)}}var mt=[];function qe(){var x=mt.pop()||new Pe;q.call(x),x.mipmask=0;for(var N=0;N<16;++N)x.images[N]=null;return x}function At(x){for(var N=x.images,I=0;I<N.length;++I)N[I]&&be(N[I]),N[I]=null;mt.push(x)}function lt(){this.minFilter=ql,this.magFilter=ql,this.wrapS=Ul,this.wrapT=Ul,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Co}function Qt(x,N){if("min"in N){var I=N.min;O.parameter(I,le),x.minFilter=le[I],vy.indexOf(x.minFilter)>=0&&!("faces"in N)&&(x.genMipmaps=!0)}if("mag"in N){var Se=N.mag;O.parameter(Se,oe),x.magFilter=oe[Se]}var Ze=x.wrapS,v=x.wrapT;if("wrap"in N){var p=N.wrap;typeof p=="string"?(O.parameter(p,J),Ze=v=J[p]):Array.isArray(p)&&(O.parameter(p[0],J),O.parameter(p[1],J),Ze=J[p[0]],v=J[p[1]])}else{if("wrapS"in N){var T=N.wrapS;O.parameter(T,J),Ze=J[T]}if("wrapT"in N){var C=N.wrapT;O.parameter(C,J),v=J[C]}}if(x.wrapS=Ze,x.wrapT=v,"anisotropic"in N){var R=N.anisotropic;O(typeof R=="number"&&R>=1&&R<=w.maxAnisotropic,"aniso samples must be between 1 and "),x.anisotropic=N.anisotropic}if("mipmap"in N){var Q=!1;switch(typeof N.mipmap){case"string":O.parameter(N.mipmap,ee,"invalid mipmap hint"),x.mipmapHint=ee[N.mipmap],x.genMipmaps=!0,Q=!0;break;case"boolean":Q=x.genMipmaps=N.mipmap;break;case"object":O(Array.isArray(N.mipmap),"invalid mipmap type"),x.genMipmaps=!1,Q=!0;break;default:O.raise("invalid mipmap type")}Q&&!("min"in N)&&(x.minFilter=Hl)}}function Ct(x,N){u.texParameteri(N,ly,x.minFilter),u.texParameteri(N,ay,x.magFilter),u.texParameteri(N,ry,x.wrapS),u.texParameteri(N,ny,x.wrapT),m.ext_texture_filter_anisotropic&&u.texParameteri(N,dy,x.anisotropic),x.genMipmaps&&(u.hint(cy,x.mipmapHint),u.generateMipmap(N))}var $t=0,It={},Vt=w.maxTextureUnits,yt=Array(Vt).map(function(){return null});function je(x){q.call(this),this.mipmask=0,this.internalformat=zr,this.id=$t++,this.refCount=1,this.target=x,this.texture=u.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new lt,F.profile&&(this.stats={size:0})}function Zt(x){u.activeTexture(hs),u.bindTexture(x.target,x.texture)}function Je(){var x=yt[0];x?u.bindTexture(x.target,x.texture):u.bindTexture(Vi,null)}function Re(x){var N=x.texture;O(N,"must not double destroy texture");var I=x.unit,Se=x.target;I>=0&&(u.activeTexture(hs+I),u.bindTexture(Se,null),yt[I]=null),u.deleteTexture(N),x.texture=null,x.params=null,x.pixels=null,x.refCount=0,delete It[x.id],B.textureCount--}i(je.prototype,{bind:function(){var x=this;x.bindCount+=1;var N=x.unit;if(N<0){for(var I=0;I<Vt;++I){var Se=yt[I];if(Se){if(Se.bindCount>0)continue;Se.unit=-1}yt[I]=x,N=I;break}N>=Vt&&O.raise("insufficient number of texture units"),F.profile&&B.maxTextureUnits<N+1&&(B.maxTextureUnits=N+1),x.unit=N,u.activeTexture(hs+N),u.bindTexture(x.target,x.texture)}return N},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Re(this)}});function Ue(x,N){var I=new je(Vi);It[I.id]=I,B.textureCount++;function Se(p,T){var C=I.texInfo;lt.call(C);var R=qe();return typeof p=="number"?typeof T=="number"?Fe(R,p|0,T|0):Fe(R,p|0,p|0):p?(O.type(p,"object","invalid arguments to regl.texture"),Qt(C,p),ze(R,p)):Fe(R,1,1),C.genMipmaps&&(R.mipmask=(R.width<<1)-1),I.mipmask=R.mipmask,Z(I,R),O.texture2D(C,R,w),I.internalformat=R.internalformat,Se.width=R.width,Se.height=R.height,Zt(I),ht(R,Vi),Ct(C,Vi),Je(),At(R),F.profile&&(I.stats.size=Eo(I.internalformat,I.type,R.width,R.height,C.genMipmaps,!1)),Se.format=re[I.internalformat],Se.type=ye[I.type],Se.mag=K[C.magFilter],Se.min=ve[C.minFilter],Se.wrapS=Oe[C.wrapS],Se.wrapT=Oe[C.wrapT],Se}function Ze(p,T,C,R){O(!!p,"must specify image data");var Q=T|0,k=C|0,A=R|0,b=ge();return Z(b,I),b.width=0,b.height=0,de(b,p),b.width=b.width||(I.width>>A)-Q,b.height=b.height||(I.height>>A)-k,O(I.type===b.type&&I.format===b.format&&I.internalformat===b.internalformat,"incompatible format for texture.subimage"),O(Q>=0&&k>=0&&Q+b.width<=I.width&&k+b.height<=I.height,"texture.subimage write out of bounds"),O(I.mipmask&1<<A,"missing mipmap data"),O(b.data||b.element||b.needsCopy,"missing image data"),Zt(I),We(b,Vi,Q,k,A),Je(),be(b),Se}function v(p,T){var C=p|0,R=T|0||C;if(C===I.width&&R===I.height)return Se;Se.width=I.width=C,Se.height=I.height=R,Zt(I);for(var Q=0;I.mipmask>>Q;++Q){var k=C>>Q,A=R>>Q;if(!k||!A)break;u.texImage2D(Vi,Q,I.format,k,A,0,I.format,I.type,null)}return Je(),F.profile&&(I.stats.size=Eo(I.internalformat,I.type,C,R,!1,!1)),Se}return Se(x,N),Se.subimage=Ze,Se.resize=v,Se._reglType="texture2d",Se._texture=I,F.profile&&(Se.stats=I.stats),Se.destroy=function(){I.decRef()},Se}function Ye(x,N,I,Se,Ze,v){var p=new je(Ml);It[p.id]=p,B.cubeCount++;var T=new Array(6);function C(k,A,b,S,y,M){var P,V=p.texInfo;for(lt.call(V),P=0;P<6;++P)T[P]=qe();if(typeof k=="number"||!k){var H=k|0||1;for(P=0;P<6;++P)Fe(T[P],H,H)}else if(typeof k=="object")if(A)ze(T[0],k),ze(T[1],A),ze(T[2],b),ze(T[3],S),ze(T[4],y),ze(T[5],M);else if(Qt(V,k),_e(p,k),"faces"in k){var ce=k.faces;for(O(Array.isArray(ce)&&ce.length===6,"cube faces must be a length 6 array"),P=0;P<6;++P)O(typeof ce[P]=="object"&&!!ce[P],"invalid input for cube map face"),Z(T[P],p),ze(T[P],ce[P])}else for(P=0;P<6;++P)ze(T[P],k);else O.raise("invalid arguments to cube map");for(Z(p,T[0]),O.optional(function(){w.npotTextureCube||O(lu(p.width)&&lu(p.height),"your browser does not support non power or two texture dimensions")}),V.genMipmaps?p.mipmask=(T[0].width<<1)-1:p.mipmask=T[0].mipmask,O.textureCube(p,V,T,w),p.internalformat=T[0].internalformat,C.width=T[0].width,C.height=T[0].height,Zt(p),P=0;P<6;++P)ht(T[P],To+P);for(Ct(V,Ml),Je(),F.profile&&(p.stats.size=Eo(p.internalformat,p.type,C.width,C.height,V.genMipmaps,!0)),C.format=re[p.internalformat],C.type=ye[p.type],C.mag=K[V.magFilter],C.min=ve[V.minFilter],C.wrapS=Oe[V.wrapS],C.wrapT=Oe[V.wrapT],P=0;P<6;++P)At(T[P]);return C}function R(k,A,b,S,y){O(!!A,"must specify image data"),O(typeof k=="number"&&k===(k|0)&&k>=0&&k<6,"invalid face");var M=b|0,P=S|0,V=y|0,H=ge();return Z(H,p),H.width=0,H.height=0,de(H,A),H.width=H.width||(p.width>>V)-M,H.height=H.height||(p.height>>V)-P,O(p.type===H.type&&p.format===H.format&&p.internalformat===H.internalformat,"incompatible format for texture.subimage"),O(M>=0&&P>=0&&M+H.width<=p.width&&P+H.height<=p.height,"texture.subimage write out of bounds"),O(p.mipmask&1<<V,"missing mipmap data"),O(H.data||H.element||H.needsCopy,"missing image data"),Zt(p),We(H,To+k,M,P,V),Je(),be(H),C}function Q(k){var A=k|0;if(A!==p.width){C.width=p.width=A,C.height=p.height=A,Zt(p);for(var b=0;b<6;++b)for(var S=0;p.mipmask>>S;++S)u.texImage2D(To+b,S,p.format,A>>S,A>>S,0,p.format,p.type,null);return Je(),F.profile&&(p.stats.size=Eo(p.internalformat,p.type,C.width,C.height,!1,!0)),C}}return C(x,N,I,Se,Ze,v),C.subimage=R,C.resize=Q,C._reglType="textureCube",C._texture=p,F.profile&&(C.stats=p.stats),C.destroy=function(){p.decRef()},C}function xt(){for(var x=0;x<Vt;++x)u.activeTexture(hs+x),u.bindTexture(Vi,null),yt[x]=null;xi(It).forEach(Re),B.cubeCount=0,B.textureCount=0}F.profile&&(B.getTotalTextureSize=function(){var x=0;return Object.keys(It).forEach(function(N){x+=It[N].stats.size}),x});function zi(){for(var x=0;x<Vt;++x){var N=yt[x];N&&(N.bindCount=0,N.unit=-1,yt[x]=null)}xi(It).forEach(function(I){I.texture=u.createTexture(),u.bindTexture(I.target,I.texture);for(var Se=0;Se<32;++Se)if((I.mipmask&1<<Se)!==0)if(I.target===Vi)u.texImage2D(Vi,Se,I.internalformat,I.width>>Se,I.height>>Se,0,I.internalformat,I.type,null);else for(var Ze=0;Ze<6;++Ze)u.texImage2D(To+Ze,Se,I.internalformat,I.width>>Se,I.height>>Se,0,I.internalformat,I.type,null);Ct(I.texInfo,I.target)})}function tn(){for(var x=0;x<Vt;++x){var N=yt[x];N&&(N.bindCount=0,N.unit=-1,yt[x]=null),u.activeTexture(hs+x),u.bindTexture(Vi,null),u.bindTexture(Ml,null)}}return{create2D:Ue,createCube:Ye,clear:xt,getTexture:function(x){return null},restore:zi,refresh:tn}}var br=36161,Ro=32854,Du=32855,Mu=36194,Iu=33189,Bu=36168,Gu=34041,Nu=35907,Wu=34836,Fu=34842,Xu=34843,Mi=[];Mi[Ro]=2,Mi[Du]=2,Mi[Mu]=2,Mi[Iu]=2,Mi[Bu]=1,Mi[Gu]=4,Mi[Nu]=4,Mi[Wu]=16,Mi[Fu]=8,Mi[Xu]=6;function ju(u,m,w){return Mi[u]*m*w}var Qy=function(u,m,w,G,z){var B={rgba4:Ro,rgb565:Mu,"rgb5 a1":Du,depth:Iu,stencil:Bu,"depth stencil":Gu};m.ext_srgb&&(B.srgba=Nu),m.ext_color_buffer_half_float&&(B.rgba16f=Fu,B.rgb16f=Xu),m.webgl_color_buffer_float&&(B.rgba32f=Wu);var F=[];Object.keys(B).forEach(function(te){var ne=B[te];F[ne]=te});var ee=0,J={};function oe(te){this.id=ee++,this.refCount=1,this.renderbuffer=te,this.format=Ro,this.width=0,this.height=0,z.profile&&(this.stats={size:0})}oe.prototype.decRef=function(){--this.refCount<=0&&le(this)};function le(te){var ne=te.renderbuffer;O(ne,"must not double destroy renderbuffer"),u.bindRenderbuffer(br,null),u.deleteRenderbuffer(ne),te.renderbuffer=null,te.refCount=0,delete J[te.id],G.renderbufferCount--}function ae(te,ne){var $=new oe(u.createRenderbuffer());J[$.id]=$,G.renderbufferCount++;function W(ye,K){var ve=0,Oe=0,Ee=Ro;if(typeof ye=="object"&&ye){var q=ye;if("shape"in q){var Z=q.shape;O(Array.isArray(Z)&&Z.length>=2,"invalid renderbuffer shape"),ve=Z[0]|0,Oe=Z[1]|0}else"radius"in q&&(ve=Oe=q.radius|0),"width"in q&&(ve=q.width|0),"height"in q&&(Oe=q.height|0);"format"in q&&(O.parameter(q.format,B,"invalid renderbuffer format"),Ee=B[q.format])}else typeof ye=="number"?(ve=ye|0,typeof K=="number"?Oe=K|0:Oe=ve):ye?O.raise("invalid arguments to renderbuffer constructor"):ve=Oe=1;if(O(ve>0&&Oe>0&&ve<=w.maxRenderbufferSize&&Oe<=w.maxRenderbufferSize,"invalid renderbuffer size"),!(ve===$.width&&Oe===$.height&&Ee===$.format))return W.width=$.width=ve,W.height=$.height=Oe,$.format=Ee,u.bindRenderbuffer(br,$.renderbuffer),u.renderbufferStorage(br,Ee,ve,Oe),O(u.getError()===0,"invalid render buffer format"),z.profile&&($.stats.size=ju($.format,$.width,$.height)),W.format=F[$.format],W}function re(ye,K){var ve=ye|0,Oe=K|0||ve;return ve===$.width&&Oe===$.height||(O(ve>0&&Oe>0&&ve<=w.maxRenderbufferSize&&Oe<=w.maxRenderbufferSize,"invalid renderbuffer size"),W.width=$.width=ve,W.height=$.height=Oe,u.bindRenderbuffer(br,$.renderbuffer),u.renderbufferStorage(br,$.format,ve,Oe),O(u.getError()===0,"invalid render buffer format"),z.profile&&($.stats.size=ju($.format,$.width,$.height))),W}return W(te,ne),W.resize=re,W._reglType="renderbuffer",W._renderbuffer=$,z.profile&&(W.stats=$.stats),W.destroy=function(){$.decRef()},W}z.profile&&(G.getTotalRenderbufferSize=function(){var te=0;return Object.keys(J).forEach(function(ne){te+=J[ne].stats.size}),te});function he(){xi(J).forEach(function(te){te.renderbuffer=u.createRenderbuffer(),u.bindRenderbuffer(br,te.renderbuffer),u.renderbufferStorage(br,te.format,te.width,te.height)}),u.bindRenderbuffer(br,null)}return{create:ae,clear:function(){xi(J).forEach(le)},restore:he}},fr=36160,Jl=36161,qr=3553,Po=34069,Vu=36064,Zu=36096,zu=36128,Uu=33306,qu=36053,Ay=36054,Cy=36055,$y=36057,Ey=36061,Ry=36193,Py=5121,Ly=5126,Hu=6407,Yu=6408,Dy=6402,My=[Hu,Yu],ef=[];ef[Yu]=4,ef[Hu]=3;var Lo=[];Lo[Py]=1,Lo[Ly]=4,Lo[Ry]=2;var Iy=32854,By=32855,Gy=36194,Ny=33189,Wy=36168,Ku=34041,Fy=35907,Xy=34836,jy=34842,Vy=34843,Zy=[Iy,By,Gy,Fy,jy,Vy,Xy],An={};An[qu]="complete",An[Ay]="incomplete attachment",An[$y]="incomplete dimensions",An[Cy]="incomplete, missing attachment",An[Ey]="unsupported";function zy(u,m,w,G,z,B){var F={cur:null,next:null,dirty:!1,setFBO:null},ee=["rgba"],J=["rgba4","rgb565","rgb5 a1"];m.ext_srgb&&J.push("srgba"),m.ext_color_buffer_half_float&&J.push("rgba16f","rgb16f"),m.webgl_color_buffer_float&&J.push("rgba32f");var oe=["uint8"];m.oes_texture_half_float&&oe.push("half float","float16"),m.oes_texture_float&&oe.push("float","float32");function le(ie,de,me){this.target=ie,this.texture=de,this.renderbuffer=me;var We=0,Ge=0;de?(We=de.width,Ge=de.height):me&&(We=me.width,Ge=me.height),this.width=We,this.height=Ge}function ae(ie){ie&&(ie.texture&&ie.texture._texture.decRef(),ie.renderbuffer&&ie.renderbuffer._renderbuffer.decRef())}function he(ie,de,me){if(!!ie)if(ie.texture){var We=ie.texture._texture,Ge=Math.max(1,We.width),ge=Math.max(1,We.height);O(Ge===de&&ge===me,"inconsistent width/height for supplied texture"),We.refCount+=1}else{var be=ie.renderbuffer._renderbuffer;O(be.width===de&&be.height===me,"inconsistent width/height for renderbuffer"),be.refCount+=1}}function te(ie,de){de&&(de.texture?u.framebufferTexture2D(fr,ie,de.target,de.texture._texture.texture,0):u.framebufferRenderbuffer(fr,ie,Jl,de.renderbuffer._renderbuffer.renderbuffer))}function ne(ie){var de=qr,me=null,We=null,Ge=ie;typeof ie=="object"&&(Ge=ie.data,"target"in ie&&(de=ie.target|0)),O.type(Ge,"function","invalid attachment data");var ge=Ge._reglType;return ge==="texture2d"?(me=Ge,O(de===qr)):ge==="textureCube"?(me=Ge,O(de>=Po&&de<Po+6,"invalid cube map target")):ge==="renderbuffer"?(We=Ge,de=Jl):O.raise("invalid regl object for attachment"),new le(de,me,We)}function $(ie,de,me,We,Ge){if(me){var ge=G.create2D({width:ie,height:de,format:We,type:Ge});return ge._texture.refCount=0,new le(qr,ge,null)}else{var be=z.create({width:ie,height:de,format:We});return be._renderbuffer.refCount=0,new le(Jl,null,be)}}function W(ie){return ie&&(ie.texture||ie.renderbuffer)}function re(ie,de,me){ie&&(ie.texture?ie.texture.resize(de,me):ie.renderbuffer&&ie.renderbuffer.resize(de,me),ie.width=de,ie.height=me)}var ye=0,K={};function ve(){this.id=ye++,K[this.id]=this,this.framebuffer=u.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Oe(ie){ie.colorAttachments.forEach(ae),ae(ie.depthAttachment),ae(ie.stencilAttachment),ae(ie.depthStencilAttachment)}function Ee(ie){var de=ie.framebuffer;O(de,"must not double destroy framebuffer"),u.deleteFramebuffer(de),ie.framebuffer=null,B.framebufferCount--,delete K[ie.id]}function q(ie){var de;u.bindFramebuffer(fr,ie.framebuffer);var me=ie.colorAttachments;for(de=0;de<me.length;++de)te(Vu+de,me[de]);for(de=me.length;de<w.maxColorAttachments;++de)u.framebufferTexture2D(fr,Vu+de,qr,null,0);u.framebufferTexture2D(fr,Uu,qr,null,0),u.framebufferTexture2D(fr,Zu,qr,null,0),u.framebufferTexture2D(fr,zu,qr,null,0),te(Zu,ie.depthAttachment),te(zu,ie.stencilAttachment),te(Uu,ie.depthStencilAttachment);var We=u.checkFramebufferStatus(fr);!u.isContextLost()&&We!==qu&&O.raise("framebuffer configuration not supported, status = "+An[We]),u.bindFramebuffer(fr,F.next?F.next.framebuffer:null),F.cur=F.next,u.getError()}function Z(ie,de){var me=new ve;B.framebufferCount++;function We(ge,be){var Pe;O(F.next!==me,"can not update framebuffer which is currently in use");var Fe=0,ze=0,ht=!0,mt=!0,qe=null,At=!0,lt="rgba",Qt="uint8",Ct=1,$t=null,It=null,Vt=null,yt=!1;if(typeof ge=="number")Fe=ge|0,ze=be|0||Fe;else if(!ge)Fe=ze=1;else{O.type(ge,"object","invalid arguments for framebuffer");var je=ge;if("shape"in je){var Zt=je.shape;O(Array.isArray(Zt)&&Zt.length>=2,"invalid shape for framebuffer"),Fe=Zt[0],ze=Zt[1]}else"radius"in je&&(Fe=ze=je.radius),"width"in je&&(Fe=je.width),"height"in je&&(ze=je.height);("color"in je||"colors"in je)&&(qe=je.color||je.colors,Array.isArray(qe)&&O(qe.length===1||m.webgl_draw_buffers,"multiple render targets not supported")),qe||("colorCount"in je&&(Ct=je.colorCount|0,O(Ct>0,"invalid color buffer count")),"colorTexture"in je&&(At=!!je.colorTexture,lt="rgba4"),"colorType"in je&&(Qt=je.colorType,At?(O(m.oes_texture_float||!(Qt==="float"||Qt==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),O(m.oes_texture_half_float||!(Qt==="half float"||Qt==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Qt==="half float"||Qt==="float16"?(O(m.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),lt="rgba16f"):(Qt==="float"||Qt==="float32")&&(O(m.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),lt="rgba32f"),O.oneOf(Qt,oe,"invalid color type")),"colorFormat"in je&&(lt=je.colorFormat,ee.indexOf(lt)>=0?At=!0:J.indexOf(lt)>=0?At=!1:O.optional(function(){At?O.oneOf(je.colorFormat,ee,"invalid color format for texture"):O.oneOf(je.colorFormat,J,"invalid color format for renderbuffer")}))),("depthTexture"in je||"depthStencilTexture"in je)&&(yt=!!(je.depthTexture||je.depthStencilTexture),O(!yt||m.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in je&&(typeof je.depth=="boolean"?ht=je.depth:($t=je.depth,mt=!1)),"stencil"in je&&(typeof je.stencil=="boolean"?mt=je.stencil:(It=je.stencil,ht=!1)),"depthStencil"in je&&(typeof je.depthStencil=="boolean"?ht=mt=je.depthStencil:(Vt=je.depthStencil,ht=!1,mt=!1))}var Je=null,Re=null,Ue=null,Ye=null;if(Array.isArray(qe))Je=qe.map(ne);else if(qe)Je=[ne(qe)];else for(Je=new Array(Ct),Pe=0;Pe<Ct;++Pe)Je[Pe]=$(Fe,ze,At,lt,Qt);O(m.webgl_draw_buffers||Je.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),O(Je.length<=w.maxColorAttachments,"too many color attachments, not supported"),Fe=Fe||Je[0].width,ze=ze||Je[0].height,$t?Re=ne($t):ht&&!mt&&(Re=$(Fe,ze,yt,"depth","uint32")),It?Ue=ne(It):mt&&!ht&&(Ue=$(Fe,ze,!1,"stencil","uint8")),Vt?Ye=ne(Vt):!$t&&!It&&mt&&ht&&(Ye=$(Fe,ze,yt,"depth stencil","depth stencil")),O(!!$t+!!It+!!Vt<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var xt=null;for(Pe=0;Pe<Je.length;++Pe)if(he(Je[Pe],Fe,ze),O(!Je[Pe]||Je[Pe].texture&&My.indexOf(Je[Pe].texture._texture.format)>=0||Je[Pe].renderbuffer&&Zy.indexOf(Je[Pe].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Pe+" is invalid"),Je[Pe]&&Je[Pe].texture){var zi=ef[Je[Pe].texture._texture.format]*Lo[Je[Pe].texture._texture.type];xt===null?xt=zi:O(xt===zi,"all color attachments much have the same number of bits per pixel.")}return he(Re,Fe,ze),O(!Re||Re.texture&&Re.texture._texture.format===Dy||Re.renderbuffer&&Re.renderbuffer._renderbuffer.format===Ny,"invalid depth attachment for framebuffer object"),he(Ue,Fe,ze),O(!Ue||Ue.renderbuffer&&Ue.renderbuffer._renderbuffer.format===Wy,"invalid stencil attachment for framebuffer object"),he(Ye,Fe,ze),O(!Ye||Ye.texture&&Ye.texture._texture.format===Ku||Ye.renderbuffer&&Ye.renderbuffer._renderbuffer.format===Ku,"invalid depth-stencil attachment for framebuffer object"),Oe(me),me.width=Fe,me.height=ze,me.colorAttachments=Je,me.depthAttachment=Re,me.stencilAttachment=Ue,me.depthStencilAttachment=Ye,We.color=Je.map(W),We.depth=W(Re),We.stencil=W(Ue),We.depthStencil=W(Ye),We.width=me.width,We.height=me.height,q(me),We}function Ge(ge,be){O(F.next!==me,"can not resize a framebuffer which is currently in use");var Pe=Math.max(ge|0,1),Fe=Math.max(be|0||Pe,1);if(Pe===me.width&&Fe===me.height)return We;for(var ze=me.colorAttachments,ht=0;ht<ze.length;++ht)re(ze[ht],Pe,Fe);return re(me.depthAttachment,Pe,Fe),re(me.stencilAttachment,Pe,Fe),re(me.depthStencilAttachment,Pe,Fe),me.width=We.width=Pe,me.height=We.height=Fe,q(me),We}return We(ie,de),i(We,{resize:Ge,_reglType:"framebuffer",_framebuffer:me,destroy:function(){Ee(me),Oe(me)},use:function(ge){F.setFBO({framebuffer:We},ge)}})}function _e(ie){var de=Array(6);function me(Ge){var ge;O(de.indexOf(F.next)<0,"can not update framebuffer which is currently in use");var be={color:null},Pe=0,Fe=null,ze="rgba",ht="uint8",mt=1;if(typeof Ge=="number")Pe=Ge|0;else if(!Ge)Pe=1;else{O.type(Ge,"object","invalid arguments for framebuffer");var qe=Ge;if("shape"in qe){var At=qe.shape;O(Array.isArray(At)&&At.length>=2,"invalid shape for framebuffer"),O(At[0]===At[1],"cube framebuffer must be square"),Pe=At[0]}else"radius"in qe&&(Pe=qe.radius|0),"width"in qe?(Pe=qe.width|0,"height"in qe&&O(qe.height===Pe,"must be square")):"height"in qe&&(Pe=qe.height|0);("color"in qe||"colors"in qe)&&(Fe=qe.color||qe.colors,Array.isArray(Fe)&&O(Fe.length===1||m.webgl_draw_buffers,"multiple render targets not supported")),Fe||("colorCount"in qe&&(mt=qe.colorCount|0,O(mt>0,"invalid color buffer count")),"colorType"in qe&&(O.oneOf(qe.colorType,oe,"invalid color type"),ht=qe.colorType),"colorFormat"in qe&&(ze=qe.colorFormat,O.oneOf(qe.colorFormat,ee,"invalid color format for texture"))),"depth"in qe&&(be.depth=qe.depth),"stencil"in qe&&(be.stencil=qe.stencil),"depthStencil"in qe&&(be.depthStencil=qe.depthStencil)}var lt;if(Fe)if(Array.isArray(Fe))for(lt=[],ge=0;ge<Fe.length;++ge)lt[ge]=Fe[ge];else lt=[Fe];else{lt=Array(mt);var Qt={radius:Pe,format:ze,type:ht};for(ge=0;ge<mt;++ge)lt[ge]=G.createCube(Qt)}for(be.color=Array(lt.length),ge=0;ge<lt.length;++ge){var Ct=lt[ge];O(typeof Ct=="function"&&Ct._reglType==="textureCube","invalid cube map"),Pe=Pe||Ct.width,O(Ct.width===Pe&&Ct.height===Pe,"invalid cube map shape"),be.color[ge]={target:Po,data:lt[ge]}}for(ge=0;ge<6;++ge){for(var $t=0;$t<lt.length;++$t)be.color[$t].target=Po+ge;ge>0&&(be.depth=de[0].depth,be.stencil=de[0].stencil,be.depthStencil=de[0].depthStencil),de[ge]?de[ge](be):de[ge]=Z(be)}return i(me,{width:Pe,height:Pe,color:lt})}function We(Ge){var ge,be=Ge|0;if(O(be>0&&be<=w.maxCubeMapSize,"invalid radius for cube fbo"),be===me.width)return me;var Pe=me.color;for(ge=0;ge<Pe.length;++ge)Pe[ge].resize(be);for(ge=0;ge<6;++ge)de[ge].resize(be);return me.width=me.height=be,me}return me(ie),i(me,{faces:de,resize:We,_reglType:"framebufferCube",destroy:function(){de.forEach(function(Ge){Ge.destroy()})}})}function ue(){F.cur=null,F.next=null,F.dirty=!0,xi(K).forEach(function(ie){ie.framebuffer=u.createFramebuffer(),q(ie)})}return i(F,{getFramebuffer:function(ie){if(typeof ie=="function"&&ie._reglType==="framebuffer"){var de=ie._framebuffer;if(de instanceof ve)return de}return null},create:Z,createCube:_e,clear:function(){xi(K).forEach(Ee)},restore:ue})}var Uy=5126,Ju=34962,Do=34963,ed=["attributes","elements","offset","count","primitive","instances"];function tf(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Uy,this.offset=0,this.stride=0,this.divisor=0}function qy(u,m,w,G,z,B,F){for(var ee=w.maxAttributes,J=new Array(ee),oe=0;oe<ee;++oe)J[oe]=new tf;var le=0,ae={},he={Record:tf,scope:{},state:J,currentVAO:null,targetVAO:null,restore:ne()?Oe:function(){},createVAO:Ee,getVAO:W,destroyBuffer:te,setVAO:ne()?re:ye,clear:ne()?K:function(){}};function te(q){for(var Z=0;Z<J.length;++Z){var _e=J[Z];_e.buffer===q&&(u.disableVertexAttribArray(Z),_e.buffer=null)}}function ne(){return m.oes_vertex_array_object}function $(){return m.angle_instanced_arrays}function W(q){return typeof q=="function"&&q._vao?q._vao:null}function re(q){if(q!==he.currentVAO){var Z=ne();q?Z.bindVertexArrayOES(q.vao):Z.bindVertexArrayOES(null),he.currentVAO=q}}function ye(q){if(q!==he.currentVAO){if(q)q.bindAttrs();else{for(var Z=$(),_e=0;_e<J.length;++_e){var ue=J[_e];ue.buffer?(u.enableVertexAttribArray(_e),ue.buffer.bind(),u.vertexAttribPointer(_e,ue.size,ue.type,ue.normalized,ue.stride,ue.offfset),Z&&ue.divisor&&Z.vertexAttribDivisorANGLE(_e,ue.divisor)):(u.disableVertexAttribArray(_e),u.vertexAttrib4f(_e,ue.x,ue.y,ue.z,ue.w))}F.elements?u.bindBuffer(Do,F.elements.buffer.buffer):u.bindBuffer(Do,null)}he.currentVAO=q}}function K(){xi(ae).forEach(function(q){q.destroy()})}function ve(){this.id=++le,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var q=ne();q?this.vao=q.createVertexArrayOES():this.vao=null,ae[this.id]=this,this.buffers=[]}ve.prototype.bindAttrs=function(){for(var q=$(),Z=this.attributes,_e=0;_e<Z.length;++_e){var ue=Z[_e];ue.buffer?(u.enableVertexAttribArray(_e),u.bindBuffer(Ju,ue.buffer.buffer),u.vertexAttribPointer(_e,ue.size,ue.type,ue.normalized,ue.stride,ue.offset),q&&ue.divisor&&q.vertexAttribDivisorANGLE(_e,ue.divisor)):(u.disableVertexAttribArray(_e),u.vertexAttrib4f(_e,ue.x,ue.y,ue.z,ue.w))}for(var ie=Z.length;ie<ee;++ie)u.disableVertexAttribArray(ie);var de=B.getElements(this.elements);de?u.bindBuffer(Do,de.buffer.buffer):u.bindBuffer(Do,null)},ve.prototype.refresh=function(){var q=ne();q&&(q.bindVertexArrayOES(this.vao),this.bindAttrs(),he.currentVAO=null,q.bindVertexArrayOES(null))},ve.prototype.destroy=function(){if(this.vao){var q=ne();this===he.currentVAO&&(he.currentVAO=null,q.bindVertexArrayOES(null)),q.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ae[this.id]&&(delete ae[this.id],G.vaoCount-=1)};function Oe(){var q=ne();q&&xi(ae).forEach(function(Z){Z.refresh()})}function Ee(q){var Z=new ve;G.vaoCount+=1;function _e(ue){var ie;if(Array.isArray(ue))ie=ue,Z.elements&&Z.ownsElements&&Z.elements.destroy(),Z.elements=null,Z.ownsElements=!1,Z.offset=0,Z.count=0,Z.instances=-1,Z.primitive=4;else{if(O(typeof ue=="object","invalid arguments for create vao"),O("attributes"in ue,"must specify attributes for vao"),ue.elements){var de=ue.elements;Z.ownsElements?typeof de=="function"&&de._reglType==="elements"?(Z.elements.destroy(),Z.ownsElements=!1):(Z.elements(de),Z.ownsElements=!1):B.getElements(ue.elements)?(Z.elements=ue.elements,Z.ownsElements=!1):(Z.elements=B.create(ue.elements),Z.ownsElements=!0)}else Z.elements=null,Z.ownsElements=!1;ie=ue.attributes,Z.offset=0,Z.count=-1,Z.instances=-1,Z.primitive=4,Z.elements&&(Z.count=Z.elements._elements.vertCount,Z.primitive=Z.elements._elements.primType),"offset"in ue&&(Z.offset=ue.offset|0),"count"in ue&&(Z.count=ue.count|0),"instances"in ue&&(Z.instances=ue.instances|0),"primitive"in ue&&(O(ue.primitive in vr,"bad primitive type: "+ue.primitive),Z.primitive=vr[ue.primitive]),O.optional(()=>{for(var ht=Object.keys(ue),mt=0;mt<ht.length;++mt)O(ed.indexOf(ht[mt])>=0,'invalid option for vao: "'+ht[mt]+'" valid options are '+ed)}),O(Array.isArray(ie),"attributes must be an array")}O(ie.length<ee,"too many attributes"),O(ie.length>0,"must specify at least one attribute");var me={},We=Z.attributes;We.length=ie.length;for(var Ge=0;Ge<ie.length;++Ge){var ge=ie[Ge],be=We[Ge]=new tf,Pe=ge.data||ge;if(Array.isArray(Pe)||t(Pe)||Di(Pe)){var Fe;Z.buffers[Ge]&&(Fe=Z.buffers[Ge],t(Pe)&&Fe._buffer.byteLength>=Pe.byteLength?Fe.subdata(Pe):(Fe.destroy(),Z.buffers[Ge]=null)),Z.buffers[Ge]||(Fe=Z.buffers[Ge]=z.create(ge,Ju,!1,!0)),be.buffer=z.getBuffer(Fe),be.size=be.buffer.dimension|0,be.normalized=!1,be.type=be.buffer.dtype,be.offset=0,be.stride=0,be.divisor=0,be.state=1,me[Ge]=1}else z.getBuffer(ge)?(be.buffer=z.getBuffer(ge),be.size=be.buffer.dimension|0,be.normalized=!1,be.type=be.buffer.dtype,be.offset=0,be.stride=0,be.divisor=0,be.state=1):z.getBuffer(ge.buffer)?(be.buffer=z.getBuffer(ge.buffer),be.size=(+ge.size||be.buffer.dimension)|0,be.normalized=!!ge.normalized||!1,"type"in ge?(O.parameter(ge.type,Vr,"invalid buffer type"),be.type=Vr[ge.type]):be.type=be.buffer.dtype,be.offset=(ge.offset||0)|0,be.stride=(ge.stride||0)|0,be.divisor=(ge.divisor||0)|0,be.state=1,O(be.size>=1&&be.size<=4,"size must be between 1 and 4"),O(be.offset>=0,"invalid offset"),O(be.stride>=0&&be.stride<=255,"stride must be between 0 and 255"),O(be.divisor>=0,"divisor must be positive"),O(!be.divisor||!!m.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ge?(O(Ge>0,"first attribute must not be a constant"),be.x=+ge.x||0,be.y=+ge.y||0,be.z=+ge.z||0,be.w=+ge.w||0,be.state=2):O(!1,"invalid attribute spec for location "+Ge)}for(var ze=0;ze<Z.buffers.length;++ze)!me[ze]&&Z.buffers[ze]&&(Z.buffers[ze].destroy(),Z.buffers[ze]=null);return Z.refresh(),_e}return _e.destroy=function(){for(var ue=0;ue<Z.buffers.length;++ue)Z.buffers[ue]&&Z.buffers[ue].destroy();Z.buffers.length=0,Z.ownsElements&&(Z.elements.destroy(),Z.elements=null,Z.ownsElements=!1),Z.destroy()},_e._vao=Z,_e._reglType="vao",_e(q)}return he}var td=35632,Hy=35633,Yy=35718,Ky=35721;function Jy(u,m,w,G){var z={},B={};function F($,W,re,ye){this.name=$,this.id=W,this.location=re,this.info=ye}function ee($,W){for(var re=0;re<$.length;++re)if($[re].id===W.id){$[re].location=W.location;return}$.push(W)}function J($,W,re){var ye=$===td?z:B,K=ye[W];if(!K){var ve=m.str(W);K=u.createShader($),u.shaderSource(K,ve),u.compileShader(K),O.shaderError(u,K,ve,$,re),ye[W]=K}return K}var oe={},le=[],ae=0;function he($,W){this.id=ae++,this.fragId=$,this.vertId=W,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,G.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function te($,W,re){var ye,K,ve=J(td,$.fragId),Oe=J(Hy,$.vertId),Ee=$.program=u.createProgram();if(u.attachShader(Ee,ve),u.attachShader(Ee,Oe),re)for(ye=0;ye<re.length;++ye){var q=re[ye];u.bindAttribLocation(Ee,q[0],q[1])}u.linkProgram(Ee),O.linkError(u,Ee,m.str($.fragId),m.str($.vertId),W);var Z=u.getProgramParameter(Ee,Yy);G.profile&&($.stats.uniformsCount=Z);var _e=$.uniforms;for(ye=0;ye<Z;++ye)if(K=u.getActiveUniform(Ee,ye),K){if(K.size>1)for(var ue=0;ue<K.size;++ue){var ie=K.name.replace("[0]","["+ue+"]");ee(_e,new F(ie,m.id(ie),u.getUniformLocation(Ee,ie),K))}var de=K.name;K.size>1&&(de=de.replace("[0]","")),ee(_e,new F(de,m.id(de),u.getUniformLocation(Ee,de),K))}var me=u.getProgramParameter(Ee,Ky);G.profile&&($.stats.attributesCount=me);var We=$.attributes;for(ye=0;ye<me;++ye)K=u.getActiveAttrib(Ee,ye),K&&ee(We,new F(K.name,m.id(K.name),u.getAttribLocation(Ee,K.name),K))}G.profile&&(w.getMaxUniformsCount=function(){var $=0;return le.forEach(function(W){W.stats.uniformsCount>$&&($=W.stats.uniformsCount)}),$},w.getMaxAttributesCount=function(){var $=0;return le.forEach(function(W){W.stats.attributesCount>$&&($=W.stats.attributesCount)}),$});function ne(){z={},B={};for(var $=0;$<le.length;++$)te(le[$],null,le[$].attributes.map(function(W){return[W.location,W.name]}))}return{clear:function(){var $=u.deleteShader.bind(u);xi(z).forEach($),z={},xi(B).forEach($),B={},le.forEach(function(W){u.deleteProgram(W.program)}),le.length=0,oe={},w.shaderCount=0},program:function($,W,re,ye){O.command($>=0,"missing vertex shader",re),O.command(W>=0,"missing fragment shader",re);var K=oe[W];K||(K=oe[W]={});var ve=K[$];if(ve&&(ve.refCount++,!ye))return ve;var Oe=new he(W,$);return w.shaderCount++,te(Oe,re,ye),ve||(K[$]=Oe),le.push(Oe),i(Oe,{destroy:function(){if(Oe.refCount--,Oe.refCount<=0){u.deleteProgram(Oe.program);var Ee=le.indexOf(Oe);le.splice(Ee,1),w.shaderCount--}K[Oe.vertId].refCount<=0&&(u.deleteShader(B[Oe.vertId]),delete B[Oe.vertId],delete oe[Oe.fragId][Oe.vertId]),Object.keys(oe[Oe.fragId]).length||(u.deleteShader(z[Oe.fragId]),delete z[Oe.fragId],delete oe[Oe.fragId])}})},restore:ne,shader:J,frag:-1,vert:-1}}var e1=6408,us=5121,t1=3333,Mo=5126;function i1(u,m,w,G,z,B,F){function ee(le){var ae;m.next===null?(O(z.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ae=us):(O(m.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ae=m.next.colorAttachments[0].texture._texture.type,O.optional(function(){B.oes_texture_float?(O(ae===us||ae===Mo,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ae===Mo&&O(F.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):O(ae===us,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var he=0,te=0,ne=G.framebufferWidth,$=G.framebufferHeight,W=null;t(le)?W=le:le&&(O.type(le,"object","invalid arguments to regl.read()"),he=le.x|0,te=le.y|0,O(he>=0&&he<G.framebufferWidth,"invalid x offset for regl.read"),O(te>=0&&te<G.framebufferHeight,"invalid y offset for regl.read"),ne=(le.width||G.framebufferWidth-he)|0,$=(le.height||G.framebufferHeight-te)|0,W=le.data||null),W&&(ae===us?O(W instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ae===Mo&&O(W instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),O(ne>0&&ne+he<=G.framebufferWidth,"invalid width for read pixels"),O($>0&&$+te<=G.framebufferHeight,"invalid height for read pixels"),w();var re=ne*$*4;return W||(ae===us?W=new Uint8Array(re):ae===Mo&&(W=W||new Float32Array(re))),O.isTypedArray(W,"data buffer for regl.read() must be a typedarray"),O(W.byteLength>=re,"data buffer for regl.read() too small"),u.pixelStorei(t1,4),u.readPixels(he,te,ne,$,e1,ae,W),W}function J(le){var ae;return m.setFBO({framebuffer:le.framebuffer},function(){ae=ee(le)}),ae}function oe(le){return!le||!("framebuffer"in le)?ee(le):J(le)}return oe}function Cn(u){return Array.prototype.slice.call(u)}function $n(u){return Cn(u).join("")}function r1(){var u=0,m=[],w=[];function G(ae){for(var he=0;he<w.length;++he)if(w[he]===ae)return m[he];var te="g"+u++;return m.push(te),w.push(ae),te}function z(){var ae=[];function he(){ae.push.apply(ae,Cn(arguments))}var te=[];function ne(){var $="v"+u++;return te.push($),arguments.length>0&&(ae.push($,"="),ae.push.apply(ae,Cn(arguments)),ae.push(";")),$}return i(he,{def:ne,toString:function(){return $n([te.length>0?"var "+te.join(",")+";":"",$n(ae)])}})}function B(){var ae=z(),he=z(),te=ae.toString,ne=he.toString;function $(W,re){he(W,re,"=",ae.def(W,re),";")}return i(function(){ae.apply(ae,Cn(arguments))},{def:ae.def,entry:ae,exit:he,save:$,set:function(W,re,ye){$(W,re),ae(W,re,"=",ye,";")},toString:function(){return te()+ne()}})}function F(){var ae=$n(arguments),he=B(),te=B(),ne=he.toString,$=te.toString;return i(he,{then:function(){return he.apply(he,Cn(arguments)),this},else:function(){return te.apply(te,Cn(arguments)),this},toString:function(){var W=$();return W&&(W="else{"+W+"}"),$n(["if(",ae,"){",ne(),"}",W])}})}var ee=z(),J={};function oe(ae,he){var te=[];function ne(){var K="a"+te.length;return te.push(K),K}he=he||0;for(var $=0;$<he;++$)ne();var W=B(),re=W.toString,ye=J[ae]=i(W,{arg:ne,toString:function(){return $n(["function(",te.join(),"){",re(),"}"])}});return ye}function le(){var ae=['"use strict";',ee,"return {"];Object.keys(J).forEach(function(ne){ae.push('"',ne,'":',J[ne].toString(),",")}),ae.push("}");var he=$n(ae).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),te=Function.apply(null,m.concat(he));return te.apply(null,w)}return{global:ee,link:G,block:z,proc:oe,scope:B,cond:F,compile:le}}var En="xyzw".split(""),id=5121,Rn=1,rf=2,nf=0,sf=1,of=2,af=3,Io=4,rd=5,nd=6,sd="dither",od="blend.enable",ad="blend.color",lf="blend.equation",ff="blend.func",ld="depth.enable",fd="depth.func",cd="depth.range",hd="depth.mask",cf="colorMask",ud="cull.enable",dd="cull.face",hf="frontFace",uf="lineWidth",pd="polygonOffset.enable",df="polygonOffset.offset",md="sample.alpha",Od="sample.enable",pf="sample.coverage",gd="stencil.enable",vd="stencil.mask",mf="stencil.func",Of="stencil.opFront",ds="stencil.opBack",bd="scissor.enable",Bo="scissor.box",cr="viewport",ps="profile",Hr="framebuffer",ms="vert",Os="frag",Yr="elements",Kr="primitive",Jr="count",Go="offset",No="instances",gs="vao",gf="Width",vf="Height",Pn=Hr+gf,Ln=Hr+vf,n1=cr+gf,s1=cr+vf,yd="drawingBuffer",xd=yd+gf,Sd=yd+vf,o1=[ff,lf,mf,Of,ds,pf,cr,Bo,df],Dn=34962,bf=34963,a1=35632,l1=35633,_d=3553,f1=34067,c1=2884,h1=3042,u1=3024,d1=2960,p1=2929,m1=3089,O1=32823,g1=32926,v1=32928,yf=5126,Wo=35664,Fo=35665,Xo=35666,xf=5124,jo=35667,Vo=35668,Zo=35669,Sf=35670,zo=35671,Uo=35672,qo=35673,vs=35674,bs=35675,ys=35676,xs=35678,Ss=35680,_f=4,_s=1028,en=1029,wd=2304,wf=2305,b1=32775,y1=32776,x1=519,yr=7680,Td=0,kd=1,Qd=32774,S1=513,Ad=36160,_1=36064,Zi={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Cd=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Mn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},xr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},$d={frag:a1,vert:l1},Tf={cw:wd,ccw:wf};function Ho(u){return Array.isArray(u)||t(u)||Di(u)}function Ed(u){return u.sort(function(m,w){return m===cr?-1:w===cr?1:m<w?-1:1})}function Rt(u,m,w,G){this.thisDep=u,this.contextDep=m,this.propDep=w,this.append=G}function Sr(u){return u&&!(u.thisDep||u.contextDep||u.propDep)}function kt(u){return new Rt(!1,!1,!1,u)}function hi(u,m){var w=u.type;if(w===nf){var G=u.data.length;return new Rt(!0,G>=1,G>=2,m)}else if(w===Io){var z=u.data;return new Rt(z.thisDep,z.contextDep,z.propDep,m)}else{if(w===rd)return new Rt(!1,!1,!1,m);if(w===nd){for(var B=!1,F=!1,ee=!1,J=0;J<u.data.length;++J){var oe=u.data[J];if(oe.type===sf)ee=!0;else if(oe.type===of)F=!0;else if(oe.type===af)B=!0;else if(oe.type===nf){B=!0;var le=oe.data;le>=1&&(F=!0),le>=2&&(ee=!0)}else oe.type===Io&&(B=B||oe.data.thisDep,F=F||oe.data.contextDep,ee=ee||oe.data.propDep)}return new Rt(B,F,ee,m)}else return new Rt(w===af,w===of,w===sf,m)}}var Rd=new Rt(!1,!1,!1,function(){});function w1(u,m,w,G,z,B,F,ee,J,oe,le,ae,he,te,ne){var $=oe.Record,W={add:32774,subtract:32778,"reverse subtract":32779};w.ext_blend_minmax&&(W.min=b1,W.max=y1);var re=w.angle_instanced_arrays,ye=w.webgl_draw_buffers,K=w.oes_vertex_array_object,ve={dirty:!0,profile:ne.profile},Oe={},Ee=[],q={},Z={};function _e(v){return v.replace(".","_")}function ue(v,p,T){var C=_e(v);Ee.push(v),Oe[C]=ve[C]=!!T,q[C]=p}function ie(v,p,T){var C=_e(v);Ee.push(v),Array.isArray(T)?(ve[C]=T.slice(),Oe[C]=T.slice()):ve[C]=Oe[C]=T,Z[C]=p}ue(sd,u1),ue(od,h1),ie(ad,"blendColor",[0,0,0,0]),ie(lf,"blendEquationSeparate",[Qd,Qd]),ie(ff,"blendFuncSeparate",[kd,Td,kd,Td]),ue(ld,p1,!0),ie(fd,"depthFunc",S1),ie(cd,"depthRange",[0,1]),ie(hd,"depthMask",!0),ie(cf,cf,[!0,!0,!0,!0]),ue(ud,c1),ie(dd,"cullFace",en),ie(hf,hf,wf),ie(uf,uf,1),ue(pd,O1),ie(df,"polygonOffset",[0,0]),ue(md,g1),ue(Od,v1),ie(pf,"sampleCoverage",[1,!1]),ue(gd,d1),ie(vd,"stencilMask",-1),ie(mf,"stencilFunc",[x1,0,-1]),ie(Of,"stencilOpSeparate",[_s,yr,yr,yr]),ie(ds,"stencilOpSeparate",[en,yr,yr,yr]),ue(bd,m1),ie(Bo,"scissor",[0,0,u.drawingBufferWidth,u.drawingBufferHeight]),ie(cr,cr,[0,0,u.drawingBufferWidth,u.drawingBufferHeight]);var de={gl:u,context:he,strings:m,next:Oe,current:ve,draw:ae,elements:B,buffer:z,shader:le,attributes:oe.state,vao:oe,uniforms:J,framebuffer:ee,extensions:w,timer:te,isBufferArgs:Ho},me={primTypes:vr,compareFuncs:Mn,blendFuncs:Zi,blendEquations:W,stencilOps:xr,glTypes:Vr,orientationType:Tf};O.optional(function(){de.isArrayLike=ct}),ye&&(me.backBuffer=[en],me.drawBuffer=yi(G.maxDrawbuffers,function(v){return v===0?[0]:yi(v,function(p){return _1+p})}));var We=0;function Ge(){var v=r1(),p=v.link,T=v.global;v.id=We++,v.batchId="0";var C=p(de),R=v.shared={props:"a0"};Object.keys(de).forEach(function(S){R[S]=T.def(C,".",S)}),O.optional(function(){v.CHECK=p(O),v.commandStr=O.guessCommand(),v.command=p(v.commandStr),v.assert=function(S,y,M){S("if(!(",y,"))",this.CHECK,".commandRaise(",p(M),",",this.command,");")},me.invalidBlendCombinations=Cd});var Q=v.next={},k=v.current={};Object.keys(Z).forEach(function(S){Array.isArray(ve[S])&&(Q[S]=T.def(R.next,".",S),k[S]=T.def(R.current,".",S))});var A=v.constants={};Object.keys(me).forEach(function(S){A[S]=T.def(JSON.stringify(me[S]))}),v.invoke=function(S,y){switch(y.type){case nf:var M=["this",R.context,R.props,v.batchId];return S.def(p(y.data),".call(",M.slice(0,Math.max(y.data.length+1,4)),")");case sf:return S.def(R.props,y.data);case of:return S.def(R.context,y.data);case af:return S.def("this",y.data);case Io:return y.data.append(v,S),y.data.ref;case rd:return y.data.toString();case nd:return y.data.map(function(P){return v.invoke(S,P)})}},v.attribCache={};var b={};return v.scopeAttrib=function(S){var y=m.id(S);if(y in b)return b[y];var M=oe.scope[y];M||(M=oe.scope[y]=new $);var P=b[y]=p(M);return P},v}function ge(v){var p=v.static,T=v.dynamic,C;if(ps in p){var R=!!p[ps];C=kt(function(k,A){return R}),C.enable=R}else if(ps in T){var Q=T[ps];C=hi(Q,function(k,A){return k.invoke(A,Q)})}return C}function be(v,p){var T=v.static,C=v.dynamic;if(Hr in T){var R=T[Hr];return R?(R=ee.getFramebuffer(R),O.command(R,"invalid framebuffer object"),kt(function(k,A){var b=k.link(R),S=k.shared;A.set(S.framebuffer,".next",b);var y=S.context;return A.set(y,"."+Pn,b+".width"),A.set(y,"."+Ln,b+".height"),b})):kt(function(k,A){var b=k.shared;A.set(b.framebuffer,".next","null");var S=b.context;return A.set(S,"."+Pn,S+"."+xd),A.set(S,"."+Ln,S+"."+Sd),"null"})}else if(Hr in C){var Q=C[Hr];return hi(Q,function(k,A){var b=k.invoke(A,Q),S=k.shared,y=S.framebuffer,M=A.def(y,".getFramebuffer(",b,")");O.optional(function(){k.assert(A,"!"+b+"||"+M,"invalid framebuffer object")}),A.set(y,".next",M);var P=S.context;return A.set(P,"."+Pn,M+"?"+M+".width:"+P+"."+xd),A.set(P,"."+Ln,M+"?"+M+".height:"+P+"."+Sd),M})}else return null}function Pe(v,p,T){var C=v.static,R=v.dynamic;function Q(b){if(b in C){var S=C[b];O.commandType(S,"object","invalid "+b,T.commandStr);var y=!0,M=S.x|0,P=S.y|0,V,H;return"width"in S?(V=S.width|0,O.command(V>=0,"invalid "+b,T.commandStr)):y=!1,"height"in S?(H=S.height|0,O.command(H>=0,"invalid "+b,T.commandStr)):y=!1,new Rt(!y&&p&&p.thisDep,!y&&p&&p.contextDep,!y&&p&&p.propDep,function($e,xe){var Y=$e.shared.context,j=V;"width"in S||(j=xe.def(Y,".",Pn,"-",M));var Ce=H;return"height"in S||(Ce=xe.def(Y,".",Ln,"-",P)),[M,P,j,Ce]})}else if(b in R){var ce=R[b],De=hi(ce,function($e,xe){var Y=$e.invoke(xe,ce);O.optional(function(){$e.assert(xe,Y+"&&typeof "+Y+'==="object"',"invalid "+b)});var j=$e.shared.context,Ce=xe.def(Y,".x|0"),ke=xe.def(Y,".y|0"),Le=xe.def('"width" in ',Y,"?",Y,".width|0:","(",j,".",Pn,"-",Ce,")"),tt=xe.def('"height" in ',Y,"?",Y,".height|0:","(",j,".",Ln,"-",ke,")");return O.optional(function(){$e.assert(xe,Le+">=0&&"+tt+">=0","invalid "+b)}),[Ce,ke,Le,tt]});return p&&(De.thisDep=De.thisDep||p.thisDep,De.contextDep=De.contextDep||p.contextDep,De.propDep=De.propDep||p.propDep),De}else return p?new Rt(p.thisDep,p.contextDep,p.propDep,function($e,xe){var Y=$e.shared.context;return[0,0,xe.def(Y,".",Pn),xe.def(Y,".",Ln)]}):null}var k=Q(cr);if(k){var A=k;k=new Rt(k.thisDep,k.contextDep,k.propDep,function(b,S){var y=A.append(b,S),M=b.shared.context;return S.set(M,"."+n1,y[2]),S.set(M,"."+s1,y[3]),y})}return{viewport:k,scissor_box:Q(Bo)}}function Fe(v,p){var T=v.static,C=typeof T[Os]=="string"&&typeof T[ms]=="string";if(C){if(Object.keys(p.dynamic).length>0)return null;var R=p.static,Q=Object.keys(R);if(Q.length>0&&typeof R[Q[0]]=="number"){for(var k=[],A=0;A<Q.length;++A)O(typeof R[Q[A]]=="number","must specify all vertex attribute locations when using vaos"),k.push([R[Q[A]]|0,Q[A]]);return k}}return null}function ze(v,p,T){var C=v.static,R=v.dynamic;function Q(y){if(y in C){var M=m.id(C[y]);O.optional(function(){le.shader($d[y],M,O.guessCommand())});var P=kt(function(){return M});return P.id=M,P}else if(y in R){var V=R[y];return hi(V,function(H,ce){var De=H.invoke(ce,V),$e=ce.def(H.shared.strings,".id(",De,")");return O.optional(function(){ce(H.shared.shader,".shader(",$d[y],",",$e,",",H.command,");")}),$e})}return null}var k=Q(Os),A=Q(ms),b=null,S;return Sr(k)&&Sr(A)?(b=le.program(A.id,k.id,null,T),S=kt(function(y,M){return y.link(b)})):S=new Rt(k&&k.thisDep||A&&A.thisDep,k&&k.contextDep||A&&A.contextDep,k&&k.propDep||A&&A.propDep,function(y,M){var P=y.shared.shader,V;k?V=k.append(y,M):V=M.def(P,".",Os);var H;A?H=A.append(y,M):H=M.def(P,".",ms);var ce=P+".program("+H+","+V;return O.optional(function(){ce+=","+y.command}),M.def(ce+")")}),{frag:k,vert:A,progVar:S,program:b}}function ht(v,p){var T=v.static,C=v.dynamic,R={},Q=!1;function k(){if(gs in T){var xe=T[gs];return xe!==null&&oe.getVAO(xe)===null&&(xe=oe.createVAO(xe)),Q=!0,R.vao=xe,kt(function(j){var Ce=oe.getVAO(xe);return Ce?j.link(Ce):"null"})}else if(gs in C){Q=!0;var Y=C[gs];return hi(Y,function(j,Ce){var ke=j.invoke(Ce,Y);return Ce.def(j.shared.vao+".getVAO("+ke+")")})}return null}var A=k(),b=!1;function S(){if(Yr in T){var xe=T[Yr];if(R.elements=xe,Ho(xe)){var Y=R.elements=B.create(xe,!0);xe=B.getElements(Y),b=!0}else xe&&(xe=B.getElements(xe),b=!0,O.command(xe,"invalid elements",p.commandStr));var j=kt(function(ke,Le){if(xe){var tt=ke.link(xe);return ke.ELEMENTS=tt,tt}return ke.ELEMENTS=null,null});return j.value=xe,j}else if(Yr in C){b=!0;var Ce=C[Yr];return hi(Ce,function(ke,Le){var tt=ke.shared,zt=tt.isBufferArgs,rn=tt.elements,hr=ke.invoke(Le,Ce),Ui=Le.def("null"),_r=Le.def(zt,"(",hr,")"),nn=ke.cond(_r).then(Ui,"=",rn,".createStream(",hr,");").else(Ui,"=",rn,".getElements(",hr,");");return O.optional(function(){ke.assert(nn.else,"!"+hr+"||"+Ui,"invalid elements")}),Le.entry(nn),Le.exit(ke.cond(_r).then(rn,".destroyStream(",Ui,");")),ke.ELEMENTS=Ui,Ui})}else if(Q)return new Rt(A.thisDep,A.contextDep,A.propDep,function(ke,Le){return Le.def(ke.shared.vao+".currentVAO?"+ke.shared.elements+".getElements("+ke.shared.vao+".currentVAO.elements):null")});return null}var y=S();function M(){if(Kr in T){var xe=T[Kr];return R.primitive=xe,O.commandParameter(xe,vr,"invalid primitve",p.commandStr),kt(function(j,Ce){return vr[xe]})}else if(Kr in C){var Y=C[Kr];return hi(Y,function(j,Ce){var ke=j.constants.primTypes,Le=j.invoke(Ce,Y);return O.optional(function(){j.assert(Ce,Le+" in "+ke,"invalid primitive, must be one of "+Object.keys(vr))}),Ce.def(ke,"[",Le,"]")})}else{if(b)return Sr(y)?y.value?kt(function(j,Ce){return Ce.def(j.ELEMENTS,".primType")}):kt(function(){return _f}):new Rt(y.thisDep,y.contextDep,y.propDep,function(j,Ce){var ke=j.ELEMENTS;return Ce.def(ke,"?",ke,".primType:",_f)});if(Q)return new Rt(A.thisDep,A.contextDep,A.propDep,function(j,Ce){return Ce.def(j.shared.vao+".currentVAO?"+j.shared.vao+".currentVAO.primitive:"+_f)})}return null}function P(xe,Y){if(xe in T){var j=T[xe]|0;return Y?R.offset=j:R.instances=j,O.command(!Y||j>=0,"invalid "+xe,p.commandStr),kt(function(ke,Le){return Y&&(ke.OFFSET=j),j})}else if(xe in C){var Ce=C[xe];return hi(Ce,function(ke,Le){var tt=ke.invoke(Le,Ce);return Y&&(ke.OFFSET=tt,O.optional(function(){ke.assert(Le,tt+">=0","invalid "+xe)})),tt})}else if(Y){if(b)return kt(function(ke,Le){return ke.OFFSET=0,0});if(Q)return new Rt(A.thisDep,A.contextDep,A.propDep,function(ke,Le){return Le.def(ke.shared.vao+".currentVAO?"+ke.shared.vao+".currentVAO.offset:0")})}else if(Q)return new Rt(A.thisDep,A.contextDep,A.propDep,function(ke,Le){return Le.def(ke.shared.vao+".currentVAO?"+ke.shared.vao+".currentVAO.instances:-1")});return null}var V=P(Go,!0);function H(){if(Jr in T){var xe=T[Jr]|0;return R.count=xe,O.command(typeof xe=="number"&&xe>=0,"invalid vertex count",p.commandStr),kt(function(){return xe})}else if(Jr in C){var Y=C[Jr];return hi(Y,function(Le,tt){var zt=Le.invoke(tt,Y);return O.optional(function(){Le.assert(tt,"typeof "+zt+'==="number"&&'+zt+">=0&&"+zt+"===("+zt+"|0)","invalid vertex count")}),zt})}else if(b)if(Sr(y)){if(y)return V?new Rt(V.thisDep,V.contextDep,V.propDep,function(Le,tt){var zt=tt.def(Le.ELEMENTS,".vertCount-",Le.OFFSET);return O.optional(function(){Le.assert(tt,zt+">=0","invalid vertex offset/element buffer too small")}),zt}):kt(function(Le,tt){return tt.def(Le.ELEMENTS,".vertCount")});var j=kt(function(){return-1});return O.optional(function(){j.MISSING=!0}),j}else{var Ce=new Rt(y.thisDep||V.thisDep,y.contextDep||V.contextDep,y.propDep||V.propDep,function(Le,tt){var zt=Le.ELEMENTS;return Le.OFFSET?tt.def(zt,"?",zt,".vertCount-",Le.OFFSET,":-1"):tt.def(zt,"?",zt,".vertCount:-1")});return O.optional(function(){Ce.DYNAMIC=!0}),Ce}else if(Q){var ke=new Rt(A.thisDep,A.contextDep,A.propDep,function(Le,tt){return tt.def(Le.shared.vao,".currentVAO?",Le.shared.vao,".currentVAO.count:-1")});return ke}return null}var ce=M(),De=H(),$e=P(No,!1);return{elements:y,primitive:ce,count:De,instances:$e,offset:V,vao:A,vaoActive:Q,elementsActive:b,static:R}}function mt(v,p){var T=v.static,C=v.dynamic,R={};return Ee.forEach(function(Q){var k=_e(Q);function A(b,S){if(Q in T){var y=b(T[Q]);R[k]=kt(function(){return y})}else if(Q in C){var M=C[Q];R[k]=hi(M,function(P,V){return S(P,V,P.invoke(V,M))})}}switch(Q){case ud:case od:case sd:case gd:case ld:case bd:case pd:case md:case Od:case hd:return A(function(b){return O.commandType(b,"boolean",Q,p.commandStr),b},function(b,S,y){return O.optional(function(){b.assert(S,"typeof "+y+'==="boolean"',"invalid flag "+Q,b.commandStr)}),y});case fd:return A(function(b){return O.commandParameter(b,Mn,"invalid "+Q,p.commandStr),Mn[b]},function(b,S,y){var M=b.constants.compareFuncs;return O.optional(function(){b.assert(S,y+" in "+M,"invalid "+Q+", must be one of "+Object.keys(Mn))}),S.def(M,"[",y,"]")});case cd:return A(function(b){return O.command(ct(b)&&b.length===2&&typeof b[0]=="number"&&typeof b[1]=="number"&&b[0]<=b[1],"depth range is 2d array",p.commandStr),b},function(b,S,y){O.optional(function(){b.assert(S,b.shared.isArrayLike+"("+y+")&&"+y+".length===2&&typeof "+y+'[0]==="number"&&typeof '+y+'[1]==="number"&&'+y+"[0]<="+y+"[1]","depth range must be a 2d array")});var M=S.def("+",y,"[0]"),P=S.def("+",y,"[1]");return[M,P]});case ff:return A(function(b){O.commandType(b,"object","blend.func",p.commandStr);var S="srcRGB"in b?b.srcRGB:b.src,y="srcAlpha"in b?b.srcAlpha:b.src,M="dstRGB"in b?b.dstRGB:b.dst,P="dstAlpha"in b?b.dstAlpha:b.dst;return O.commandParameter(S,Zi,k+".srcRGB",p.commandStr),O.commandParameter(y,Zi,k+".srcAlpha",p.commandStr),O.commandParameter(M,Zi,k+".dstRGB",p.commandStr),O.commandParameter(P,Zi,k+".dstAlpha",p.commandStr),O.command(Cd.indexOf(S+", "+M)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+S+", "+M+")",p.commandStr),[Zi[S],Zi[M],Zi[y],Zi[P]]},function(b,S,y){var M=b.constants.blendFuncs;O.optional(function(){b.assert(S,y+"&&typeof "+y+'==="object"',"invalid blend func, must be an object")});function P(Y,j){var Ce=S.def('"',Y,j,'" in ',y,"?",y,".",Y,j,":",y,".",Y);return O.optional(function(){b.assert(S,Ce+" in "+M,"invalid "+Q+"."+Y+j+", must be one of "+Object.keys(Zi))}),Ce}var V=P("src","RGB"),H=P("dst","RGB");O.optional(function(){var Y=b.constants.invalidBlendCombinations;b.assert(S,Y+".indexOf("+V+'+", "+'+H+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ce=S.def(M,"[",V,"]"),De=S.def(M,"[",P("src","Alpha"),"]"),$e=S.def(M,"[",H,"]"),xe=S.def(M,"[",P("dst","Alpha"),"]");return[ce,$e,De,xe]});case lf:return A(function(b){if(typeof b=="string")return O.commandParameter(b,W,"invalid "+Q,p.commandStr),[W[b],W[b]];if(typeof b=="object")return O.commandParameter(b.rgb,W,Q+".rgb",p.commandStr),O.commandParameter(b.alpha,W,Q+".alpha",p.commandStr),[W[b.rgb],W[b.alpha]];O.commandRaise("invalid blend.equation",p.commandStr)},function(b,S,y){var M=b.constants.blendEquations,P=S.def(),V=S.def(),H=b.cond("typeof ",y,'==="string"');return O.optional(function(){function ce(De,$e,xe){b.assert(De,xe+" in "+M,"invalid "+$e+", must be one of "+Object.keys(W))}ce(H.then,Q,y),b.assert(H.else,y+"&&typeof "+y+'==="object"',"invalid "+Q),ce(H.else,Q+".rgb",y+".rgb"),ce(H.else,Q+".alpha",y+".alpha")}),H.then(P,"=",V,"=",M,"[",y,"];"),H.else(P,"=",M,"[",y,".rgb];",V,"=",M,"[",y,".alpha];"),S(H),[P,V]});case ad:return A(function(b){return O.command(ct(b)&&b.length===4,"blend.color must be a 4d array",p.commandStr),yi(4,function(S){return+b[S]})},function(b,S,y){return O.optional(function(){b.assert(S,b.shared.isArrayLike+"("+y+")&&"+y+".length===4","blend.color must be a 4d array")}),yi(4,function(M){return S.def("+",y,"[",M,"]")})});case vd:return A(function(b){return O.commandType(b,"number",k,p.commandStr),b|0},function(b,S,y){return O.optional(function(){b.assert(S,"typeof "+y+'==="number"',"invalid stencil.mask")}),S.def(y,"|0")});case mf:return A(function(b){O.commandType(b,"object",k,p.commandStr);var S=b.cmp||"keep",y=b.ref||0,M="mask"in b?b.mask:-1;return O.commandParameter(S,Mn,Q+".cmp",p.commandStr),O.commandType(y,"number",Q+".ref",p.commandStr),O.commandType(M,"number",Q+".mask",p.commandStr),[Mn[S],y,M]},function(b,S,y){var M=b.constants.compareFuncs;O.optional(function(){function ce(){b.assert(S,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ce(y+"&&typeof ",y,'==="object"'),ce('!("cmp" in ',y,")||(",y,".cmp in ",M,")")});var P=S.def('"cmp" in ',y,"?",M,"[",y,".cmp]",":",yr),V=S.def(y,".ref|0"),H=S.def('"mask" in ',y,"?",y,".mask|0:-1");return[P,V,H]});case Of:case ds:return A(function(b){O.commandType(b,"object",k,p.commandStr);var S=b.fail||"keep",y=b.zfail||"keep",M=b.zpass||"keep";return O.commandParameter(S,xr,Q+".fail",p.commandStr),O.commandParameter(y,xr,Q+".zfail",p.commandStr),O.commandParameter(M,xr,Q+".zpass",p.commandStr),[Q===ds?en:_s,xr[S],xr[y],xr[M]]},function(b,S,y){var M=b.constants.stencilOps;O.optional(function(){b.assert(S,y+"&&typeof "+y+'==="object"',"invalid "+Q)});function P(V){return O.optional(function(){b.assert(S,'!("'+V+'" in '+y+")||("+y+"."+V+" in "+M+")","invalid "+Q+"."+V+", must be one of "+Object.keys(xr))}),S.def('"',V,'" in ',y,"?",M,"[",y,".",V,"]:",yr)}return[Q===ds?en:_s,P("fail"),P("zfail"),P("zpass")]});case df:return A(function(b){O.commandType(b,"object",k,p.commandStr);var S=b.factor|0,y=b.units|0;return O.commandType(S,"number",k+".factor",p.commandStr),O.commandType(y,"number",k+".units",p.commandStr),[S,y]},function(b,S,y){O.optional(function(){b.assert(S,y+"&&typeof "+y+'==="object"',"invalid "+Q)});var M=S.def(y,".factor|0"),P=S.def(y,".units|0");return[M,P]});case dd:return A(function(b){var S=0;return b==="front"?S=_s:b==="back"&&(S=en),O.command(!!S,k,p.commandStr),S},function(b,S,y){return O.optional(function(){b.assert(S,y+'==="front"||'+y+'==="back"',"invalid cull.face")}),S.def(y,'==="front"?',_s,":",en)});case uf:return A(function(b){return O.command(typeof b=="number"&&b>=G.lineWidthDims[0]&&b<=G.lineWidthDims[1],"invalid line width, must be a positive number between "+G.lineWidthDims[0]+" and "+G.lineWidthDims[1],p.commandStr),b},function(b,S,y){return O.optional(function(){b.assert(S,"typeof "+y+'==="number"&&'+y+">="+G.lineWidthDims[0]+"&&"+y+"<="+G.lineWidthDims[1],"invalid line width")}),y});case hf:return A(function(b){return O.commandParameter(b,Tf,k,p.commandStr),Tf[b]},function(b,S,y){return O.optional(function(){b.assert(S,y+'==="cw"||'+y+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),S.def(y+'==="cw"?'+wd+":"+wf)});case cf:return A(function(b){return O.command(ct(b)&&b.length===4,"color.mask must be length 4 array",p.commandStr),b.map(function(S){return!!S})},function(b,S,y){return O.optional(function(){b.assert(S,b.shared.isArrayLike+"("+y+")&&"+y+".length===4","invalid color.mask")}),yi(4,function(M){return"!!"+y+"["+M+"]"})});case pf:return A(function(b){O.command(typeof b=="object"&&b,k,p.commandStr);var S="value"in b?b.value:1,y=!!b.invert;return O.command(typeof S=="number"&&S>=0&&S<=1,"sample.coverage.value must be a number between 0 and 1",p.commandStr),[S,y]},function(b,S,y){O.optional(function(){b.assert(S,y+"&&typeof "+y+'==="object"',"invalid sample.coverage")});var M=S.def('"value" in ',y,"?+",y,".value:1"),P=S.def("!!",y,".invert");return[M,P]})}}),R}function qe(v,p){var T=v.static,C=v.dynamic,R={};return Object.keys(T).forEach(function(Q){var k=T[Q],A;if(typeof k=="number"||typeof k=="boolean")A=kt(function(){return k});else if(typeof k=="function"){var b=k._reglType;b==="texture2d"||b==="textureCube"?A=kt(function(S){return S.link(k)}):b==="framebuffer"||b==="framebufferCube"?(O.command(k.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Q+'"',p.commandStr),A=kt(function(S){return S.link(k.color[0])})):O.commandRaise('invalid data for uniform "'+Q+'"',p.commandStr)}else ct(k)?A=kt(function(S){var y=S.global.def("[",yi(k.length,function(M){return O.command(typeof k[M]=="number"||typeof k[M]=="boolean","invalid uniform "+Q,S.commandStr),k[M]}),"]");return y}):O.commandRaise('invalid or missing data for uniform "'+Q+'"',p.commandStr);A.value=k,R[Q]=A}),Object.keys(C).forEach(function(Q){var k=C[Q];R[Q]=hi(k,function(A,b){return A.invoke(b,k)})}),R}function At(v,p){var T=v.static,C=v.dynamic,R={};return Object.keys(T).forEach(function(Q){var k=T[Q],A=m.id(Q),b=new $;if(Ho(k))b.state=Rn,b.buffer=z.getBuffer(z.create(k,Dn,!1,!0)),b.type=0;else{var S=z.getBuffer(k);if(S)b.state=Rn,b.buffer=S,b.type=0;else if(O.command(typeof k=="object"&&k,"invalid data for attribute "+Q,p.commandStr),"constant"in k){var y=k.constant;b.buffer="null",b.state=rf,typeof y=="number"?b.x=y:(O.command(ct(y)&&y.length>0&&y.length<=4,"invalid constant for attribute "+Q,p.commandStr),En.forEach(function($e,xe){xe<y.length&&(b[$e]=y[xe])}))}else{Ho(k.buffer)?S=z.getBuffer(z.create(k.buffer,Dn,!1,!0)):S=z.getBuffer(k.buffer),O.command(!!S,'missing buffer for attribute "'+Q+'"',p.commandStr);var M=k.offset|0;O.command(M>=0,'invalid offset for attribute "'+Q+'"',p.commandStr);var P=k.stride|0;O.command(P>=0&&P<256,'invalid stride for attribute "'+Q+'", must be integer betweeen [0, 255]',p.commandStr);var V=k.size|0;O.command(!("size"in k)||V>0&&V<=4,'invalid size for attribute "'+Q+'", must be 1,2,3,4',p.commandStr);var H=!!k.normalized,ce=0;"type"in k&&(O.commandParameter(k.type,Vr,"invalid type for attribute "+Q,p.commandStr),ce=Vr[k.type]);var De=k.divisor|0;O.optional(function(){"divisor"in k&&(O.command(De===0||re,'cannot specify divisor for attribute "'+Q+'", instancing not supported',p.commandStr),O.command(De>=0,'invalid divisor for attribute "'+Q+'"',p.commandStr));var $e=p.commandStr,xe=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(k).forEach(function(Y){O.command(xe.indexOf(Y)>=0,'unknown parameter "'+Y+'" for attribute pointer "'+Q+'" (valid parameters are '+xe+")",$e)})}),b.buffer=S,b.state=Rn,b.size=V,b.normalized=H,b.type=ce||S.dtype,b.offset=M,b.stride=P,b.divisor=De}}R[Q]=kt(function($e,xe){var Y=$e.attribCache;if(A in Y)return Y[A];var j={isStream:!1};return Object.keys(b).forEach(function(Ce){j[Ce]=b[Ce]}),b.buffer&&(j.buffer=$e.link(b.buffer),j.type=j.type||j.buffer+".dtype"),Y[A]=j,j})}),Object.keys(C).forEach(function(Q){var k=C[Q];function A(b,S){var y=b.invoke(S,k),M=b.shared,P=b.constants,V=M.isBufferArgs,H=M.buffer;O.optional(function(){b.assert(S,y+"&&(typeof "+y+'==="object"||typeof '+y+'==="function")&&('+V+"("+y+")||"+H+".getBuffer("+y+")||"+H+".getBuffer("+y+".buffer)||"+V+"("+y+'.buffer)||("constant" in '+y+"&&(typeof "+y+'.constant==="number"||'+M.isArrayLike+"("+y+".constant))))",'invalid dynamic attribute "'+Q+'"')});var ce={isStream:S.def(!1)},De=new $;De.state=Rn,Object.keys(De).forEach(function(j){ce[j]=S.def(""+De[j])});var $e=ce.buffer,xe=ce.type;S("if(",V,"(",y,")){",ce.isStream,"=true;",$e,"=",H,".createStream(",Dn,",",y,");",xe,"=",$e,".dtype;","}else{",$e,"=",H,".getBuffer(",y,");","if(",$e,"){",xe,"=",$e,".dtype;",'}else if("constant" in ',y,"){",ce.state,"=",rf,";","if(typeof "+y+'.constant === "number"){',ce[En[0]],"=",y,".constant;",En.slice(1).map(function(j){return ce[j]}).join("="),"=0;","}else{",En.map(function(j,Ce){return ce[j]+"="+y+".constant.length>"+Ce+"?"+y+".constant["+Ce+"]:0;"}).join(""),"}}else{","if(",V,"(",y,".buffer)){",$e,"=",H,".createStream(",Dn,",",y,".buffer);","}else{",$e,"=",H,".getBuffer(",y,".buffer);","}",xe,'="type" in ',y,"?",P.glTypes,"[",y,".type]:",$e,".dtype;",ce.normalized,"=!!",y,".normalized;");function Y(j){S(ce[j],"=",y,".",j,"|0;")}return Y("size"),Y("offset"),Y("stride"),Y("divisor"),S("}}"),S.exit("if(",ce.isStream,"){",H,".destroyStream(",$e,");","}"),ce}R[Q]=hi(k,A)}),R}function lt(v){var p=v.static,T=v.dynamic,C={};return Object.keys(p).forEach(function(R){var Q=p[R];C[R]=kt(function(k,A){return typeof Q=="number"||typeof Q=="boolean"?""+Q:k.link(Q)})}),Object.keys(T).forEach(function(R){var Q=T[R];C[R]=hi(Q,function(k,A){return k.invoke(A,Q)})}),C}function Qt(v,p,T,C,R){var Q=v.static,k=v.dynamic;O.optional(function(){var Y=[Hr,ms,Os,Yr,Kr,Go,Jr,No,ps,gs].concat(Ee);function j(Ce){Object.keys(Ce).forEach(function(ke){O.command(Y.indexOf(ke)>=0,'unknown parameter "'+ke+'"',R.commandStr)})}j(Q),j(k)});var A=Fe(v,p),b=be(v),S=Pe(v,b,R),y=ht(v,R),M=mt(v,R),P=ze(v,R,A);function V(Y){var j=S[Y];j&&(M[Y]=j)}V(cr),V(_e(Bo));var H=Object.keys(M).length>0,ce={framebuffer:b,draw:y,shader:P,state:M,dirty:H,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ce.profile=ge(v),ce.uniforms=qe(T,R),ce.drawVAO=ce.scopeVAO=y.vao,!ce.drawVAO&&P.program&&!A&&w.angle_instanced_arrays&&y.static.elements){var De=!0,$e=P.program.attributes.map(function(Y){var j=p.static[Y];return De=De&&!!j,j});if(De&&$e.length>0){var xe=oe.getVAO(oe.createVAO({attributes:$e,elements:y.static.elements}));ce.drawVAO=new Rt(null,null,null,function(Y,j){return Y.link(xe)}),ce.useVAO=!0}}return A?ce.useVAO=!0:ce.attributes=At(p,R),ce.context=lt(C),ce}function Ct(v,p,T){var C=v.shared,R=C.context,Q=v.scope();Object.keys(T).forEach(function(k){p.save(R,"."+k);var A=T[k],b=A.append(v,p);Array.isArray(b)?Q(R,".",k,"=[",b.join(),"];"):Q(R,".",k,"=",b,";")}),p(Q)}function $t(v,p,T,C){var R=v.shared,Q=R.gl,k=R.framebuffer,A;ye&&(A=p.def(R.extensions,".webgl_draw_buffers"));var b=v.constants,S=b.drawBuffer,y=b.backBuffer,M;T?M=T.append(v,p):M=p.def(k,".next"),C||p("if(",M,"!==",k,".cur){"),p("if(",M,"){",Q,".bindFramebuffer(",Ad,",",M,".framebuffer);"),ye&&p(A,".drawBuffersWEBGL(",S,"[",M,".colorAttachments.length]);"),p("}else{",Q,".bindFramebuffer(",Ad,",null);"),ye&&p(A,".drawBuffersWEBGL(",y,");"),p("}",k,".cur=",M,";"),C||p("}")}function It(v,p,T){var C=v.shared,R=C.gl,Q=v.current,k=v.next,A=C.current,b=C.next,S=v.cond(A,".dirty");Ee.forEach(function(y){var M=_e(y);if(!(M in T.state)){var P,V;if(M in k){P=k[M],V=Q[M];var H=yi(ve[M].length,function(De){return S.def(P,"[",De,"]")});S(v.cond(H.map(function(De,$e){return De+"!=="+V+"["+$e+"]"}).join("||")).then(R,".",Z[M],"(",H,");",H.map(function(De,$e){return V+"["+$e+"]="+De}).join(";"),";"))}else{P=S.def(b,".",M);var ce=v.cond(P,"!==",A,".",M);S(ce),M in q?ce(v.cond(P).then(R,".enable(",q[M],");").else(R,".disable(",q[M],");"),A,".",M,"=",P,";"):ce(R,".",Z[M],"(",P,");",A,".",M,"=",P,";")}}}),Object.keys(T.state).length===0&&S(A,".dirty=false;"),p(S)}function Vt(v,p,T,C){var R=v.shared,Q=v.current,k=R.current,A=R.gl;Ed(Object.keys(T)).forEach(function(b){var S=T[b];if(!(C&&!C(S))){var y=S.append(v,p);if(q[b]){var M=q[b];Sr(S)?y?p(A,".enable(",M,");"):p(A,".disable(",M,");"):p(v.cond(y).then(A,".enable(",M,");").else(A,".disable(",M,");")),p(k,".",b,"=",y,";")}else if(ct(y)){var P=Q[b];p(A,".",Z[b],"(",y,");",y.map(function(V,H){return P+"["+H+"]="+V}).join(";"),";")}else p(A,".",Z[b],"(",y,");",k,".",b,"=",y,";")}})}function yt(v,p){re&&(v.instancing=p.def(v.shared.extensions,".angle_instanced_arrays"))}function je(v,p,T,C,R){var Q=v.shared,k=v.stats,A=Q.current,b=Q.timer,S=T.profile;function y(){return typeof performance>"u"?"Date.now()":"performance.now()"}var M,P;function V(Y){M=p.def(),Y(M,"=",y(),";"),typeof R=="string"?Y(k,".count+=",R,";"):Y(k,".count++;"),te&&(C?(P=p.def(),Y(P,"=",b,".getNumPendingQueries();")):Y(b,".beginQuery(",k,");"))}function H(Y){Y(k,".cpuTime+=",y(),"-",M,";"),te&&(C?Y(b,".pushScopeStats(",P,",",b,".getNumPendingQueries(),",k,");"):Y(b,".endQuery();"))}function ce(Y){var j=p.def(A,".profile");p(A,".profile=",Y,";"),p.exit(A,".profile=",j,";")}var De;if(S){if(Sr(S)){S.enable?(V(p),H(p.exit),ce("true")):ce("false");return}De=S.append(v,p),ce(De)}else De=p.def(A,".profile");var $e=v.block();V($e),p("if(",De,"){",$e,"}");var xe=v.block();H(xe),p.exit("if(",De,"){",xe,"}")}function Zt(v,p,T,C,R){var Q=v.shared;function k(b){switch(b){case Wo:case jo:case zo:return 2;case Fo:case Vo:case Uo:return 3;case Xo:case Zo:case qo:return 4;default:return 1}}function A(b,S,y){var M=Q.gl,P=p.def(b,".location"),V=p.def(Q.attributes,"[",P,"]"),H=y.state,ce=y.buffer,De=[y.x,y.y,y.z,y.w],$e=["buffer","normalized","offset","stride"];function xe(){p("if(!",V,".buffer){",M,".enableVertexAttribArray(",P,");}");var j=y.type,Ce;if(y.size?Ce=p.def(y.size,"||",S):Ce=S,p("if(",V,".type!==",j,"||",V,".size!==",Ce,"||",$e.map(function(Le){return V+"."+Le+"!=="+y[Le]}).join("||"),"){",M,".bindBuffer(",Dn,",",ce,".buffer);",M,".vertexAttribPointer(",[P,Ce,j,y.normalized,y.stride,y.offset],");",V,".type=",j,";",V,".size=",Ce,";",$e.map(function(Le){return V+"."+Le+"="+y[Le]+";"}).join(""),"}"),re){var ke=y.divisor;p("if(",V,".divisor!==",ke,"){",v.instancing,".vertexAttribDivisorANGLE(",[P,ke],");",V,".divisor=",ke,";}")}}function Y(){p("if(",V,".buffer){",M,".disableVertexAttribArray(",P,");",V,".buffer=null;","}if(",En.map(function(j,Ce){return V+"."+j+"!=="+De[Ce]}).join("||"),"){",M,".vertexAttrib4f(",P,",",De,");",En.map(function(j,Ce){return V+"."+j+"="+De[Ce]+";"}).join(""),"}")}H===Rn?xe():H===rf?Y():(p("if(",H,"===",Rn,"){"),xe(),p("}else{"),Y(),p("}"))}C.forEach(function(b){var S=b.name,y=T.attributes[S],M;if(y){if(!R(y))return;M=y.append(v,p)}else{if(!R(Rd))return;var P=v.scopeAttrib(S);O.optional(function(){v.assert(p,P+".state","missing attribute "+S)}),M={},Object.keys(new $).forEach(function(V){M[V]=p.def(P,".",V)})}A(v.link(b),k(b.info.type),M)})}function Je(v,p,T,C,R,Q){for(var k=v.shared,A=k.gl,b={},S,y=0;y<C.length;++y){var M=C[y],P=M.name,V=M.info.type,H=M.info.size,ce=T.uniforms[P];if(H>1){if(!ce)continue;var De=P.replace("[0]","");if(b[De])continue;b[De]=1}var $e=v.link(M),xe=$e+".location",Y;if(ce){if(!R(ce))continue;if(Sr(ce)){var j=ce.value;if(O.command(j!==null&&typeof j<"u",'missing uniform "'+P+'"',v.commandStr),V===xs||V===Ss){O.command(typeof j=="function"&&(V===xs&&(j._reglType==="texture2d"||j._reglType==="framebuffer")||V===Ss&&(j._reglType==="textureCube"||j._reglType==="framebufferCube")),"invalid texture for uniform "+P,v.commandStr);var Ce=v.link(j._texture||j.color[0]._texture);p(A,".uniform1i(",xe,",",Ce+".bind());"),p.exit(Ce,".unbind();")}else if(V===vs||V===bs||V===ys){O.optional(function(){O.command(ct(j),"invalid matrix for uniform "+P,v.commandStr),O.command(V===vs&&j.length===4||V===bs&&j.length===9||V===ys&&j.length===16,"invalid length for matrix uniform "+P,v.commandStr)});var ke=v.global.def("new Float32Array(["+Array.prototype.slice.call(j)+"])"),Le=2;V===bs?Le=3:V===ys&&(Le=4),p(A,".uniformMatrix",Le,"fv(",xe,",false,",ke,");")}else{switch(V){case yf:H===1?O.commandType(j,"number","uniform "+P,v.commandStr):O.command(ct(j)&&j.length===H,"uniform "+P,v.commandStr),S="1f";break;case Wo:O.command(ct(j)&&j.length&&j.length%2===0&&j.length<=H*2,"uniform "+P,v.commandStr),S="2f";break;case Fo:O.command(ct(j)&&j.length&&j.length%3===0&&j.length<=H*3,"uniform "+P,v.commandStr),S="3f";break;case Xo:O.command(ct(j)&&j.length&&j.length%4===0&&j.length<=H*4,"uniform "+P,v.commandStr),S="4f";break;case Sf:H===1?O.commandType(j,"boolean","uniform "+P,v.commandStr):O.command(ct(j)&&j.length===H,"uniform "+P,v.commandStr),S="1i";break;case xf:H===1?O.commandType(j,"number","uniform "+P,v.commandStr):O.command(ct(j)&&j.length===H,"uniform "+P,v.commandStr),S="1i";break;case zo:O.command(ct(j)&&j.length&&j.length%2===0&&j.length<=H*2,"uniform "+P,v.commandStr),S="2i";break;case jo:O.command(ct(j)&&j.length&&j.length%2===0&&j.length<=H*2,"uniform "+P,v.commandStr),S="2i";break;case Uo:O.command(ct(j)&&j.length&&j.length%3===0&&j.length<=H*3,"uniform "+P,v.commandStr),S="3i";break;case Vo:O.command(ct(j)&&j.length&&j.length%3===0&&j.length<=H*3,"uniform "+P,v.commandStr),S="3i";break;case qo:O.command(ct(j)&&j.length&&j.length%4===0&&j.length<=H*4,"uniform "+P,v.commandStr),S="4i";break;case Zo:O.command(ct(j)&&j.length&&j.length%4===0&&j.length<=H*4,"uniform "+P,v.commandStr),S="4i";break}H>1?(S+="v",j=v.global.def("["+Array.prototype.slice.call(j)+"]")):j=ct(j)?Array.prototype.slice.call(j):j,p(A,".uniform",S,"(",xe,",",j,");")}continue}else Y=ce.append(v,p)}else{if(!R(Rd))continue;Y=p.def(k.uniforms,"[",m.id(P),"]")}V===xs?(O(!Array.isArray(Y),"must specify a scalar prop for textures"),p("if(",Y,"&&",Y,'._reglType==="framebuffer"){',Y,"=",Y,".color[0];","}")):V===Ss&&(O(!Array.isArray(Y),"must specify a scalar prop for cube maps"),p("if(",Y,"&&",Y,'._reglType==="framebufferCube"){',Y,"=",Y,".color[0];","}")),O.optional(function(){function Si(ui,Yo){v.assert(p,ui,'bad data or missing for uniform "'+P+'".  '+Yo)}function sn(ui,Yo){Yo===1&&O(!Array.isArray(Y),"must not specify an array type for uniform"),Si("Array.isArray("+Y+") && typeof "+Y+'[0]===" '+ui+'" || typeof '+Y+'==="'+ui+'"',"invalid type, expected "+ui)}function $i(ui,Yo,Ko){Array.isArray(Y)?O(Y.length&&Y.length%ui===0&&Y.length<=ui*Ko,"must have length of "+(Ko===1?"":"n * ")+ui):Si(k.isArrayLike+"("+Y+")&&"+Y+".length && "+Y+".length % "+ui+" === 0 && "+Y+".length<="+ui*Ko,"invalid vector, should have length of "+(Ko===1?"":"n * ")+ui,v.commandStr)}function Gd(ui){O(!Array.isArray(Y),"must not specify a value type"),Si("typeof "+Y+'==="function"&&'+Y+'._reglType==="texture'+(ui===_d?"2d":"Cube")+'"',"invalid texture type",v.commandStr)}switch(V){case xf:sn("number",H);break;case jo:$i(2,"number",H);break;case Vo:$i(3,"number",H);break;case Zo:$i(4,"number",H);break;case yf:sn("number",H);break;case Wo:$i(2,"number",H);break;case Fo:$i(3,"number",H);break;case Xo:$i(4,"number",H);break;case Sf:sn("boolean",H);break;case zo:$i(2,"boolean",H);break;case Uo:$i(3,"boolean",H);break;case qo:$i(4,"boolean",H);break;case vs:$i(4,"number",H);break;case bs:$i(9,"number",H);break;case ys:$i(16,"number",H);break;case xs:Gd(_d);break;case Ss:Gd(f1);break}});var tt=1;switch(V){case xs:case Ss:var zt=p.def(Y,"._texture");p(A,".uniform1i(",xe,",",zt,".bind());"),p.exit(zt,".unbind();");continue;case xf:case Sf:S="1i";break;case jo:case zo:S="2i",tt=2;break;case Vo:case Uo:S="3i",tt=3;break;case Zo:case qo:S="4i",tt=4;break;case yf:S="1f";break;case Wo:S="2f",tt=2;break;case Fo:S="3f",tt=3;break;case Xo:S="4f",tt=4;break;case vs:S="Matrix2fv";break;case bs:S="Matrix3fv";break;case ys:S="Matrix4fv";break}if(S.indexOf("Matrix")===-1&&H>1&&(S+="v",tt=1),S.charAt(0)==="M"){p(A,".uniform",S,"(",xe,",");var rn=Math.pow(V-vs+2,2),hr=v.global.def("new Float32Array(",rn,")");Array.isArray(Y)?p("false,(",yi(rn,function(Si){return hr+"["+Si+"]="+Y[Si]}),",",hr,")"):p("false,(Array.isArray(",Y,")||",Y," instanceof Float32Array)?",Y,":(",yi(rn,function(Si){return hr+"["+Si+"]="+Y+"["+Si+"]"}),",",hr,")"),p(");")}else if(tt>1){for(var Ui=[],_r=[],nn=0;nn<tt;++nn)Array.isArray(Y)?_r.push(Y[nn]):_r.push(p.def(Y+"["+nn+"]")),Q&&Ui.push(p.def());Q&&p("if(!",v.batchId,"||",Ui.map(function(Si,sn){return Si+"!=="+_r[sn]}).join("||"),"){",Ui.map(function(Si,sn){return Si+"="+_r[sn]+";"}).join("")),p(A,".uniform",S,"(",xe,",",_r.join(","),");"),Q&&p("}")}else{if(O(!Array.isArray(Y),"uniform value must not be an array"),Q){var Bd=p.def();p("if(!",v.batchId,"||",Bd,"!==",Y,"){",Bd,"=",Y,";")}p(A,".uniform",S,"(",xe,",",Y,");"),Q&&p("}")}}}function Re(v,p,T,C){var R=v.shared,Q=R.gl,k=R.draw,A=C.draw;function b(){var Ce=A.elements,ke,Le=p;return Ce?((Ce.contextDep&&C.contextDynamic||Ce.propDep)&&(Le=T),ke=Ce.append(v,Le),A.elementsActive&&Le("if("+ke+")"+Q+".bindBuffer("+bf+","+ke+".buffer.buffer);")):(ke=Le.def(),Le(ke,"=",k,".",Yr,";","if(",ke,"){",Q,".bindBuffer(",bf,",",ke,".buffer.buffer);}","else if(",R.vao,".currentVAO){",ke,"=",v.shared.elements+".getElements("+R.vao,".currentVAO.elements);",K?"":"if("+ke+")"+Q+".bindBuffer("+bf+","+ke+".buffer.buffer);","}")),ke}function S(){var Ce=A.count,ke,Le=p;return Ce?((Ce.contextDep&&C.contextDynamic||Ce.propDep)&&(Le=T),ke=Ce.append(v,Le),O.optional(function(){Ce.MISSING&&v.assert(p,"false","missing vertex count"),Ce.DYNAMIC&&v.assert(Le,ke+">=0","missing vertex count")})):(ke=Le.def(k,".",Jr),O.optional(function(){v.assert(Le,ke+">=0","missing vertex count")})),ke}var y=b();function M(Ce){var ke=A[Ce];return ke?ke.contextDep&&C.contextDynamic||ke.propDep?ke.append(v,T):ke.append(v,p):p.def(k,".",Ce)}var P=M(Kr),V=M(Go),H=S();if(typeof H=="number"){if(H===0)return}else T("if(",H,"){"),T.exit("}");var ce,De;re&&(ce=M(No),De=v.instancing);var $e=y+".type",xe=A.elements&&Sr(A.elements)&&!A.vaoActive;function Y(){function Ce(){T(De,".drawElementsInstancedANGLE(",[P,H,$e,V+"<<(("+$e+"-"+id+")>>1)",ce],");")}function ke(){T(De,".drawArraysInstancedANGLE(",[P,V,H,ce],");")}y&&y!=="null"?xe?Ce():(T("if(",y,"){"),Ce(),T("}else{"),ke(),T("}")):ke()}function j(){function Ce(){T(Q+".drawElements("+[P,H,$e,V+"<<(("+$e+"-"+id+")>>1)"]+");")}function ke(){T(Q+".drawArrays("+[P,V,H]+");")}y&&y!=="null"?xe?Ce():(T("if(",y,"){"),Ce(),T("}else{"),ke(),T("}")):ke()}re&&(typeof ce!="number"||ce>=0)?typeof ce=="string"?(T("if(",ce,">0){"),Y(),T("}else if(",ce,"<0){"),j(),T("}")):Y():j()}function Ue(v,p,T,C,R){var Q=Ge(),k=Q.proc("body",R);return O.optional(function(){Q.commandStr=p.commandStr,Q.command=Q.link(p.commandStr)}),re&&(Q.instancing=k.def(Q.shared.extensions,".angle_instanced_arrays")),v(Q,k,T,C),Q.compile().body}function Ye(v,p,T,C){yt(v,p),T.useVAO?T.drawVAO?p(v.shared.vao,".setVAO(",T.drawVAO.append(v,p),");"):p(v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"):(p(v.shared.vao,".setVAO(null);"),Zt(v,p,T,C.attributes,function(){return!0})),Je(v,p,T,C.uniforms,function(){return!0},!1),Re(v,p,p,T)}function xt(v,p){var T=v.proc("draw",1);yt(v,T),Ct(v,T,p.context),$t(v,T,p.framebuffer),It(v,T,p),Vt(v,T,p.state),je(v,T,p,!1,!0);var C=p.shader.progVar.append(v,T);if(T(v.shared.gl,".useProgram(",C,".program);"),p.shader.program)Ye(v,T,p,p.shader.program);else{T(v.shared.vao,".setVAO(null);");var R=v.global.def("{}"),Q=T.def(C,".id"),k=T.def(R,"[",Q,"]");T(v.cond(k).then(k,".call(this,a0);").else(k,"=",R,"[",Q,"]=",v.link(function(A){return Ue(Ye,v,p,A,1)}),"(",C,");",k,".call(this,a0);"))}Object.keys(p.state).length>0&&T(v.shared.current,".dirty=true;"),v.shared.vao&&T(v.shared.vao,".setVAO(null);")}function zi(v,p,T,C){v.batchId="a1",yt(v,p);function R(){return!0}Zt(v,p,T,C.attributes,R),Je(v,p,T,C.uniforms,R,!1),Re(v,p,p,T)}function tn(v,p,T,C){yt(v,p);var R=T.contextDep,Q=p.def(),k="a0",A="a1",b=p.def();v.shared.props=b,v.batchId=Q;var S=v.scope(),y=v.scope();p(S.entry,"for(",Q,"=0;",Q,"<",A,";++",Q,"){",b,"=",k,"[",Q,"];",y,"}",S.exit);function M($e){return $e.contextDep&&R||$e.propDep}function P($e){return!M($e)}if(T.needsContext&&Ct(v,y,T.context),T.needsFramebuffer&&$t(v,y,T.framebuffer),Vt(v,y,T.state,M),T.profile&&M(T.profile)&&je(v,y,T,!1,!0),C)T.useVAO?T.drawVAO?M(T.drawVAO)?y(v.shared.vao,".setVAO(",T.drawVAO.append(v,y),");"):S(v.shared.vao,".setVAO(",T.drawVAO.append(v,S),");"):S(v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"):(S(v.shared.vao,".setVAO(null);"),Zt(v,S,T,C.attributes,P),Zt(v,y,T,C.attributes,M)),Je(v,S,T,C.uniforms,P,!1),Je(v,y,T,C.uniforms,M,!0),Re(v,S,y,T);else{var V=v.global.def("{}"),H=T.shader.progVar.append(v,y),ce=y.def(H,".id"),De=y.def(V,"[",ce,"]");y(v.shared.gl,".useProgram(",H,".program);","if(!",De,"){",De,"=",V,"[",ce,"]=",v.link(function($e){return Ue(zi,v,T,$e,2)}),"(",H,");}",De,".call(this,a0[",Q,"],",Q,");")}}function x(v,p){var T=v.proc("batch",2);v.batchId="0",yt(v,T);var C=!1,R=!0;Object.keys(p.context).forEach(function(V){C=C||p.context[V].propDep}),C||(Ct(v,T,p.context),R=!1);var Q=p.framebuffer,k=!1;Q?(Q.propDep?C=k=!0:Q.contextDep&&C&&(k=!0),k||$t(v,T,Q)):$t(v,T,null),p.state.viewport&&p.state.viewport.propDep&&(C=!0);function A(V){return V.contextDep&&C||V.propDep}It(v,T,p),Vt(v,T,p.state,function(V){return!A(V)}),(!p.profile||!A(p.profile))&&je(v,T,p,!1,"a1"),p.contextDep=C,p.needsContext=R,p.needsFramebuffer=k;var b=p.shader.progVar;if(b.contextDep&&C||b.propDep)tn(v,T,p,null);else{var S=b.append(v,T);if(T(v.shared.gl,".useProgram(",S,".program);"),p.shader.program)tn(v,T,p,p.shader.program);else{T(v.shared.vao,".setVAO(null);");var y=v.global.def("{}"),M=T.def(S,".id"),P=T.def(y,"[",M,"]");T(v.cond(P).then(P,".call(this,a0,a1);").else(P,"=",y,"[",M,"]=",v.link(function(V){return Ue(tn,v,p,V,2)}),"(",S,");",P,".call(this,a0,a1);"))}}Object.keys(p.state).length>0&&T(v.shared.current,".dirty=true;"),v.shared.vao&&T(v.shared.vao,".setVAO(null);")}function N(v,p){var T=v.proc("scope",3);v.batchId="a2";var C=v.shared,R=C.current;Ct(v,T,p.context),p.framebuffer&&p.framebuffer.append(v,T),Ed(Object.keys(p.state)).forEach(function(k){var A=p.state[k],b=A.append(v,T);ct(b)?b.forEach(function(S,y){T.set(v.next[k],"["+y+"]",S)}):T.set(C.next,"."+k,b)}),je(v,T,p,!0,!0),[Yr,Go,Jr,No,Kr].forEach(function(k){var A=p.draw[k];!A||T.set(C.draw,"."+k,""+A.append(v,T))}),Object.keys(p.uniforms).forEach(function(k){var A=p.uniforms[k].append(v,T);Array.isArray(A)&&(A="["+A.join()+"]"),T.set(C.uniforms,"["+m.id(k)+"]",A)}),Object.keys(p.attributes).forEach(function(k){var A=p.attributes[k].append(v,T),b=v.scopeAttrib(k);Object.keys(new $).forEach(function(S){T.set(b,"."+S,A[S])})}),p.scopeVAO&&T.set(C.vao,".targetVAO",p.scopeVAO.append(v,T));function Q(k){var A=p.shader[k];A&&T.set(C.shader,"."+k,A.append(v,T))}Q(ms),Q(Os),Object.keys(p.state).length>0&&(T(R,".dirty=true;"),T.exit(R,".dirty=true;")),T("a1(",v.shared.context,",a0,",v.batchId,");")}function I(v){if(!(typeof v!="object"||ct(v))){for(var p=Object.keys(v),T=0;T<p.length;++T)if(bi.isDynamic(v[p[T]]))return!0;return!1}}function Se(v,p,T){var C=p.static[T];if(!C||!I(C))return;var R=v.global,Q=Object.keys(C),k=!1,A=!1,b=!1,S=v.global.def("{}");Q.forEach(function(M){var P=C[M];if(bi.isDynamic(P)){typeof P=="function"&&(P=C[M]=bi.unbox(P));var V=hi(P,null);k=k||V.thisDep,b=b||V.propDep,A=A||V.contextDep}else{switch(R(S,".",M,"="),typeof P){case"number":R(P);break;case"string":R('"',P,'"');break;case"object":Array.isArray(P)&&R("[",P.join(),"]");break;default:R(v.link(P));break}R(";")}});function y(M,P){Q.forEach(function(V){var H=C[V];if(!!bi.isDynamic(H)){var ce=M.invoke(P,H);P(S,".",V,"=",ce,";")}})}p.dynamic[T]=new bi.DynamicVariable(Io,{thisDep:k,contextDep:A,propDep:b,ref:S,append:y}),delete p.static[T]}function Ze(v,p,T,C,R){var Q=Ge();Q.stats=Q.link(R),Object.keys(p.static).forEach(function(A){Se(Q,p,A)}),o1.forEach(function(A){Se(Q,v,A)});var k=Qt(v,p,T,C,Q);return xt(Q,k),N(Q,k),x(Q,k),i(Q.compile(),{destroy:function(){k.shader.program.destroy()}})}return{next:Oe,current:ve,procs:function(){var v=Ge(),p=v.proc("poll"),T=v.proc("refresh"),C=v.block();p(C),T(C);var R=v.shared,Q=R.gl,k=R.next,A=R.current;C(A,".dirty=false;"),$t(v,p),$t(v,T,null,!0);var b;re&&(b=v.link(re)),w.oes_vertex_array_object&&T(v.link(w.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var S=0;S<G.maxAttributes;++S){var y=T.def(R.attributes,"[",S,"]"),M=v.cond(y,".buffer");M.then(Q,".enableVertexAttribArray(",S,");",Q,".bindBuffer(",Dn,",",y,".buffer.buffer);",Q,".vertexAttribPointer(",S,",",y,".size,",y,".type,",y,".normalized,",y,".stride,",y,".offset);").else(Q,".disableVertexAttribArray(",S,");",Q,".vertexAttrib4f(",S,",",y,".x,",y,".y,",y,".z,",y,".w);",y,".buffer=null;"),T(M),re&&T(b,".vertexAttribDivisorANGLE(",S,",",y,".divisor);")}return T(v.shared.vao,".currentVAO=null;",v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"),Object.keys(q).forEach(function(P){var V=q[P],H=C.def(k,".",P),ce=v.block();ce("if(",H,"){",Q,".enable(",V,")}else{",Q,".disable(",V,")}",A,".",P,"=",H,";"),T(ce),p("if(",H,"!==",A,".",P,"){",ce,"}")}),Object.keys(Z).forEach(function(P){var V=Z[P],H=ve[P],ce,De,$e=v.block();if($e(Q,".",V,"("),ct(H)){var xe=H.length;ce=v.global.def(k,".",P),De=v.global.def(A,".",P),$e(yi(xe,function(Y){return ce+"["+Y+"]"}),");",yi(xe,function(Y){return De+"["+Y+"]="+ce+"["+Y+"];"}).join("")),p("if(",yi(xe,function(Y){return ce+"["+Y+"]!=="+De+"["+Y+"]"}).join("||"),"){",$e,"}")}else ce=C.def(k,".",P),De=C.def(A,".",P),$e(ce,");",A,".",P,"=",ce,";"),p("if(",ce,"!==",De,"){",$e,"}");T($e)}),v.compile()}(),compile:Ze}}function T1(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var k1=34918,Q1=34919,Pd=35007,A1=function(u,m){if(!m.ext_disjoint_timer_query)return null;var w=[];function G(){return w.pop()||m.ext_disjoint_timer_query.createQueryEXT()}function z(re){w.push(re)}var B=[];function F(re){var ye=G();m.ext_disjoint_timer_query.beginQueryEXT(Pd,ye),B.push(ye),te(B.length-1,B.length,re)}function ee(){m.ext_disjoint_timer_query.endQueryEXT(Pd)}function J(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var oe=[];function le(){return oe.pop()||new J}function ae(re){oe.push(re)}var he=[];function te(re,ye,K){var ve=le();ve.startQueryIndex=re,ve.endQueryIndex=ye,ve.sum=0,ve.stats=K,he.push(ve)}var ne=[],$=[];function W(){var re,ye,K=B.length;if(K!==0){$.length=Math.max($.length,K+1),ne.length=Math.max(ne.length,K+1),ne[0]=0,$[0]=0;var ve=0;for(re=0,ye=0;ye<B.length;++ye){var Oe=B[ye];m.ext_disjoint_timer_query.getQueryObjectEXT(Oe,Q1)?(ve+=m.ext_disjoint_timer_query.getQueryObjectEXT(Oe,k1),z(Oe)):B[re++]=Oe,ne[ye+1]=ve,$[ye+1]=re}for(B.length=re,re=0,ye=0;ye<he.length;++ye){var Ee=he[ye],q=Ee.startQueryIndex,Z=Ee.endQueryIndex;Ee.sum+=ne[Z]-ne[q];var _e=$[q],ue=$[Z];ue===_e?(Ee.stats.gpuTime+=Ee.sum/1e6,ae(Ee)):(Ee.startQueryIndex=_e,Ee.endQueryIndex=ue,he[re++]=Ee)}he.length=re}}return{beginQuery:F,endQuery:ee,pushScopeStats:te,update:W,getNumPendingQueries:function(){return B.length},clear:function(){w.push.apply(w,B);for(var re=0;re<w.length;re++)m.ext_disjoint_timer_query.deleteQueryEXT(w[re]);B.length=0,w.length=0},restore:function(){B.length=0,w.length=0}}},C1=16384,$1=256,E1=1024,R1=34962,Ld="webglcontextlost",Dd="webglcontextrestored",Md=1,P1=2,L1=3;function Id(u,m){for(var w=0;w<u.length;++w)if(u[w]===m)return w;return-1}function D1(u){var m=Pv(u);if(!m)return null;var w=m.gl,G=w.getContextAttributes(),z=w.isContextLost(),B=Lv(w,m);if(!B)return null;var F=Av(),ee=T1(),J=B.extensions,oe=A1(w,J),le=Vh(),ae=w.drawingBufferWidth,he=w.drawingBufferHeight,te={tick:0,time:0,viewportWidth:ae,viewportHeight:he,framebufferWidth:ae,framebufferHeight:he,drawingBufferWidth:ae,drawingBufferHeight:he,pixelRatio:m.pixelRatio},ne={},$={elements:null,primitive:4,count:-1,offset:0,instances:-1},W=xb(w,J),re=Ib(w,ee,m,ve),ye=qb(w,J,re,ee),K=qy(w,J,W,ee,re,ye,$);function ve(Re){return K.destroyBuffer(Re)}var Oe=Jy(w,F,ee,m),Ee=ky(w,J,W,function(){_e.procs.poll()},te,ee,m),q=Qy(w,J,W,ee,m),Z=zy(w,J,W,Ee,q,ee),_e=w1(w,F,J,W,re,ye,Ee,Z,ne,K,Oe,$,te,oe,m),ue=i1(w,Z,_e.procs.poll,te,G,J,W),ie=_e.next,de=w.canvas,me=[],We=[],Ge=[],ge=[m.onDestroy],be=null;function Pe(){if(me.length===0){oe&&oe.update(),be=null;return}be=Al.next(Pe),Vt();for(var Re=me.length-1;Re>=0;--Re){var Ue=me[Re];Ue&&Ue(te,null,0)}w.flush(),oe&&oe.update()}function Fe(){!be&&me.length>0&&(be=Al.next(Pe))}function ze(){be&&(Al.cancel(Pe),be=null)}function ht(Re){Re.preventDefault(),z=!0,ze(),We.forEach(function(Ue){Ue()})}function mt(Re){w.getError(),z=!1,B.restore(),Oe.restore(),re.restore(),Ee.restore(),q.restore(),Z.restore(),K.restore(),oe&&oe.restore(),_e.procs.refresh(),Fe(),Ge.forEach(function(Ue){Ue()})}de&&(de.addEventListener(Ld,ht,!1),de.addEventListener(Dd,mt,!1));function qe(){me.length=0,ze(),de&&(de.removeEventListener(Ld,ht),de.removeEventListener(Dd,mt)),Oe.clear(),Z.clear(),q.clear(),K.clear(),Ee.clear(),ye.clear(),re.clear(),oe&&oe.clear(),ge.forEach(function(Re){Re()})}function At(Re){O(!!Re,"invalid args to regl({...})"),O.type(Re,"object","invalid args to regl({...})");function Ue(R){var Q=i({},R);delete Q.uniforms,delete Q.attributes,delete Q.context,delete Q.vao,"stencil"in Q&&Q.stencil.op&&(Q.stencil.opBack=Q.stencil.opFront=Q.stencil.op,delete Q.stencil.op);function k(A){if(A in Q){var b=Q[A];delete Q[A],Object.keys(b).forEach(function(S){Q[A+"."+S]=b[S]})}}return k("blend"),k("depth"),k("cull"),k("stencil"),k("polygonOffset"),k("scissor"),k("sample"),"vao"in R&&(Q.vao=R.vao),Q}function Ye(R,Q){var k={},A={};return Object.keys(R).forEach(function(b){var S=R[b];if(bi.isDynamic(S)){A[b]=bi.unbox(S,b);return}else if(Q&&Array.isArray(S)){for(var y=0;y<S.length;++y)if(bi.isDynamic(S[y])){A[b]=bi.unbox(S,b);return}}k[b]=S}),{dynamic:A,static:k}}var xt=Ye(Re.context||{},!0),zi=Ye(Re.uniforms||{},!0),tn=Ye(Re.attributes||{},!1),x=Ye(Ue(Re),!1),N={gpuTime:0,cpuTime:0,count:0},I=_e.compile(x,tn,zi,xt,N),Se=I.draw,Ze=I.batch,v=I.scope,p=[];function T(R){for(;p.length<R;)p.push(null);return p}function C(R,Q){var k;if(z&&O.raise("context lost"),typeof R=="function")return v.call(this,null,R,0);if(typeof Q=="function")if(typeof R=="number")for(k=0;k<R;++k)v.call(this,null,Q,k);else if(Array.isArray(R))for(k=0;k<R.length;++k)v.call(this,R[k],Q,k);else return v.call(this,R,Q,0);else if(typeof R=="number"){if(R>0)return Ze.call(this,T(R|0),R|0)}else if(Array.isArray(R)){if(R.length)return Ze.call(this,R,R.length)}else return Se.call(this,R)}return i(C,{stats:N,destroy:function(){I.destroy()}})}var lt=Z.setFBO=At({framebuffer:bi.define.call(null,Md,"framebuffer")});function Qt(Re,Ue){var Ye=0;_e.procs.poll();var xt=Ue.color;xt&&(w.clearColor(+xt[0]||0,+xt[1]||0,+xt[2]||0,+xt[3]||0),Ye|=C1),"depth"in Ue&&(w.clearDepth(+Ue.depth),Ye|=$1),"stencil"in Ue&&(w.clearStencil(Ue.stencil|0),Ye|=E1),O(!!Ye,"called regl.clear with no buffer specified"),w.clear(Ye)}function Ct(Re){if(O(typeof Re=="object"&&Re,"regl.clear() takes an object as input"),"framebuffer"in Re)if(Re.framebuffer&&Re.framebuffer_reglType==="framebufferCube")for(var Ue=0;Ue<6;++Ue)lt(i({framebuffer:Re.framebuffer.faces[Ue]},Re),Qt);else lt(Re,Qt);else Qt(null,Re)}function $t(Re){O.type(Re,"function","regl.frame() callback must be a function"),me.push(Re);function Ue(){var Ye=Id(me,Re);O(Ye>=0,"cannot cancel a frame twice");function xt(){var zi=Id(me,xt);me[zi]=me[me.length-1],me.length-=1,me.length<=0&&ze()}me[Ye]=xt}return Fe(),{cancel:Ue}}function It(){var Re=ie.viewport,Ue=ie.scissor_box;Re[0]=Re[1]=Ue[0]=Ue[1]=0,te.viewportWidth=te.framebufferWidth=te.drawingBufferWidth=Re[2]=Ue[2]=w.drawingBufferWidth,te.viewportHeight=te.framebufferHeight=te.drawingBufferHeight=Re[3]=Ue[3]=w.drawingBufferHeight}function Vt(){te.tick+=1,te.time=je(),It(),_e.procs.poll()}function yt(){Ee.refresh(),It(),_e.procs.refresh(),oe&&oe.update()}function je(){return(Vh()-le)/1e3}yt();function Zt(Re,Ue){O.type(Ue,"function","listener callback must be a function");var Ye;switch(Re){case"frame":return $t(Ue);case"lost":Ye=We;break;case"restore":Ye=Ge;break;case"destroy":Ye=ge;break;default:O.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ye.push(Ue),{cancel:function(){for(var xt=0;xt<Ye.length;++xt)if(Ye[xt]===Ue){Ye[xt]=Ye[Ye.length-1],Ye.pop();return}}}}var Je=i(At,{clear:Ct,prop:bi.define.bind(null,Md),context:bi.define.bind(null,P1),this:bi.define.bind(null,L1),draw:At({}),buffer:function(Re){return re.create(Re,R1,!1,!1)},elements:function(Re){return ye.create(Re,!1)},texture:Ee.create2D,cube:Ee.createCube,renderbuffer:q.create,framebuffer:Z.create,framebufferCube:Z.createCube,vao:K.createVAO,attributes:G,frame:$t,on:Zt,limits:W,hasExtension:function(Re){return W.extensions.indexOf(Re.toLowerCase())>=0},read:ue,destroy:qe,_gl:w,_refresh:yt,poll:function(){Vt(),oe&&oe.update()},now:je,stats:ee});return m.onDone(null,Je),Je}return D1})})(sv);const VA=sv.exports,ZA={_luminance:{type:"util",glsl:`float _luminance(vec3 rgb){
      const vec3 W = vec3(0.2125, 0.7154, 0.0721);
      return dot(rgb, W);
    }`},_noise:{type:"util",glsl:`
    //	Simplex 3D Noise
    //	by Ian McEwan, Ashima Arts
    vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}
  vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}

  float _noise(vec3 v){
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);

  // First corner
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;

  // Other corners
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );

    //  x0 = x0 - 0. + 0.0 * C
    vec3 x1 = x0 - i1 + 1.0 * C.xxx;
    vec3 x2 = x0 - i2 + 2.0 * C.xxx;
    vec3 x3 = x0 - 1. + 3.0 * C.xxx;

  // Permutations
    i = mod(i, 289.0 );
    vec4 p = permute( permute( permute(
               i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
             + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
             + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));

  // Gradients
  // ( N*N points uniformly over a square, mapped onto an octahedron.)
    float n_ = 1.0/7.0; // N=7
    vec3  ns = n_ * D.wyz - D.xzx;

    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)

    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)

    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);

    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );

    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));

    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;

    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);

  //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;

  // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
  }
    `},_rgbToHsv:{type:"util",glsl:`vec3 _rgbToHsv(vec3 c){
            vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
            vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
            vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

            float d = q.x - min(q.w, q.y);
            float e = 1.0e-10;
            return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
        }`},_hsvToRgb:{type:"util",glsl:`vec3 _hsvToRgb(vec3 c){
        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }`},_rotate:{type:"util",glsl:`vec2 _rotate(vec2 uv, vec2 cp, float a, bool side) {
    float angle = a * 3.141592;
    vec2 n = vec2(sin(angle), cos(angle));
    float d = dot(uv - cp, n);
    if (side) {
      uv -= n * max(0.0, d) * 2.0;
    } else {
        uv -= n * min(0.0, d) * 2.0;
    }
    return uv;
}`}};class ov{constructor(e){this.transforms=[e]}out(e){e.render(this.transforms)}}const rc={linear(r){return r},easeInQuad(r){return r*r},easeOutQuad(r){return r*(2-r)},easeInOutQuad(r){return r<.5?2*r*r:-1+(4-2*r)*r},easeInCubic(r){return r*r*r},easeOutCubic(r){return--r*r*r+1},easeInOutCubic(r){return r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1},easeInQuart(r){return r*r*r*r},easeOutQuart(r){return 1- --r*r*r*r},easeInOutQuart(r){return r<.5?8*r*r*r*r:1-8*--r*r*r*r},easeInQuint(r){return r*r*r*r*r},easeOutQuint(r){return 1+--r*r*r*r*r},easeInOutQuint(r){return r<.5?16*r*r*r*r*r:1+16*--r*r*r*r*r},sin(r){return(1+Math.sin(Math.PI*r-Math.PI/2))/2}},zA=(r,e,t,i,n)=>(r-e)*(n-i)/(t-e)+i,av={init:()=>{Array.prototype.fast=function(r=1){return this._speed=r,this},Array.prototype.smooth=function(r=1){return this._smooth=r,this},Array.prototype.ease=function(r="linear"){return typeof r=="function"?(this._smooth=1,this._ease=r):rc[r]&&(this._smooth=1,this._ease=rc[r]),this},Array.prototype.offset=function(r=.5){return this._offset=r%1,this},Array.prototype.fit=function(r=0,e=1){let t=Math.min(...this),i=Math.max(...this);const n=this.map(s=>zA(s,t,i,r,e));return n._speed=this._speed,n._smooth=this._smooth,n._ease=this._ease,n}},getValue:(r=[])=>({time:e,bpm:t})=>{let i=r._speed?r._speed:1,n=r._smooth?r._smooth:0,s=e*i*(t/60)+(r._offset||0);if(n!==0){let o=r._ease?r._ease:rc.linear,a=s-n/2,l=r[Math.floor(a%r.length)],f=r[Math.floor((a+1)%r.length)],c=Math.min(a%1/n,1);return o(c)*(f-l)+l}else return r[Math.floor(s%r.length)]}};function UA(r){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(t=>t.kind==="videoinput")).then(e=>{let t={audio:!1,video:!0};return e[r]&&(t.video={deviceId:{exact:e[r].deviceId}}),window.navigator.mediaDevices.getUserMedia(t)}).then(e=>{const t=document.createElement("video");return t.setAttribute("autoplay",""),t.setAttribute("muted",""),t.setAttribute("playsinline",""),t.srcObject=e,new Promise((i,n)=>{t.addEventListener("loadedmetadata",()=>{t.play().then(()=>i(t))})})})}function qA(r){return new Promise(function(e,t){navigator.mediaDevices.getDisplayMedia(r).then(i=>{const n=document.createElement("video");n.srcObject=i,n.addEventListener("loadedmetadata",()=>{n.play(),e(n)})}).catch(i=>t(i))})}class lv{constructor({regl:e}){this.init=t=>{t.src&&(this.src=t.src,this.tex=this.regl.texture(this.src)),t.dynamic&&(this.dynamic=t.dynamic)},this.initCam=t=>{UA(t).then(i=>{this.src=i,this.dynamic=!0,this.tex=this.regl.texture(i)}).catch(i=>console.log("could not get camera",i))},this.initVideo=(t="")=>{const i=document.createElement("video");i.crossOrigin="anonymous",i.autoplay=!0,i.loop=!0,i.muted=!0,i.addEventListener("loadeddata",()=>{this.src=i,i.play(),this.tex=this.regl.texture(this.src),this.dynamic=!0}),i.src=t},this.initImage=(t="")=>{const i=document.createElement("img");i.crossOrigin="anonymous",i.src=t,i.onload=()=>{this.src=i,this.dynamic=!1,this.tex=this.regl.texture(this.src)}},this.initScreen=()=>{qA().then(t=>{this.src=t,this.tex=this.regl.texture(this.src),this.dynamic=!0}).catch(t=>console.log("could not get screen",t))},this.clear=()=>{this.src&&"srcObject"in this.src&&this.src.srcObject&&"getTracks"in this.src.srcObject&&this.src.srcObject.getTracks&&this.src.srcObject.getTracks().forEach(t=>t.stop()),this.src=void 0,this.tex=this.regl.texture({shape:[1,1]})},this.tick=t=>{this.src&&this.dynamic&&("videoWidth"in this.src&&this.src.videoWidth&&this.src.videoWidth!==this.tex.width&&this.tex.resize(this.src.videoWidth,this.src.videoHeight),"width"in this.src&&this.src.width&&this.src.width!==this.tex.width&&this.tex.resize(this.src.width,this.src.height),this.tex.subimage(this.src))},this.getTexture=()=>this.tex,this.regl=e,this.src=void 0,this.dynamic=!0,this.tex=this.regl.texture({shape:[1,1]})}}function HA({generatorTransforms:r,modifierTransforms:e}){const t=class extends ov{},i={};for(const n of r){const s=Jm(n);i[s.name]=(...o)=>new t({transform:s,userArgs:o})}for(const n of e){const s=Jm(n);YA(t,s)}return i}function YA(r,e){function t(...i){return this.transforms.push({transform:e,userArgs:i}),this}r.prototype[e.name]=t}const KA={src:{returnType:"vec4",implicitFirstArg:"vec2 _st"},coord:{returnType:"vec2",implicitFirstArg:"vec2 _st"},color:{returnType:"vec4",implicitFirstArg:"vec4 _c0"},combine:{returnType:"vec4",implicitFirstArg:"vec4 _c0"},combineCoord:{returnType:"vec2",implicitFirstArg:"vec2 _st"}};function Jm(r){const{implicitFirstArg:e,returnType:t}=KA[r.type],i=[e,...r.inputs.map(s=>`${s.type} ${s.name}`)].join(", ");let n=`
  ${t} ${r.name}(${i}) {
      ${r.glsl}
  }
`;return Object.assign(Object.assign({},r),{glsl:n,processed:!0})}const JA=[{name:"noise",type:"src",inputs:[{type:"float",name:"scale",default:10},{type:"float",name:"offset",default:.1}],glsl:"   return vec4(vec3(_noise(vec3(_st*scale, offset*time))), 1.0);"},{name:"voronoi",type:"src",inputs:[{type:"float",name:"scale",default:5},{type:"float",name:"speed",default:.3},{type:"float",name:"blending",default:.3}],glsl:`   vec3 color = vec3(.0);
   // Scale
   _st *= scale;
   // Tile the space
   vec2 i_st = floor(_st);
   vec2 f_st = fract(_st);
   float m_dist = 10.;  // minimun distance
   vec2 m_point;        // minimum point
   for (int j=-1; j<=1; j++ ) {
   for (int i=-1; i<=1; i++ ) {
   vec2 neighbor = vec2(float(i),float(j));
   vec2 p = i_st + neighbor;
   vec2 point = fract(sin(vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3))))*43758.5453);
   point = 0.5 + 0.5*sin(time*speed + 6.2831*point);
   vec2 diff = neighbor + point - f_st;
   float dist = length(diff);
   if( dist < m_dist ) {
   m_dist = dist;
   m_point = point;
   }
   }
   }
   // Assign a color using the closest point position
   color += dot(m_point,vec2(.3,.6));
   color *= 1.0 - blending*m_dist;
   return vec4(color, 1.0);`},{name:"osc",type:"src",inputs:[{type:"float",name:"frequency",default:60},{type:"float",name:"sync",default:.1},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st;
   float r = sin((st.x-offset/frequency+time*sync)*frequency)*0.5  + 0.5;
   float g = sin((st.x+time*sync)*frequency)*0.5 + 0.5;
   float b = sin((st.x+offset/frequency+time*sync)*frequency)*0.5  + 0.5;
   return vec4(r, g, b, 1.0);`},{name:"shape",type:"src",inputs:[{type:"float",name:"sides",default:3},{type:"float",name:"radius",default:.3},{type:"float",name:"smoothing",default:.01}],glsl:`   vec2 st = _st * 2. - 1.;
   // Angle and radius from the current pixel
   float a = atan(st.x,st.y)+3.1416;
   float r = (2.*3.1416)/sides;
   float d = cos(floor(.5+a/r)*r-a)*length(st);
   return vec4(vec3(1.0-smoothstep(radius,radius + smoothing + 0.0000001,d)), 1.0);`},{name:"gradient",type:"src",inputs:[{type:"float",name:"speed",default:0}],glsl:"   return vec4(_st, sin(time*speed), 1.0);"},{name:"src",type:"src",inputs:[{type:"sampler2D",name:"tex",default:NaN}],glsl:"return texture2D(tex, fract(_st));"},{name:"solid",type:"src",inputs:[{type:"float",name:"r",default:0},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:1}],glsl:"   return vec4(r, g, b, a);"}],eC=[{name:"rotate",type:"coord",inputs:[{type:"float",name:"angle",default:10},{type:"float",name:"speed",default:0}],glsl:`   vec2 xy = _st - vec2(0.5);
   float ang = angle + speed *time;
   xy = mat2(cos(ang),-sin(ang), sin(ang),cos(ang))*xy;
   xy += 0.5;
   return xy;`},{name:"scale",type:"coord",inputs:[{type:"float",name:"amount",default:1.5},{type:"float",name:"xMult",default:1},{type:"float",name:"yMult",default:1},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:`   vec2 xy = _st - vec2(offsetX, offsetY);
   xy*=(1.0/vec2(amount*xMult, amount*yMult));
   xy+=vec2(offsetX, offsetY);
   return xy;
   `},{name:"pixelate",type:"coord",inputs:[{type:"float",name:"pixelX",default:20},{type:"float",name:"pixelY",default:20}],glsl:`   vec2 xy = vec2(pixelX, pixelY);
   return (floor(_st * xy) + 0.5)/xy;`},{name:"posterize",type:"color",inputs:[{type:"float",name:"bins",default:3},{type:"float",name:"gamma",default:.6}],glsl:`   vec4 c2 = pow(_c0, vec4(gamma));
   c2 *= vec4(bins);
   c2 = floor(c2);
   c2/= vec4(bins);
   c2 = pow(c2, vec4(1.0/gamma));
   return vec4(c2.xyz, _c0.a);`},{name:"shift",type:"color",inputs:[{type:"float",name:"r",default:.5},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:0}],glsl:`   vec4 c2 = vec4(_c0);
   c2.r = fract(c2.r + r);
   c2.g = fract(c2.g + g);
   c2.b = fract(c2.b + b);
   c2.a = fract(c2.a + a);
   return vec4(c2.rgba);`},{name:"repeat",type:"coord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:0},{type:"float",name:"offsetY",default:0}],glsl:`   vec2 st = _st * vec2(repeatX, repeatY);
   st.x += step(1., mod(st.y,2.0)) * offsetX;
   st.y += step(1., mod(st.x,2.0)) * offsetY;
   return fract(st);`},{name:"modulateRepeat",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:`   vec2 st = _st * vec2(repeatX, repeatY);
   st.x += step(1., mod(st.y,2.0)) + color.r * offsetX;
   st.y += step(1., mod(st.x,2.0)) + color.g * offsetY;
   return fract(st);`},{name:"repeatX",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.y += step(1., mod(st.x,2.0))* offset;
   return fract(st);`},{name:"modulateRepeatX",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.y += step(1., mod(st.x,2.0)) + color.r * offset;
   return fract(st);`},{name:"repeatY",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st * vec2(1.0, reps);
   //  float f =  mod(_st.y,2.0);
   st.x += step(1., mod(st.y,2.0))* offset;
   return fract(st);`},{name:"modulateRepeatY",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.x += step(1., mod(st.y,2.0)) + color.r * offset;
   return fract(st);`},{name:"kaleid",type:"coord",inputs:[{type:"float",name:"nSides",default:4}],glsl:`   vec2 st = _st;
   st -= 0.5;
   float r = length(st);
   float a = atan(st.y, st.x);
   float pi = 2.*3.1416;
   a = mod(a,pi/nSides);
   a = abs(a-pi/nSides/2.);
   return r*vec2(cos(a), sin(a));`},{name:"modulateKaleid",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"nSides",default:4}],glsl:`   vec2 st = _st - 0.5;
   float r = length(st);
   float a = atan(st.y, st.x);
   float pi = 2.*3.1416;
   a = mod(a,pi/nSides);
   a = abs(a-pi/nSides/2.);
   return (color.r+r)*vec2(cos(a), sin(a));`},{name:"scroll",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"scrollY",default:.5},{type:"float",name:"speedX",default:0},{type:"float",name:"speedY",default:0}],glsl:`
   _st.x += scrollX + time*speedX;
   _st.y += scrollY + time*speedY;
   return fract(_st);`},{name:"scrollX",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.x += scrollX + time*speed;
   return fract(_st);`},{name:"modulateScrollX",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.x += color.r*scrollX + time*speed;
   return fract(_st);`},{name:"scrollY",type:"coord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.y += scrollY + time*speed;
   return fract(_st);`},{name:"modulateScrollY",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.y += color.r*scrollY + time*speed;
   return fract(_st);`},{name:"add",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"amount",default:1}],glsl:"   return (_c0+color)*amount + _c0*(1.0-amount);"},{name:"sub",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"amount",default:1}],glsl:"   return (_c0-color)*amount + _c0*(1.0-amount);"},{name:"layer",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4}],glsl:"   return vec4(mix(_c0.rgb, color.rgb, color.a), _c0.a+color.a);"},{name:"blend",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"amount",default:.5}],glsl:"   return _c0*(1.0-amount)+color*amount;"},{name:"mult",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"amount",default:1}],glsl:"   return _c0*(1.0-amount)+(_c0*color)*amount;"},{name:"diff",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4}],glsl:"   return vec4(abs(_c0.rgb-color.rgb), max(_c0.a, color.a));"},{name:"modulate",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"amount",default:.1}],glsl:`   //  return fract(st+(color.xy-0.5)*amount);
   return _st + color.xy*amount;`},{name:"modulateScale",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:1}],glsl:`   vec2 xy = _st - vec2(0.5);
   xy*=(1.0/vec2(offset + multiple*color.r, offset + multiple*color.g));
   xy+=vec2(0.5);
   return xy;`},{name:"modulatePixelate",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"multiple",default:10},{type:"float",name:"offset",default:3}],glsl:`   vec2 xy = vec2(offset + color.x*multiple, offset + color.y*multiple);
   return (floor(_st * xy) + 0.5)/xy;`},{name:"modulateRotate",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:0}],glsl:`   vec2 xy = _st - vec2(0.5);
   float angle = offset + color.x * multiple;
   xy = mat2(cos(angle),-sin(angle), sin(angle),cos(angle))*xy;
   xy += 0.5;
   return xy;`},{name:"modulateHue",type:"combineCoord",inputs:[{name:"color",type:"vec4",vecLen:4},{type:"float",name:"amount",default:1}],glsl:"   return _st + (vec2(color.g - color.r, color.b - color.g) * amount * 1.0/resolution);"},{name:"invert",type:"color",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return vec4((1.0-_c0.rgb)*amount + _c0.rgb*(1.0-amount), _c0.a);"},{name:"contrast",type:"color",inputs:[{type:"float",name:"amount",default:1.6}],glsl:`   vec4 c = (_c0-vec4(0.5))*vec4(amount) + vec4(0.5);
   return vec4(c.rgb, _c0.a);`},{name:"brightness",type:"color",inputs:[{type:"float",name:"amount",default:.4}],glsl:"   return vec4(_c0.rgb + vec3(amount), _c0.a);"},{name:"mask",type:"combine",inputs:[{name:"color",type:"vec4",vecLen:4}],glsl:`   float a = _luminance(color.rgb);
   return vec4(_c0.rgb*a, a);`},{name:"luma",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.1}],glsl:`   float a = smoothstep(threshold-(tolerance+0.0000001), threshold+(tolerance+0.0000001), _luminance(_c0.rgb));
   return vec4(_c0.rgb*a, a);`},{name:"thresh",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.04}],glsl:"   return vec4(vec3(smoothstep(threshold-(tolerance+0.0000001), threshold+(tolerance+0.0000001), _luminance(_c0.rgb))), _c0.a);"},{name:"color",type:"color",inputs:[{type:"float",name:"r",default:1},{type:"float",name:"g",default:1},{type:"float",name:"b",default:1},{type:"float",name:"a",default:1}],glsl:`   vec4 c = vec4(r, g, b, a);
   vec4 pos = step(0.0, c); // detect whether negative
   // if > 0, return r * _c0
   // if < 0 return (1.0-r) * _c0
   return vec4(mix((1.0-_c0)*abs(c), c*_c0, pos));`},{name:"saturate",type:"color",inputs:[{type:"float",name:"amount",default:2}],glsl:`   const vec3 W = vec3(0.2125, 0.7154, 0.0721);
   vec3 intensity = vec3(dot(_c0.rgb, W));
   return vec4(mix(intensity, _c0.rgb, amount), _c0.a);`},{name:"hue",type:"color",inputs:[{type:"float",name:"hue",default:.4}],glsl:`   vec3 c = _rgbToHsv(_c0.rgb);
   c.r += hue;
   //  c.r = fract(c.r);
   return vec4(_hsvToRgb(c), _c0.a);`},{name:"colorama",type:"color",inputs:[{type:"float",name:"amount",default:.005}],glsl:`   vec3 c = _rgbToHsv(_c0.rgb);
   c += vec3(amount);
   c = _hsvToRgb(c);
   c = fract(c);
   return vec4(c, _c0.a);`},{name:"sum",type:"color",inputs:[{type:"vec4",name:"scale",default:1}],glsl:`   vec4 v = _c0 * s;
   return v.r + v.g + v.b + v.a;
   }
   float sum(vec2 _st, vec4 s) { // vec4 is not a typo, because argument type is not overloaded
   vec2 v = _st.xy * s.xy;
   return v.x + v.y;`},{name:"r",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.r * scale + offset);"},{name:"g",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.g * scale + offset);"},{name:"b",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.b * scale + offset);"},{name:"a",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.a * scale + offset);"}],{gradient:tC,noise:iC,osc:rC,shape:nC,solid:fv,src:cv,voronoi:sC}=HA({generatorTransforms:JA,modifierTransforms:eC}),oC=Object.freeze(Object.defineProperty({__proto__:null,gradient:tC,noise:iC,osc:rC,shape:nC,solid:fv,src:cv,voronoi:sC},Symbol.toStringTag,{value:"Module"}));function aC(r,e){const{transform:t,userArgs:i}=r,{inputs:n}=t;return n.map((s,o)=>{var a;const l=(a=s.vecLen)!==null&&a!==void 0?a:0;let f=s.default,c=!1;if(s.type==="float"&&(f=nc(f)),i.length>o){const d=i[o];f=d,typeof d=="function"?(l>0?f=(g,_)=>eO(d(_),l):f=(g,_)=>{try{return d(_)}catch(D){return console.log("ERROR",D),s.default}},c=!0):Array.isArray(d)&&(l>0?(c=!0,f=eO(f,l)):(f=(g,_)=>av.getValue(d)(_),c=!0))}if(f instanceof ov)c=!1;else if(s.type==="float"&&typeof f=="number")f=nc(f);else if(s.type.startsWith("vec")&&Array.isArray(f))c=!1,f=`${s.type}(${f.map(nc).join(", ")})`;else if(s.type==="sampler2D"){const d=f;f=()=>d.getTexture(),c=!0}else(f instanceof lv||f instanceof hv)&&(f=cv(f),c=!1);let{name:h}=s;return c&&(h+=e),{value:f,type:s.type,isUniform:c,vecLen:l,name:h}})}function nc(r){return r=r.toString(),r.indexOf(".")<0&&(r+="."),r}function eO(r,e){for(;r.length<e;)r.length===3?r.push(1):r.push(0);return r.slice(0,e)}function hl(r,e){let t=()=>"";return r.forEach(i=>{let n;const s=aC(i,e.uniforms.length);s.forEach(a=>{a.isUniform&&e.uniforms.push(a)}),lC(i,e.transformApplications)||e.transformApplications.push(i);const o=t;i.transform.type==="src"?t=a=>`${Rs(a,i,s,e)}`:i.transform.type==="coord"?t=a=>`${o(`${Rs(a,i,s,e)}`)}`:i.transform.type==="color"?t=a=>`${Rs(`${o(a)}`,i,s,e)}`:i.transform.type==="combine"?(n=s[0].value&&s[0].value.transforms?a=>`${hl(s[0].value.transforms,e)(a)}`:s[0].isUniform?()=>s[0].name:()=>s[0].value,t=a=>`${Rs(`${o(a)}, ${n(a)}`,i,s.slice(1),e)}`):i.transform.type==="combineCoord"&&(n=s[0].value&&s[0].value.transforms?a=>`${hl(s[0].value.transforms,e)(a)}`:s[0].isUniform?()=>s[0].name:()=>s[0].value,t=a=>`${o(`${Rs(`${a}, ${n(a)}`,i,s.slice(1),e)}`)}`)}),t}function Rs(r,e,t,i){const n=t.map(s=>s.isUniform?s.name:s.value&&s.value.transforms?`${hl(s.value.transforms,i)("st")}`:s.value).reduce((s,o)=>`${s}, ${o}`,"");return`${e.transform.name}(${r}${n})`}function lC(r,e){for(let t=0;t<e.length;t++)if(r.transform.name==e[t].transform.name)return!0;return!1}function fC(r,e){const t=cC(r),i={};return t.uniforms.forEach(s=>{i[s.name]=s.value}),{frag:`
  precision ${e.precision} float;
  ${Object.values(t.uniforms).map(s=>`
      uniform ${s.type} ${s.name};`).join("")}
  uniform float time;
  uniform vec2 resolution;
  varying vec2 uv;

  ${Object.values(ZA).map(s=>`
            ${s.glsl}
          `).join("")}

  ${t.transformApplications.map(s=>`
            ${s.transform.glsl}
          `).join("")}

  void main () {
    vec4 c = vec4(1, 0, 0, 1);
    vec2 st = gl_FragCoord.xy/resolution.xy;
    gl_FragColor = ${t.fragColor};
  }
  `,uniforms:Object.assign(Object.assign({},e.defaultUniforms),i)}}function cC(r){const e={uniforms:[],transformApplications:[],fragColor:""};e.fragColor=hl(r,e)("st");let t={};return e.uniforms.forEach(i=>t[i.name]=i),e.uniforms=Object.values(t),e}class hv{constructor({defaultUniforms:e,height:t,precision:i,regl:n,width:s}){this.pingPongIndex=0,this.regl=n,this.defaultUniforms=e,this.precision=i,this.draw=()=>{},this.vert=`
  precision ${this.precision} float;
  attribute vec2 position;
  varying vec2 uv;

  void main () {
    uv = position;
    gl_Position = vec4(2.0 * position - 1.0, 0, 1);
  }`,this.attributes={position:this.regl.buffer([[-2,0],[0,-2],[2,2]])},this.fbos=Array(2).fill(void 0).map(()=>this.regl.framebuffer({color:this.regl.texture({mag:"nearest",width:s,height:t,format:"rgba"}),depthStencil:!1}))}resize(e,t){this.fbos.forEach(i=>{i.resize(e,t)})}getCurrent(){return this.fbos[this.pingPongIndex]}getTexture(){const e=this.pingPongIndex?0:1;return this.fbos[e]}render(e){if(e.length===0)return;let t=fC(e,{defaultUniforms:this.defaultUniforms,precision:this.precision});this.draw=this.regl({frag:t.frag,vert:this.vert,attributes:this.attributes,uniforms:t.uniforms,count:3,framebuffer:()=>(this.pingPongIndex=this.pingPongIndex?0:1,this.fbos[this.pingPongIndex])})}tick(e){this.draw(e)}}var wr=globalThis&&globalThis.__classPrivateFieldSet||function(r,e,t,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},Bn=globalThis&&globalThis.__classPrivateFieldGet||function(r,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(r):i?i.value:e.get(r)},Gs,Xn,an,$a;class hC{constructor(e){Gs.set(this,performance.now()),Xn.set(this,!1),an.set(this,void 0),$a.set(this,void 0),this.start=()=>Bn(this,Xn,"f")?this:(wr(this,Xn,!0,"f"),wr(this,Gs,performance.now(),"f"),wr(this,an,requestAnimationFrame(this.tick),"f"),this),this.stop=()=>(wr(this,Xn,!1,"f"),Bn(this,an,"f")&&cancelAnimationFrame(Bn(this,an,"f")),wr(this,an,void 0,"f"),this),this.toggle=()=>(Bn(this,Xn,"f")?this.stop():this.start(),this),this.tick=()=>{wr(this,an,requestAnimationFrame(this.tick),"f");const t=performance.now(),i=t-Bn(this,Gs,"f");return Bn(this,$a,"f").call(this,i),wr(this,Gs,t,"f"),this},wr(this,$a,e,"f")}}Gs=new WeakMap,Xn=new WeakMap,an=new WeakMap,$a=new WeakMap;class uC{constructor({height:e,numOutputs:t=4,numSources:i=4,precision:n="mediump",regl:s,width:o}){this.outputs=[],this.sources=[],this.hush=()=>{this.outputs.forEach(l=>{fv(1,1,1,0).out(l)})},this.setResolution=(l,f)=>{this.synth.resolution=[l,f],this.outputs.forEach(c=>{c.resize(l,f)})},this.render=l=>{this.output=l!=null?l:this.outputs[0]},this.tick=l=>{this.synth.time+=l*.001*this.synth.speed,this.timeSinceLastUpdate+=l,(!this.synth.fps||this.timeSinceLastUpdate>=1e3/this.synth.fps)&&(this.synth.stats.fps=Math.ceil(1e3/this.timeSinceLastUpdate),this.sources.forEach(f=>{f.tick(this.synth)}),this.outputs.forEach(f=>{f.tick(this.synth)}),this.renderFbo({tex0:this.output.getCurrent(),resolution:this.synth.resolution}),this.timeSinceLastUpdate=0)},this.regl=s,this.synth={bpm:30,fps:void 0,resolution:[o,e],speed:1,stats:{fps:0},time:0},this.timeSinceLastUpdate=0;const a={time:this.regl.prop("time"),resolution:this.regl.prop("resolution")};this.precision=n,this.regl.clear({color:[0,0,0,1]}),this.renderFbo=this.regl({frag:`
      precision ${this.precision} float;
      varying vec2 uv;
      uniform vec2 resolution;
      uniform sampler2D tex0;

      void main () {
        gl_FragColor = texture2D(tex0, vec2(1.0 - uv.x, uv.y));
      }
      `,vert:`
      precision ${this.precision} float;
      attribute vec2 position;
      varying vec2 uv;

      void main () {
        uv = position;
        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);
      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),resolution:this.regl.prop("resolution")},count:3,depth:{enable:!1}});for(let l=0;l<i;l++){let f=new lv({regl:this.regl});this.sources.push(f)}for(let l=0;l<t;l++){const f=new hv({regl:this.regl,width:o,height:e,precision:this.precision,defaultUniforms:a});this.outputs.push(f)}this.output=this.outputs[0],this.loop=new hC(this.tick)}}class dC{constructor(){const n=document.createElement("canvas");n.style.backgroundColor="#000000",n.width=1080,n.height=1080,document.body.appendChild(n),av.init();const s=VA(n),o=new uC({width:1080*2,height:1080*2,precision:"mediump",regl:s});o.loop.start();const{sources:a,outputs:l,render:f}=o,[c,h,d,g]=l,{src:_,osc:D,gradient:E,shape:U,voronoi:Qe,noise:pe}=oC;D(()=>4*Math.PI).add(c,[0,.5].smooth()).mult(_(c).rotate(Math.PI/2),.6).out(c),_(c).scrollX(.1,-.1).scrollY(.1,-.1).out(h),f(h)}}const pC=new hx;pC.on(lO,r=>{mC.setValue(r)});const mC=new jA;new dC;
